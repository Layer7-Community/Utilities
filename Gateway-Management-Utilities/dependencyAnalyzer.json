{
  "encassConfigs": [
    {
      "guid": "c8a5a0d5-1ae2-4144-b538-5c311efc1560",
      "name": "Utility: Call Restman",
      "checksum": "054f361ae22354aabbfccceb8d7034a116de47dd",
      "description": "Call the Restman interface for managing the Gateway. Expects an administrative user to have been authenticated.",
      "policyName": "Utility: Call Restman",
      "encassArgs": [
        {
          "name": "element",
          "type": "STRING",
          "ordinal": 4,
          "guiPrompt": true,
          "guiLabel": "Element to add management namespace: "
        },
        {
          "name": "message",
          "type": "STRING",
          "ordinal": 3,
          "guiPrompt": true,
          "guiLabel": "Message (use for PUT and POST methods): "
        },
        {
          "name": "method",
          "type": "STRING",
          "ordinal": 2,
          "guiPrompt": true,
          "guiLabel": "Method (default=GET): "
        },
        {
          "name": "resource",
          "type": "STRING",
          "ordinal": 1,
          "guiPrompt": true,
          "guiLabel": "Restman resource string (default=policies): "
        }
      ],
      "encassResults": [
        {
          "name": "restGatewayMan.status",
          "type": "STRING"
        }
      ],
      "properties": [
        {
          "name": "allowTracing",
          "value": "false"
        },
        {
          "name": "paletteFolder",
          "value": "internalAssertions"
        },
        {
          "name": "paletteIconResourceName",
          "value": "Refresh16.gif"
        },
        {
          "name": "passMetricsToParent",
          "value": "false"
        }
      ]
    },
    {
      "guid": "f6b19229-a705-4c48-bc78-3975564a1a9a",
      "name": "Utility: Escape HTML String",
      "checksum": "04d51dd8844c599e49b2e4b3dde38af783c02d20",
      "description": "Escape a string for HTML display",
      "policyName": "Utility: HTML Escape String",
      "encassArgs": [
        {
          "name": "escapedString",
          "type": "STRING",
          "ordinal": 1,
          "guiPrompt": true,
          "guiLabel": "String to escape: "
        }
      ],
      "encassResults": [
        {
          "name": "escapedString",
          "type": "MESSAGE"
        }
      ],
      "properties": [
        {
          "name": "allowTracing",
          "value": "false"
        },
        {
          "name": "paletteFolder",
          "value": "internalAssertions"
        },
        {
          "name": "paletteIconResourceName",
          "value": "enableAllAssertions16.gif"
        },
        {
          "name": "passMetricsToParent",
          "value": "false"
        }
      ]
    },
    {
      "guid": "4bd10104-a43c-4ecf-ae4d-b95e312cad4b",
      "name": "Utility: Form and Session Authentication",
      "checksum": "37dd42d4ab59483726f86cf2cbcea3ecc227e09b",
      "description": "Authenticate form submission or session cookie",
      "policyName": "Utility: Form and Session Authentication",
      "encassArgs": [
        {
          "name": "sessionTTL",
          "type": "STRING",
          "ordinal": 1,
          "guiPrompt": true,
          "guiLabel": "Session TTL (default 600): "
        },
        {
          "name": "verifyAdmin",
          "type": "BOOLEAN",
          "ordinal": 2,
          "guiPrompt": true,
          "guiLabel": "Verify User is Administrator: "
        }
      ],
      "encassResults": [
        {
          "name": "form.message",
          "type": "STRING"
        },
        {
          "name": "loggedIn",
          "type": "BOOLEAN"
        },
        {
          "name": "logout",
          "type": "BOOLEAN"
        },
        {
          "name": "redirectUrl",
          "type": "STRING"
        }
      ],
      "properties": [
        {
          "name": "allowTracing",
          "value": "false"
        },
        {
          "name": "paletteFolder",
          "value": "internalAssertions"
        },
        {
          "name": "paletteIconResourceName",
          "value": "user16.png"
        },
        {
          "name": "passMetricsToParent",
          "value": "false"
        }
      ]
    },
    {
      "guid": "420909da-0e72-4996-a6ed-cf3c21b8bc59",
      "name": "Utility: Get All Policy XML",
      "checksum": "7f5cab48c53aae8c97849868f10ba29680c0c315",
      "description": "Call restman to get policy XML for all policies and services",
      "policyName": "Utility: Get All Policy XML",
      "encassArgs": [
        {
          "name": "cacheAge",
          "type": "STRING",
          "ordinal": 2,
          "guiPrompt": true,
          "guiLabel": "Cache Age (optional): "
        },
        {
          "name": "refresh",
          "type": "STRING",
          "ordinal": 1,
          "guiPrompt": true,
          "guiLabel": "Refresh Cache? (true|false) (optional): "
        }
      ],
      "encassResults": [
        {
          "name": "allPolicyXML",
          "type": "MESSAGE"
        },
        {
          "name": "error.msg",
          "type": "STRING"
        }
      ],
      "properties": [
        {
          "name": "allowTracing",
          "value": "false"
        },
        {
          "name": "paletteFolder",
          "value": "internalAssertions"
        },
        {
          "name": "paletteIconResourceName",
          "value": "Refresh16.gif"
        },
        {
          "name": "passMetricsToParent",
          "value": "false"
        }
      ]
    },
    {
      "guid": "48b49f89-16fe-4b7a-bb66-02d86ad236d8",
      "name": "Utility: List Active Connectors",
      "checksum": "00ee7c25e889936478982f02868d8912fa61f54a",
      "description": "Assertion to call restman and generate a sorted list of active connectors on the Gateway",
      "policyName": "Utility: List Active Connectors",
      "encassArgs": [
        {
          "name": "cacheAge",
          "type": "STRING",
          "ordinal": 2,
          "guiPrompt": true,
          "guiLabel": "Cache Age (optional): "
        },
        {
          "name": "refresh",
          "type": "STRING",
          "ordinal": 1,
          "guiPrompt": true,
          "guiLabel": "Refresh Cache? (true|false) (optional): "
        }
      ],
      "encassResults": [
        {
          "name": "activeConnectors.sorted",
          "type": "MESSAGE"
        },
        {
          "name": "error.msg",
          "type": "STRING"
        }
      ],
      "properties": [
        {
          "name": "allowTracing",
          "value": "false"
        },
        {
          "name": "paletteFolder",
          "value": "internalAssertions"
        },
        {
          "name": "paletteIconResourceName",
          "value": "Refresh16.gif"
        },
        {
          "name": "passMetricsToParent",
          "value": "false"
        }
      ]
    },
    {
      "guid": "b55454b6-3095-4e4d-92dc-3f10a6594fba",
      "name": "Utility: List Cassandra Connections",
      "checksum": "68dc7048d80a0e9ae79f76d3e031a96d757ef4f2",
      "description": "Assertion to call restman and generate a sorted list of cassandra connections on the Gateway",
      "policyName": "Utility: List Cassandra Connections",
      "encassArgs": [
        {
          "name": "cacheAge",
          "type": "STRING",
          "ordinal": 2,
          "guiPrompt": true,
          "guiLabel": "Cache Age (optional): "
        },
        {
          "name": "refresh",
          "type": "STRING",
          "ordinal": 1,
          "guiPrompt": true,
          "guiLabel": "Refresh Cache? (true|false) (optional): "
        }
      ],
      "encassResults": [
        {
          "name": "cassandraConnections.sorted",
          "type": "MESSAGE"
        },
        {
          "name": "error.msg",
          "type": "STRING"
        }
      ],
      "properties": [
        {
          "name": "allowTracing",
          "value": "false"
        },
        {
          "name": "paletteFolder",
          "value": "internalAssertions"
        },
        {
          "name": "paletteIconResourceName",
          "value": "Refresh16.gif"
        },
        {
          "name": "passMetricsToParent",
          "value": "false"
        }
      ]
    },
    {
      "guid": "c8e30576-c290-4bd0-b63d-1eb3df866479",
      "name": "Utility: List Cluster Properties",
      "checksum": "1973b16b021594b322217a2dd05a70dee999dbf7",
      "description": "Assertion to call restman and generate a sorted list of encapsulated assertions on the Gateway",
      "policyName": "Utility: List Cluster Properties",
      "encassArgs": [
        {
          "name": "cacheAge",
          "type": "STRING",
          "ordinal": 2,
          "guiPrompt": true,
          "guiLabel": "Cache Age (optional): "
        },
        {
          "name": "refresh",
          "type": "STRING",
          "ordinal": 1,
          "guiPrompt": true,
          "guiLabel": "Refresh Cache? (true|false) (optional): "
        }
      ],
      "encassResults": [
        {
          "name": "clusterProperties.sorted",
          "type": "MESSAGE"
        },
        {
          "name": "error.msg",
          "type": "STRING"
        }
      ],
      "properties": [
        {
          "name": "allowTracing",
          "value": "false"
        },
        {
          "name": "paletteFolder",
          "value": "internalAssertions"
        },
        {
          "name": "paletteIconResourceName",
          "value": "Refresh16.gif"
        },
        {
          "name": "passMetricsToParent",
          "value": "false"
        }
      ]
    },
    {
      "guid": "33877201-e5e7-4d81-a8d2-34c1250204ec",
      "name": "Utility: List Email Listeners",
      "checksum": "601745d337a229ac29e2a566d7a6d278bb7d3725",
      "description": "Assertion to call restman and generate a sorted list of email listeners on the Gateway",
      "policyName": "Utility: List Email Listeners",
      "encassArgs": [
        {
          "name": "cacheAge",
          "type": "STRING",
          "ordinal": 2,
          "guiPrompt": true,
          "guiLabel": "Cache Age (optional): "
        },
        {
          "name": "refresh",
          "type": "STRING",
          "ordinal": 1,
          "guiPrompt": true,
          "guiLabel": "Refresh Cache? (true|false) (optional): "
        }
      ],
      "encassResults": [
        {
          "name": "emailListeners.sorted",
          "type": "MESSAGE"
        },
        {
          "name": "error.msg",
          "type": "STRING"
        }
      ],
      "properties": [
        {
          "name": "allowTracing",
          "value": "false"
        },
        {
          "name": "paletteFolder",
          "value": "internalAssertions"
        },
        {
          "name": "paletteIconResourceName",
          "value": "Refresh16.gif"
        },
        {
          "name": "passMetricsToParent",
          "value": "false"
        }
      ]
    },
    {
      "guid": "8fc67f28-191e-4a4b-808b-299848593b53",
      "name": "Utility: List Encapsulated Assertions",
      "checksum": "4afc08f378bbe9d39e900f8a95fb1ca511dad5c4",
      "description": "Assertion to call restman and generate a sorted list of encapsulated assertions on the Gateway",
      "policyName": "Utility: List Encapsulated Assertions",
      "encassArgs": [
        {
          "name": "cacheAge",
          "type": "STRING",
          "ordinal": 2,
          "guiPrompt": true,
          "guiLabel": "Cache Age (optional): "
        },
        {
          "name": "refresh",
          "type": "STRING",
          "ordinal": 1,
          "guiPrompt": true,
          "guiLabel": "Refresh Cache? (true|false) (optional): "
        }
      ],
      "encassResults": [
        {
          "name": "encapsulatedAssertions.sorted",
          "type": "MESSAGE"
        },
        {
          "name": "error.msg",
          "type": "STRING"
        }
      ],
      "properties": [
        {
          "name": "allowTracing",
          "value": "false"
        },
        {
          "name": "paletteFolder",
          "value": "internalAssertions"
        },
        {
          "name": "paletteIconResourceName",
          "value": "Refresh16.gif"
        },
        {
          "name": "passMetricsToParent",
          "value": "false"
        }
      ]
    },
    {
      "guid": "fbb4b1d3-54a5-4ab4-95af-814267236d17",
      "name": "Utility: List Folders",
      "checksum": "12e011d8c3afebe63f9590c73c63e14fe880d4fb",
      "description": "Assertion to call restman and generate a sorted list of folders on the Gateway",
      "policyName": "Utility: List Folders",
      "encassArgs": [
        {
          "name": "cacheAge",
          "type": "STRING",
          "ordinal": 2,
          "guiPrompt": true,
          "guiLabel": "Cache Age (optional): "
        },
        {
          "name": "refresh",
          "type": "STRING",
          "ordinal": 1,
          "guiPrompt": true,
          "guiLabel": "Refresh Cache? (true|false) (optional): "
        }
      ],
      "encassResults": [
        {
          "name": "error.msg",
          "type": "STRING"
        },
        {
          "name": "folders.sorted",
          "type": "MESSAGE"
        }
      ],
      "properties": [
        {
          "name": "allowTracing",
          "value": "false"
        },
        {
          "name": "paletteFolder",
          "value": "internalAssertions"
        },
        {
          "name": "paletteIconResourceName",
          "value": "Refresh16.gif"
        },
        {
          "name": "passMetricsToParent",
          "value": "false"
        }
      ]
    },
    {
      "guid": "6db56c26-58d7-4ffc-8fa5-01b525d5468b",
      "name": "Utility: List Generic Entities",
      "checksum": "58cba9f3a7b90baa1327ca878c7e3b24e2e412e9",
      "description": "Assertion to call restman and generate a sorted list of generic entities on the Gateway",
      "policyName": "Utility: List Generic Entities",
      "encassArgs": [
        {
          "name": "cacheAge",
          "type": "STRING",
          "ordinal": 2,
          "guiPrompt": true,
          "guiLabel": "Cache Age (optional): "
        },
        {
          "name": "refresh",
          "type": "STRING",
          "ordinal": 1,
          "guiPrompt": true,
          "guiLabel": "Refresh Cache? (true|false) (optional): "
        }
      ],
      "encassResults": [
        {
          "name": "error.msg",
          "type": "STRING"
        },
        {
          "name": "genericEntities.sorted",
          "type": "MESSAGE"
        }
      ],
      "properties": [
        {
          "name": "allowTracing",
          "value": "false"
        },
        {
          "name": "paletteFolder",
          "value": "internalAssertions"
        },
        {
          "name": "paletteIconResourceName",
          "value": "Refresh16.gif"
        },
        {
          "name": "passMetricsToParent",
          "value": "false"
        }
      ]
    },
    {
      "guid": "ead32848-5ace-4468-95fe-50cb9d343d60",
      "name": "Utility: List Groups",
      "checksum": "09a958ecd157ee8bb159f996e1d8e2143959cd73",
      "description": "Assertion to call restman and generate a sorted list of groups in the Internal Identity Provider on the Gateway",
      "policyName": "Utility: List Groups",
      "encassArgs": [
        {
          "name": "cacheAge",
          "type": "STRING",
          "ordinal": 3,
          "guiPrompt": true,
          "guiLabel": "Cache Age (optional): "
        },
        {
          "name": "identityProviderIds",
          "type": "STRING",
          "ordinal": 1,
          "guiPrompt": true,
          "guiLabel": "Identity Provider IDs (comma separated, optional): "
        },
        {
          "name": "refresh",
          "type": "STRING",
          "ordinal": 2,
          "guiPrompt": true,
          "guiLabel": "Refresh Cache? (true|false) (optional): "
        }
      ],
      "encassResults": [
        {
          "name": "error.msg",
          "type": "STRING"
        },
        {
          "name": "groups.sorted",
          "type": "MESSAGE"
        }
      ],
      "properties": [
        {
          "name": "allowTracing",
          "value": "false"
        },
        {
          "name": "paletteFolder",
          "value": "internalAssertions"
        },
        {
          "name": "paletteIconResourceName",
          "value": "Refresh16.gif"
        },
        {
          "name": "passMetricsToParent",
          "value": "false"
        }
      ]
    },
    {
      "guid": "8ad8d013-cb3d-4ab1-b92d-8ad943148b5f",
      "name": "Utility: List HTTP Configurations",
      "checksum": "2c20ce652687b01e6a1d86cfa091bbae30d5f361",
      "description": "Assertion to call restman and generate a sorted list of HTTP configurations on the Gateway",
      "policyName": "Utility: List HTTP Configurations",
      "encassArgs": [
        {
          "name": "cacheAge",
          "type": "STRING",
          "ordinal": 2,
          "guiPrompt": true,
          "guiLabel": "Cache Age (optional): "
        },
        {
          "name": "refresh",
          "type": "STRING",
          "ordinal": 1,
          "guiPrompt": true,
          "guiLabel": "Refresh Cache? (true|false) (optional): "
        }
      ],
      "encassResults": [
        {
          "name": "error.msg",
          "type": "STRING"
        },
        {
          "name": "httpConfigurations.sorted",
          "type": "MESSAGE"
        }
      ],
      "properties": [
        {
          "name": "allowTracing",
          "value": "false"
        },
        {
          "name": "paletteFolder",
          "value": "internalAssertions"
        },
        {
          "name": "paletteIconResourceName",
          "value": "Refresh16.gif"
        },
        {
          "name": "passMetricsToParent",
          "value": "false"
        }
      ]
    },
    {
      "guid": "1ab6158d-33ce-4fa6-a7d8-2b8dc8e31faf",
      "name": "Utility: List Identity Providers",
      "checksum": "01ba482aa1aea8026c324e613fe6692a3bf9a521",
      "description": "Assertion to call restman and generate a sorted list of identity providers on the Gateway",
      "policyName": "Utility: List Identity Providers",
      "encassArgs": [
        {
          "name": "cacheAge",
          "type": "STRING",
          "ordinal": 2,
          "guiPrompt": true,
          "guiLabel": "Cache Age (optional): "
        },
        {
          "name": "refresh",
          "type": "STRING",
          "ordinal": 1,
          "guiPrompt": true,
          "guiLabel": "Refresh Cache? (true|false) (optional): "
        }
      ],
      "encassResults": [
        {
          "name": "error.msg",
          "type": "STRING"
        },
        {
          "name": "identityProviders.sorted",
          "type": "MESSAGE"
        }
      ],
      "properties": [
        {
          "name": "allowTracing",
          "value": "false"
        },
        {
          "name": "paletteFolder",
          "value": "internalAssertions"
        },
        {
          "name": "paletteIconResourceName",
          "value": "Refresh16.gif"
        },
        {
          "name": "passMetricsToParent",
          "value": "false"
        }
      ]
    },
    {
      "guid": "f8abecfe-11d6-44e4-be07-16e6080a7e5e",
      "name": "Utility: List JDBC Connections",
      "checksum": "e9b2b16f0eabcb7561a8c4c3c6ff77b14e5d3252",
      "description": "Assertion to call restman and generate a sorted list of JDBC connections on the Gateway",
      "policyName": "Utility: List JDBC Connections",
      "encassArgs": [
        {
          "name": "cacheAge",
          "type": "STRING",
          "ordinal": 2,
          "guiPrompt": true,
          "guiLabel": "Cache Age (optional): "
        },
        {
          "name": "refresh",
          "type": "STRING",
          "ordinal": 1,
          "guiPrompt": true,
          "guiLabel": "Refresh Cache? (true|false) (optional): "
        }
      ],
      "encassResults": [
        {
          "name": "error.msg",
          "type": "STRING"
        },
        {
          "name": "jdbcConnections.sorted",
          "type": "MESSAGE"
        }
      ],
      "properties": [
        {
          "name": "allowTracing",
          "value": "true"
        },
        {
          "name": "paletteFolder",
          "value": "internalAssertions"
        },
        {
          "name": "paletteIconResourceName",
          "value": "Refresh16.gif"
        },
        {
          "name": "passMetricsToParent",
          "value": "false"
        }
      ]
    },
    {
      "guid": "53bc61d8-f0d0-4024-b09c-61fd5c9ef33e",
      "name": "Utility: List JMS Destinations",
      "checksum": "e1c1a7407ca76aa1b4bfac06a6e77641d5f8b756",
      "description": "Assertion to call restman and generate a sorted list of JMS destinations on the Gateway",
      "policyName": "Utility: List JMS Destinations",
      "encassArgs": [
        {
          "name": "cacheAge",
          "type": "STRING",
          "ordinal": 2,
          "guiPrompt": true,
          "guiLabel": "Cache Age (optional): "
        },
        {
          "name": "refresh",
          "type": "STRING",
          "ordinal": 1,
          "guiPrompt": true,
          "guiLabel": "Refresh Cache? (true|false) (optional): "
        }
      ],
      "encassResults": [
        {
          "name": "error.msg",
          "type": "STRING"
        },
        {
          "name": "jmsDestinations.sorted",
          "type": "MESSAGE"
        }
      ],
      "properties": [
        {
          "name": "allowTracing",
          "value": "false"
        },
        {
          "name": "paletteFolder",
          "value": "internalAssertions"
        },
        {
          "name": "paletteIconResourceName",
          "value": "Refresh16.gif"
        },
        {
          "name": "passMetricsToParent",
          "value": "false"
        }
      ]
    },
    {
      "guid": "9bee9837-82a1-4aab-99f4-08b664773ad7",
      "name": "Utility: List Listen Ports",
      "checksum": "6b6163f34ab0e14e19ebb0ed829c6e2028cff688",
      "description": "Assertion to call restman and generate a sorted list of listen ports on the Gateway",
      "policyName": "Utility: List Listen Ports",
      "encassArgs": [
        {
          "name": "cacheAge",
          "type": "STRING",
          "ordinal": 2,
          "guiPrompt": true,
          "guiLabel": "Cache Age (optional): "
        },
        {
          "name": "refresh",
          "type": "STRING",
          "ordinal": 1,
          "guiPrompt": true,
          "guiLabel": "Refresh Cache? (true|false) (optional): "
        }
      ],
      "encassResults": [
        {
          "name": "error.msg",
          "type": "STRING"
        },
        {
          "name": "listenPorts.sorted",
          "type": "MESSAGE"
        }
      ],
      "properties": [
        {
          "name": "allowTracing",
          "value": "false"
        },
        {
          "name": "paletteFolder",
          "value": "internalAssertions"
        },
        {
          "name": "paletteIconResourceName",
          "value": "Refresh16.gif"
        },
        {
          "name": "passMetricsToParent",
          "value": "false"
        }
      ]
    },
    {
      "guid": "da84740e-cee3-47d8-b6f7-0a9eb1fd9638",
      "name": "Utility: List Policies",
      "checksum": "53c3e7bb5dddaa712c882a11aff39d82579ff1d5",
      "description": "Assertion to call restman and generate a sorted list of policies on the Gateway",
      "policyName": "Utility: List Policies",
      "encassArgs": [
        {
          "name": "cacheAge",
          "type": "STRING",
          "ordinal": 3,
          "guiPrompt": true,
          "guiLabel": "Cache Age (optional): "
        },
        {
          "name": "folderId",
          "type": "STRING",
          "ordinal": 1,
          "guiPrompt": true,
          "guiLabel": "Parent Folder ID (optional):"
        },
        {
          "name": "refresh",
          "type": "STRING",
          "ordinal": 2,
          "guiPrompt": true,
          "guiLabel": "Refresh Cache? (true|false) (optional): "
        }
      ],
      "encassResults": [
        {
          "name": "error.msg",
          "type": "STRING"
        },
        {
          "name": "policies.sorted",
          "type": "MESSAGE"
        }
      ],
      "properties": [
        {
          "name": "allowTracing",
          "value": "false"
        },
        {
          "name": "paletteFolder",
          "value": "internalAssertions"
        },
        {
          "name": "paletteIconResourceName",
          "value": "Refresh16.gif"
        },
        {
          "name": "passMetricsToParent",
          "value": "false"
        }
      ]
    },
    {
      "guid": "461cb9aa-0d25-4bf0-85d2-7e2d8d895e47",
      "name": "Utility: List Policy Backed Services",
      "checksum": "b6c0a6e5af64442bc14af9fae740c9f773d3eb83",
      "description": "Assertion to call restman and generate a sorted list of policy backed services on the Gateway",
      "policyName": "Utility: List Policy Backed Services",
      "encassArgs": [
        {
          "name": "cacheAge",
          "type": "STRING",
          "ordinal": 2,
          "guiPrompt": true,
          "guiLabel": "Cache Age (optional): "
        },
        {
          "name": "refresh",
          "type": "STRING",
          "ordinal": 1,
          "guiPrompt": true,
          "guiLabel": "Refresh Cache? (true|false) (optional): "
        }
      ],
      "encassResults": [
        {
          "name": "error.msg",
          "type": "STRING"
        },
        {
          "name": "policyBackedServices.sorted",
          "type": "MESSAGE"
        }
      ],
      "properties": [
        {
          "name": "allowTracing",
          "value": "false"
        },
        {
          "name": "paletteFolder",
          "value": "internalAssertions"
        },
        {
          "name": "paletteIconResourceName",
          "value": "Refresh16.gif"
        },
        {
          "name": "passMetricsToParent",
          "value": "false"
        }
      ]
    },
    {
      "guid": "fbdcb4ad-bf2d-44f7-8aef-c8e1553c13ba",
      "name": "Utility: List Private Keys",
      "checksum": "688870efb8e7c3c80c3e8e17ce7cb4dce935a32c",
      "description": "Assertion to call restman and generate a sorted list of private keys on the Gateway",
      "policyName": "Utility: List Private Keys",
      "encassArgs": [
        {
          "name": "cacheAge",
          "type": "STRING",
          "ordinal": 2,
          "guiPrompt": true,
          "guiLabel": "Cache Age (optional): "
        },
        {
          "name": "refresh",
          "type": "STRING",
          "ordinal": 1,
          "guiPrompt": true,
          "guiLabel": "Refresh Cache? (true|false) (optional): "
        }
      ],
      "encassResults": [
        {
          "name": "error.msg",
          "type": "STRING"
        },
        {
          "name": "privateKeys.sorted",
          "type": "MESSAGE"
        }
      ],
      "properties": [
        {
          "name": "allowTracing",
          "value": "false"
        },
        {
          "name": "paletteFolder",
          "value": "internalAssertions"
        },
        {
          "name": "paletteIconResourceName",
          "value": "Refresh16.gif"
        },
        {
          "name": "passMetricsToParent",
          "value": "false"
        }
      ]
    },
    {
      "guid": "100c1321-8d9f-45b9-80bd-ca1198081e5b",
      "name": "Utility: List Scheduled Tasks",
      "checksum": "8d046e2610ecdb39bd9a04bcbdabc78bbfb5ae76",
      "description": "Assertion to call restman and generate a sorted list of scheduled tasks on the Gateway",
      "policyName": "Utility: List Scheduled Tasks",
      "encassArgs": [
        {
          "name": "cacheAge",
          "type": "STRING",
          "ordinal": 2,
          "guiPrompt": true,
          "guiLabel": "Cache Age (optional): "
        },
        {
          "name": "refresh",
          "type": "STRING",
          "ordinal": 1,
          "guiPrompt": true,
          "guiLabel": "Refresh Cache? (true|false) (optional): "
        }
      ],
      "encassResults": [
        {
          "name": "error.msg",
          "type": "STRING"
        },
        {
          "name": "scheduledTasks.sorted",
          "type": "MESSAGE"
        }
      ],
      "properties": [
        {
          "name": "allowTracing",
          "value": "false"
        },
        {
          "name": "paletteFolder",
          "value": "internalAssertions"
        },
        {
          "name": "paletteIconResourceName",
          "value": "Refresh16.gif"
        },
        {
          "name": "passMetricsToParent",
          "value": "false"
        }
      ]
    },
    {
      "guid": "eeb96501-f75c-4078-bcf7-98bc2c52bfe8",
      "name": "Utility: List Secure Passwords",
      "checksum": "8293fbee07e7f5ffaa849edaa0b709602a1c9d4c",
      "description": "Assertion to call restman and generate a sorted list of secure passwords on the Gateway",
      "policyName": "Utility: List Secure Passwords",
      "encassArgs": [
        {
          "name": "cacheAge",
          "type": "STRING",
          "ordinal": 2,
          "guiPrompt": true,
          "guiLabel": "Cache Age (optional): "
        },
        {
          "name": "refresh",
          "type": "STRING",
          "ordinal": 1,
          "guiPrompt": true,
          "guiLabel": "Refresh Cache? (true|false) (optional): "
        }
      ],
      "encassResults": [
        {
          "name": "error.msg",
          "type": "STRING"
        },
        {
          "name": "securePasswords.sorted",
          "type": "MESSAGE"
        }
      ],
      "properties": [
        {
          "name": "allowTracing",
          "value": "false"
        },
        {
          "name": "paletteFolder",
          "value": "internalAssertions"
        },
        {
          "name": "paletteIconResourceName",
          "value": "Refresh16.gif"
        },
        {
          "name": "passMetricsToParent",
          "value": "false"
        }
      ]
    },
    {
      "guid": "6fcf3e6c-eac9-4b2b-ac49-aa5fb2ff801f",
      "name": "Utility: List Services",
      "checksum": "32d3a6438d0023a39d2aa19306a85029723db6d8",
      "description": "Assertion to call restman and generate a sorted list of services on the Gateway",
      "policyName": "Utility: List Services",
      "encassArgs": [
        {
          "name": "cacheAge",
          "type": "STRING",
          "ordinal": 3,
          "guiPrompt": true,
          "guiLabel": "Cache Age (optional): "
        },
        {
          "name": "folderId",
          "type": "STRING",
          "ordinal": 1,
          "guiPrompt": true,
          "guiLabel": "Parent Folder ID (optional):"
        },
        {
          "name": "refresh",
          "type": "STRING",
          "ordinal": 2,
          "guiPrompt": true,
          "guiLabel": "Refresh Cache? (true|false) (optional): "
        }
      ],
      "encassResults": [
        {
          "name": "error.msg",
          "type": "STRING"
        },
        {
          "name": "services.sorted",
          "type": "MESSAGE"
        }
      ],
      "properties": [
        {
          "name": "allowTracing",
          "value": "false"
        },
        {
          "name": "paletteFolder",
          "value": "internalAssertions"
        },
        {
          "name": "paletteIconResourceName",
          "value": "Refresh16.gif"
        },
        {
          "name": "passMetricsToParent",
          "value": "false"
        }
      ]
    },
    {
      "guid": "779a8f46-fcef-4739-b6c7-95eea2a160ff",
      "name": "Utility: List SiteMinder Configurations",
      "checksum": "6c2fa70e130637cdf538722601c6f32c3278a38d",
      "description": "Assertion to call restman and generate a sorted list of siteminder configurations on the Gateway",
      "policyName": "Utility: List SiteMinder Configurations",
      "encassArgs": [
        {
          "name": "cacheAge",
          "type": "STRING",
          "ordinal": 2,
          "guiPrompt": true,
          "guiLabel": "Cache Age (optional): "
        },
        {
          "name": "refresh",
          "type": "STRING",
          "ordinal": 1,
          "guiPrompt": true,
          "guiLabel": "Refresh Cache? (true|false) (optional): "
        }
      ],
      "encassResults": [
        {
          "name": "error.msg",
          "type": "STRING"
        },
        {
          "name": "siteminderConfigurations.sorted",
          "type": "MESSAGE"
        }
      ],
      "properties": [
        {
          "name": "allowTracing",
          "value": "false"
        },
        {
          "name": "paletteFolder",
          "value": "internalAssertions"
        },
        {
          "name": "paletteIconResourceName",
          "value": "Refresh16.gif"
        },
        {
          "name": "passMetricsToParent",
          "value": "false"
        }
      ]
    },
    {
      "guid": "1feebe6b-c754-4bdc-834b-c6f3065d0216",
      "name": "Utility: List Trusted Certificates",
      "checksum": "763856fed71a48bce66ebc85bc8dad177e28e231",
      "description": "Assertion to call restman and generate a sorted list of trusted certificates on the Gateway",
      "policyName": "Utility: List Trusted Certificates",
      "encassArgs": [
        {
          "name": "cacheAge",
          "type": "STRING",
          "ordinal": 2,
          "guiPrompt": true,
          "guiLabel": "Cache Age (optional): "
        },
        {
          "name": "refresh",
          "type": "STRING",
          "ordinal": 1,
          "guiPrompt": true,
          "guiLabel": "Refresh Cache? (true|false) (optional): "
        }
      ],
      "encassResults": [
        {
          "name": "error.msg",
          "type": "STRING"
        },
        {
          "name": "trustedCertificates.sorted",
          "type": "MESSAGE"
        }
      ],
      "properties": [
        {
          "name": "allowTracing",
          "value": "false"
        },
        {
          "name": "paletteFolder",
          "value": "internalAssertions"
        },
        {
          "name": "paletteIconResourceName",
          "value": "Refresh16.gif"
        },
        {
          "name": "passMetricsToParent",
          "value": "false"
        }
      ]
    },
    {
      "guid": "005d518f-604e-4c02-b889-85c2607e46cc",
      "name": "Utility: List Users",
      "checksum": "fc33353e8f6f27f0c4303f705fb8f5c5810696cd",
      "description": "Assertion to call restman and generate a sorted list of users in the Internal Identity Provider on the Gateway",
      "policyName": "Utility: List Users",
      "encassArgs": [
        {
          "name": "cacheAge",
          "type": "STRING",
          "ordinal": 3,
          "guiPrompt": true,
          "guiLabel": "Cache Age (optional): "
        },
        {
          "name": "identityProviderIds",
          "type": "STRING",
          "ordinal": 1,
          "guiPrompt": true,
          "guiLabel": "Identity Provider IDs (comma separated, optional): "
        },
        {
          "name": "refresh",
          "type": "STRING",
          "ordinal": 2,
          "guiPrompt": true,
          "guiLabel": "Refresh Cache? (true|false) (optional): "
        }
      ],
      "encassResults": [
        {
          "name": "error.msg",
          "type": "STRING"
        },
        {
          "name": "users.sorted",
          "type": "MESSAGE"
        }
      ],
      "properties": [
        {
          "name": "allowTracing",
          "value": "false"
        },
        {
          "name": "paletteFolder",
          "value": "internalAssertions"
        },
        {
          "name": "paletteIconResourceName",
          "value": "Refresh16.gif"
        },
        {
          "name": "passMetricsToParent",
          "value": "false"
        }
      ]
    }
  ],
  "internalIdps": [
    {
      "name": "Internal Identity Provider",
      "checksum": "909dcb79418e5aaca75df96cc0ec2b2cbc3bdef4",
      "certValidation": "USE_DEFAULT"
    }
  ],
  "policies": [
    {
      "guid": "fc38ba53-a1d8-4bb6-be56-819606f9d330",
      "name": "Utility: Call Restman",
      "policyType": "FRAGMENT",
      "checksum": "505c842aa4955f90f3bded8c817bec8321e25a3b",
      "folderPath": "/Gateway Management Utilities/fragments",
      "soap": false,
      "policy": {
        "xml": "<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<wsp:Policy xmlns:L7p=\"http://www.layer7tech.com/ws/policy\" xmlns:wsp=\"http://schemas.xmlsoap.org/ws/2002/12/policy\">\n    <wsp:All wsp:Usage=\"Required\">\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**************************************************************************************************************\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Call the Restman interface\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Inputs:\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - message (string) - Use when calling PUT and POST methods\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - resource (string) - The restman resource to call\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - method (string) - what method to use\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - element (string) - Element in response to wich namespace will be added\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**       - This is useful when response will be parsed through Items\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Outputs:\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - response (message)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - restGatewayMan.status (string)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** v1.0.0 - Jay MacDonald - 20201107 - Initial Version\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**************************************************************************************************************\"/>\n        </L7p:CommentAssertion>\n        <L7p:AuditDetailAssertion>\n            <L7p:AssertionComment assertionComment=\"included\">\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// FINE\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:AssertionComment>\n            <L7p:Detail stringValue=\"==> Entering Utility Fragment: ${policy.name}\"/>\n            <L7p:Level stringValue=\"FINE\"/>\n        </L7p:AuditDetailAssertion>\n        <wsp:OneOrMore wsp:Usage=\"Required\">\n            <L7p:ComparisonAssertion>\n                <L7p:CaseSensitive booleanValue=\"false\"/>\n                <L7p:Expression1 stringValue=\"${resource}\"/>\n                <L7p:Expression2 stringValue=\"\"/>\n                <L7p:Negate booleanValue=\"true\"/>\n                <L7p:Operator operator=\"EMPTY\"/>\n                <L7p:Predicates predicates=\"included\">\n                    <L7p:item binary=\"included\">\n                        <L7p:CaseSensitive booleanValue=\"false\"/>\n                        <L7p:Negated booleanValue=\"true\"/>\n                        <L7p:Operator operator=\"EMPTY\"/>\n                        <L7p:RightValue stringValue=\"\"/>\n                    </L7p:item>\n                </L7p:Predicates>\n            </L7p:ComparisonAssertion>\n            <L7p:SetVariable>\n                <L7p:Base64Expression stringValue=\"cG9saWNpZXM=\"/>\n                <L7p:VariableToSet stringValue=\"resource\"/>\n            </L7p:SetVariable>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Default resource is policies\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:OneOrMore>\n        <wsp:OneOrMore wsp:Usage=\"Required\">\n            <L7p:ComparisonAssertion>\n                <L7p:CaseSensitive booleanValue=\"false\"/>\n                <L7p:Expression1 stringValue=\"${method}\"/>\n                <L7p:Expression2 stringValue=\"\"/>\n                <L7p:Negate booleanValue=\"true\"/>\n                <L7p:Operator operator=\"EMPTY\"/>\n                <L7p:Predicates predicates=\"included\">\n                    <L7p:item binary=\"included\">\n                        <L7p:CaseSensitive booleanValue=\"false\"/>\n                        <L7p:Negated booleanValue=\"true\"/>\n                        <L7p:Operator operator=\"EMPTY\"/>\n                        <L7p:RightValue stringValue=\"\"/>\n                    </L7p:item>\n                </L7p:Predicates>\n            </L7p:ComparisonAssertion>\n            <L7p:SetVariable>\n                <L7p:Base64Expression stringValue=\"R0VU\"/>\n                <L7p:VariableToSet stringValue=\"method\"/>\n            </L7p:SetVariable>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Default method is GET\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:OneOrMore>\n        <L7p:AuditDetailAssertion>\n            <L7p:AssertionComment assertionComment=\"included\">\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// FINE\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:AssertionComment>\n            <L7p:Detail stringValue=\"==> ${method} ${resource}\"/>\n            <L7p:Level stringValue=\"FINE\"/>\n        </L7p:AuditDetailAssertion>\n        <L7p:SetVariable>\n            <L7p:Base64Expression stringValue=\"JHttZXNzYWdlfQ==\"/>\n            <L7p:ContentType stringValue=\"text/plain; charset=utf-8\"/>\n            <L7p:DataType variableDataType=\"message\"/>\n            <L7p:VariableToSet stringValue=\"restGatewayMan.message\"/>\n        </L7p:SetVariable>\n        <L7p:SetVariable>\n            <L7p:Base64Expression stringValue=\"LzEuMC8ke3Jlc291cmNlfQ==\"/>\n            <L7p:VariableToSet stringValue=\"restGatewayMan.uri\"/>\n        </L7p:SetVariable>\n        <L7p:SetVariable>\n            <L7p:Base64Expression stringValue=\"JHttZXRob2R9\"/>\n            <L7p:VariableToSet stringValue=\"restGatewayMan.action\"/>\n        </L7p:SetVariable>\n        <L7p:AddHeader>\n            <L7p:AssertionComment assertionComment=\"included\">\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// 7layer\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:AssertionComment>\n            <L7p:HeaderName stringValue=\"L7-key-passphrase\"/>\n            <L7p:HeaderValue stringValue=\"N2xheWVy\"/>\n            <L7p:OtherTargetMessageVariable stringValue=\"restGatewayMan.message\"/>\n            <L7p:Target target=\"OTHER\"/>\n        </L7p:AddHeader>\n        <L7p:RESTGatewayManagement>\n            <L7p:OtherTargetMessageVariable stringValue=\"restGatewayMan.message\"/>\n            <L7p:Target target=\"OTHER\"/>\n        </L7p:RESTGatewayManagement>\n        <wsp:OneOrMore wsp:Usage=\"Required\">\n            <L7p:ComparisonAssertion>\n                <L7p:CaseSensitive booleanValue=\"false\"/>\n                <L7p:Expression1 stringValue=\"${element}\"/>\n                <L7p:Expression2 stringValue=\"\"/>\n                <L7p:Operator operator=\"EMPTY\"/>\n                <L7p:Predicates predicates=\"included\">\n                    <L7p:item binary=\"included\">\n                        <L7p:CaseSensitive booleanValue=\"false\"/>\n                        <L7p:Operator operator=\"EMPTY\"/>\n                        <L7p:RightValue stringValue=\"\"/>\n                    </L7p:item>\n                </L7p:Predicates>\n            </L7p:ComparisonAssertion>\n            <L7p:Regex>\n                <L7p:AssertionComment assertionComment=\"included\">\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// Add namespace to each Policy element\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:AssertionComment>\n                <L7p:AutoTarget booleanValue=\"false\"/>\n                <L7p:PatternContainsVariables booleanValue=\"true\"/>\n                <L7p:Regex stringValue=\"&lt;l7:${element} \"/>\n                <L7p:Replace booleanValue=\"true\"/>\n                <L7p:Replacement stringValue=\"&lt;l7:${element} xmlns:l7=&quot;http://ns.l7tech.com/2010/04/gateway-management&quot; \"/>\n                <L7p:Target target=\"RESPONSE\"/>\n            </L7p:Regex>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Add management namespace to ${element} if set\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:OneOrMore>\n        <L7p:AuditDetailAssertion>\n            <L7p:AssertionComment assertionComment=\"included\">\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// FINE\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:AssertionComment>\n            <L7p:Detail stringValue=\"==> Leaving Utility Fragment: ${policy.name}\"/>\n            <L7p:Level stringValue=\"FINE\"/>\n        </L7p:AuditDetailAssertion>\n    </wsp:All>\n</wsp:Policy>\n"
      },
      "policyRevisions": [
        {
          "goid": "bed4baf4ff33b7e528854c3965d9bb08",
          "ordinal": 1,
          "active": true,
          "author": "admin",
          "time": "2025-02-05T14:20:38.383Z",
          "xml": "<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<wsp:Policy xmlns:L7p=\"http://www.layer7tech.com/ws/policy\" xmlns:wsp=\"http://schemas.xmlsoap.org/ws/2002/12/policy\">\n    <wsp:All wsp:Usage=\"Required\">\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**************************************************************************************************************\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Call the Restman interface\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Inputs:\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - message (string) - Use when calling PUT and POST methods\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - resource (string) - The restman resource to call\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - method (string) - what method to use\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - element (string) - Element in response to wich namespace will be added\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**       - This is useful when response will be parsed through Items\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Outputs:\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - response (message)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - restGatewayMan.status (string)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** v1.0.0 - Jay MacDonald - 20201107 - Initial Version\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**************************************************************************************************************\"/>\n        </L7p:CommentAssertion>\n        <L7p:AuditDetailAssertion>\n            <L7p:AssertionComment assertionComment=\"included\">\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// FINE\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:AssertionComment>\n            <L7p:Detail stringValue=\"==> Entering Utility Fragment: ${policy.name}\"/>\n            <L7p:Level stringValue=\"FINE\"/>\n        </L7p:AuditDetailAssertion>\n        <wsp:OneOrMore wsp:Usage=\"Required\">\n            <L7p:ComparisonAssertion>\n                <L7p:CaseSensitive booleanValue=\"false\"/>\n                <L7p:Expression1 stringValue=\"${resource}\"/>\n                <L7p:Expression2 stringValue=\"\"/>\n                <L7p:Negate booleanValue=\"true\"/>\n                <L7p:Operator operator=\"EMPTY\"/>\n                <L7p:Predicates predicates=\"included\">\n                    <L7p:item binary=\"included\">\n                        <L7p:CaseSensitive booleanValue=\"false\"/>\n                        <L7p:Negated booleanValue=\"true\"/>\n                        <L7p:Operator operator=\"EMPTY\"/>\n                        <L7p:RightValue stringValue=\"\"/>\n                    </L7p:item>\n                </L7p:Predicates>\n            </L7p:ComparisonAssertion>\n            <L7p:SetVariable>\n                <L7p:Base64Expression stringValue=\"cG9saWNpZXM=\"/>\n                <L7p:VariableToSet stringValue=\"resource\"/>\n            </L7p:SetVariable>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Default resource is policies\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:OneOrMore>\n        <wsp:OneOrMore wsp:Usage=\"Required\">\n            <L7p:ComparisonAssertion>\n                <L7p:CaseSensitive booleanValue=\"false\"/>\n                <L7p:Expression1 stringValue=\"${method}\"/>\n                <L7p:Expression2 stringValue=\"\"/>\n                <L7p:Negate booleanValue=\"true\"/>\n                <L7p:Operator operator=\"EMPTY\"/>\n                <L7p:Predicates predicates=\"included\">\n                    <L7p:item binary=\"included\">\n                        <L7p:CaseSensitive booleanValue=\"false\"/>\n                        <L7p:Negated booleanValue=\"true\"/>\n                        <L7p:Operator operator=\"EMPTY\"/>\n                        <L7p:RightValue stringValue=\"\"/>\n                    </L7p:item>\n                </L7p:Predicates>\n            </L7p:ComparisonAssertion>\n            <L7p:SetVariable>\n                <L7p:Base64Expression stringValue=\"R0VU\"/>\n                <L7p:VariableToSet stringValue=\"method\"/>\n            </L7p:SetVariable>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Default method is GET\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:OneOrMore>\n        <L7p:AuditDetailAssertion>\n            <L7p:AssertionComment assertionComment=\"included\">\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// FINE\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:AssertionComment>\n            <L7p:Detail stringValue=\"==> ${method} ${resource}\"/>\n            <L7p:Level stringValue=\"FINE\"/>\n        </L7p:AuditDetailAssertion>\n        <L7p:SetVariable>\n            <L7p:Base64Expression stringValue=\"JHttZXNzYWdlfQ==\"/>\n            <L7p:ContentType stringValue=\"text/plain; charset=utf-8\"/>\n            <L7p:DataType variableDataType=\"message\"/>\n            <L7p:VariableToSet stringValue=\"restGatewayMan.message\"/>\n        </L7p:SetVariable>\n        <L7p:SetVariable>\n            <L7p:Base64Expression stringValue=\"LzEuMC8ke3Jlc291cmNlfQ==\"/>\n            <L7p:VariableToSet stringValue=\"restGatewayMan.uri\"/>\n        </L7p:SetVariable>\n        <L7p:SetVariable>\n            <L7p:Base64Expression stringValue=\"JHttZXRob2R9\"/>\n            <L7p:VariableToSet stringValue=\"restGatewayMan.action\"/>\n        </L7p:SetVariable>\n        <L7p:AddHeader>\n            <L7p:AssertionComment assertionComment=\"included\">\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// 7layer\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:AssertionComment>\n            <L7p:HeaderName stringValue=\"L7-key-passphrase\"/>\n            <L7p:HeaderValue stringValue=\"N2xheWVy\"/>\n            <L7p:OtherTargetMessageVariable stringValue=\"restGatewayMan.message\"/>\n            <L7p:Target target=\"OTHER\"/>\n        </L7p:AddHeader>\n        <L7p:RESTGatewayManagement>\n            <L7p:OtherTargetMessageVariable stringValue=\"restGatewayMan.message\"/>\n            <L7p:Target target=\"OTHER\"/>\n        </L7p:RESTGatewayManagement>\n        <wsp:OneOrMore wsp:Usage=\"Required\">\n            <L7p:ComparisonAssertion>\n                <L7p:CaseSensitive booleanValue=\"false\"/>\n                <L7p:Expression1 stringValue=\"${element}\"/>\n                <L7p:Expression2 stringValue=\"\"/>\n                <L7p:Operator operator=\"EMPTY\"/>\n                <L7p:Predicates predicates=\"included\">\n                    <L7p:item binary=\"included\">\n                        <L7p:CaseSensitive booleanValue=\"false\"/>\n                        <L7p:Operator operator=\"EMPTY\"/>\n                        <L7p:RightValue stringValue=\"\"/>\n                    </L7p:item>\n                </L7p:Predicates>\n            </L7p:ComparisonAssertion>\n            <L7p:Regex>\n                <L7p:AssertionComment assertionComment=\"included\">\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// Add namespace to each Policy element\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:AssertionComment>\n                <L7p:AutoTarget booleanValue=\"false\"/>\n                <L7p:PatternContainsVariables booleanValue=\"true\"/>\n                <L7p:Regex stringValue=\"&lt;l7:${element} \"/>\n                <L7p:Replace booleanValue=\"true\"/>\n                <L7p:Replacement stringValue=\"&lt;l7:${element} xmlns:l7=&quot;http://ns.l7tech.com/2010/04/gateway-management&quot; \"/>\n                <L7p:Target target=\"RESPONSE\"/>\n            </L7p:Regex>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Add management namespace to ${element} if set\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:OneOrMore>\n        <L7p:AuditDetailAssertion>\n            <L7p:AssertionComment assertionComment=\"included\">\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// FINE\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:AssertionComment>\n            <L7p:Detail stringValue=\"==> Leaving Utility Fragment: ${policy.name}\"/>\n            <L7p:Level stringValue=\"FINE\"/>\n        </L7p:AuditDetailAssertion>\n    </wsp:All>\n</wsp:Policy>\n"
        }
      ]
    },
    {
      "guid": "fefc1213-858e-4be0-82cd-67e980463597",
      "name": "Utility: Form and Session Authentication",
      "policyType": "FRAGMENT",
      "checksum": "64c1be3e6e706fc265a71e8286af98d1aa9fddbb",
      "folderPath": "/Gateway Management Utilities/fragments",
      "soap": false,
      "policy": {
        "xml": "<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<wsp:Policy xmlns:L7p=\"http://www.layer7tech.com/ws/policy\" xmlns:wsp=\"http://schemas.xmlsoap.org/ws/2002/12/policy\">\n    <wsp:All wsp:Usage=\"Required\">\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Policy fragment for &quot;Utility: Form and Session Authentication&quot; encapsulated assertion\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Check for logout request, else check if session is cached and validate, else check if form was\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   submitted and validate, else assume user is not logged in.\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Inputs:\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - sessionTTL (string) - overrule default 600 second session TTL\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - verifyAdmin (boolean) - Verify that the authenticated user is a member of Administrator role\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Outputs:\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - loggedIn\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - logout\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - form.message (a string to display in the login form)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - redirectUrl\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** v1.0.0 - Jay MacDonald - 20201107 - Initial Version\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n        </L7p:CommentAssertion>\n        <L7p:AuditDetailAssertion>\n            <L7p:AssertionComment assertionComment=\"included\">\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// FINE\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:AssertionComment>\n            <L7p:Detail stringValue=\"==> Entering Utility Fragment: ${policy.name}\"/>\n            <L7p:Level stringValue=\"FINE\"/>\n        </L7p:AuditDetailAssertion>\n        <wsp:OneOrMore wsp:Usage=\"Required\">\n            <L7p:SslAssertion/>\n            <wsp:All wsp:Usage=\"Required\">\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"JHtyZXF1ZXN0LnVybH0=\"/>\n                    <L7p:VariableToSet stringValue=\"redirectUrl\"/>\n                </L7p:SetVariable>\n                <L7p:Regex>\n                    <L7p:AutoTarget booleanValue=\"false\"/>\n                    <L7p:OtherTargetMessageVariable stringValue=\"redirectUrl\"/>\n                    <L7p:Regex stringValue=\"^https?://\"/>\n                    <L7p:Replace booleanValue=\"true\"/>\n                    <L7p:Replacement stringValue=\"https://\"/>\n                    <L7p:Target target=\"OTHER\"/>\n                </L7p:Regex>\n                <L7p:Regex>\n                    <L7p:AutoTarget booleanValue=\"false\"/>\n                    <L7p:OtherTargetMessageVariable stringValue=\"redirectUrl\"/>\n                    <L7p:Regex stringValue=\":8080/\"/>\n                    <L7p:Replace booleanValue=\"true\"/>\n                    <L7p:Replacement stringValue=\":8443/\"/>\n                    <L7p:Target target=\"OTHER\"/>\n                </L7p:Regex>\n                <L7p:CustomizeErrorResponse>\n                    <L7p:Content stringValue=\"&lt;html>&lt;head>  &lt;title>SSL/TLS required&lt;/title>&lt;/head>&lt;body>  &lt;h1>SSL/TLS required&lt;/h1>  &lt;p>&lt;a href=&quot;${redirectUrl}&quot;>Continue&lt;/a>&lt;/p>  &lt;hr />&lt;/body>&lt;/html>\"/>\n                    <L7p:ContentType stringValue=\"text/html; charset=UTF-8\"/>\n                    <L7p:ExtraHeaders nameValuePairArray=\"included\">\n                        <L7p:item nameValuePair=\"included\">\n                            <L7p:Key stringValue=\"Location\"/>\n                            <L7p:Value stringValue=\"${redirectUrl}\"/>\n                        </L7p:item>\n                    </L7p:ExtraHeaders>\n                    <L7p:HttpStatus stringValue=\"302\"/>\n                </L7p:CustomizeErrorResponse>\n                <L7p:FalseAssertion/>\n                <L7p:assertionComment>\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// Set up redirect as error response and fail\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:assertionComment>\n            </wsp:All>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Verify SSL else redirect to SSL link\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:OneOrMore>\n        <L7p:SetVariable>\n            <L7p:AssertionComment assertionComment=\"included\">\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Default message on the login form\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:AssertionComment>\n            <L7p:Base64Expression stringValue=\"V2VsY29tZSE=\"/>\n            <L7p:VariableToSet stringValue=\"form.message\"/>\n        </L7p:SetVariable>\n        <L7p:SetVariable>\n            <L7p:AssertionComment assertionComment=\"included\">\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Initialise here\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:AssertionComment>\n            <L7p:Base64Expression stringValue=\"ZmFsc2U=\"/>\n            <L7p:VariableToSet stringValue=\"logout\"/>\n        </L7p:SetVariable>\n        <L7p:SetVariable>\n            <L7p:AssertionComment assertionComment=\"included\">\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Initialise here\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:AssertionComment>\n            <L7p:Base64Expression stringValue=\"ZmFsc2U=\"/>\n            <L7p:VariableToSet stringValue=\"loggedin\"/>\n        </L7p:SetVariable>\n        <wsp:OneOrMore wsp:Usage=\"Required\">\n            <L7p:ComparisonAssertion>\n                <L7p:CaseSensitive booleanValue=\"false\"/>\n                <L7p:Expression1 stringValue=\"${sessionTTL}\"/>\n                <L7p:Expression2 stringValue=\"\"/>\n                <L7p:Negate booleanValue=\"true\"/>\n                <L7p:Operator operator=\"EMPTY\"/>\n                <L7p:Predicates predicates=\"included\">\n                    <L7p:item binary=\"included\">\n                        <L7p:CaseSensitive booleanValue=\"false\"/>\n                        <L7p:Negated booleanValue=\"true\"/>\n                        <L7p:Operator operator=\"EMPTY\"/>\n                        <L7p:RightValue stringValue=\"\"/>\n                    </L7p:item>\n                </L7p:Predicates>\n            </L7p:ComparisonAssertion>\n            <L7p:SetVariable>\n                <L7p:Base64Expression stringValue=\"NjAw\"/>\n                <L7p:VariableToSet stringValue=\"sessionTTL\"/>\n            </L7p:SetVariable>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Ensure sessionTTL is set, default 600\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:OneOrMore>\n        <wsp:OneOrMore wsp:Usage=\"Required\">\n            <wsp:All wsp:Usage=\"Required\">\n                <L7p:ComparisonAssertion>\n                    <L7p:Expression1 stringValue=\"${request.http.parameter.action}\"/>\n                    <L7p:Expression2 stringValue=\"logout\"/>\n                    <L7p:Predicates predicates=\"included\">\n                        <L7p:item binary=\"included\">\n                            <L7p:RightValue stringValue=\"logout\"/>\n                        </L7p:item>\n                    </L7p:Predicates>\n                </L7p:ComparisonAssertion>\n                <L7p:AuditDetailAssertion>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// FINE\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Detail stringValue=\"==> Logout requested\"/>\n                    <L7p:Level stringValue=\"FINE\"/>\n                </L7p:AuditDetailAssertion>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"VXNlciBsb2dnZWQgb3V0\"/>\n                    <L7p:VariableToSet stringValue=\"form.message\"/>\n                </L7p:SetVariable>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"dHJ1ZQ==\"/>\n                    <L7p:VariableToSet stringValue=\"logout\"/>\n                </L7p:SetVariable>\n                <L7p:assertionComment>\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// Logout\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:assertionComment>\n            </wsp:All>\n            <wsp:All wsp:Usage=\"Required\">\n                <L7p:CookieCredentialSource>\n                    <L7p:CookieName stringValue=\"sessionKey\"/>\n                </L7p:CookieCredentialSource>\n                <L7p:AuditDetailAssertion>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// FINE\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Detail stringValue=\"==> Found sessionKey cookie in request: ${cookie.sessionKey}\"/>\n                    <L7p:Level stringValue=\"FINE\"/>\n                </L7p:AuditDetailAssertion>\n                <wsp:OneOrMore wsp:Usage=\"Required\">\n                    <L7p:CacheLookup>\n                        <L7p:CacheEntryKey stringValue=\"${cookie.sessionKey}\"/>\n                        <L7p:CacheId stringValue=\"loginCache\"/>\n                        <L7p:ContentTypeOverride stringValue=\"\"/>\n                        <L7p:MaxEntryAgeSeconds stringValue=\"${sessionTTL}\"/>\n                        <L7p:OtherTargetMessageVariable stringValue=\"sessionDetail\"/>\n                        <L7p:Target target=\"OTHER\"/>\n                    </L7p:CacheLookup>\n                    <wsp:All wsp:Usage=\"Required\">\n                        <L7p:SetVariable>\n                            <L7p:Base64Expression stringValue=\"TWlzc2luZyBzZXNzaW9u\"/>\n                            <L7p:VariableToSet stringValue=\"form.message\"/>\n                        </L7p:SetVariable>\n                        <L7p:ManageCookie>\n                            <L7p:AssertionComment assertionComment=\"included\">\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Remove cookie from browser by setting TTL to 0\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:AssertionComment>\n                            <L7p:CookieAttributes mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"path\"/>\n                                    <L7p:value nameValuePair=\"included\">\n                                    <L7p:Key stringValue=\"path\"/>\n                                    <L7p:Value stringValue=\"${request.url.path}\"/>\n                                    </L7p:value>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"name\"/>\n                                    <L7p:value nameValuePair=\"included\">\n                                    <L7p:Key stringValue=\"name\"/>\n                                    <L7p:Value stringValue=\"sessionKey\"/>\n                                    </L7p:value>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"max-age\"/>\n                                    <L7p:value nameValuePair=\"included\">\n                                    <L7p:Key stringValue=\"max-age\"/>\n                                    <L7p:Value stringValue=\"0\"/>\n                                    </L7p:value>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"httpOnly\"/>\n                                    <L7p:value nameValuePair=\"included\">\n                                    <L7p:Key stringValue=\"httpOnly\"/>\n                                    <L7p:Value stringValue=\"true\"/>\n                                    </L7p:value>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"secure\"/>\n                                    <L7p:value nameValuePair=\"included\">\n                                    <L7p:Key stringValue=\"secure\"/>\n                                    <L7p:Value stringValue=\"true\"/>\n                                    </L7p:value>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"value\"/>\n                                    <L7p:value nameValuePair=\"included\">\n                                    <L7p:Key stringValue=\"value\"/>\n                                    <L7p:Value stringValue=\"${cookie.sessionKey}\"/>\n                                    </L7p:value>\n                                </L7p:entry>\n                            </L7p:CookieAttributes>\n                            <L7p:Operation operation=\"ADD_OR_REPLACE\"/>\n                            <L7p:Target target=\"RESPONSE\"/>\n                        </L7p:ManageCookie>\n                        <L7p:SetVariable>\n                            <L7p:Base64Expression stringValue=\"ZmFsc2U=\"/>\n                            <L7p:VariableToSet stringValue=\"loggedin\"/>\n                        </L7p:SetVariable>\n                        <L7p:FalseAssertion/>\n                        <L7p:assertionComment>\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Fail due to missing session in cache\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:assertionComment>\n                    </wsp:All>\n                    <L7p:assertionComment>\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// Get session from cache else fail\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:assertionComment>\n                </wsp:OneOrMore>\n                <L7p:ResponseXpathAssertion>\n                    <L7p:VariablePrefix stringValue=\"username\"/>\n                    <L7p:XmlMsgSrc stringValue=\"sessionDetail\"/>\n                    <L7p:XpathExpression xpathExpressionValue=\"included\">\n                        <L7p:Expression stringValue=\"//Username\"/>\n                        <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                    </L7p:XpathExpression>\n                </L7p:ResponseXpathAssertion>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"JHt1c2VybmFtZS5yZXN1bHR9\"/>\n                    <L7p:VariableToSet stringValue=\"username\"/>\n                </L7p:SetVariable>\n                <L7p:ResponseXpathAssertion>\n                    <L7p:VariablePrefix stringValue=\"password\"/>\n                    <L7p:XmlMsgSrc stringValue=\"sessionDetail\"/>\n                    <L7p:XpathExpression xpathExpressionValue=\"included\">\n                        <L7p:Expression stringValue=\"//Password\"/>\n                        <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                    </L7p:XpathExpression>\n                </L7p:ResponseXpathAssertion>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"JHtwYXNzd29yZC5yZXN1bHR9\"/>\n                    <L7p:VariableToSet stringValue=\"password\"/>\n                </L7p:SetVariable>\n                <L7p:XpathCredentialSource>\n                    <L7p:PasswordExpression xpathExpressionValue=\"included\">\n                        <L7p:Expression stringValue=\"$password\"/>\n                    </L7p:PasswordExpression>\n                    <L7p:XpathExpression xpathExpressionValue=\"included\">\n                        <L7p:Expression stringValue=\"$username\"/>\n                    </L7p:XpathExpression>\n                </L7p:XpathCredentialSource>\n                <wsp:OneOrMore wsp:Usage=\"Required\">\n                    <L7p:Authentication>\n                        <L7p:IdentityProviderOid goidValue=\"0000000000000000fffffffffffffffe\"/>\n                    </L7p:Authentication>\n                    <wsp:All wsp:Usage=\"Required\">\n                        <L7p:SetVariable>\n                            <L7p:Base64Expression stringValue=\"SW52YWxpZCBjcmVkZW50aWFscy4gTG9nZ2luZyBvdXQ=\"/>\n                            <L7p:VariableToSet stringValue=\"form.message\"/>\n                        </L7p:SetVariable>\n                        <L7p:ManageCookie>\n                            <L7p:AssertionComment assertionComment=\"included\">\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Remove cookie from browser by setting TTL to 0\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:AssertionComment>\n                            <L7p:CookieAttributes mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"path\"/>\n                                    <L7p:value nameValuePair=\"included\">\n                                    <L7p:Key stringValue=\"path\"/>\n                                    <L7p:Value stringValue=\"${request.url.path}\"/>\n                                    </L7p:value>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"name\"/>\n                                    <L7p:value nameValuePair=\"included\">\n                                    <L7p:Key stringValue=\"name\"/>\n                                    <L7p:Value stringValue=\"sessionKey\"/>\n                                    </L7p:value>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"max-age\"/>\n                                    <L7p:value nameValuePair=\"included\">\n                                    <L7p:Key stringValue=\"max-age\"/>\n                                    <L7p:Value stringValue=\"0\"/>\n                                    </L7p:value>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"httpOnly\"/>\n                                    <L7p:value nameValuePair=\"included\">\n                                    <L7p:Key stringValue=\"httpOnly\"/>\n                                    <L7p:Value stringValue=\"true\"/>\n                                    </L7p:value>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"secure\"/>\n                                    <L7p:value nameValuePair=\"included\">\n                                    <L7p:Key stringValue=\"secure\"/>\n                                    <L7p:Value stringValue=\"true\"/>\n                                    </L7p:value>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"value\"/>\n                                    <L7p:value nameValuePair=\"included\">\n                                    <L7p:Key stringValue=\"value\"/>\n                                    <L7p:Value stringValue=\"${cookie.sessionKey}\"/>\n                                    </L7p:value>\n                                </L7p:entry>\n                            </L7p:CookieAttributes>\n                            <L7p:Operation operation=\"ADD_OR_REPLACE\"/>\n                            <L7p:Target target=\"RESPONSE\"/>\n                        </L7p:ManageCookie>\n                        <L7p:CacheStorage>\n                            <L7p:AssertionComment assertionComment=\"included\">\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Remove from cache by setting TTL to 0\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:AssertionComment>\n                            <L7p:CacheEntryKey stringValue=\"${cookie.sessionKey}\"/>\n                            <L7p:CacheId stringValue=\"loginCache\"/>\n                            <L7p:MaxEntries stringValue=\"25\"/>\n                            <L7p:MaxEntryAgeSeconds stringValue=\"0\"/>\n                            <L7p:MaxEntrySizeBytes stringValue=\"1000\"/>\n                            <L7p:OtherTargetMessageVariable stringValue=\"sessionDetail\"/>\n                            <L7p:Target target=\"OTHER\"/>\n                        </L7p:CacheStorage>\n                        <L7p:SetVariable>\n                            <L7p:Base64Expression stringValue=\"dHJ1ZQ==\"/>\n                            <L7p:VariableToSet stringValue=\"logout\"/>\n                        </L7p:SetVariable>\n                        <L7p:SetVariable>\n                            <L7p:Base64Expression stringValue=\"ZmFsc2U=\"/>\n                            <L7p:VariableToSet stringValue=\"loggedin\"/>\n                        </L7p:SetVariable>\n                        <L7p:FalseAssertion/>\n                        <L7p:assertionComment>\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Fail due to Invalid credentials\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:assertionComment>\n                    </wsp:All>\n                    <L7p:assertionComment>\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// Authenticate credentials else fail\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:assertionComment>\n                </wsp:OneOrMore>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"JHtjb29raWUuc2Vzc2lvbktleX0=\"/>\n                    <L7p:VariableToSet stringValue=\"sessionKey\"/>\n                </L7p:SetVariable>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"dHJ1ZQ==\"/>\n                    <L7p:VariableToSet stringValue=\"loggedin\"/>\n                </L7p:SetVariable>\n                <L7p:assertionComment>\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// Get session token and validate against cache\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:assertionComment>\n            </wsp:All>\n            <wsp:All wsp:Usage=\"Required\">\n                <L7p:ComparisonAssertion>\n                    <L7p:Expression1 stringValue=\"${request.http.parameter.action}\"/>\n                    <L7p:Expression2 stringValue=\"login\"/>\n                    <L7p:Predicates predicates=\"included\">\n                        <L7p:item binary=\"included\">\n                            <L7p:RightValue stringValue=\"login\"/>\n                        </L7p:item>\n                    </L7p:Predicates>\n                </L7p:ComparisonAssertion>\n                <L7p:AuditDetailAssertion>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// FINE\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Detail stringValue=\"==> Login form was submitted\"/>\n                    <L7p:Level stringValue=\"FINE\"/>\n                </L7p:AuditDetailAssertion>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"JHtyZXF1ZXN0Lmh0dHAucGFyYW1ldGVyLnVzZXJuYW1lfQ==\"/>\n                    <L7p:VariableToSet stringValue=\"username\"/>\n                </L7p:SetVariable>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"JHtyZXF1ZXN0Lmh0dHAucGFyYW1ldGVyLnBhc3N3b3JkfQ==\"/>\n                    <L7p:VariableToSet stringValue=\"password\"/>\n                </L7p:SetVariable>\n                <L7p:XpathCredentialSource>\n                    <L7p:PasswordExpression xpathExpressionValue=\"included\">\n                        <L7p:Expression stringValue=\"$password\"/>\n                    </L7p:PasswordExpression>\n                    <L7p:XpathExpression xpathExpressionValue=\"included\">\n                        <L7p:Expression stringValue=\"$username\"/>\n                    </L7p:XpathExpression>\n                </L7p:XpathCredentialSource>\n                <wsp:OneOrMore wsp:Usage=\"Required\">\n                    <L7p:Authentication>\n                        <L7p:IdentityProviderOid goidValue=\"0000000000000000fffffffffffffffe\"/>\n                    </L7p:Authentication>\n                    <wsp:All wsp:Usage=\"Required\">\n                        <L7p:SetVariable>\n                            <L7p:Base64Expression stringValue=\"SW52YWxpZCBjcmVkZW50aWFscy4gUGxlYXNlIHRyeSBhZ2Fpbg==\"/>\n                            <L7p:VariableToSet stringValue=\"form.message\"/>\n                        </L7p:SetVariable>\n                        <L7p:SetVariable>\n                            <L7p:Base64Expression stringValue=\"ZmFsc2U=\"/>\n                            <L7p:VariableToSet stringValue=\"loggedin\"/>\n                        </L7p:SetVariable>\n                        <L7p:FalseAssertion/>\n                        <L7p:assertionComment>\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Fail due to Invalid credentials\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:assertionComment>\n                    </wsp:All>\n                    <L7p:assertionComment>\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// Authenticate credentials else fail\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:assertionComment>\n                </wsp:OneOrMore>\n                <L7p:UUIDGenerator>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// ${session}\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:TargetVariable stringValue=\"sessionKey\"/>\n                </L7p:UUIDGenerator>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"PHNlc3Npb24gaWQ9IiR7c2Vzc2lvbktleX0iPjxVc2VybmFtZT4ke3JlcXVlc3QuaHR0cC5wYXJhbWV0ZXIudXNlcm5hbWV9PC9Vc2VybmFtZT48UGFzc3dvcmQ+JHtyZXF1ZXN0Lmh0dHAucGFyYW1ldGVyLnBhc3N3b3JkfTwvUGFzc3dvcmQ+PC9zZXNzaW9uPg==\"/>\n                    <L7p:ContentType stringValue=\"text/xml; charset=utf-8\"/>\n                    <L7p:DataType variableDataType=\"message\"/>\n                    <L7p:VariableToSet stringValue=\"sessionDetail\"/>\n                </L7p:SetVariable>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"dHJ1ZQ==\"/>\n                    <L7p:VariableToSet stringValue=\"loggedin\"/>\n                </L7p:SetVariable>\n                <L7p:assertionComment>\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// Form submitted, validate credential and cache\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:assertionComment>\n            </wsp:All>\n            <L7p:TrueAssertion/>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Authentication - override ${loggedIn} and ${logout}, never fail\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:OneOrMore>\n        <wsp:OneOrMore wsp:Usage=\"Required\">\n            <L7p:ComparisonAssertion>\n                <L7p:CaseSensitive booleanValue=\"false\"/>\n                <L7p:Expression1 stringValue=\"${loggedIn}\"/>\n                <L7p:Operator operatorNull=\"null\"/>\n                <L7p:Predicates predicates=\"included\">\n                    <L7p:item dataType=\"included\">\n                        <L7p:Type variableDataType=\"boolean\"/>\n                    </L7p:item>\n                    <L7p:item binary=\"included\">\n                        <L7p:CaseSensitive booleanValue=\"false\"/>\n                        <L7p:RightValue stringValue=\"false\"/>\n                    </L7p:item>\n                </L7p:Predicates>\n            </L7p:ComparisonAssertion>\n            <wsp:OneOrMore wsp:Usage=\"Required\">\n                <wsp:All wsp:Usage=\"Required\">\n                    <L7p:ComparisonAssertion>\n                        <L7p:CaseSensitive booleanValue=\"false\"/>\n                        <L7p:Expression1 stringValue=\"${verifyAdmin}\"/>\n                        <L7p:Operator operatorNull=\"null\"/>\n                        <L7p:Predicates predicates=\"included\">\n                            <L7p:item dataType=\"included\">\n                                <L7p:Type variableDataType=\"boolean\"/>\n                            </L7p:item>\n                            <L7p:item binary=\"included\">\n                                <L7p:CaseSensitive booleanValue=\"false\"/>\n                                <L7p:RightValue stringValue=\"false\"/>\n                            </L7p:item>\n                        </L7p:Predicates>\n                    </L7p:ComparisonAssertion>\n                    <L7p:ManageCookie>\n                        <L7p:CookieAttributes mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"name\"/>\n                                <L7p:value nameValuePair=\"included\">\n                                    <L7p:Key stringValue=\"name\"/>\n                                    <L7p:Value stringValue=\"sessionKey\"/>\n                                </L7p:value>\n                            </L7p:entry>\n                            <L7p:entry>\n                                <L7p:key stringValue=\"max-age\"/>\n                                <L7p:value nameValuePair=\"included\">\n                                    <L7p:Key stringValue=\"max-age\"/>\n                                    <L7p:Value stringValue=\"${sessionTTL}\"/>\n                                </L7p:value>\n                            </L7p:entry>\n                            <L7p:entry>\n                                <L7p:key stringValue=\"httpOnly\"/>\n                                <L7p:value nameValuePair=\"included\">\n                                    <L7p:Key stringValue=\"httpOnly\"/>\n                                    <L7p:Value stringValue=\"true\"/>\n                                </L7p:value>\n                            </L7p:entry>\n                            <L7p:entry>\n                                <L7p:key stringValue=\"secure\"/>\n                                <L7p:value nameValuePair=\"included\">\n                                    <L7p:Key stringValue=\"secure\"/>\n                                    <L7p:Value stringValue=\"true\"/>\n                                </L7p:value>\n                            </L7p:entry>\n                            <L7p:entry>\n                                <L7p:key stringValue=\"value\"/>\n                                <L7p:value nameValuePair=\"included\">\n                                    <L7p:Key stringValue=\"value\"/>\n                                    <L7p:Value stringValue=\"${sessionKey}\"/>\n                                </L7p:value>\n                            </L7p:entry>\n                        </L7p:CookieAttributes>\n                        <L7p:Operation operation=\"ADD_OR_REPLACE\"/>\n                        <L7p:Target target=\"RESPONSE\"/>\n                    </L7p:ManageCookie>\n                    <L7p:CacheStorage>\n                        <L7p:CacheEntryKey stringValue=\"${sessionKey}\"/>\n                        <L7p:CacheId stringValue=\"loginCache\"/>\n                        <L7p:MaxEntries stringValue=\"25\"/>\n                        <L7p:MaxEntryAgeSeconds stringValue=\"${sessionTTL}\"/>\n                        <L7p:MaxEntrySizeBytes stringValue=\"1000\"/>\n                        <L7p:OtherTargetMessageVariable stringValue=\"sessionDetail\"/>\n                        <L7p:Target target=\"OTHER\"/>\n                    </L7p:CacheStorage>\n                    <L7p:assertionComment>\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// ${verifyAdmin} == false - set the cookie and cache sessionDetail\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:assertionComment>\n                </wsp:All>\n                <wsp:All wsp:Usage=\"Required\">\n                    <L7p:ComparisonAssertion>\n                        <L7p:CaseSensitive booleanValue=\"false\"/>\n                        <L7p:Expression1 stringValue=\"${verifyAdmin}\"/>\n                        <L7p:Operator operatorNull=\"null\"/>\n                        <L7p:Predicates predicates=\"included\">\n                            <L7p:item dataType=\"included\">\n                                <L7p:Type variableDataType=\"boolean\"/>\n                            </L7p:item>\n                            <L7p:item binary=\"included\">\n                                <L7p:CaseSensitive booleanValue=\"false\"/>\n                                <L7p:RightValue stringValue=\"true\"/>\n                            </L7p:item>\n                        </L7p:Predicates>\n                    </L7p:ComparisonAssertion>\n                    <wsp:OneOrMore wsp:Usage=\"Required\">\n                        <wsp:All wsp:Usage=\"Required\">\n                            <L7p:Encapsulated>\n                                <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// GET roles?name=Administrator\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:AssertionComment>\n                                <L7p:EncapsulatedAssertionConfigGuid stringValue=\"c8a5a0d5-1ae2-4144-b538-5c311efc1560\"/>\n                                <L7p:EncapsulatedAssertionConfigName stringValue=\"Utility: Call Restman\"/>\n                                <L7p:Parameters mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"element\"/>\n                                    <L7p:value stringValue=\"\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"message\"/>\n                                    <L7p:value stringValue=\"\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"method\"/>\n                                    <L7p:value stringValue=\"GET\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"resource\"/>\n                                    <L7p:value stringValue=\"roles?name=Administrator\"/>\n                                    </L7p:entry>\n                                </L7p:Parameters>\n                            </L7p:Encapsulated>\n                            <L7p:SetVariable>\n                                <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Cast to string for XPath predicate\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:AssertionComment>\n                                <L7p:Base64Expression stringValue=\"JHtyZXF1ZXN0LmF1dGhlbnRpY2F0ZWR1c2VyLnByb3ZpZGVySWR9\"/>\n                                <L7p:VariableToSet stringValue=\"providerId\"/>\n                            </L7p:SetVariable>\n                            <L7p:SetVariable>\n                                <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Cast to string for XPath predicate\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:AssertionComment>\n                                <L7p:Base64Expression stringValue=\"JHtyZXF1ZXN0LmF1dGhlbnRpY2F0ZWR1c2VyLmlkfQ==\"/>\n                                <L7p:VariableToSet stringValue=\"identityId\"/>\n                            </L7p:SetVariable>\n                            <L7p:ResponseXpathAssertion>\n                                <L7p:VariablePrefix stringValue=\"entityType\"/>\n                                <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                    <L7p:Expression stringValue=\"/l7:List/l7:Item/l7:Resource/l7:Role/l7:assignments/l7:assignment[(l7:providerId=$providerId) and (l7:identityId=$identityId)]\"/>\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"s\"/>\n                                    <L7p:value stringValue=\"http://schemas.xmlsoap.org/soap/envelope/\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                                </L7p:XpathExpression>\n                            </L7p:ResponseXpathAssertion>\n                            <L7p:AuditDetailAssertion>\n                                <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// FINE\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:AssertionComment>\n                                <L7p:Detail stringValue=\"==> Confirmed that ${request.authenticateduser} is a member of Administrator role\"/>\n                                <L7p:Level stringValue=\"FINE\"/>\n                            </L7p:AuditDetailAssertion>\n                            <L7p:ManageCookie>\n                                <L7p:CookieAttributes mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"name\"/>\n                                    <L7p:value nameValuePair=\"included\">\n                                    <L7p:Key stringValue=\"name\"/>\n                                    <L7p:Value stringValue=\"sessionKey\"/>\n                                    </L7p:value>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"max-age\"/>\n                                    <L7p:value nameValuePair=\"included\">\n                                    <L7p:Key stringValue=\"max-age\"/>\n                                    <L7p:Value stringValue=\"${sessionTTL}\"/>\n                                    </L7p:value>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"httpOnly\"/>\n                                    <L7p:value nameValuePair=\"included\">\n                                    <L7p:Key stringValue=\"httpOnly\"/>\n                                    <L7p:Value stringValue=\"true\"/>\n                                    </L7p:value>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"secure\"/>\n                                    <L7p:value nameValuePair=\"included\">\n                                    <L7p:Key stringValue=\"secure\"/>\n                                    <L7p:Value stringValue=\"true\"/>\n                                    </L7p:value>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"value\"/>\n                                    <L7p:value nameValuePair=\"included\">\n                                    <L7p:Key stringValue=\"value\"/>\n                                    <L7p:Value stringValue=\"${sessionKey}\"/>\n                                    </L7p:value>\n                                    </L7p:entry>\n                                </L7p:CookieAttributes>\n                                <L7p:Operation operation=\"ADD_OR_REPLACE\"/>\n                                <L7p:Target target=\"RESPONSE\"/>\n                            </L7p:ManageCookie>\n                            <L7p:CacheStorage>\n                                <L7p:CacheEntryKey stringValue=\"${sessionKey}\"/>\n                                <L7p:CacheId stringValue=\"loginCache\"/>\n                                <L7p:MaxEntries stringValue=\"25\"/>\n                                <L7p:MaxEntryAgeSeconds stringValue=\"${sessionTTL}\"/>\n                                <L7p:MaxEntrySizeBytes stringValue=\"1000\"/>\n                                <L7p:OtherTargetMessageVariable stringValue=\"sessionDetail\"/>\n                                <L7p:Target target=\"OTHER\"/>\n                            </L7p:CacheStorage>\n                            <L7p:assertionComment>\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Get Administrator role from restman and check is authenticated user is in it\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:assertionComment>\n                        </wsp:All>\n                        <wsp:All wsp:Usage=\"Required\">\n                            <L7p:AuditDetailAssertion>\n                                <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// FINE\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:AssertionComment>\n                                <L7p:Detail stringValue=\"==> ${request.authenticateduser} is NOT a member of Administrator role\"/>\n                                <L7p:Level stringValue=\"FINE\"/>\n                            </L7p:AuditDetailAssertion>\n                            <L7p:SetVariable>\n                                <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Default message on the login form\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:AssertionComment>\n                                <L7p:Base64Expression stringValue=\"JHtyZXF1ZXN0LmF1dGhlbnRpY2F0ZWR1c2VyfSBpcyBub3QgYW4gYWRtaW5pc3RyYXRvci4=\"/>\n                                <L7p:VariableToSet stringValue=\"form.message\"/>\n                            </L7p:SetVariable>\n                            <L7p:SetVariable>\n                                <L7p:Base64Expression stringValue=\"ZmFsc2U=\"/>\n                                <L7p:VariableToSet stringValue=\"loggedIn\"/>\n                            </L7p:SetVariable>\n                            <L7p:assertionComment>\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Reset ${loggedIn} and ${form.message}\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:assertionComment>\n                        </wsp:All>\n                        <L7p:assertionComment>\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Attempt restman call else reset ${loggedIn} to false and set ${form.message}\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:assertionComment>\n                    </wsp:OneOrMore>\n                    <L7p:assertionComment>\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// ${verifyAdmin} == true\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:assertionComment>\n                </wsp:All>\n                <L7p:assertionComment>\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// Handle ${verifyAdmin} cases\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:assertionComment>\n            </wsp:OneOrMore>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Set cookie and cache sessionDetail (and test access to restman if requested)  if ${loggedIn} == true\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:OneOrMore>\n        <wsp:OneOrMore wsp:Usage=\"Required\">\n            <L7p:ComparisonAssertion>\n                <L7p:CaseSensitive booleanValue=\"false\"/>\n                <L7p:Expression1 stringValue=\"${request.http.method}\"/>\n                <L7p:Expression2 stringValue=\"GET\"/>\n                <L7p:Predicates predicates=\"included\">\n                    <L7p:item binary=\"included\">\n                        <L7p:CaseSensitive booleanValue=\"false\"/>\n                        <L7p:RightValue stringValue=\"GET\"/>\n                    </L7p:item>\n                </L7p:Predicates>\n            </L7p:ComparisonAssertion>\n            <wsp:All wsp:Usage=\"Required\">\n                <L7p:ComparisonAssertion>\n                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                    <L7p:Expression1 stringValue=\"${request.http.method}\"/>\n                    <L7p:Expression2 stringValue=\"POST\"/>\n                    <L7p:Predicates predicates=\"included\">\n                        <L7p:item binary=\"included\">\n                            <L7p:CaseSensitive booleanValue=\"false\"/>\n                            <L7p:RightValue stringValue=\"POST\"/>\n                        </L7p:item>\n                    </L7p:Predicates>\n                </L7p:ComparisonAssertion>\n                <L7p:ComparisonAssertion>\n                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                    <L7p:Expression1 stringValue=\"${request.http.uri}\"/>\n                    <L7p:Expression2 stringValue=\"/services/selection\"/>\n                    <L7p:Predicates predicates=\"included\">\n                        <L7p:item binary=\"included\">\n                            <L7p:CaseSensitive booleanValue=\"false\"/>\n                            <L7p:RightValue stringValue=\"/services/selection\"/>\n                        </L7p:item>\n                    </L7p:Predicates>\n                </L7p:ComparisonAssertion>\n                <L7p:assertionComment>\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// Added by cob when reusing the Utility for /services/selection\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:assertionComment>\n            </wsp:All>\n            <L7p:ComparisonAssertion>\n                <L7p:CaseSensitive booleanValue=\"false\"/>\n                <L7p:Expression1 stringValue=\"${loggedIn}\"/>\n                <L7p:Operator operatorNull=\"null\"/>\n                <L7p:Predicates predicates=\"included\">\n                    <L7p:item dataType=\"included\">\n                        <L7p:Type variableDataType=\"boolean\"/>\n                    </L7p:item>\n                    <L7p:item binary=\"included\">\n                        <L7p:CaseSensitive booleanValue=\"false\"/>\n                        <L7p:RightValue stringValue=\"false\"/>\n                    </L7p:item>\n                </L7p:Predicates>\n            </L7p:ComparisonAssertion>\n            <wsp:All wsp:Usage=\"Required\">\n                <L7p:ComparisonAssertion>\n                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                    <L7p:Expression1 stringValue=\"${loggedIn}\"/>\n                    <L7p:Operator operatorNull=\"null\"/>\n                    <L7p:Predicates predicates=\"included\">\n                        <L7p:item dataType=\"included\">\n                            <L7p:Type variableDataType=\"boolean\"/>\n                        </L7p:item>\n                        <L7p:item binary=\"included\">\n                            <L7p:CaseSensitive booleanValue=\"false\"/>\n                            <L7p:RightValue stringValue=\"true\"/>\n                        </L7p:item>\n                    </L7p:Predicates>\n                </L7p:ComparisonAssertion>\n                <L7p:CustomizeErrorResponse>\n                    <L7p:Content stringValue=\"&lt;html>&lt;head>  &lt;title>User logged in&lt;/title>&lt;/head>&lt;body>  &lt;h1>User logged in&lt;/h1>  &lt;p>&lt;a href=&quot;${request.url}&quot;>Continue&lt;/a>&lt;/p>  &lt;hr />&lt;/body>&lt;/html>\"/>\n                    <L7p:ContentType stringValue=\"text/html; charset=UTF-8\"/>\n                    <L7p:ExtraHeaders nameValuePairArray=\"included\">\n                        <L7p:item nameValuePair=\"included\">\n                            <L7p:Key stringValue=\"Location\"/>\n                            <L7p:Value stringValue=\"${request.url}\"/>\n                        </L7p:item>\n                    </L7p:ExtraHeaders>\n                    <L7p:HttpStatus stringValue=\"302\"/>\n                </L7p:CustomizeErrorResponse>\n                <L7p:FalseAssertion/>\n                <L7p:assertionComment>\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// Redirect to this URL with GET\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:assertionComment>\n            </wsp:All>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Redirect if method is not GET\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:OneOrMore>\n        <L7p:AuditDetailAssertion>\n            <L7p:AssertionComment assertionComment=\"included\">\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// FINE\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:AssertionComment>\n            <L7p:Detail stringValue=\"==> Leaving Utility Fragment: ${policy.name}\"/>\n            <L7p:Level stringValue=\"FINE\"/>\n        </L7p:AuditDetailAssertion>\n    </wsp:All>\n</wsp:Policy>\n"
      },
      "policyRevisions": [
        {
          "goid": "bed4baf4ff33b7e528854c3965d9bb0c",
          "ordinal": 1,
          "active": true,
          "author": "admin",
          "time": "2025-02-05T14:20:38.389Z",
          "xml": "<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<wsp:Policy xmlns:L7p=\"http://www.layer7tech.com/ws/policy\" xmlns:wsp=\"http://schemas.xmlsoap.org/ws/2002/12/policy\">\n    <wsp:All wsp:Usage=\"Required\">\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Policy fragment for &quot;Utility: Form and Session Authentication&quot; encapsulated assertion\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Check for logout request, else check if session is cached and validate, else check if form was\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   submitted and validate, else assume user is not logged in.\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Inputs:\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - sessionTTL (string) - overrule default 600 second session TTL\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - verifyAdmin (boolean) - Verify that the authenticated user is a member of Administrator role\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Outputs:\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - loggedIn\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - logout\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - form.message (a string to display in the login form)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - redirectUrl\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** v1.0.0 - Jay MacDonald - 20201107 - Initial Version\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n        </L7p:CommentAssertion>\n        <L7p:AuditDetailAssertion>\n            <L7p:AssertionComment assertionComment=\"included\">\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// FINE\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:AssertionComment>\n            <L7p:Detail stringValue=\"==> Entering Utility Fragment: ${policy.name}\"/>\n            <L7p:Level stringValue=\"FINE\"/>\n        </L7p:AuditDetailAssertion>\n        <wsp:OneOrMore wsp:Usage=\"Required\">\n            <L7p:SslAssertion/>\n            <wsp:All wsp:Usage=\"Required\">\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"JHtyZXF1ZXN0LnVybH0=\"/>\n                    <L7p:VariableToSet stringValue=\"redirectUrl\"/>\n                </L7p:SetVariable>\n                <L7p:Regex>\n                    <L7p:AutoTarget booleanValue=\"false\"/>\n                    <L7p:OtherTargetMessageVariable stringValue=\"redirectUrl\"/>\n                    <L7p:Regex stringValue=\"^https?://\"/>\n                    <L7p:Replace booleanValue=\"true\"/>\n                    <L7p:Replacement stringValue=\"https://\"/>\n                    <L7p:Target target=\"OTHER\"/>\n                </L7p:Regex>\n                <L7p:Regex>\n                    <L7p:AutoTarget booleanValue=\"false\"/>\n                    <L7p:OtherTargetMessageVariable stringValue=\"redirectUrl\"/>\n                    <L7p:Regex stringValue=\":8080/\"/>\n                    <L7p:Replace booleanValue=\"true\"/>\n                    <L7p:Replacement stringValue=\":8443/\"/>\n                    <L7p:Target target=\"OTHER\"/>\n                </L7p:Regex>\n                <L7p:CustomizeErrorResponse>\n                    <L7p:Content stringValue=\"&lt;html>&lt;head>  &lt;title>SSL/TLS required&lt;/title>&lt;/head>&lt;body>  &lt;h1>SSL/TLS required&lt;/h1>  &lt;p>&lt;a href=&quot;${redirectUrl}&quot;>Continue&lt;/a>&lt;/p>  &lt;hr />&lt;/body>&lt;/html>\"/>\n                    <L7p:ContentType stringValue=\"text/html; charset=UTF-8\"/>\n                    <L7p:ExtraHeaders nameValuePairArray=\"included\">\n                        <L7p:item nameValuePair=\"included\">\n                            <L7p:Key stringValue=\"Location\"/>\n                            <L7p:Value stringValue=\"${redirectUrl}\"/>\n                        </L7p:item>\n                    </L7p:ExtraHeaders>\n                    <L7p:HttpStatus stringValue=\"302\"/>\n                </L7p:CustomizeErrorResponse>\n                <L7p:FalseAssertion/>\n                <L7p:assertionComment>\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// Set up redirect as error response and fail\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:assertionComment>\n            </wsp:All>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Verify SSL else redirect to SSL link\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:OneOrMore>\n        <L7p:SetVariable>\n            <L7p:AssertionComment assertionComment=\"included\">\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Default message on the login form\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:AssertionComment>\n            <L7p:Base64Expression stringValue=\"V2VsY29tZSE=\"/>\n            <L7p:VariableToSet stringValue=\"form.message\"/>\n        </L7p:SetVariable>\n        <L7p:SetVariable>\n            <L7p:AssertionComment assertionComment=\"included\">\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Initialise here\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:AssertionComment>\n            <L7p:Base64Expression stringValue=\"ZmFsc2U=\"/>\n            <L7p:VariableToSet stringValue=\"logout\"/>\n        </L7p:SetVariable>\n        <L7p:SetVariable>\n            <L7p:AssertionComment assertionComment=\"included\">\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Initialise here\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:AssertionComment>\n            <L7p:Base64Expression stringValue=\"ZmFsc2U=\"/>\n            <L7p:VariableToSet stringValue=\"loggedin\"/>\n        </L7p:SetVariable>\n        <wsp:OneOrMore wsp:Usage=\"Required\">\n            <L7p:ComparisonAssertion>\n                <L7p:CaseSensitive booleanValue=\"false\"/>\n                <L7p:Expression1 stringValue=\"${sessionTTL}\"/>\n                <L7p:Expression2 stringValue=\"\"/>\n                <L7p:Negate booleanValue=\"true\"/>\n                <L7p:Operator operator=\"EMPTY\"/>\n                <L7p:Predicates predicates=\"included\">\n                    <L7p:item binary=\"included\">\n                        <L7p:CaseSensitive booleanValue=\"false\"/>\n                        <L7p:Negated booleanValue=\"true\"/>\n                        <L7p:Operator operator=\"EMPTY\"/>\n                        <L7p:RightValue stringValue=\"\"/>\n                    </L7p:item>\n                </L7p:Predicates>\n            </L7p:ComparisonAssertion>\n            <L7p:SetVariable>\n                <L7p:Base64Expression stringValue=\"NjAw\"/>\n                <L7p:VariableToSet stringValue=\"sessionTTL\"/>\n            </L7p:SetVariable>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Ensure sessionTTL is set, default 600\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:OneOrMore>\n        <wsp:OneOrMore wsp:Usage=\"Required\">\n            <wsp:All wsp:Usage=\"Required\">\n                <L7p:ComparisonAssertion>\n                    <L7p:Expression1 stringValue=\"${request.http.parameter.action}\"/>\n                    <L7p:Expression2 stringValue=\"logout\"/>\n                    <L7p:Predicates predicates=\"included\">\n                        <L7p:item binary=\"included\">\n                            <L7p:RightValue stringValue=\"logout\"/>\n                        </L7p:item>\n                    </L7p:Predicates>\n                </L7p:ComparisonAssertion>\n                <L7p:AuditDetailAssertion>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// FINE\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Detail stringValue=\"==> Logout requested\"/>\n                    <L7p:Level stringValue=\"FINE\"/>\n                </L7p:AuditDetailAssertion>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"VXNlciBsb2dnZWQgb3V0\"/>\n                    <L7p:VariableToSet stringValue=\"form.message\"/>\n                </L7p:SetVariable>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"dHJ1ZQ==\"/>\n                    <L7p:VariableToSet stringValue=\"logout\"/>\n                </L7p:SetVariable>\n                <L7p:assertionComment>\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// Logout\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:assertionComment>\n            </wsp:All>\n            <wsp:All wsp:Usage=\"Required\">\n                <L7p:CookieCredentialSource>\n                    <L7p:CookieName stringValue=\"sessionKey\"/>\n                </L7p:CookieCredentialSource>\n                <L7p:AuditDetailAssertion>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// FINE\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Detail stringValue=\"==> Found sessionKey cookie in request: ${cookie.sessionKey}\"/>\n                    <L7p:Level stringValue=\"FINE\"/>\n                </L7p:AuditDetailAssertion>\n                <wsp:OneOrMore wsp:Usage=\"Required\">\n                    <L7p:CacheLookup>\n                        <L7p:CacheEntryKey stringValue=\"${cookie.sessionKey}\"/>\n                        <L7p:CacheId stringValue=\"loginCache\"/>\n                        <L7p:ContentTypeOverride stringValue=\"\"/>\n                        <L7p:MaxEntryAgeSeconds stringValue=\"${sessionTTL}\"/>\n                        <L7p:OtherTargetMessageVariable stringValue=\"sessionDetail\"/>\n                        <L7p:Target target=\"OTHER\"/>\n                    </L7p:CacheLookup>\n                    <wsp:All wsp:Usage=\"Required\">\n                        <L7p:SetVariable>\n                            <L7p:Base64Expression stringValue=\"TWlzc2luZyBzZXNzaW9u\"/>\n                            <L7p:VariableToSet stringValue=\"form.message\"/>\n                        </L7p:SetVariable>\n                        <L7p:ManageCookie>\n                            <L7p:AssertionComment assertionComment=\"included\">\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Remove cookie from browser by setting TTL to 0\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:AssertionComment>\n                            <L7p:CookieAttributes mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"path\"/>\n                                    <L7p:value nameValuePair=\"included\">\n                                    <L7p:Key stringValue=\"path\"/>\n                                    <L7p:Value stringValue=\"${request.url.path}\"/>\n                                    </L7p:value>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"name\"/>\n                                    <L7p:value nameValuePair=\"included\">\n                                    <L7p:Key stringValue=\"name\"/>\n                                    <L7p:Value stringValue=\"sessionKey\"/>\n                                    </L7p:value>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"max-age\"/>\n                                    <L7p:value nameValuePair=\"included\">\n                                    <L7p:Key stringValue=\"max-age\"/>\n                                    <L7p:Value stringValue=\"0\"/>\n                                    </L7p:value>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"httpOnly\"/>\n                                    <L7p:value nameValuePair=\"included\">\n                                    <L7p:Key stringValue=\"httpOnly\"/>\n                                    <L7p:Value stringValue=\"true\"/>\n                                    </L7p:value>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"secure\"/>\n                                    <L7p:value nameValuePair=\"included\">\n                                    <L7p:Key stringValue=\"secure\"/>\n                                    <L7p:Value stringValue=\"true\"/>\n                                    </L7p:value>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"value\"/>\n                                    <L7p:value nameValuePair=\"included\">\n                                    <L7p:Key stringValue=\"value\"/>\n                                    <L7p:Value stringValue=\"${cookie.sessionKey}\"/>\n                                    </L7p:value>\n                                </L7p:entry>\n                            </L7p:CookieAttributes>\n                            <L7p:Operation operation=\"ADD_OR_REPLACE\"/>\n                            <L7p:Target target=\"RESPONSE\"/>\n                        </L7p:ManageCookie>\n                        <L7p:SetVariable>\n                            <L7p:Base64Expression stringValue=\"ZmFsc2U=\"/>\n                            <L7p:VariableToSet stringValue=\"loggedin\"/>\n                        </L7p:SetVariable>\n                        <L7p:FalseAssertion/>\n                        <L7p:assertionComment>\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Fail due to missing session in cache\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:assertionComment>\n                    </wsp:All>\n                    <L7p:assertionComment>\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// Get session from cache else fail\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:assertionComment>\n                </wsp:OneOrMore>\n                <L7p:ResponseXpathAssertion>\n                    <L7p:VariablePrefix stringValue=\"username\"/>\n                    <L7p:XmlMsgSrc stringValue=\"sessionDetail\"/>\n                    <L7p:XpathExpression xpathExpressionValue=\"included\">\n                        <L7p:Expression stringValue=\"//Username\"/>\n                        <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                    </L7p:XpathExpression>\n                </L7p:ResponseXpathAssertion>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"JHt1c2VybmFtZS5yZXN1bHR9\"/>\n                    <L7p:VariableToSet stringValue=\"username\"/>\n                </L7p:SetVariable>\n                <L7p:ResponseXpathAssertion>\n                    <L7p:VariablePrefix stringValue=\"password\"/>\n                    <L7p:XmlMsgSrc stringValue=\"sessionDetail\"/>\n                    <L7p:XpathExpression xpathExpressionValue=\"included\">\n                        <L7p:Expression stringValue=\"//Password\"/>\n                        <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                    </L7p:XpathExpression>\n                </L7p:ResponseXpathAssertion>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"JHtwYXNzd29yZC5yZXN1bHR9\"/>\n                    <L7p:VariableToSet stringValue=\"password\"/>\n                </L7p:SetVariable>\n                <L7p:XpathCredentialSource>\n                    <L7p:PasswordExpression xpathExpressionValue=\"included\">\n                        <L7p:Expression stringValue=\"$password\"/>\n                    </L7p:PasswordExpression>\n                    <L7p:XpathExpression xpathExpressionValue=\"included\">\n                        <L7p:Expression stringValue=\"$username\"/>\n                    </L7p:XpathExpression>\n                </L7p:XpathCredentialSource>\n                <wsp:OneOrMore wsp:Usage=\"Required\">\n                    <L7p:Authentication>\n                        <L7p:IdentityProviderOid goidValue=\"0000000000000000fffffffffffffffe\"/>\n                    </L7p:Authentication>\n                    <wsp:All wsp:Usage=\"Required\">\n                        <L7p:SetVariable>\n                            <L7p:Base64Expression stringValue=\"SW52YWxpZCBjcmVkZW50aWFscy4gTG9nZ2luZyBvdXQ=\"/>\n                            <L7p:VariableToSet stringValue=\"form.message\"/>\n                        </L7p:SetVariable>\n                        <L7p:ManageCookie>\n                            <L7p:AssertionComment assertionComment=\"included\">\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Remove cookie from browser by setting TTL to 0\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:AssertionComment>\n                            <L7p:CookieAttributes mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"path\"/>\n                                    <L7p:value nameValuePair=\"included\">\n                                    <L7p:Key stringValue=\"path\"/>\n                                    <L7p:Value stringValue=\"${request.url.path}\"/>\n                                    </L7p:value>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"name\"/>\n                                    <L7p:value nameValuePair=\"included\">\n                                    <L7p:Key stringValue=\"name\"/>\n                                    <L7p:Value stringValue=\"sessionKey\"/>\n                                    </L7p:value>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"max-age\"/>\n                                    <L7p:value nameValuePair=\"included\">\n                                    <L7p:Key stringValue=\"max-age\"/>\n                                    <L7p:Value stringValue=\"0\"/>\n                                    </L7p:value>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"httpOnly\"/>\n                                    <L7p:value nameValuePair=\"included\">\n                                    <L7p:Key stringValue=\"httpOnly\"/>\n                                    <L7p:Value stringValue=\"true\"/>\n                                    </L7p:value>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"secure\"/>\n                                    <L7p:value nameValuePair=\"included\">\n                                    <L7p:Key stringValue=\"secure\"/>\n                                    <L7p:Value stringValue=\"true\"/>\n                                    </L7p:value>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"value\"/>\n                                    <L7p:value nameValuePair=\"included\">\n                                    <L7p:Key stringValue=\"value\"/>\n                                    <L7p:Value stringValue=\"${cookie.sessionKey}\"/>\n                                    </L7p:value>\n                                </L7p:entry>\n                            </L7p:CookieAttributes>\n                            <L7p:Operation operation=\"ADD_OR_REPLACE\"/>\n                            <L7p:Target target=\"RESPONSE\"/>\n                        </L7p:ManageCookie>\n                        <L7p:CacheStorage>\n                            <L7p:AssertionComment assertionComment=\"included\">\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Remove from cache by setting TTL to 0\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:AssertionComment>\n                            <L7p:CacheEntryKey stringValue=\"${cookie.sessionKey}\"/>\n                            <L7p:CacheId stringValue=\"loginCache\"/>\n                            <L7p:MaxEntries stringValue=\"25\"/>\n                            <L7p:MaxEntryAgeSeconds stringValue=\"0\"/>\n                            <L7p:MaxEntrySizeBytes stringValue=\"1000\"/>\n                            <L7p:OtherTargetMessageVariable stringValue=\"sessionDetail\"/>\n                            <L7p:Target target=\"OTHER\"/>\n                        </L7p:CacheStorage>\n                        <L7p:SetVariable>\n                            <L7p:Base64Expression stringValue=\"dHJ1ZQ==\"/>\n                            <L7p:VariableToSet stringValue=\"logout\"/>\n                        </L7p:SetVariable>\n                        <L7p:SetVariable>\n                            <L7p:Base64Expression stringValue=\"ZmFsc2U=\"/>\n                            <L7p:VariableToSet stringValue=\"loggedin\"/>\n                        </L7p:SetVariable>\n                        <L7p:FalseAssertion/>\n                        <L7p:assertionComment>\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Fail due to Invalid credentials\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:assertionComment>\n                    </wsp:All>\n                    <L7p:assertionComment>\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// Authenticate credentials else fail\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:assertionComment>\n                </wsp:OneOrMore>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"JHtjb29raWUuc2Vzc2lvbktleX0=\"/>\n                    <L7p:VariableToSet stringValue=\"sessionKey\"/>\n                </L7p:SetVariable>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"dHJ1ZQ==\"/>\n                    <L7p:VariableToSet stringValue=\"loggedin\"/>\n                </L7p:SetVariable>\n                <L7p:assertionComment>\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// Get session token and validate against cache\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:assertionComment>\n            </wsp:All>\n            <wsp:All wsp:Usage=\"Required\">\n                <L7p:ComparisonAssertion>\n                    <L7p:Expression1 stringValue=\"${request.http.parameter.action}\"/>\n                    <L7p:Expression2 stringValue=\"login\"/>\n                    <L7p:Predicates predicates=\"included\">\n                        <L7p:item binary=\"included\">\n                            <L7p:RightValue stringValue=\"login\"/>\n                        </L7p:item>\n                    </L7p:Predicates>\n                </L7p:ComparisonAssertion>\n                <L7p:AuditDetailAssertion>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// FINE\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Detail stringValue=\"==> Login form was submitted\"/>\n                    <L7p:Level stringValue=\"FINE\"/>\n                </L7p:AuditDetailAssertion>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"JHtyZXF1ZXN0Lmh0dHAucGFyYW1ldGVyLnVzZXJuYW1lfQ==\"/>\n                    <L7p:VariableToSet stringValue=\"username\"/>\n                </L7p:SetVariable>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"JHtyZXF1ZXN0Lmh0dHAucGFyYW1ldGVyLnBhc3N3b3JkfQ==\"/>\n                    <L7p:VariableToSet stringValue=\"password\"/>\n                </L7p:SetVariable>\n                <L7p:XpathCredentialSource>\n                    <L7p:PasswordExpression xpathExpressionValue=\"included\">\n                        <L7p:Expression stringValue=\"$password\"/>\n                    </L7p:PasswordExpression>\n                    <L7p:XpathExpression xpathExpressionValue=\"included\">\n                        <L7p:Expression stringValue=\"$username\"/>\n                    </L7p:XpathExpression>\n                </L7p:XpathCredentialSource>\n                <wsp:OneOrMore wsp:Usage=\"Required\">\n                    <L7p:Authentication>\n                        <L7p:IdentityProviderOid goidValue=\"0000000000000000fffffffffffffffe\"/>\n                    </L7p:Authentication>\n                    <wsp:All wsp:Usage=\"Required\">\n                        <L7p:SetVariable>\n                            <L7p:Base64Expression stringValue=\"SW52YWxpZCBjcmVkZW50aWFscy4gUGxlYXNlIHRyeSBhZ2Fpbg==\"/>\n                            <L7p:VariableToSet stringValue=\"form.message\"/>\n                        </L7p:SetVariable>\n                        <L7p:SetVariable>\n                            <L7p:Base64Expression stringValue=\"ZmFsc2U=\"/>\n                            <L7p:VariableToSet stringValue=\"loggedin\"/>\n                        </L7p:SetVariable>\n                        <L7p:FalseAssertion/>\n                        <L7p:assertionComment>\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Fail due to Invalid credentials\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:assertionComment>\n                    </wsp:All>\n                    <L7p:assertionComment>\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// Authenticate credentials else fail\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:assertionComment>\n                </wsp:OneOrMore>\n                <L7p:UUIDGenerator>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// ${session}\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:TargetVariable stringValue=\"sessionKey\"/>\n                </L7p:UUIDGenerator>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"PHNlc3Npb24gaWQ9IiR7c2Vzc2lvbktleX0iPjxVc2VybmFtZT4ke3JlcXVlc3QuaHR0cC5wYXJhbWV0ZXIudXNlcm5hbWV9PC9Vc2VybmFtZT48UGFzc3dvcmQ+JHtyZXF1ZXN0Lmh0dHAucGFyYW1ldGVyLnBhc3N3b3JkfTwvUGFzc3dvcmQ+PC9zZXNzaW9uPg==\"/>\n                    <L7p:ContentType stringValue=\"text/xml; charset=utf-8\"/>\n                    <L7p:DataType variableDataType=\"message\"/>\n                    <L7p:VariableToSet stringValue=\"sessionDetail\"/>\n                </L7p:SetVariable>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"dHJ1ZQ==\"/>\n                    <L7p:VariableToSet stringValue=\"loggedin\"/>\n                </L7p:SetVariable>\n                <L7p:assertionComment>\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// Form submitted, validate credential and cache\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:assertionComment>\n            </wsp:All>\n            <L7p:TrueAssertion/>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Authentication - override ${loggedIn} and ${logout}, never fail\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:OneOrMore>\n        <wsp:OneOrMore wsp:Usage=\"Required\">\n            <L7p:ComparisonAssertion>\n                <L7p:CaseSensitive booleanValue=\"false\"/>\n                <L7p:Expression1 stringValue=\"${loggedIn}\"/>\n                <L7p:Operator operatorNull=\"null\"/>\n                <L7p:Predicates predicates=\"included\">\n                    <L7p:item dataType=\"included\">\n                        <L7p:Type variableDataType=\"boolean\"/>\n                    </L7p:item>\n                    <L7p:item binary=\"included\">\n                        <L7p:CaseSensitive booleanValue=\"false\"/>\n                        <L7p:RightValue stringValue=\"false\"/>\n                    </L7p:item>\n                </L7p:Predicates>\n            </L7p:ComparisonAssertion>\n            <wsp:OneOrMore wsp:Usage=\"Required\">\n                <wsp:All wsp:Usage=\"Required\">\n                    <L7p:ComparisonAssertion>\n                        <L7p:CaseSensitive booleanValue=\"false\"/>\n                        <L7p:Expression1 stringValue=\"${verifyAdmin}\"/>\n                        <L7p:Operator operatorNull=\"null\"/>\n                        <L7p:Predicates predicates=\"included\">\n                            <L7p:item dataType=\"included\">\n                                <L7p:Type variableDataType=\"boolean\"/>\n                            </L7p:item>\n                            <L7p:item binary=\"included\">\n                                <L7p:CaseSensitive booleanValue=\"false\"/>\n                                <L7p:RightValue stringValue=\"false\"/>\n                            </L7p:item>\n                        </L7p:Predicates>\n                    </L7p:ComparisonAssertion>\n                    <L7p:ManageCookie>\n                        <L7p:CookieAttributes mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"name\"/>\n                                <L7p:value nameValuePair=\"included\">\n                                    <L7p:Key stringValue=\"name\"/>\n                                    <L7p:Value stringValue=\"sessionKey\"/>\n                                </L7p:value>\n                            </L7p:entry>\n                            <L7p:entry>\n                                <L7p:key stringValue=\"max-age\"/>\n                                <L7p:value nameValuePair=\"included\">\n                                    <L7p:Key stringValue=\"max-age\"/>\n                                    <L7p:Value stringValue=\"${sessionTTL}\"/>\n                                </L7p:value>\n                            </L7p:entry>\n                            <L7p:entry>\n                                <L7p:key stringValue=\"httpOnly\"/>\n                                <L7p:value nameValuePair=\"included\">\n                                    <L7p:Key stringValue=\"httpOnly\"/>\n                                    <L7p:Value stringValue=\"true\"/>\n                                </L7p:value>\n                            </L7p:entry>\n                            <L7p:entry>\n                                <L7p:key stringValue=\"secure\"/>\n                                <L7p:value nameValuePair=\"included\">\n                                    <L7p:Key stringValue=\"secure\"/>\n                                    <L7p:Value stringValue=\"true\"/>\n                                </L7p:value>\n                            </L7p:entry>\n                            <L7p:entry>\n                                <L7p:key stringValue=\"value\"/>\n                                <L7p:value nameValuePair=\"included\">\n                                    <L7p:Key stringValue=\"value\"/>\n                                    <L7p:Value stringValue=\"${sessionKey}\"/>\n                                </L7p:value>\n                            </L7p:entry>\n                        </L7p:CookieAttributes>\n                        <L7p:Operation operation=\"ADD_OR_REPLACE\"/>\n                        <L7p:Target target=\"RESPONSE\"/>\n                    </L7p:ManageCookie>\n                    <L7p:CacheStorage>\n                        <L7p:CacheEntryKey stringValue=\"${sessionKey}\"/>\n                        <L7p:CacheId stringValue=\"loginCache\"/>\n                        <L7p:MaxEntries stringValue=\"25\"/>\n                        <L7p:MaxEntryAgeSeconds stringValue=\"${sessionTTL}\"/>\n                        <L7p:MaxEntrySizeBytes stringValue=\"1000\"/>\n                        <L7p:OtherTargetMessageVariable stringValue=\"sessionDetail\"/>\n                        <L7p:Target target=\"OTHER\"/>\n                    </L7p:CacheStorage>\n                    <L7p:assertionComment>\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// ${verifyAdmin} == false - set the cookie and cache sessionDetail\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:assertionComment>\n                </wsp:All>\n                <wsp:All wsp:Usage=\"Required\">\n                    <L7p:ComparisonAssertion>\n                        <L7p:CaseSensitive booleanValue=\"false\"/>\n                        <L7p:Expression1 stringValue=\"${verifyAdmin}\"/>\n                        <L7p:Operator operatorNull=\"null\"/>\n                        <L7p:Predicates predicates=\"included\">\n                            <L7p:item dataType=\"included\">\n                                <L7p:Type variableDataType=\"boolean\"/>\n                            </L7p:item>\n                            <L7p:item binary=\"included\">\n                                <L7p:CaseSensitive booleanValue=\"false\"/>\n                                <L7p:RightValue stringValue=\"true\"/>\n                            </L7p:item>\n                        </L7p:Predicates>\n                    </L7p:ComparisonAssertion>\n                    <wsp:OneOrMore wsp:Usage=\"Required\">\n                        <wsp:All wsp:Usage=\"Required\">\n                            <L7p:Encapsulated>\n                                <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// GET roles?name=Administrator\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:AssertionComment>\n                                <L7p:EncapsulatedAssertionConfigGuid stringValue=\"c8a5a0d5-1ae2-4144-b538-5c311efc1560\"/>\n                                <L7p:EncapsulatedAssertionConfigName stringValue=\"Utility: Call Restman\"/>\n                                <L7p:Parameters mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"element\"/>\n                                    <L7p:value stringValue=\"\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"message\"/>\n                                    <L7p:value stringValue=\"\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"method\"/>\n                                    <L7p:value stringValue=\"GET\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"resource\"/>\n                                    <L7p:value stringValue=\"roles?name=Administrator\"/>\n                                    </L7p:entry>\n                                </L7p:Parameters>\n                            </L7p:Encapsulated>\n                            <L7p:SetVariable>\n                                <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Cast to string for XPath predicate\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:AssertionComment>\n                                <L7p:Base64Expression stringValue=\"JHtyZXF1ZXN0LmF1dGhlbnRpY2F0ZWR1c2VyLnByb3ZpZGVySWR9\"/>\n                                <L7p:VariableToSet stringValue=\"providerId\"/>\n                            </L7p:SetVariable>\n                            <L7p:SetVariable>\n                                <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Cast to string for XPath predicate\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:AssertionComment>\n                                <L7p:Base64Expression stringValue=\"JHtyZXF1ZXN0LmF1dGhlbnRpY2F0ZWR1c2VyLmlkfQ==\"/>\n                                <L7p:VariableToSet stringValue=\"identityId\"/>\n                            </L7p:SetVariable>\n                            <L7p:ResponseXpathAssertion>\n                                <L7p:VariablePrefix stringValue=\"entityType\"/>\n                                <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                    <L7p:Expression stringValue=\"/l7:List/l7:Item/l7:Resource/l7:Role/l7:assignments/l7:assignment[(l7:providerId=$providerId) and (l7:identityId=$identityId)]\"/>\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"s\"/>\n                                    <L7p:value stringValue=\"http://schemas.xmlsoap.org/soap/envelope/\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                                </L7p:XpathExpression>\n                            </L7p:ResponseXpathAssertion>\n                            <L7p:AuditDetailAssertion>\n                                <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// FINE\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:AssertionComment>\n                                <L7p:Detail stringValue=\"==> Confirmed that ${request.authenticateduser} is a member of Administrator role\"/>\n                                <L7p:Level stringValue=\"FINE\"/>\n                            </L7p:AuditDetailAssertion>\n                            <L7p:ManageCookie>\n                                <L7p:CookieAttributes mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"name\"/>\n                                    <L7p:value nameValuePair=\"included\">\n                                    <L7p:Key stringValue=\"name\"/>\n                                    <L7p:Value stringValue=\"sessionKey\"/>\n                                    </L7p:value>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"max-age\"/>\n                                    <L7p:value nameValuePair=\"included\">\n                                    <L7p:Key stringValue=\"max-age\"/>\n                                    <L7p:Value stringValue=\"${sessionTTL}\"/>\n                                    </L7p:value>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"httpOnly\"/>\n                                    <L7p:value nameValuePair=\"included\">\n                                    <L7p:Key stringValue=\"httpOnly\"/>\n                                    <L7p:Value stringValue=\"true\"/>\n                                    </L7p:value>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"secure\"/>\n                                    <L7p:value nameValuePair=\"included\">\n                                    <L7p:Key stringValue=\"secure\"/>\n                                    <L7p:Value stringValue=\"true\"/>\n                                    </L7p:value>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"value\"/>\n                                    <L7p:value nameValuePair=\"included\">\n                                    <L7p:Key stringValue=\"value\"/>\n                                    <L7p:Value stringValue=\"${sessionKey}\"/>\n                                    </L7p:value>\n                                    </L7p:entry>\n                                </L7p:CookieAttributes>\n                                <L7p:Operation operation=\"ADD_OR_REPLACE\"/>\n                                <L7p:Target target=\"RESPONSE\"/>\n                            </L7p:ManageCookie>\n                            <L7p:CacheStorage>\n                                <L7p:CacheEntryKey stringValue=\"${sessionKey}\"/>\n                                <L7p:CacheId stringValue=\"loginCache\"/>\n                                <L7p:MaxEntries stringValue=\"25\"/>\n                                <L7p:MaxEntryAgeSeconds stringValue=\"${sessionTTL}\"/>\n                                <L7p:MaxEntrySizeBytes stringValue=\"1000\"/>\n                                <L7p:OtherTargetMessageVariable stringValue=\"sessionDetail\"/>\n                                <L7p:Target target=\"OTHER\"/>\n                            </L7p:CacheStorage>\n                            <L7p:assertionComment>\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Get Administrator role from restman and check is authenticated user is in it\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:assertionComment>\n                        </wsp:All>\n                        <wsp:All wsp:Usage=\"Required\">\n                            <L7p:AuditDetailAssertion>\n                                <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// FINE\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:AssertionComment>\n                                <L7p:Detail stringValue=\"==> ${request.authenticateduser} is NOT a member of Administrator role\"/>\n                                <L7p:Level stringValue=\"FINE\"/>\n                            </L7p:AuditDetailAssertion>\n                            <L7p:SetVariable>\n                                <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Default message on the login form\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:AssertionComment>\n                                <L7p:Base64Expression stringValue=\"JHtyZXF1ZXN0LmF1dGhlbnRpY2F0ZWR1c2VyfSBpcyBub3QgYW4gYWRtaW5pc3RyYXRvci4=\"/>\n                                <L7p:VariableToSet stringValue=\"form.message\"/>\n                            </L7p:SetVariable>\n                            <L7p:SetVariable>\n                                <L7p:Base64Expression stringValue=\"ZmFsc2U=\"/>\n                                <L7p:VariableToSet stringValue=\"loggedIn\"/>\n                            </L7p:SetVariable>\n                            <L7p:assertionComment>\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Reset ${loggedIn} and ${form.message}\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:assertionComment>\n                        </wsp:All>\n                        <L7p:assertionComment>\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Attempt restman call else reset ${loggedIn} to false and set ${form.message}\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:assertionComment>\n                    </wsp:OneOrMore>\n                    <L7p:assertionComment>\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// ${verifyAdmin} == true\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:assertionComment>\n                </wsp:All>\n                <L7p:assertionComment>\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// Handle ${verifyAdmin} cases\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:assertionComment>\n            </wsp:OneOrMore>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Set cookie and cache sessionDetail (and test access to restman if requested)  if ${loggedIn} == true\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:OneOrMore>\n        <wsp:OneOrMore wsp:Usage=\"Required\">\n            <L7p:ComparisonAssertion>\n                <L7p:CaseSensitive booleanValue=\"false\"/>\n                <L7p:Expression1 stringValue=\"${request.http.method}\"/>\n                <L7p:Expression2 stringValue=\"GET\"/>\n                <L7p:Predicates predicates=\"included\">\n                    <L7p:item binary=\"included\">\n                        <L7p:CaseSensitive booleanValue=\"false\"/>\n                        <L7p:RightValue stringValue=\"GET\"/>\n                    </L7p:item>\n                </L7p:Predicates>\n            </L7p:ComparisonAssertion>\n            <wsp:All wsp:Usage=\"Required\">\n                <L7p:ComparisonAssertion>\n                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                    <L7p:Expression1 stringValue=\"${request.http.method}\"/>\n                    <L7p:Expression2 stringValue=\"POST\"/>\n                    <L7p:Predicates predicates=\"included\">\n                        <L7p:item binary=\"included\">\n                            <L7p:CaseSensitive booleanValue=\"false\"/>\n                            <L7p:RightValue stringValue=\"POST\"/>\n                        </L7p:item>\n                    </L7p:Predicates>\n                </L7p:ComparisonAssertion>\n                <L7p:ComparisonAssertion>\n                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                    <L7p:Expression1 stringValue=\"${request.http.uri}\"/>\n                    <L7p:Expression2 stringValue=\"/services/selection\"/>\n                    <L7p:Predicates predicates=\"included\">\n                        <L7p:item binary=\"included\">\n                            <L7p:CaseSensitive booleanValue=\"false\"/>\n                            <L7p:RightValue stringValue=\"/services/selection\"/>\n                        </L7p:item>\n                    </L7p:Predicates>\n                </L7p:ComparisonAssertion>\n                <L7p:assertionComment>\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// Added by cob when reusing the Utility for /services/selection\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:assertionComment>\n            </wsp:All>\n            <L7p:ComparisonAssertion>\n                <L7p:CaseSensitive booleanValue=\"false\"/>\n                <L7p:Expression1 stringValue=\"${loggedIn}\"/>\n                <L7p:Operator operatorNull=\"null\"/>\n                <L7p:Predicates predicates=\"included\">\n                    <L7p:item dataType=\"included\">\n                        <L7p:Type variableDataType=\"boolean\"/>\n                    </L7p:item>\n                    <L7p:item binary=\"included\">\n                        <L7p:CaseSensitive booleanValue=\"false\"/>\n                        <L7p:RightValue stringValue=\"false\"/>\n                    </L7p:item>\n                </L7p:Predicates>\n            </L7p:ComparisonAssertion>\n            <wsp:All wsp:Usage=\"Required\">\n                <L7p:ComparisonAssertion>\n                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                    <L7p:Expression1 stringValue=\"${loggedIn}\"/>\n                    <L7p:Operator operatorNull=\"null\"/>\n                    <L7p:Predicates predicates=\"included\">\n                        <L7p:item dataType=\"included\">\n                            <L7p:Type variableDataType=\"boolean\"/>\n                        </L7p:item>\n                        <L7p:item binary=\"included\">\n                            <L7p:CaseSensitive booleanValue=\"false\"/>\n                            <L7p:RightValue stringValue=\"true\"/>\n                        </L7p:item>\n                    </L7p:Predicates>\n                </L7p:ComparisonAssertion>\n                <L7p:CustomizeErrorResponse>\n                    <L7p:Content stringValue=\"&lt;html>&lt;head>  &lt;title>User logged in&lt;/title>&lt;/head>&lt;body>  &lt;h1>User logged in&lt;/h1>  &lt;p>&lt;a href=&quot;${request.url}&quot;>Continue&lt;/a>&lt;/p>  &lt;hr />&lt;/body>&lt;/html>\"/>\n                    <L7p:ContentType stringValue=\"text/html; charset=UTF-8\"/>\n                    <L7p:ExtraHeaders nameValuePairArray=\"included\">\n                        <L7p:item nameValuePair=\"included\">\n                            <L7p:Key stringValue=\"Location\"/>\n                            <L7p:Value stringValue=\"${request.url}\"/>\n                        </L7p:item>\n                    </L7p:ExtraHeaders>\n                    <L7p:HttpStatus stringValue=\"302\"/>\n                </L7p:CustomizeErrorResponse>\n                <L7p:FalseAssertion/>\n                <L7p:assertionComment>\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// Redirect to this URL with GET\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:assertionComment>\n            </wsp:All>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Redirect if method is not GET\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:OneOrMore>\n        <L7p:AuditDetailAssertion>\n            <L7p:AssertionComment assertionComment=\"included\">\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// FINE\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:AssertionComment>\n            <L7p:Detail stringValue=\"==> Leaving Utility Fragment: ${policy.name}\"/>\n            <L7p:Level stringValue=\"FINE\"/>\n        </L7p:AuditDetailAssertion>\n    </wsp:All>\n</wsp:Policy>\n"
        }
      ]
    },
    {
      "guid": "9deeaade-8769-4ff0-a112-6e1494d0f65d",
      "name": "Utility: Get All Policy XML",
      "policyType": "FRAGMENT",
      "checksum": "c4894d5ae7af4c3073865ce96fbb281bb289e1ae",
      "folderPath": "/Gateway Management Utilities/fragments",
      "soap": false,
      "policy": {
        "xml": "<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<wsp:Policy xmlns:L7p=\"http://www.layer7tech.com/ws/policy\" xmlns:wsp=\"http://schemas.xmlsoap.org/ws/2002/12/policy\">\n    <wsp:All wsp:Usage=\"Required\">\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Policy fragment for &quot;Utility: Get All Policy XML&quot; encapsulated assertion\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Call Restman and get policy XML for both policies and services\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** - Assumes an admin role user has been authenticated\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** - Caches results for ${cacheAge} seconds (default=300). To refresh the cache set ${refresh}=true when calling\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** - Returns a text/xml message variable in ${allPolicyXML}\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Inputs:\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - refresh (string)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - cacheAge (string)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Outputs:\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - allPolicyXML (message)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - error.msg (string)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** v1.0.0 - Jay MacDonald - 20201107 - Initial Version\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n        </L7p:CommentAssertion>\n        <L7p:AuditDetailAssertion>\n            <L7p:AssertionComment assertionComment=\"included\">\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// FINE\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:AssertionComment>\n            <L7p:Detail stringValue=\"==> Entering Utility Fragment: ${policy.name} (refresh=${refresh})\"/>\n            <L7p:Level stringValue=\"FINE\"/>\n        </L7p:AuditDetailAssertion>\n        <wsp:All wsp:Usage=\"Required\">\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** ${allPolicyXML} has the following schema:\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** \"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** &lt;AllPolicyXML source=&quot;cache|system&quot;>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   &lt;PolicyXML ownerId=&quot;string&quot; ownerType=&quot;string&quot;>PolicyXML&lt;/PolicyXML>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   ...\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** &lt;/AllPolicyXML>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n            </L7p:CommentAssertion>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Description of ${allPolicyXML}\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:All>\n        <wsp:OneOrMore wsp:Usage=\"Required\">\n            <L7p:ComparisonAssertion>\n                <L7p:AssertionComment assertionComment=\"included\">\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// true or false\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:AssertionComment>\n                <L7p:CaseSensitive booleanValue=\"false\"/>\n                <L7p:Expression1 stringValue=\"${cacheAge}\"/>\n                <L7p:Operator operatorNull=\"null\"/>\n                <L7p:Predicates predicates=\"included\">\n                    <L7p:item dataType=\"included\">\n                        <L7p:Type variableDataType=\"int\"/>\n                    </L7p:item>\n                    <L7p:item binary=\"included\">\n                        <L7p:CaseSensitive booleanValue=\"false\"/>\n                        <L7p:Operator operator=\"GT\"/>\n                        <L7p:RightValue stringValue=\"0\"/>\n                    </L7p:item>\n                </L7p:Predicates>\n            </L7p:ComparisonAssertion>\n            <L7p:SetVariable>\n                <L7p:Base64Expression stringValue=\"MzAw\"/>\n                <L7p:DataType variableDataType=\"int\"/>\n                <L7p:VariableToSet stringValue=\"cacheAge\"/>\n            </L7p:SetVariable>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Ensure ${cacheAge} is set, default=300\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:OneOrMore>\n        <wsp:OneOrMore wsp:Usage=\"Required\">\n            <L7p:ComparisonAssertion>\n                <L7p:AssertionComment assertionComment=\"included\">\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// true or false\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:AssertionComment>\n                <L7p:CaseSensitive booleanValue=\"false\"/>\n                <L7p:Expression1 stringValue=\"${refresh}\"/>\n                <L7p:Operator operatorNull=\"null\"/>\n                <L7p:Predicates predicates=\"included\">\n                    <L7p:item dataType=\"included\">\n                        <L7p:Type variableDataType=\"string\"/>\n                    </L7p:item>\n                    <L7p:item regex=\"included\">\n                        <L7p:Pattern stringValue=\"^(true|false)$\"/>\n                    </L7p:item>\n                </L7p:Predicates>\n            </L7p:ComparisonAssertion>\n            <L7p:SetVariable>\n                <L7p:Base64Expression stringValue=\"ZmFsc2U=\"/>\n                <L7p:VariableToSet stringValue=\"refresh\"/>\n            </L7p:SetVariable>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Ensure ${refresh} is set, default=false\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:OneOrMore>\n        <L7p:SetVariable>\n            <L7p:Base64Expression stringValue=\"YWxsUG9saWN5WE1M\"/>\n            <L7p:VariableToSet stringValue=\"cacheKey\"/>\n        </L7p:SetVariable>\n        <wsp:OneOrMore wsp:Usage=\"Required\">\n            <wsp:All wsp:Usage=\"Required\">\n                <L7p:ComparisonAssertion>\n                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                    <L7p:Expression1 stringValue=\"${refresh}\"/>\n                    <L7p:Operator operatorNull=\"null\"/>\n                    <L7p:Predicates predicates=\"included\">\n                        <L7p:item dataType=\"included\">\n                            <L7p:Type variableDataType=\"string\"/>\n                        </L7p:item>\n                        <L7p:item binary=\"included\">\n                            <L7p:Negated booleanValue=\"true\"/>\n                            <L7p:RightValue stringValue=\"true\"/>\n                        </L7p:item>\n                    </L7p:Predicates>\n                </L7p:ComparisonAssertion>\n                <L7p:CacheLookup>\n                    <L7p:CacheEntryKey stringValue=\"${cacheKey}\"/>\n                    <L7p:CacheId stringValue=\"allPolicyXML\"/>\n                    <L7p:ContentTypeOverride stringValue=\"\"/>\n                    <L7p:MaxEntryAgeSeconds stringValue=\"${cacheAge}\"/>\n                    <L7p:OtherTargetMessageVariable stringValue=\"allPolicyXML\"/>\n                    <L7p:Target target=\"OTHER\"/>\n                </L7p:CacheLookup>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"Y2FjaGU=\"/>\n                    <L7p:VariableToSet stringValue=\"source\"/>\n                </L7p:SetVariable>\n                <L7p:AuditDetailAssertion>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// FINE\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Detail stringValue=\"==> Found allPolicyXML in the cache\"/>\n                    <L7p:Level stringValue=\"FINE\"/>\n                </L7p:AuditDetailAssertion>\n                <L7p:assertionComment>\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// Look in cache unless asked to refresh cache\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:assertionComment>\n            </wsp:All>\n            <wsp:All wsp:Usage=\"Required\">\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4NCjxBbGxQb2xpY3lYTUw+\"/>\n                    <L7p:VariableToSet stringValue=\"allPolicyXML\"/>\n                </L7p:SetVariable>\n                <wsp:All wsp:Usage=\"Required\">\n                    <L7p:Encapsulated>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// GET policies\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:EncapsulatedAssertionConfigGuid stringValue=\"c8a5a0d5-1ae2-4144-b538-5c311efc1560\"/>\n                        <L7p:EncapsulatedAssertionConfigName stringValue=\"Utility: Call Restman\"/>\n                        <L7p:Parameters mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"element\"/>\n                                <L7p:value stringValue=\"Policy\"/>\n                            </L7p:entry>\n                            <L7p:entry>\n                                <L7p:key stringValue=\"message\"/>\n                                <L7p:value stringValue=\"\"/>\n                            </L7p:entry>\n                            <L7p:entry>\n                                <L7p:key stringValue=\"method\"/>\n                                <L7p:value stringValue=\"GET\"/>\n                            </L7p:entry>\n                            <L7p:entry>\n                                <L7p:key stringValue=\"resource\"/>\n                                <L7p:value stringValue=\"policies\"/>\n                            </L7p:entry>\n                        </L7p:Parameters>\n                    </L7p:Encapsulated>\n                    <wsp:OneOrMore wsp:Usage=\"Required\">\n                        <L7p:ResponseXpathAssertion>\n                            <L7p:VariablePrefix stringValue=\"objects\"/>\n                            <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                <L7p:Expression stringValue=\"/l7:List/l7:Item/l7:Resource/l7:Policy\"/>\n                                <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                    </L7p:entry>\n                                </L7p:Namespaces>\n                                <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                            </L7p:XpathExpression>\n                        </L7p:ResponseXpathAssertion>\n                        <L7p:TrueAssertion/>\n                        <L7p:assertionComment>\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Extract the list of policies, never fail\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:assertionComment>\n                    </wsp:OneOrMore>\n                    <L7p:ForEachLoop L7p:Usage=\"Required\"\n                        loopVariable=\"objects.elements\" variablePrefix=\"object\">\n                        <L7p:SetVariable>\n                            <L7p:Base64Expression stringValue=\"JHtvYmplY3QuY3VycmVudH0=\"/>\n                            <L7p:ContentType stringValue=\"text/xml; charset=utf-8\"/>\n                            <L7p:DataType variableDataType=\"message\"/>\n                            <L7p:VariableToSet stringValue=\"object.xml\"/>\n                        </L7p:SetVariable>\n                        <L7p:ResponseXpathAssertion>\n                            <L7p:VariablePrefix stringValue=\"id\"/>\n                            <L7p:XmlMsgSrc stringValue=\"object.xml\"/>\n                            <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                <L7p:Expression stringValue=\"/l7:Policy/@id\"/>\n                                <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"s\"/>\n                                    <L7p:value stringValue=\"http://schemas.xmlsoap.org/soap/envelope/\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                    </L7p:entry>\n                                </L7p:Namespaces>\n                                <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                            </L7p:XpathExpression>\n                        </L7p:ResponseXpathAssertion>\n                        <L7p:ResponseXpathAssertion>\n                            <L7p:VariablePrefix stringValue=\"policy.xml\"/>\n                            <L7p:XmlMsgSrc stringValue=\"object.xml\"/>\n                            <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                <L7p:Expression stringValue=\"//l7:Resource[@type=&quot;policy&quot;]/text()\"/>\n                                <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"s\"/>\n                                    <L7p:value stringValue=\"http://schemas.xmlsoap.org/soap/envelope/\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                    </L7p:entry>\n                                </L7p:Namespaces>\n                                <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                            </L7p:XpathExpression>\n                        </L7p:ResponseXpathAssertion>\n                        <L7p:Regex>\n                            <L7p:AutoTarget booleanValue=\"false\"/>\n                            <L7p:OtherTargetMessageVariable stringValue=\"policy.xml.result\"/>\n                            <L7p:Regex stringValue=\"&amp;\"/>\n                            <L7p:Replace booleanValue=\"true\"/>\n                            <L7p:Replacement stringValue=\"&amp;amp;\"/>\n                            <L7p:Target target=\"OTHER\"/>\n                        </L7p:Regex>\n                        <L7p:Regex>\n                            <L7p:AutoTarget booleanValue=\"false\"/>\n                            <L7p:OtherTargetMessageVariable stringValue=\"policy.xml.result\"/>\n                            <L7p:Regex stringValue=\"&lt;\"/>\n                            <L7p:Replace booleanValue=\"true\"/>\n                            <L7p:Replacement stringValue=\"&amp;lt;\"/>\n                            <L7p:Target target=\"OTHER\"/>\n                        </L7p:Regex>\n                        <L7p:Regex>\n                            <L7p:AutoTarget booleanValue=\"false\"/>\n                            <L7p:OtherTargetMessageVariable stringValue=\"policy.xml.result\"/>\n                            <L7p:Regex stringValue=\">\"/>\n                            <L7p:Replace booleanValue=\"true\"/>\n                            <L7p:Replacement stringValue=\"&amp;gt;\"/>\n                            <L7p:Target target=\"OTHER\"/>\n                        </L7p:Regex>\n                        <L7p:SetVariable>\n                            <L7p:Base64Expression stringValue=\"JHthbGxQb2xpY3lYTUx9DQogIDxQb2xpY3lYTUwgc291cmNlSWQ9IiR7aWQucmVzdWx0fSIgc291cmNlVHlwZT0iUE9MSUNZIj4ke3BvbGljeS54bWwucmVzdWx0fTwvUG9saWN5WE1MPg==\"/>\n                            <L7p:VariableToSet stringValue=\"allPolicyXML\"/>\n                        </L7p:SetVariable>\n                    </L7p:ForEachLoop>\n                    <L7p:assertionComment>\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// Get policy XML for Policies and append to ${allPolicyXML}\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:assertionComment>\n                </wsp:All>\n                <wsp:All wsp:Usage=\"Required\">\n                    <L7p:Encapsulated>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// GET services\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:EncapsulatedAssertionConfigGuid stringValue=\"c8a5a0d5-1ae2-4144-b538-5c311efc1560\"/>\n                        <L7p:EncapsulatedAssertionConfigName stringValue=\"Utility: Call Restman\"/>\n                        <L7p:Parameters mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"element\"/>\n                                <L7p:value stringValue=\"Service\"/>\n                            </L7p:entry>\n                            <L7p:entry>\n                                <L7p:key stringValue=\"message\"/>\n                                <L7p:value stringValue=\"\"/>\n                            </L7p:entry>\n                            <L7p:entry>\n                                <L7p:key stringValue=\"method\"/>\n                                <L7p:value stringValue=\"GET\"/>\n                            </L7p:entry>\n                            <L7p:entry>\n                                <L7p:key stringValue=\"resource\"/>\n                                <L7p:value stringValue=\"services\"/>\n                            </L7p:entry>\n                        </L7p:Parameters>\n                    </L7p:Encapsulated>\n                    <wsp:OneOrMore wsp:Usage=\"Required\">\n                        <L7p:ResponseXpathAssertion>\n                            <L7p:VariablePrefix stringValue=\"objects\"/>\n                            <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                <L7p:Expression stringValue=\"/l7:List/l7:Item/l7:Resource/l7:Service\"/>\n                                <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                    </L7p:entry>\n                                </L7p:Namespaces>\n                                <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                            </L7p:XpathExpression>\n                        </L7p:ResponseXpathAssertion>\n                        <L7p:TrueAssertion/>\n                        <L7p:assertionComment>\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Extract the list of services, never fail\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:assertionComment>\n                    </wsp:OneOrMore>\n                    <L7p:ForEachLoop L7p:Usage=\"Required\"\n                        loopVariable=\"objects.elements\" variablePrefix=\"object\">\n                        <L7p:SetVariable>\n                            <L7p:Base64Expression stringValue=\"JHtvYmplY3QuY3VycmVudH0=\"/>\n                            <L7p:ContentType stringValue=\"text/xml; charset=utf-8\"/>\n                            <L7p:DataType variableDataType=\"message\"/>\n                            <L7p:VariableToSet stringValue=\"object.xml\"/>\n                        </L7p:SetVariable>\n                        <L7p:ResponseXpathAssertion>\n                            <L7p:VariablePrefix stringValue=\"id\"/>\n                            <L7p:XmlMsgSrc stringValue=\"object.xml\"/>\n                            <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                <L7p:Expression stringValue=\"/l7:Service/@id\"/>\n                                <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"s\"/>\n                                    <L7p:value stringValue=\"http://schemas.xmlsoap.org/soap/envelope/\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                    </L7p:entry>\n                                </L7p:Namespaces>\n                                <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                            </L7p:XpathExpression>\n                        </L7p:ResponseXpathAssertion>\n                        <L7p:ResponseXpathAssertion>\n                            <L7p:VariablePrefix stringValue=\"policy.xml\"/>\n                            <L7p:XmlMsgSrc stringValue=\"object.xml\"/>\n                            <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                <L7p:Expression stringValue=\"//l7:Resource[@type=&quot;policy&quot;]/text()\"/>\n                                <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"s\"/>\n                                    <L7p:value stringValue=\"http://schemas.xmlsoap.org/soap/envelope/\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                    </L7p:entry>\n                                </L7p:Namespaces>\n                                <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                            </L7p:XpathExpression>\n                        </L7p:ResponseXpathAssertion>\n                        <L7p:Regex>\n                            <L7p:AutoTarget booleanValue=\"false\"/>\n                            <L7p:OtherTargetMessageVariable stringValue=\"policy.xml.result\"/>\n                            <L7p:Regex stringValue=\"&amp;\"/>\n                            <L7p:Replace booleanValue=\"true\"/>\n                            <L7p:Replacement stringValue=\"&amp;amp;\"/>\n                            <L7p:Target target=\"OTHER\"/>\n                        </L7p:Regex>\n                        <L7p:Regex>\n                            <L7p:AutoTarget booleanValue=\"false\"/>\n                            <L7p:OtherTargetMessageVariable stringValue=\"policy.xml.result\"/>\n                            <L7p:Regex stringValue=\"&lt;\"/>\n                            <L7p:Replace booleanValue=\"true\"/>\n                            <L7p:Replacement stringValue=\"&amp;lt;\"/>\n                            <L7p:Target target=\"OTHER\"/>\n                        </L7p:Regex>\n                        <L7p:Regex>\n                            <L7p:AutoTarget booleanValue=\"false\"/>\n                            <L7p:OtherTargetMessageVariable stringValue=\"policy.xml.result\"/>\n                            <L7p:Regex stringValue=\">\"/>\n                            <L7p:Replace booleanValue=\"true\"/>\n                            <L7p:Replacement stringValue=\"&amp;gt;\"/>\n                            <L7p:Target target=\"OTHER\"/>\n                        </L7p:Regex>\n                        <L7p:SetVariable>\n                            <L7p:Base64Expression stringValue=\"JHthbGxQb2xpY3lYTUx9DQogIDxQb2xpY3lYTUwgc291cmNlSWQ9IiR7aWQucmVzdWx0fSIgc291cmNlVHlwZT0iU0VSVklDRSI+JHtwb2xpY3kueG1sLnJlc3VsdH08L1BvbGljeVhNTD4=\"/>\n                            <L7p:VariableToSet stringValue=\"allPolicyXML\"/>\n                        </L7p:SetVariable>\n                    </L7p:ForEachLoop>\n                    <L7p:assertionComment>\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// Get policy XML for Services and append to ${allPolicyXML}\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:assertionComment>\n                </wsp:All>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"JHthbGxQb2xpY3lYTUx9DQo8L0FsbFBvbGljeVhNTD4=\"/>\n                    <L7p:ContentType stringValue=\"text/xml; charset=utf-8\"/>\n                    <L7p:DataType variableDataType=\"message\"/>\n                    <L7p:VariableToSet stringValue=\"allPolicyXML\"/>\n                </L7p:SetVariable>\n                <L7p:CacheStorage>\n                    <L7p:CacheEntryKey stringValue=\"${cacheKey}\"/>\n                    <L7p:CacheId stringValue=\"allPolicyXML\"/>\n                    <L7p:MaxEntries stringValue=\"1\"/>\n                    <L7p:MaxEntryAgeSeconds stringValue=\"${cacheAge}\"/>\n                    <L7p:MaxEntrySizeBytes stringValue=\"25000000\"/>\n                    <L7p:OtherTargetMessageVariable stringValue=\"allPolicyXML\"/>\n                    <L7p:StoreSoapFaults booleanValue=\"true\"/>\n                    <L7p:Target target=\"OTHER\"/>\n                </L7p:CacheStorage>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"c3lzdGVt\"/>\n                    <L7p:VariableToSet stringValue=\"source\"/>\n                </L7p:SetVariable>\n                <L7p:AuditDetailAssertion>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// FINE\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Detail stringValue=\"==> Loaded policies.sorted from system and stored to cache\"/>\n                    <L7p:Level stringValue=\"FINE\"/>\n                </L7p:AuditDetailAssertion>\n                <L7p:assertionComment>\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// Retrieve new list and cache\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:assertionComment>\n            </wsp:All>\n            <wsp:All wsp:Usage=\"Required\">\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"RXJyb3Igd2hlbiBvYnRhaW5pbmcgcG9saWN5IFhNTA==\"/>\n                    <L7p:VariableToSet stringValue=\"error.msg\"/>\n                </L7p:SetVariable>\n                <L7p:AuditDetailAssertion>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// WARNING\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Detail stringValue=\"==> Error obtaining policy XML in ${policy.name}\"/>\n                    <L7p:Level stringValue=\"WARNING\"/>\n                </L7p:AuditDetailAssertion>\n                <L7p:FalseAssertion/>\n                <L7p:assertionComment>\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// Failure - set ${error.msg}\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:assertionComment>\n            </wsp:All>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Caching logic\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:OneOrMore>\n        <L7p:Regex>\n            <L7p:AssertionComment assertionComment=\"included\">\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Add source attribute to /Policies element\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:AssertionComment>\n            <L7p:AutoTarget booleanValue=\"false\"/>\n            <L7p:OtherTargetMessageVariable stringValue=\"allPolicyXML\"/>\n            <L7p:Regex stringValue=\"&lt;AllPolicyXML>\"/>\n            <L7p:Replace booleanValue=\"true\"/>\n            <L7p:Replacement stringValue=\"&lt;AllPolicyXML source=&quot;${source}&quot;>\"/>\n            <L7p:Target target=\"OTHER\"/>\n        </L7p:Regex>\n        <L7p:AuditDetailAssertion>\n            <L7p:AssertionComment assertionComment=\"included\">\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// FINE\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:AssertionComment>\n            <L7p:Detail stringValue=\"==> Leaving Utility Fragment: ${policy.name}\"/>\n            <L7p:Level stringValue=\"FINE\"/>\n        </L7p:AuditDetailAssertion>\n    </wsp:All>\n</wsp:Policy>\n"
      },
      "policyRevisions": [
        {
          "goid": "bed4baf4ff33b7e528854c3965d9bb10",
          "ordinal": 1,
          "active": true,
          "author": "admin",
          "time": "2025-02-05T14:20:38.402Z",
          "xml": "<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<wsp:Policy xmlns:L7p=\"http://www.layer7tech.com/ws/policy\" xmlns:wsp=\"http://schemas.xmlsoap.org/ws/2002/12/policy\">\n    <wsp:All wsp:Usage=\"Required\">\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Policy fragment for &quot;Utility: Get All Policy XML&quot; encapsulated assertion\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Call Restman and get policy XML for both policies and services\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** - Assumes an admin role user has been authenticated\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** - Caches results for ${cacheAge} seconds (default=300). To refresh the cache set ${refresh}=true when calling\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** - Returns a text/xml message variable in ${allPolicyXML}\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Inputs:\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - refresh (string)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - cacheAge (string)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Outputs:\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - allPolicyXML (message)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - error.msg (string)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** v1.0.0 - Jay MacDonald - 20201107 - Initial Version\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n        </L7p:CommentAssertion>\n        <L7p:AuditDetailAssertion>\n            <L7p:AssertionComment assertionComment=\"included\">\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// FINE\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:AssertionComment>\n            <L7p:Detail stringValue=\"==> Entering Utility Fragment: ${policy.name} (refresh=${refresh})\"/>\n            <L7p:Level stringValue=\"FINE\"/>\n        </L7p:AuditDetailAssertion>\n        <wsp:All wsp:Usage=\"Required\">\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** ${allPolicyXML} has the following schema:\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** \"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** &lt;AllPolicyXML source=&quot;cache|system&quot;>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   &lt;PolicyXML ownerId=&quot;string&quot; ownerType=&quot;string&quot;>PolicyXML&lt;/PolicyXML>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   ...\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** &lt;/AllPolicyXML>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n            </L7p:CommentAssertion>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Description of ${allPolicyXML}\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:All>\n        <wsp:OneOrMore wsp:Usage=\"Required\">\n            <L7p:ComparisonAssertion>\n                <L7p:AssertionComment assertionComment=\"included\">\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// true or false\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:AssertionComment>\n                <L7p:CaseSensitive booleanValue=\"false\"/>\n                <L7p:Expression1 stringValue=\"${cacheAge}\"/>\n                <L7p:Operator operatorNull=\"null\"/>\n                <L7p:Predicates predicates=\"included\">\n                    <L7p:item dataType=\"included\">\n                        <L7p:Type variableDataType=\"int\"/>\n                    </L7p:item>\n                    <L7p:item binary=\"included\">\n                        <L7p:CaseSensitive booleanValue=\"false\"/>\n                        <L7p:Operator operator=\"GT\"/>\n                        <L7p:RightValue stringValue=\"0\"/>\n                    </L7p:item>\n                </L7p:Predicates>\n            </L7p:ComparisonAssertion>\n            <L7p:SetVariable>\n                <L7p:Base64Expression stringValue=\"MzAw\"/>\n                <L7p:DataType variableDataType=\"int\"/>\n                <L7p:VariableToSet stringValue=\"cacheAge\"/>\n            </L7p:SetVariable>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Ensure ${cacheAge} is set, default=300\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:OneOrMore>\n        <wsp:OneOrMore wsp:Usage=\"Required\">\n            <L7p:ComparisonAssertion>\n                <L7p:AssertionComment assertionComment=\"included\">\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// true or false\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:AssertionComment>\n                <L7p:CaseSensitive booleanValue=\"false\"/>\n                <L7p:Expression1 stringValue=\"${refresh}\"/>\n                <L7p:Operator operatorNull=\"null\"/>\n                <L7p:Predicates predicates=\"included\">\n                    <L7p:item dataType=\"included\">\n                        <L7p:Type variableDataType=\"string\"/>\n                    </L7p:item>\n                    <L7p:item regex=\"included\">\n                        <L7p:Pattern stringValue=\"^(true|false)$\"/>\n                    </L7p:item>\n                </L7p:Predicates>\n            </L7p:ComparisonAssertion>\n            <L7p:SetVariable>\n                <L7p:Base64Expression stringValue=\"ZmFsc2U=\"/>\n                <L7p:VariableToSet stringValue=\"refresh\"/>\n            </L7p:SetVariable>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Ensure ${refresh} is set, default=false\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:OneOrMore>\n        <L7p:SetVariable>\n            <L7p:Base64Expression stringValue=\"YWxsUG9saWN5WE1M\"/>\n            <L7p:VariableToSet stringValue=\"cacheKey\"/>\n        </L7p:SetVariable>\n        <wsp:OneOrMore wsp:Usage=\"Required\">\n            <wsp:All wsp:Usage=\"Required\">\n                <L7p:ComparisonAssertion>\n                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                    <L7p:Expression1 stringValue=\"${refresh}\"/>\n                    <L7p:Operator operatorNull=\"null\"/>\n                    <L7p:Predicates predicates=\"included\">\n                        <L7p:item dataType=\"included\">\n                            <L7p:Type variableDataType=\"string\"/>\n                        </L7p:item>\n                        <L7p:item binary=\"included\">\n                            <L7p:Negated booleanValue=\"true\"/>\n                            <L7p:RightValue stringValue=\"true\"/>\n                        </L7p:item>\n                    </L7p:Predicates>\n                </L7p:ComparisonAssertion>\n                <L7p:CacheLookup>\n                    <L7p:CacheEntryKey stringValue=\"${cacheKey}\"/>\n                    <L7p:CacheId stringValue=\"allPolicyXML\"/>\n                    <L7p:ContentTypeOverride stringValue=\"\"/>\n                    <L7p:MaxEntryAgeSeconds stringValue=\"${cacheAge}\"/>\n                    <L7p:OtherTargetMessageVariable stringValue=\"allPolicyXML\"/>\n                    <L7p:Target target=\"OTHER\"/>\n                </L7p:CacheLookup>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"Y2FjaGU=\"/>\n                    <L7p:VariableToSet stringValue=\"source\"/>\n                </L7p:SetVariable>\n                <L7p:AuditDetailAssertion>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// FINE\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Detail stringValue=\"==> Found allPolicyXML in the cache\"/>\n                    <L7p:Level stringValue=\"FINE\"/>\n                </L7p:AuditDetailAssertion>\n                <L7p:assertionComment>\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// Look in cache unless asked to refresh cache\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:assertionComment>\n            </wsp:All>\n            <wsp:All wsp:Usage=\"Required\">\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4NCjxBbGxQb2xpY3lYTUw+\"/>\n                    <L7p:VariableToSet stringValue=\"allPolicyXML\"/>\n                </L7p:SetVariable>\n                <wsp:All wsp:Usage=\"Required\">\n                    <L7p:Encapsulated>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// GET policies\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:EncapsulatedAssertionConfigGuid stringValue=\"c8a5a0d5-1ae2-4144-b538-5c311efc1560\"/>\n                        <L7p:EncapsulatedAssertionConfigName stringValue=\"Utility: Call Restman\"/>\n                        <L7p:Parameters mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"element\"/>\n                                <L7p:value stringValue=\"Policy\"/>\n                            </L7p:entry>\n                            <L7p:entry>\n                                <L7p:key stringValue=\"message\"/>\n                                <L7p:value stringValue=\"\"/>\n                            </L7p:entry>\n                            <L7p:entry>\n                                <L7p:key stringValue=\"method\"/>\n                                <L7p:value stringValue=\"GET\"/>\n                            </L7p:entry>\n                            <L7p:entry>\n                                <L7p:key stringValue=\"resource\"/>\n                                <L7p:value stringValue=\"policies\"/>\n                            </L7p:entry>\n                        </L7p:Parameters>\n                    </L7p:Encapsulated>\n                    <wsp:OneOrMore wsp:Usage=\"Required\">\n                        <L7p:ResponseXpathAssertion>\n                            <L7p:VariablePrefix stringValue=\"objects\"/>\n                            <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                <L7p:Expression stringValue=\"/l7:List/l7:Item/l7:Resource/l7:Policy\"/>\n                                <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                    </L7p:entry>\n                                </L7p:Namespaces>\n                                <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                            </L7p:XpathExpression>\n                        </L7p:ResponseXpathAssertion>\n                        <L7p:TrueAssertion/>\n                        <L7p:assertionComment>\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Extract the list of policies, never fail\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:assertionComment>\n                    </wsp:OneOrMore>\n                    <L7p:ForEachLoop L7p:Usage=\"Required\"\n                        loopVariable=\"objects.elements\" variablePrefix=\"object\">\n                        <L7p:SetVariable>\n                            <L7p:Base64Expression stringValue=\"JHtvYmplY3QuY3VycmVudH0=\"/>\n                            <L7p:ContentType stringValue=\"text/xml; charset=utf-8\"/>\n                            <L7p:DataType variableDataType=\"message\"/>\n                            <L7p:VariableToSet stringValue=\"object.xml\"/>\n                        </L7p:SetVariable>\n                        <L7p:ResponseXpathAssertion>\n                            <L7p:VariablePrefix stringValue=\"id\"/>\n                            <L7p:XmlMsgSrc stringValue=\"object.xml\"/>\n                            <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                <L7p:Expression stringValue=\"/l7:Policy/@id\"/>\n                                <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"s\"/>\n                                    <L7p:value stringValue=\"http://schemas.xmlsoap.org/soap/envelope/\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                    </L7p:entry>\n                                </L7p:Namespaces>\n                                <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                            </L7p:XpathExpression>\n                        </L7p:ResponseXpathAssertion>\n                        <L7p:ResponseXpathAssertion>\n                            <L7p:VariablePrefix stringValue=\"policy.xml\"/>\n                            <L7p:XmlMsgSrc stringValue=\"object.xml\"/>\n                            <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                <L7p:Expression stringValue=\"//l7:Resource[@type=&quot;policy&quot;]/text()\"/>\n                                <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"s\"/>\n                                    <L7p:value stringValue=\"http://schemas.xmlsoap.org/soap/envelope/\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                    </L7p:entry>\n                                </L7p:Namespaces>\n                                <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                            </L7p:XpathExpression>\n                        </L7p:ResponseXpathAssertion>\n                        <L7p:Regex>\n                            <L7p:AutoTarget booleanValue=\"false\"/>\n                            <L7p:OtherTargetMessageVariable stringValue=\"policy.xml.result\"/>\n                            <L7p:Regex stringValue=\"&amp;\"/>\n                            <L7p:Replace booleanValue=\"true\"/>\n                            <L7p:Replacement stringValue=\"&amp;amp;\"/>\n                            <L7p:Target target=\"OTHER\"/>\n                        </L7p:Regex>\n                        <L7p:Regex>\n                            <L7p:AutoTarget booleanValue=\"false\"/>\n                            <L7p:OtherTargetMessageVariable stringValue=\"policy.xml.result\"/>\n                            <L7p:Regex stringValue=\"&lt;\"/>\n                            <L7p:Replace booleanValue=\"true\"/>\n                            <L7p:Replacement stringValue=\"&amp;lt;\"/>\n                            <L7p:Target target=\"OTHER\"/>\n                        </L7p:Regex>\n                        <L7p:Regex>\n                            <L7p:AutoTarget booleanValue=\"false\"/>\n                            <L7p:OtherTargetMessageVariable stringValue=\"policy.xml.result\"/>\n                            <L7p:Regex stringValue=\">\"/>\n                            <L7p:Replace booleanValue=\"true\"/>\n                            <L7p:Replacement stringValue=\"&amp;gt;\"/>\n                            <L7p:Target target=\"OTHER\"/>\n                        </L7p:Regex>\n                        <L7p:SetVariable>\n                            <L7p:Base64Expression stringValue=\"JHthbGxQb2xpY3lYTUx9DQogIDxQb2xpY3lYTUwgc291cmNlSWQ9IiR7aWQucmVzdWx0fSIgc291cmNlVHlwZT0iUE9MSUNZIj4ke3BvbGljeS54bWwucmVzdWx0fTwvUG9saWN5WE1MPg==\"/>\n                            <L7p:VariableToSet stringValue=\"allPolicyXML\"/>\n                        </L7p:SetVariable>\n                    </L7p:ForEachLoop>\n                    <L7p:assertionComment>\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// Get policy XML for Policies and append to ${allPolicyXML}\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:assertionComment>\n                </wsp:All>\n                <wsp:All wsp:Usage=\"Required\">\n                    <L7p:Encapsulated>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// GET services\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:EncapsulatedAssertionConfigGuid stringValue=\"c8a5a0d5-1ae2-4144-b538-5c311efc1560\"/>\n                        <L7p:EncapsulatedAssertionConfigName stringValue=\"Utility: Call Restman\"/>\n                        <L7p:Parameters mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"element\"/>\n                                <L7p:value stringValue=\"Service\"/>\n                            </L7p:entry>\n                            <L7p:entry>\n                                <L7p:key stringValue=\"message\"/>\n                                <L7p:value stringValue=\"\"/>\n                            </L7p:entry>\n                            <L7p:entry>\n                                <L7p:key stringValue=\"method\"/>\n                                <L7p:value stringValue=\"GET\"/>\n                            </L7p:entry>\n                            <L7p:entry>\n                                <L7p:key stringValue=\"resource\"/>\n                                <L7p:value stringValue=\"services\"/>\n                            </L7p:entry>\n                        </L7p:Parameters>\n                    </L7p:Encapsulated>\n                    <wsp:OneOrMore wsp:Usage=\"Required\">\n                        <L7p:ResponseXpathAssertion>\n                            <L7p:VariablePrefix stringValue=\"objects\"/>\n                            <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                <L7p:Expression stringValue=\"/l7:List/l7:Item/l7:Resource/l7:Service\"/>\n                                <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                    </L7p:entry>\n                                </L7p:Namespaces>\n                                <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                            </L7p:XpathExpression>\n                        </L7p:ResponseXpathAssertion>\n                        <L7p:TrueAssertion/>\n                        <L7p:assertionComment>\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Extract the list of services, never fail\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:assertionComment>\n                    </wsp:OneOrMore>\n                    <L7p:ForEachLoop L7p:Usage=\"Required\"\n                        loopVariable=\"objects.elements\" variablePrefix=\"object\">\n                        <L7p:SetVariable>\n                            <L7p:Base64Expression stringValue=\"JHtvYmplY3QuY3VycmVudH0=\"/>\n                            <L7p:ContentType stringValue=\"text/xml; charset=utf-8\"/>\n                            <L7p:DataType variableDataType=\"message\"/>\n                            <L7p:VariableToSet stringValue=\"object.xml\"/>\n                        </L7p:SetVariable>\n                        <L7p:ResponseXpathAssertion>\n                            <L7p:VariablePrefix stringValue=\"id\"/>\n                            <L7p:XmlMsgSrc stringValue=\"object.xml\"/>\n                            <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                <L7p:Expression stringValue=\"/l7:Service/@id\"/>\n                                <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"s\"/>\n                                    <L7p:value stringValue=\"http://schemas.xmlsoap.org/soap/envelope/\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                    </L7p:entry>\n                                </L7p:Namespaces>\n                                <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                            </L7p:XpathExpression>\n                        </L7p:ResponseXpathAssertion>\n                        <L7p:ResponseXpathAssertion>\n                            <L7p:VariablePrefix stringValue=\"policy.xml\"/>\n                            <L7p:XmlMsgSrc stringValue=\"object.xml\"/>\n                            <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                <L7p:Expression stringValue=\"//l7:Resource[@type=&quot;policy&quot;]/text()\"/>\n                                <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"s\"/>\n                                    <L7p:value stringValue=\"http://schemas.xmlsoap.org/soap/envelope/\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                    </L7p:entry>\n                                </L7p:Namespaces>\n                                <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                            </L7p:XpathExpression>\n                        </L7p:ResponseXpathAssertion>\n                        <L7p:Regex>\n                            <L7p:AutoTarget booleanValue=\"false\"/>\n                            <L7p:OtherTargetMessageVariable stringValue=\"policy.xml.result\"/>\n                            <L7p:Regex stringValue=\"&amp;\"/>\n                            <L7p:Replace booleanValue=\"true\"/>\n                            <L7p:Replacement stringValue=\"&amp;amp;\"/>\n                            <L7p:Target target=\"OTHER\"/>\n                        </L7p:Regex>\n                        <L7p:Regex>\n                            <L7p:AutoTarget booleanValue=\"false\"/>\n                            <L7p:OtherTargetMessageVariable stringValue=\"policy.xml.result\"/>\n                            <L7p:Regex stringValue=\"&lt;\"/>\n                            <L7p:Replace booleanValue=\"true\"/>\n                            <L7p:Replacement stringValue=\"&amp;lt;\"/>\n                            <L7p:Target target=\"OTHER\"/>\n                        </L7p:Regex>\n                        <L7p:Regex>\n                            <L7p:AutoTarget booleanValue=\"false\"/>\n                            <L7p:OtherTargetMessageVariable stringValue=\"policy.xml.result\"/>\n                            <L7p:Regex stringValue=\">\"/>\n                            <L7p:Replace booleanValue=\"true\"/>\n                            <L7p:Replacement stringValue=\"&amp;gt;\"/>\n                            <L7p:Target target=\"OTHER\"/>\n                        </L7p:Regex>\n                        <L7p:SetVariable>\n                            <L7p:Base64Expression stringValue=\"JHthbGxQb2xpY3lYTUx9DQogIDxQb2xpY3lYTUwgc291cmNlSWQ9IiR7aWQucmVzdWx0fSIgc291cmNlVHlwZT0iU0VSVklDRSI+JHtwb2xpY3kueG1sLnJlc3VsdH08L1BvbGljeVhNTD4=\"/>\n                            <L7p:VariableToSet stringValue=\"allPolicyXML\"/>\n                        </L7p:SetVariable>\n                    </L7p:ForEachLoop>\n                    <L7p:assertionComment>\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// Get policy XML for Services and append to ${allPolicyXML}\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:assertionComment>\n                </wsp:All>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"JHthbGxQb2xpY3lYTUx9DQo8L0FsbFBvbGljeVhNTD4=\"/>\n                    <L7p:ContentType stringValue=\"text/xml; charset=utf-8\"/>\n                    <L7p:DataType variableDataType=\"message\"/>\n                    <L7p:VariableToSet stringValue=\"allPolicyXML\"/>\n                </L7p:SetVariable>\n                <L7p:CacheStorage>\n                    <L7p:CacheEntryKey stringValue=\"${cacheKey}\"/>\n                    <L7p:CacheId stringValue=\"allPolicyXML\"/>\n                    <L7p:MaxEntries stringValue=\"1\"/>\n                    <L7p:MaxEntryAgeSeconds stringValue=\"${cacheAge}\"/>\n                    <L7p:MaxEntrySizeBytes stringValue=\"25000000\"/>\n                    <L7p:OtherTargetMessageVariable stringValue=\"allPolicyXML\"/>\n                    <L7p:StoreSoapFaults booleanValue=\"true\"/>\n                    <L7p:Target target=\"OTHER\"/>\n                </L7p:CacheStorage>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"c3lzdGVt\"/>\n                    <L7p:VariableToSet stringValue=\"source\"/>\n                </L7p:SetVariable>\n                <L7p:AuditDetailAssertion>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// FINE\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Detail stringValue=\"==> Loaded policies.sorted from system and stored to cache\"/>\n                    <L7p:Level stringValue=\"FINE\"/>\n                </L7p:AuditDetailAssertion>\n                <L7p:assertionComment>\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// Retrieve new list and cache\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:assertionComment>\n            </wsp:All>\n            <wsp:All wsp:Usage=\"Required\">\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"RXJyb3Igd2hlbiBvYnRhaW5pbmcgcG9saWN5IFhNTA==\"/>\n                    <L7p:VariableToSet stringValue=\"error.msg\"/>\n                </L7p:SetVariable>\n                <L7p:AuditDetailAssertion>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// WARNING\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Detail stringValue=\"==> Error obtaining policy XML in ${policy.name}\"/>\n                    <L7p:Level stringValue=\"WARNING\"/>\n                </L7p:AuditDetailAssertion>\n                <L7p:FalseAssertion/>\n                <L7p:assertionComment>\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// Failure - set ${error.msg}\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:assertionComment>\n            </wsp:All>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Caching logic\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:OneOrMore>\n        <L7p:Regex>\n            <L7p:AssertionComment assertionComment=\"included\">\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Add source attribute to /Policies element\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:AssertionComment>\n            <L7p:AutoTarget booleanValue=\"false\"/>\n            <L7p:OtherTargetMessageVariable stringValue=\"allPolicyXML\"/>\n            <L7p:Regex stringValue=\"&lt;AllPolicyXML>\"/>\n            <L7p:Replace booleanValue=\"true\"/>\n            <L7p:Replacement stringValue=\"&lt;AllPolicyXML source=&quot;${source}&quot;>\"/>\n            <L7p:Target target=\"OTHER\"/>\n        </L7p:Regex>\n        <L7p:AuditDetailAssertion>\n            <L7p:AssertionComment assertionComment=\"included\">\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// FINE\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:AssertionComment>\n            <L7p:Detail stringValue=\"==> Leaving Utility Fragment: ${policy.name}\"/>\n            <L7p:Level stringValue=\"FINE\"/>\n        </L7p:AuditDetailAssertion>\n    </wsp:All>\n</wsp:Policy>\n"
        }
      ]
    },
    {
      "guid": "8f33b165-bc16-4959-a524-aba67aff3cdf",
      "name": "Utility: Get PolicyObject Info",
      "policyType": "FRAGMENT",
      "checksum": "7f9b6b7a68e387c0d508ce9d46e37d606e7fbc15",
      "folderPath": "/Gateway Management Utilities/fragments",
      "soap": false,
      "policy": {
        "xml": "<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<wsp:Policy xmlns:L7p=\"http://www.layer7tech.com/ws/policy\" xmlns:wsp=\"http://schemas.xmlsoap.org/ws/2002/12/policy\">\n    <wsp:All wsp:Usage=\"Required\">\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Policy fragment to extract the name and foldername of an object from Get All Policy XML output\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Outputs:\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - name.result\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - folderPath.result\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** v0.0.0 - Jay MacDonald - 20200921 - Initial Version\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n        </L7p:CommentAssertion>\n        <L7p:ResponseXpathAssertion>\n            <L7p:AssertionComment assertionComment=\"included\">\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Get the id of the source object\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:AssertionComment>\n            <L7p:VariablePrefix stringValue=\"sourceId\"/>\n            <L7p:XmlMsgSrc stringValue=\"policyObject.xml\"/>\n            <L7p:XpathExpression xpathExpressionValue=\"included\">\n                <L7p:Expression stringValue=\"/PolicyXML/@sourceId\"/>\n                <L7p:Namespaces mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"s\"/>\n                        <L7p:value stringValue=\"http://schemas.xmlsoap.org/soap/envelope/\"/>\n                    </L7p:entry>\n                    <L7p:entry>\n                        <L7p:key stringValue=\"l7\"/>\n                        <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                    </L7p:entry>\n                </L7p:Namespaces>\n                <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n            </L7p:XpathExpression>\n        </L7p:ResponseXpathAssertion>\n        <L7p:ResponseXpathAssertion>\n            <L7p:AssertionComment assertionComment=\"included\">\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Get the type of the source object\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:AssertionComment>\n            <L7p:VariablePrefix stringValue=\"sourceType\"/>\n            <L7p:XmlMsgSrc stringValue=\"policyObject.xml\"/>\n            <L7p:XpathExpression xpathExpressionValue=\"included\">\n                <L7p:Expression stringValue=\"/PolicyXML/@sourceType\"/>\n                <L7p:Namespaces mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"s\"/>\n                        <L7p:value stringValue=\"http://schemas.xmlsoap.org/soap/envelope/\"/>\n                    </L7p:entry>\n                    <L7p:entry>\n                        <L7p:key stringValue=\"l7\"/>\n                        <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                    </L7p:entry>\n                </L7p:Namespaces>\n                <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n            </L7p:XpathExpression>\n        </L7p:ResponseXpathAssertion>\n        <wsp:OneOrMore wsp:Usage=\"Required\">\n            <wsp:All wsp:Usage=\"Required\">\n                <L7p:ResponseXpathAssertion>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// Get name of Policy\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:VariablePrefix stringValue=\"name\"/>\n                    <L7p:XmlMsgSrc stringValue=\"policies.sorted\"/>\n                    <L7p:XpathExpression xpathExpressionValue=\"included\">\n                        <L7p:Expression stringValue=\"/Policies/Policy[@id=$sourceId.result]/Name\"/>\n                        <L7p:Namespaces mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"l7\"/>\n                                <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                            </L7p:entry>\n                        </L7p:Namespaces>\n                        <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                    </L7p:XpathExpression>\n                </L7p:ResponseXpathAssertion>\n                <L7p:ResponseXpathAssertion>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// Get folderpath of Policy\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:VariablePrefix stringValue=\"folderPath\"/>\n                    <L7p:XmlMsgSrc stringValue=\"policies.sorted\"/>\n                    <L7p:XpathExpression xpathExpressionValue=\"included\">\n                        <L7p:Expression stringValue=\"/Policies/Policy[@id=$sourceId.result]/FolderPath\"/>\n                        <L7p:Namespaces mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"l7\"/>\n                                <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                            </L7p:entry>\n                        </L7p:Namespaces>\n                        <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                    </L7p:XpathExpression>\n                </L7p:ResponseXpathAssertion>\n                <L7p:assertionComment>\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// Try for Policy\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:assertionComment>\n            </wsp:All>\n            <wsp:All wsp:Usage=\"Required\">\n                <L7p:ResponseXpathAssertion>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// Get name of Service\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:VariablePrefix stringValue=\"name\"/>\n                    <L7p:XmlMsgSrc stringValue=\"services.sorted\"/>\n                    <L7p:XpathExpression xpathExpressionValue=\"included\">\n                        <L7p:Expression stringValue=\"/Services/Service[@id=$sourceId.result]/Name\"/>\n                        <L7p:Namespaces mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"l7\"/>\n                                <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                            </L7p:entry>\n                        </L7p:Namespaces>\n                        <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                    </L7p:XpathExpression>\n                </L7p:ResponseXpathAssertion>\n                <L7p:ResponseXpathAssertion>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// Get folderpath of Service\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:VariablePrefix stringValue=\"folderPath\"/>\n                    <L7p:XmlMsgSrc stringValue=\"services.sorted\"/>\n                    <L7p:XpathExpression xpathExpressionValue=\"included\">\n                        <L7p:Expression stringValue=\"/Services/Service[@id=$sourceId.result]/FolderPath\"/>\n                        <L7p:Namespaces mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"l7\"/>\n                                <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                            </L7p:entry>\n                        </L7p:Namespaces>\n                        <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                    </L7p:XpathExpression>\n                </L7p:ResponseXpathAssertion>\n                <L7p:assertionComment>\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// Try for Service\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:assertionComment>\n            </wsp:All>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Get name and folderpath of Policy/Service\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:OneOrMore>\n        <L7p:ExportVariables>\n            <L7p:ExportedVars stringArrayValue=\"included\">\n                <L7p:item stringValue=\"folderPath.result\"/>\n                <L7p:item stringValue=\"name.result\"/>\n                <L7p:item stringValue=\"sourceId.result\"/>\n                <L7p:item stringValue=\"sourceType.result\"/>\n            </L7p:ExportedVars>\n        </L7p:ExportVariables>\n    </wsp:All>\n</wsp:Policy>\n"
      },
      "policyRevisions": [
        {
          "goid": "bed4baf4ff33b7e528854c3965d9bb14",
          "ordinal": 1,
          "active": true,
          "author": "admin",
          "time": "2025-02-05T14:20:38.411Z",
          "xml": "<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<wsp:Policy xmlns:L7p=\"http://www.layer7tech.com/ws/policy\" xmlns:wsp=\"http://schemas.xmlsoap.org/ws/2002/12/policy\">\n    <wsp:All wsp:Usage=\"Required\">\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Policy fragment to extract the name and foldername of an object from Get All Policy XML output\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Outputs:\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - name.result\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - folderPath.result\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** v0.0.0 - Jay MacDonald - 20200921 - Initial Version\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n        </L7p:CommentAssertion>\n        <L7p:ResponseXpathAssertion>\n            <L7p:AssertionComment assertionComment=\"included\">\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Get the id of the source object\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:AssertionComment>\n            <L7p:VariablePrefix stringValue=\"sourceId\"/>\n            <L7p:XmlMsgSrc stringValue=\"policyObject.xml\"/>\n            <L7p:XpathExpression xpathExpressionValue=\"included\">\n                <L7p:Expression stringValue=\"/PolicyXML/@sourceId\"/>\n                <L7p:Namespaces mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"s\"/>\n                        <L7p:value stringValue=\"http://schemas.xmlsoap.org/soap/envelope/\"/>\n                    </L7p:entry>\n                    <L7p:entry>\n                        <L7p:key stringValue=\"l7\"/>\n                        <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                    </L7p:entry>\n                </L7p:Namespaces>\n                <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n            </L7p:XpathExpression>\n        </L7p:ResponseXpathAssertion>\n        <L7p:ResponseXpathAssertion>\n            <L7p:AssertionComment assertionComment=\"included\">\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Get the type of the source object\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:AssertionComment>\n            <L7p:VariablePrefix stringValue=\"sourceType\"/>\n            <L7p:XmlMsgSrc stringValue=\"policyObject.xml\"/>\n            <L7p:XpathExpression xpathExpressionValue=\"included\">\n                <L7p:Expression stringValue=\"/PolicyXML/@sourceType\"/>\n                <L7p:Namespaces mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"s\"/>\n                        <L7p:value stringValue=\"http://schemas.xmlsoap.org/soap/envelope/\"/>\n                    </L7p:entry>\n                    <L7p:entry>\n                        <L7p:key stringValue=\"l7\"/>\n                        <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                    </L7p:entry>\n                </L7p:Namespaces>\n                <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n            </L7p:XpathExpression>\n        </L7p:ResponseXpathAssertion>\n        <wsp:OneOrMore wsp:Usage=\"Required\">\n            <wsp:All wsp:Usage=\"Required\">\n                <L7p:ResponseXpathAssertion>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// Get name of Policy\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:VariablePrefix stringValue=\"name\"/>\n                    <L7p:XmlMsgSrc stringValue=\"policies.sorted\"/>\n                    <L7p:XpathExpression xpathExpressionValue=\"included\">\n                        <L7p:Expression stringValue=\"/Policies/Policy[@id=$sourceId.result]/Name\"/>\n                        <L7p:Namespaces mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"l7\"/>\n                                <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                            </L7p:entry>\n                        </L7p:Namespaces>\n                        <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                    </L7p:XpathExpression>\n                </L7p:ResponseXpathAssertion>\n                <L7p:ResponseXpathAssertion>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// Get folderpath of Policy\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:VariablePrefix stringValue=\"folderPath\"/>\n                    <L7p:XmlMsgSrc stringValue=\"policies.sorted\"/>\n                    <L7p:XpathExpression xpathExpressionValue=\"included\">\n                        <L7p:Expression stringValue=\"/Policies/Policy[@id=$sourceId.result]/FolderPath\"/>\n                        <L7p:Namespaces mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"l7\"/>\n                                <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                            </L7p:entry>\n                        </L7p:Namespaces>\n                        <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                    </L7p:XpathExpression>\n                </L7p:ResponseXpathAssertion>\n                <L7p:assertionComment>\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// Try for Policy\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:assertionComment>\n            </wsp:All>\n            <wsp:All wsp:Usage=\"Required\">\n                <L7p:ResponseXpathAssertion>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// Get name of Service\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:VariablePrefix stringValue=\"name\"/>\n                    <L7p:XmlMsgSrc stringValue=\"services.sorted\"/>\n                    <L7p:XpathExpression xpathExpressionValue=\"included\">\n                        <L7p:Expression stringValue=\"/Services/Service[@id=$sourceId.result]/Name\"/>\n                        <L7p:Namespaces mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"l7\"/>\n                                <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                            </L7p:entry>\n                        </L7p:Namespaces>\n                        <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                    </L7p:XpathExpression>\n                </L7p:ResponseXpathAssertion>\n                <L7p:ResponseXpathAssertion>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// Get folderpath of Service\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:VariablePrefix stringValue=\"folderPath\"/>\n                    <L7p:XmlMsgSrc stringValue=\"services.sorted\"/>\n                    <L7p:XpathExpression xpathExpressionValue=\"included\">\n                        <L7p:Expression stringValue=\"/Services/Service[@id=$sourceId.result]/FolderPath\"/>\n                        <L7p:Namespaces mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"l7\"/>\n                                <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                            </L7p:entry>\n                        </L7p:Namespaces>\n                        <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                    </L7p:XpathExpression>\n                </L7p:ResponseXpathAssertion>\n                <L7p:assertionComment>\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// Try for Service\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:assertionComment>\n            </wsp:All>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Get name and folderpath of Policy/Service\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:OneOrMore>\n        <L7p:ExportVariables>\n            <L7p:ExportedVars stringArrayValue=\"included\">\n                <L7p:item stringValue=\"folderPath.result\"/>\n                <L7p:item stringValue=\"name.result\"/>\n                <L7p:item stringValue=\"sourceId.result\"/>\n                <L7p:item stringValue=\"sourceType.result\"/>\n            </L7p:ExportedVars>\n        </L7p:ExportVariables>\n    </wsp:All>\n</wsp:Policy>\n"
        }
      ]
    },
    {
      "guid": "58c91da2-50ba-48ff-800c-1c96ad9659c0",
      "name": "Utility: HTML Escape String",
      "policyType": "FRAGMENT",
      "checksum": "b3a9726015f0a8bbf3becb2dab1bb3cad3f07288",
      "folderPath": "/Gateway Management Utilities/fragments",
      "soap": false,
      "policy": {
        "xml": "<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<wsp:Policy xmlns:L7p=\"http://www.layer7tech.com/ws/policy\" xmlns:wsp=\"http://schemas.xmlsoap.org/ws/2002/12/policy\">\n    <wsp:All wsp:Usage=\"Required\">\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Policy fragment for &quot;Utility: Escape HTML String&quot; encapsulated assertion\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Call Use regular expressions to escape a string for HTML\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Inputs:\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - escapedString (string)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Outputs:\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - escapedString (string)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** v1.0.0 - Jay MacDonald - 20201107 - Initial Version\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n        </L7p:CommentAssertion>\n        <L7p:Regex>\n            <L7p:AutoTarget booleanValue=\"false\"/>\n            <L7p:OtherTargetMessageVariable stringValue=\"escapedString\"/>\n            <L7p:Regex stringValue=\"&amp;\"/>\n            <L7p:Replace booleanValue=\"true\"/>\n            <L7p:Replacement stringValue=\"&amp;amp;\"/>\n            <L7p:Target target=\"OTHER\"/>\n        </L7p:Regex>\n        <L7p:Regex>\n            <L7p:AutoTarget booleanValue=\"false\"/>\n            <L7p:OtherTargetMessageVariable stringValue=\"escapedString\"/>\n            <L7p:Regex stringValue=\"&lt;\"/>\n            <L7p:Replace booleanValue=\"true\"/>\n            <L7p:Replacement stringValue=\"&amp;lt;\"/>\n            <L7p:Target target=\"OTHER\"/>\n        </L7p:Regex>\n        <L7p:Regex>\n            <L7p:AutoTarget booleanValue=\"false\"/>\n            <L7p:OtherTargetMessageVariable stringValue=\"escapedString\"/>\n            <L7p:Regex stringValue=\">\"/>\n            <L7p:Replace booleanValue=\"true\"/>\n            <L7p:Replacement stringValue=\"&amp;gt;\"/>\n            <L7p:Target target=\"OTHER\"/>\n        </L7p:Regex>\n    </wsp:All>\n</wsp:Policy>\n"
      },
      "policyRevisions": [
        {
          "goid": "bed4baf4ff33b7e528854c3965d9bb18",
          "ordinal": 1,
          "active": true,
          "author": "admin",
          "time": "2025-02-05T14:20:38.417Z",
          "xml": "<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<wsp:Policy xmlns:L7p=\"http://www.layer7tech.com/ws/policy\" xmlns:wsp=\"http://schemas.xmlsoap.org/ws/2002/12/policy\">\n    <wsp:All wsp:Usage=\"Required\">\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Policy fragment for &quot;Utility: Escape HTML String&quot; encapsulated assertion\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Call Use regular expressions to escape a string for HTML\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Inputs:\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - escapedString (string)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Outputs:\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - escapedString (string)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** v1.0.0 - Jay MacDonald - 20201107 - Initial Version\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n        </L7p:CommentAssertion>\n        <L7p:Regex>\n            <L7p:AutoTarget booleanValue=\"false\"/>\n            <L7p:OtherTargetMessageVariable stringValue=\"escapedString\"/>\n            <L7p:Regex stringValue=\"&amp;\"/>\n            <L7p:Replace booleanValue=\"true\"/>\n            <L7p:Replacement stringValue=\"&amp;amp;\"/>\n            <L7p:Target target=\"OTHER\"/>\n        </L7p:Regex>\n        <L7p:Regex>\n            <L7p:AutoTarget booleanValue=\"false\"/>\n            <L7p:OtherTargetMessageVariable stringValue=\"escapedString\"/>\n            <L7p:Regex stringValue=\"&lt;\"/>\n            <L7p:Replace booleanValue=\"true\"/>\n            <L7p:Replacement stringValue=\"&amp;lt;\"/>\n            <L7p:Target target=\"OTHER\"/>\n        </L7p:Regex>\n        <L7p:Regex>\n            <L7p:AutoTarget booleanValue=\"false\"/>\n            <L7p:OtherTargetMessageVariable stringValue=\"escapedString\"/>\n            <L7p:Regex stringValue=\">\"/>\n            <L7p:Replace booleanValue=\"true\"/>\n            <L7p:Replacement stringValue=\"&amp;gt;\"/>\n            <L7p:Target target=\"OTHER\"/>\n        </L7p:Regex>\n    </wsp:All>\n</wsp:Policy>\n"
        }
      ]
    },
    {
      "guid": "5e77b1ed-3cd9-4c5a-b038-601cca3fbc27",
      "name": "Utility: List Active Connectors",
      "policyType": "FRAGMENT",
      "checksum": "06c653fb22efe0346edfffbf166270ab0027d8c3",
      "folderPath": "/Gateway Management Utilities/fragments",
      "soap": false,
      "policy": {
        "xml": "<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<wsp:Policy xmlns:L7p=\"http://www.layer7tech.com/ws/policy\" xmlns:wsp=\"http://schemas.xmlsoap.org/ws/2002/12/policy\">\n    <wsp:All wsp:Usage=\"Required\">\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Policy fragment for &quot;Utility: List Active Connectors&quot; encapsulated assertion\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Call Restman and generate a sorted list of active connectors\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** - Assumes an admin role user has been authenticated\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** - Caches results for ${cacheAge} seconds (default=300). To refresh the cache set ${refresh}=true when calling\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** - Returns a text/xml message variable in ${activeConnectors.sorted}\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Inputs:\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - refresh (string)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - cacheAge (string)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Outputs:\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - activeConnectors.sorted (message)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - error.msg (string)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** v1.0.0 - Jay MacDonald - 20201107 - Initial Version\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n        </L7p:CommentAssertion>\n        <L7p:AuditDetailAssertion>\n            <L7p:AssertionComment assertionComment=\"included\">\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// FINE\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:AssertionComment>\n            <L7p:Detail stringValue=\"==> Entering Utility Fragment: ${policy.name} (refresh=${refresh})\"/>\n            <L7p:Level stringValue=\"FINE\"/>\n        </L7p:AuditDetailAssertion>\n        <wsp:All wsp:Usage=\"Required\">\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** ${activeConnectors.sorted} has the following schema:\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** \"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** &lt;ActiveConnectors source=&quot;system|cache&quot;>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   &lt;ActiveConnector id=&quot;string&quot;>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**     &lt;Name>string&lt;/Name>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**     &lt;Type>string&lt;/Type>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**     &lt;Enabled>boolean&lt;/Enabled>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   &lt;/ActiveConnector>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   ...\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** &lt;/ActiveConnectors>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n            </L7p:CommentAssertion>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Description of ${activeConnectors.sorted}\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:All>\n        <wsp:OneOrMore wsp:Usage=\"Required\">\n            <L7p:ComparisonAssertion>\n                <L7p:AssertionComment assertionComment=\"included\">\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// true or false\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:AssertionComment>\n                <L7p:CaseSensitive booleanValue=\"false\"/>\n                <L7p:Expression1 stringValue=\"${cacheAge}\"/>\n                <L7p:Operator operatorNull=\"null\"/>\n                <L7p:Predicates predicates=\"included\">\n                    <L7p:item dataType=\"included\">\n                        <L7p:Type variableDataType=\"int\"/>\n                    </L7p:item>\n                    <L7p:item binary=\"included\">\n                        <L7p:CaseSensitive booleanValue=\"false\"/>\n                        <L7p:Operator operator=\"GT\"/>\n                        <L7p:RightValue stringValue=\"0\"/>\n                    </L7p:item>\n                </L7p:Predicates>\n            </L7p:ComparisonAssertion>\n            <L7p:SetVariable>\n                <L7p:Base64Expression stringValue=\"MzAw\"/>\n                <L7p:DataType variableDataType=\"int\"/>\n                <L7p:VariableToSet stringValue=\"cacheAge\"/>\n            </L7p:SetVariable>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Ensure ${cacheAge} is set, default=300\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:OneOrMore>\n        <wsp:OneOrMore wsp:Usage=\"Required\">\n            <L7p:ComparisonAssertion>\n                <L7p:AssertionComment assertionComment=\"included\">\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// true or false\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:AssertionComment>\n                <L7p:CaseSensitive booleanValue=\"false\"/>\n                <L7p:Expression1 stringValue=\"${refresh}\"/>\n                <L7p:Operator operatorNull=\"null\"/>\n                <L7p:Predicates predicates=\"included\">\n                    <L7p:item dataType=\"included\">\n                        <L7p:Type variableDataType=\"string\"/>\n                    </L7p:item>\n                    <L7p:item regex=\"included\">\n                        <L7p:Pattern stringValue=\"^(true|false)$\"/>\n                    </L7p:item>\n                </L7p:Predicates>\n            </L7p:ComparisonAssertion>\n            <L7p:SetVariable>\n                <L7p:Base64Expression stringValue=\"ZmFsc2U=\"/>\n                <L7p:VariableToSet stringValue=\"refresh\"/>\n            </L7p:SetVariable>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Ensure ${refresh} is set, default=false\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:OneOrMore>\n        <L7p:SetVariable>\n            <L7p:Base64Expression stringValue=\"YWN0aXZlQ29ubmVjdG9ycy5zb3J0ZWQ=\"/>\n            <L7p:VariableToSet stringValue=\"cacheKey\"/>\n        </L7p:SetVariable>\n        <wsp:OneOrMore wsp:Usage=\"Required\">\n            <wsp:All wsp:Usage=\"Required\">\n                <L7p:ComparisonAssertion>\n                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                    <L7p:Expression1 stringValue=\"${refresh}\"/>\n                    <L7p:Operator operatorNull=\"null\"/>\n                    <L7p:Predicates predicates=\"included\">\n                        <L7p:item dataType=\"included\">\n                            <L7p:Type variableDataType=\"string\"/>\n                        </L7p:item>\n                        <L7p:item binary=\"included\">\n                            <L7p:Negated booleanValue=\"true\"/>\n                            <L7p:RightValue stringValue=\"true\"/>\n                        </L7p:item>\n                    </L7p:Predicates>\n                </L7p:ComparisonAssertion>\n                <L7p:CacheLookup>\n                    <L7p:CacheEntryKey stringValue=\"${cacheKey}\"/>\n                    <L7p:CacheId stringValue=\"activeConnectorList\"/>\n                    <L7p:ContentTypeOverride stringValue=\"\"/>\n                    <L7p:MaxEntryAgeSeconds stringValue=\"${cacheAge}\"/>\n                    <L7p:OtherTargetMessageVariable stringValue=\"activeConnectors.sorted\"/>\n                    <L7p:Target target=\"OTHER\"/>\n                </L7p:CacheLookup>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"Y2FjaGU=\"/>\n                    <L7p:VariableToSet stringValue=\"source\"/>\n                </L7p:SetVariable>\n                <L7p:AuditDetailAssertion>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// FINE\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Detail stringValue=\"==> Found activeConnectors.sorted in the cache\"/>\n                    <L7p:Level stringValue=\"FINE\"/>\n                </L7p:AuditDetailAssertion>\n                <L7p:assertionComment>\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// Look in cache unless asked to refresh cache\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:assertionComment>\n            </wsp:All>\n            <wsp:All wsp:Usage=\"Required\">\n                <L7p:Encapsulated>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// GET activeConnectors\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:EncapsulatedAssertionConfigGuid stringValue=\"c8a5a0d5-1ae2-4144-b538-5c311efc1560\"/>\n                    <L7p:EncapsulatedAssertionConfigName stringValue=\"Utility: Call Restman\"/>\n                    <L7p:Parameters mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"element\"/>\n                            <L7p:value stringValue=\"ActiveConnector\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"message\"/>\n                            <L7p:value stringValue=\"\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"method\"/>\n                            <L7p:value stringValue=\"GET\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"resource\"/>\n                            <L7p:value stringValue=\"activeConnectors\"/>\n                        </L7p:entry>\n                    </L7p:Parameters>\n                </L7p:Encapsulated>\n                <wsp:OneOrMore wsp:Usage=\"Required\">\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:VariablePrefix stringValue=\"activeConnectors\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/l7:List/l7:Item/l7:Resource/l7:ActiveConnector\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <L7p:TrueAssertion/>\n                    <L7p:assertionComment>\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// Extract the list of active connectors, never fail\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:assertionComment>\n                </wsp:OneOrMore>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz48QWN0aXZlQ29ubmVjdG9ycz4=\"/>\n                    <L7p:VariableToSet stringValue=\"activeConnectors.sorted\"/>\n                </L7p:SetVariable>\n                <L7p:ForEachLoop L7p:Usage=\"Required\"\n                    loopVariable=\"activeConnectors.elements\" variablePrefix=\"activeConnector\">\n                    <L7p:SetVariable>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Cast to message type for parsing\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:Base64Expression stringValue=\"JHthY3RpdmVDb25uZWN0b3IuY3VycmVudH0=\"/>\n                        <L7p:ContentType stringValue=\"text/xml; charset=utf-8\"/>\n                        <L7p:DataType variableDataType=\"message\"/>\n                        <L7p:VariableToSet stringValue=\"activeConnector.xml\"/>\n                    </L7p:SetVariable>\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Retrieve the active connector ID\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:VariablePrefix stringValue=\"id\"/>\n                        <L7p:XmlMsgSrc stringValue=\"activeConnector.xml\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/l7:ActiveConnector/@id\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// retrieve the active connector name\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:VariablePrefix stringValue=\"name\"/>\n                        <L7p:XmlMsgSrc stringValue=\"activeConnector.xml\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/l7:ActiveConnector/l7:Name\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// retrieve the active connector type\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:VariablePrefix stringValue=\"type\"/>\n                        <L7p:XmlMsgSrc stringValue=\"activeConnector.xml\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/l7:ActiveConnector/l7:Type\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// retrieve the active connector enabled state\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:VariablePrefix stringValue=\"enabled\"/>\n                        <L7p:XmlMsgSrc stringValue=\"activeConnector.xml\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/l7:ActiveConnector/l7:Enabled\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <L7p:SetVariable>\n                        <L7p:Base64Expression stringValue=\"JHthY3RpdmVDb25uZWN0b3JzLnNvcnRlZH08QWN0aXZlQ29ubmVjdG9yIGlkPSIke2lkLnJlc3VsdH0iPjxOYW1lPjwhW0NEQVRBWyR7bmFtZS5yZXN1bHR9XV0+PC9OYW1lPjxUeXBlPiR7dHlwZS5yZXN1bHR9PC9UeXBlPjxFbmFibGVkPiR7ZW5hYmxlZC5yZXN1bHR9PC9FbmFibGVkPjwvQWN0aXZlQ29ubmVjdG9yPg==\"/>\n                        <L7p:VariableToSet stringValue=\"activeConnectors.sorted\"/>\n                    </L7p:SetVariable>\n                    <L7p:assertionComment>\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// Build the list of active connectors\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:assertionComment>\n                </L7p:ForEachLoop>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"JHthY3RpdmVDb25uZWN0b3JzLnNvcnRlZH08L0FjdGl2ZUNvbm5lY3RvcnM+\"/>\n                    <L7p:ContentType stringValue=\"text/xml; charset=utf-8\"/>\n                    <L7p:DataType variableDataType=\"message\"/>\n                    <L7p:VariableToSet stringValue=\"activeConnectors.sorted\"/>\n                </L7p:SetVariable>\n                <L7p:XslTransformation>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// Sort the active connectors by name\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Direction intValue=\"-1\"/>\n                    <L7p:OtherTargetMessageVariable stringValue=\"activeConnectors.sorted\"/>\n                    <L7p:ResourceInfo staticResourceInfo=\"included\">\n                        <L7p:Document stringValue=\"&lt;xsl:stylesheet version=&quot;1.0&quot; xmlns:l7=&quot;http://ns.l7tech.com/2010/04/gateway-management&quot; xmlns:xsl=&quot;http://www.w3.org/1999/XSL/Transform&quot;>&lt;xsl:template match=&quot;/ActiveConnectors&quot;>    &lt;xsl:copy>        &lt;xsl:for-each select=&quot;ActiveConnector&quot;>            &lt;xsl:sort select=&quot;./Name&quot;/>            &lt;xsl:copy-of select=&quot;.&quot;/>        &lt;/xsl:for-each>    &lt;/xsl:copy>&lt;/xsl:template>&lt;/xsl:stylesheet>\"/>\n                    </L7p:ResourceInfo>\n                    <L7p:Target target=\"OTHER\"/>\n                    <L7p:TransformName stringValue=\"\"/>\n                    <L7p:XsltVersion stringValue=\"1.0\"/>\n                </L7p:XslTransformation>\n                <L7p:CacheStorage>\n                    <L7p:CacheEntryKey stringValue=\"${cacheKey}\"/>\n                    <L7p:CacheId stringValue=\"activeConnectorList\"/>\n                    <L7p:MaxEntries stringValue=\"1\"/>\n                    <L7p:MaxEntryAgeSeconds stringValue=\"${cacheAge}\"/>\n                    <L7p:MaxEntrySizeBytes stringValue=\"200000\"/>\n                    <L7p:OtherTargetMessageVariable stringValue=\"activeConnectors.sorted\"/>\n                    <L7p:StoreSoapFaults booleanValue=\"true\"/>\n                    <L7p:Target target=\"OTHER\"/>\n                </L7p:CacheStorage>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"c3lzdGVt\"/>\n                    <L7p:VariableToSet stringValue=\"source\"/>\n                </L7p:SetVariable>\n                <L7p:AuditDetailAssertion>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// FINE\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Detail stringValue=\"==> Loaded activeConnectors.sorted from system and stored to cache\"/>\n                    <L7p:Level stringValue=\"FINE\"/>\n                </L7p:AuditDetailAssertion>\n                <L7p:assertionComment>\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// Retrieve new list and cache\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:assertionComment>\n            </wsp:All>\n            <wsp:All wsp:Usage=\"Required\">\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"RXJyb3Igd2hlbiBsaXN0aW5nIGFjdGl2ZSBjb25uZWN0b3Jz\"/>\n                    <L7p:VariableToSet stringValue=\"error.msg\"/>\n                </L7p:SetVariable>\n                <L7p:AuditDetailAssertion>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// WARNING\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Detail stringValue=\"==> Error listing active connectors in ${policy.name}\"/>\n                    <L7p:Level stringValue=\"WARNING\"/>\n                </L7p:AuditDetailAssertion>\n                <L7p:FalseAssertion/>\n                <L7p:assertionComment>\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// Failure - set ${error.msg}\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:assertionComment>\n            </wsp:All>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Caching logic\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:OneOrMore>\n        <L7p:Regex>\n            <L7p:AssertionComment assertionComment=\"included\">\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Add source attribute to /ActiveConnectors element\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:AssertionComment>\n            <L7p:AutoTarget booleanValue=\"false\"/>\n            <L7p:OtherTargetMessageVariable stringValue=\"activeConnectors.sorted\"/>\n            <L7p:Regex stringValue=\"&lt;ActiveConnectors>\"/>\n            <L7p:Replace booleanValue=\"true\"/>\n            <L7p:Replacement stringValue=\"&lt;ActiveConnectors source=&quot;${source}&quot;>\"/>\n            <L7p:Target target=\"OTHER\"/>\n        </L7p:Regex>\n        <L7p:AuditDetailAssertion>\n            <L7p:AssertionComment assertionComment=\"included\">\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// FINE\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:AssertionComment>\n            <L7p:Detail stringValue=\"==> Leaving Utility Fragment: ${policy.name}\"/>\n            <L7p:Level stringValue=\"FINE\"/>\n        </L7p:AuditDetailAssertion>\n    </wsp:All>\n</wsp:Policy>\n"
      },
      "policyRevisions": [
        {
          "goid": "bed4baf4ff33b7e528854c3965d9bb1c",
          "ordinal": 1,
          "active": true,
          "author": "admin",
          "time": "2025-02-05T14:20:38.421Z",
          "xml": "<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<wsp:Policy xmlns:L7p=\"http://www.layer7tech.com/ws/policy\" xmlns:wsp=\"http://schemas.xmlsoap.org/ws/2002/12/policy\">\n    <wsp:All wsp:Usage=\"Required\">\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Policy fragment for &quot;Utility: List Active Connectors&quot; encapsulated assertion\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Call Restman and generate a sorted list of active connectors\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** - Assumes an admin role user has been authenticated\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** - Caches results for ${cacheAge} seconds (default=300). To refresh the cache set ${refresh}=true when calling\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** - Returns a text/xml message variable in ${activeConnectors.sorted}\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Inputs:\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - refresh (string)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - cacheAge (string)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Outputs:\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - activeConnectors.sorted (message)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - error.msg (string)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** v1.0.0 - Jay MacDonald - 20201107 - Initial Version\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n        </L7p:CommentAssertion>\n        <L7p:AuditDetailAssertion>\n            <L7p:AssertionComment assertionComment=\"included\">\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// FINE\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:AssertionComment>\n            <L7p:Detail stringValue=\"==> Entering Utility Fragment: ${policy.name} (refresh=${refresh})\"/>\n            <L7p:Level stringValue=\"FINE\"/>\n        </L7p:AuditDetailAssertion>\n        <wsp:All wsp:Usage=\"Required\">\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** ${activeConnectors.sorted} has the following schema:\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** \"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** &lt;ActiveConnectors source=&quot;system|cache&quot;>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   &lt;ActiveConnector id=&quot;string&quot;>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**     &lt;Name>string&lt;/Name>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**     &lt;Type>string&lt;/Type>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**     &lt;Enabled>boolean&lt;/Enabled>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   &lt;/ActiveConnector>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   ...\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** &lt;/ActiveConnectors>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n            </L7p:CommentAssertion>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Description of ${activeConnectors.sorted}\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:All>\n        <wsp:OneOrMore wsp:Usage=\"Required\">\n            <L7p:ComparisonAssertion>\n                <L7p:AssertionComment assertionComment=\"included\">\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// true or false\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:AssertionComment>\n                <L7p:CaseSensitive booleanValue=\"false\"/>\n                <L7p:Expression1 stringValue=\"${cacheAge}\"/>\n                <L7p:Operator operatorNull=\"null\"/>\n                <L7p:Predicates predicates=\"included\">\n                    <L7p:item dataType=\"included\">\n                        <L7p:Type variableDataType=\"int\"/>\n                    </L7p:item>\n                    <L7p:item binary=\"included\">\n                        <L7p:CaseSensitive booleanValue=\"false\"/>\n                        <L7p:Operator operator=\"GT\"/>\n                        <L7p:RightValue stringValue=\"0\"/>\n                    </L7p:item>\n                </L7p:Predicates>\n            </L7p:ComparisonAssertion>\n            <L7p:SetVariable>\n                <L7p:Base64Expression stringValue=\"MzAw\"/>\n                <L7p:DataType variableDataType=\"int\"/>\n                <L7p:VariableToSet stringValue=\"cacheAge\"/>\n            </L7p:SetVariable>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Ensure ${cacheAge} is set, default=300\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:OneOrMore>\n        <wsp:OneOrMore wsp:Usage=\"Required\">\n            <L7p:ComparisonAssertion>\n                <L7p:AssertionComment assertionComment=\"included\">\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// true or false\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:AssertionComment>\n                <L7p:CaseSensitive booleanValue=\"false\"/>\n                <L7p:Expression1 stringValue=\"${refresh}\"/>\n                <L7p:Operator operatorNull=\"null\"/>\n                <L7p:Predicates predicates=\"included\">\n                    <L7p:item dataType=\"included\">\n                        <L7p:Type variableDataType=\"string\"/>\n                    </L7p:item>\n                    <L7p:item regex=\"included\">\n                        <L7p:Pattern stringValue=\"^(true|false)$\"/>\n                    </L7p:item>\n                </L7p:Predicates>\n            </L7p:ComparisonAssertion>\n            <L7p:SetVariable>\n                <L7p:Base64Expression stringValue=\"ZmFsc2U=\"/>\n                <L7p:VariableToSet stringValue=\"refresh\"/>\n            </L7p:SetVariable>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Ensure ${refresh} is set, default=false\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:OneOrMore>\n        <L7p:SetVariable>\n            <L7p:Base64Expression stringValue=\"YWN0aXZlQ29ubmVjdG9ycy5zb3J0ZWQ=\"/>\n            <L7p:VariableToSet stringValue=\"cacheKey\"/>\n        </L7p:SetVariable>\n        <wsp:OneOrMore wsp:Usage=\"Required\">\n            <wsp:All wsp:Usage=\"Required\">\n                <L7p:ComparisonAssertion>\n                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                    <L7p:Expression1 stringValue=\"${refresh}\"/>\n                    <L7p:Operator operatorNull=\"null\"/>\n                    <L7p:Predicates predicates=\"included\">\n                        <L7p:item dataType=\"included\">\n                            <L7p:Type variableDataType=\"string\"/>\n                        </L7p:item>\n                        <L7p:item binary=\"included\">\n                            <L7p:Negated booleanValue=\"true\"/>\n                            <L7p:RightValue stringValue=\"true\"/>\n                        </L7p:item>\n                    </L7p:Predicates>\n                </L7p:ComparisonAssertion>\n                <L7p:CacheLookup>\n                    <L7p:CacheEntryKey stringValue=\"${cacheKey}\"/>\n                    <L7p:CacheId stringValue=\"activeConnectorList\"/>\n                    <L7p:ContentTypeOverride stringValue=\"\"/>\n                    <L7p:MaxEntryAgeSeconds stringValue=\"${cacheAge}\"/>\n                    <L7p:OtherTargetMessageVariable stringValue=\"activeConnectors.sorted\"/>\n                    <L7p:Target target=\"OTHER\"/>\n                </L7p:CacheLookup>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"Y2FjaGU=\"/>\n                    <L7p:VariableToSet stringValue=\"source\"/>\n                </L7p:SetVariable>\n                <L7p:AuditDetailAssertion>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// FINE\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Detail stringValue=\"==> Found activeConnectors.sorted in the cache\"/>\n                    <L7p:Level stringValue=\"FINE\"/>\n                </L7p:AuditDetailAssertion>\n                <L7p:assertionComment>\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// Look in cache unless asked to refresh cache\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:assertionComment>\n            </wsp:All>\n            <wsp:All wsp:Usage=\"Required\">\n                <L7p:Encapsulated>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// GET activeConnectors\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:EncapsulatedAssertionConfigGuid stringValue=\"c8a5a0d5-1ae2-4144-b538-5c311efc1560\"/>\n                    <L7p:EncapsulatedAssertionConfigName stringValue=\"Utility: Call Restman\"/>\n                    <L7p:Parameters mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"element\"/>\n                            <L7p:value stringValue=\"ActiveConnector\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"message\"/>\n                            <L7p:value stringValue=\"\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"method\"/>\n                            <L7p:value stringValue=\"GET\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"resource\"/>\n                            <L7p:value stringValue=\"activeConnectors\"/>\n                        </L7p:entry>\n                    </L7p:Parameters>\n                </L7p:Encapsulated>\n                <wsp:OneOrMore wsp:Usage=\"Required\">\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:VariablePrefix stringValue=\"activeConnectors\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/l7:List/l7:Item/l7:Resource/l7:ActiveConnector\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <L7p:TrueAssertion/>\n                    <L7p:assertionComment>\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// Extract the list of active connectors, never fail\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:assertionComment>\n                </wsp:OneOrMore>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz48QWN0aXZlQ29ubmVjdG9ycz4=\"/>\n                    <L7p:VariableToSet stringValue=\"activeConnectors.sorted\"/>\n                </L7p:SetVariable>\n                <L7p:ForEachLoop L7p:Usage=\"Required\"\n                    loopVariable=\"activeConnectors.elements\" variablePrefix=\"activeConnector\">\n                    <L7p:SetVariable>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Cast to message type for parsing\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:Base64Expression stringValue=\"JHthY3RpdmVDb25uZWN0b3IuY3VycmVudH0=\"/>\n                        <L7p:ContentType stringValue=\"text/xml; charset=utf-8\"/>\n                        <L7p:DataType variableDataType=\"message\"/>\n                        <L7p:VariableToSet stringValue=\"activeConnector.xml\"/>\n                    </L7p:SetVariable>\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Retrieve the active connector ID\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:VariablePrefix stringValue=\"id\"/>\n                        <L7p:XmlMsgSrc stringValue=\"activeConnector.xml\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/l7:ActiveConnector/@id\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// retrieve the active connector name\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:VariablePrefix stringValue=\"name\"/>\n                        <L7p:XmlMsgSrc stringValue=\"activeConnector.xml\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/l7:ActiveConnector/l7:Name\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// retrieve the active connector type\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:VariablePrefix stringValue=\"type\"/>\n                        <L7p:XmlMsgSrc stringValue=\"activeConnector.xml\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/l7:ActiveConnector/l7:Type\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// retrieve the active connector enabled state\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:VariablePrefix stringValue=\"enabled\"/>\n                        <L7p:XmlMsgSrc stringValue=\"activeConnector.xml\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/l7:ActiveConnector/l7:Enabled\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <L7p:SetVariable>\n                        <L7p:Base64Expression stringValue=\"JHthY3RpdmVDb25uZWN0b3JzLnNvcnRlZH08QWN0aXZlQ29ubmVjdG9yIGlkPSIke2lkLnJlc3VsdH0iPjxOYW1lPjwhW0NEQVRBWyR7bmFtZS5yZXN1bHR9XV0+PC9OYW1lPjxUeXBlPiR7dHlwZS5yZXN1bHR9PC9UeXBlPjxFbmFibGVkPiR7ZW5hYmxlZC5yZXN1bHR9PC9FbmFibGVkPjwvQWN0aXZlQ29ubmVjdG9yPg==\"/>\n                        <L7p:VariableToSet stringValue=\"activeConnectors.sorted\"/>\n                    </L7p:SetVariable>\n                    <L7p:assertionComment>\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// Build the list of active connectors\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:assertionComment>\n                </L7p:ForEachLoop>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"JHthY3RpdmVDb25uZWN0b3JzLnNvcnRlZH08L0FjdGl2ZUNvbm5lY3RvcnM+\"/>\n                    <L7p:ContentType stringValue=\"text/xml; charset=utf-8\"/>\n                    <L7p:DataType variableDataType=\"message\"/>\n                    <L7p:VariableToSet stringValue=\"activeConnectors.sorted\"/>\n                </L7p:SetVariable>\n                <L7p:XslTransformation>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// Sort the active connectors by name\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Direction intValue=\"-1\"/>\n                    <L7p:OtherTargetMessageVariable stringValue=\"activeConnectors.sorted\"/>\n                    <L7p:ResourceInfo staticResourceInfo=\"included\">\n                        <L7p:Document stringValue=\"&lt;xsl:stylesheet version=&quot;1.0&quot; xmlns:l7=&quot;http://ns.l7tech.com/2010/04/gateway-management&quot; xmlns:xsl=&quot;http://www.w3.org/1999/XSL/Transform&quot;>&lt;xsl:template match=&quot;/ActiveConnectors&quot;>    &lt;xsl:copy>        &lt;xsl:for-each select=&quot;ActiveConnector&quot;>            &lt;xsl:sort select=&quot;./Name&quot;/>            &lt;xsl:copy-of select=&quot;.&quot;/>        &lt;/xsl:for-each>    &lt;/xsl:copy>&lt;/xsl:template>&lt;/xsl:stylesheet>\"/>\n                    </L7p:ResourceInfo>\n                    <L7p:Target target=\"OTHER\"/>\n                    <L7p:TransformName stringValue=\"\"/>\n                    <L7p:XsltVersion stringValue=\"1.0\"/>\n                </L7p:XslTransformation>\n                <L7p:CacheStorage>\n                    <L7p:CacheEntryKey stringValue=\"${cacheKey}\"/>\n                    <L7p:CacheId stringValue=\"activeConnectorList\"/>\n                    <L7p:MaxEntries stringValue=\"1\"/>\n                    <L7p:MaxEntryAgeSeconds stringValue=\"${cacheAge}\"/>\n                    <L7p:MaxEntrySizeBytes stringValue=\"200000\"/>\n                    <L7p:OtherTargetMessageVariable stringValue=\"activeConnectors.sorted\"/>\n                    <L7p:StoreSoapFaults booleanValue=\"true\"/>\n                    <L7p:Target target=\"OTHER\"/>\n                </L7p:CacheStorage>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"c3lzdGVt\"/>\n                    <L7p:VariableToSet stringValue=\"source\"/>\n                </L7p:SetVariable>\n                <L7p:AuditDetailAssertion>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// FINE\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Detail stringValue=\"==> Loaded activeConnectors.sorted from system and stored to cache\"/>\n                    <L7p:Level stringValue=\"FINE\"/>\n                </L7p:AuditDetailAssertion>\n                <L7p:assertionComment>\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// Retrieve new list and cache\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:assertionComment>\n            </wsp:All>\n            <wsp:All wsp:Usage=\"Required\">\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"RXJyb3Igd2hlbiBsaXN0aW5nIGFjdGl2ZSBjb25uZWN0b3Jz\"/>\n                    <L7p:VariableToSet stringValue=\"error.msg\"/>\n                </L7p:SetVariable>\n                <L7p:AuditDetailAssertion>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// WARNING\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Detail stringValue=\"==> Error listing active connectors in ${policy.name}\"/>\n                    <L7p:Level stringValue=\"WARNING\"/>\n                </L7p:AuditDetailAssertion>\n                <L7p:FalseAssertion/>\n                <L7p:assertionComment>\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// Failure - set ${error.msg}\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:assertionComment>\n            </wsp:All>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Caching logic\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:OneOrMore>\n        <L7p:Regex>\n            <L7p:AssertionComment assertionComment=\"included\">\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Add source attribute to /ActiveConnectors element\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:AssertionComment>\n            <L7p:AutoTarget booleanValue=\"false\"/>\n            <L7p:OtherTargetMessageVariable stringValue=\"activeConnectors.sorted\"/>\n            <L7p:Regex stringValue=\"&lt;ActiveConnectors>\"/>\n            <L7p:Replace booleanValue=\"true\"/>\n            <L7p:Replacement stringValue=\"&lt;ActiveConnectors source=&quot;${source}&quot;>\"/>\n            <L7p:Target target=\"OTHER\"/>\n        </L7p:Regex>\n        <L7p:AuditDetailAssertion>\n            <L7p:AssertionComment assertionComment=\"included\">\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// FINE\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:AssertionComment>\n            <L7p:Detail stringValue=\"==> Leaving Utility Fragment: ${policy.name}\"/>\n            <L7p:Level stringValue=\"FINE\"/>\n        </L7p:AuditDetailAssertion>\n    </wsp:All>\n</wsp:Policy>\n"
        }
      ]
    },
    {
      "guid": "a84290a6-ecec-41ed-96ea-6e9e68e2ff40",
      "name": "Utility: List Cassandra Connections",
      "policyType": "FRAGMENT",
      "checksum": "4d6070642afad4d450ce53e41b037eb61615fd52",
      "folderPath": "/Gateway Management Utilities/fragments",
      "soap": false,
      "policy": {
        "xml": "<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<wsp:Policy xmlns:L7p=\"http://www.layer7tech.com/ws/policy\" xmlns:wsp=\"http://schemas.xmlsoap.org/ws/2002/12/policy\">\n    <wsp:All wsp:Usage=\"Required\">\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Policy fragment for &quot;Utility: List Cassandra Connections&quot; encapsulated assertion\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Call Restman and generate a sorted list of Cassandra connections\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** - Assumes an admin role user has been authenticated\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** - Caches results for ${cacheAge} seconds (default=300). To refresh the cache set ${refresh}=true when calling\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** - Returns a text/xml message variable in ${cassandraConnections.sorted}\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Inputs:\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - refresh (string)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - cacheAge (string)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Outputs:\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - cassandraConnections.sorted (message)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - error.msg (string)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** v1.0.0 - Jay MacDonald - 20201107 - Initial Version\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n        </L7p:CommentAssertion>\n        <L7p:AuditDetailAssertion>\n            <L7p:AssertionComment assertionComment=\"included\">\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// FINE\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:AssertionComment>\n            <L7p:Detail stringValue=\"==> Entering Utility Fragment: ${policy.name} (refresh=${refresh})\"/>\n            <L7p:Level stringValue=\"FINE\"/>\n        </L7p:AuditDetailAssertion>\n        <wsp:All wsp:Usage=\"Required\">\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** ${cassandraConnections.sorted} has the following schema:\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** \"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** &lt;CassandraConnections source=&quot;system|cache&quot;>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   &lt;CassandraConnection id=&quot;string&quot;>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**     &lt;Name>string&lt;/Name>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**     &lt;KeySpace>string&lt;/KeySpace>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**     &lt;ContactPoint>string&lt;/ContactPoint\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**     &lt;Port>integer&lt;/Port>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**     &lt;Enabled>boolean&lt;/Enabled>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   &lt;/CassandraConnection>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   ...\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** &lt;/CassandraConnections>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** \"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** Where:\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   Name = the name of the cassandra connection\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   KeySpace = the default keyspace the Gateway connects to\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   ContactPoint = the addresses of the nodes to connect to within the Cassandra servers\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   Port = the TCP port being listened to by the Cassandra servers\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   Enabled = true or false\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n            </L7p:CommentAssertion>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Description of ${cassandraConnections.sorted}\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:All>\n        <wsp:OneOrMore wsp:Usage=\"Required\">\n            <L7p:ComparisonAssertion>\n                <L7p:AssertionComment assertionComment=\"included\">\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// true or false\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:AssertionComment>\n                <L7p:CaseSensitive booleanValue=\"false\"/>\n                <L7p:Expression1 stringValue=\"${cacheAge}\"/>\n                <L7p:Operator operatorNull=\"null\"/>\n                <L7p:Predicates predicates=\"included\">\n                    <L7p:item dataType=\"included\">\n                        <L7p:Type variableDataType=\"int\"/>\n                    </L7p:item>\n                    <L7p:item binary=\"included\">\n                        <L7p:CaseSensitive booleanValue=\"false\"/>\n                        <L7p:Operator operator=\"GT\"/>\n                        <L7p:RightValue stringValue=\"0\"/>\n                    </L7p:item>\n                </L7p:Predicates>\n            </L7p:ComparisonAssertion>\n            <L7p:SetVariable>\n                <L7p:Base64Expression stringValue=\"MzAw\"/>\n                <L7p:DataType variableDataType=\"int\"/>\n                <L7p:VariableToSet stringValue=\"cacheAge\"/>\n            </L7p:SetVariable>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Ensure ${cacheAge} is set, default=300\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:OneOrMore>\n        <wsp:OneOrMore wsp:Usage=\"Required\">\n            <L7p:ComparisonAssertion>\n                <L7p:AssertionComment assertionComment=\"included\">\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// true or false\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:AssertionComment>\n                <L7p:CaseSensitive booleanValue=\"false\"/>\n                <L7p:Expression1 stringValue=\"${refresh}\"/>\n                <L7p:Operator operatorNull=\"null\"/>\n                <L7p:Predicates predicates=\"included\">\n                    <L7p:item dataType=\"included\">\n                        <L7p:Type variableDataType=\"string\"/>\n                    </L7p:item>\n                    <L7p:item regex=\"included\">\n                        <L7p:Pattern stringValue=\"^(true|false)$\"/>\n                    </L7p:item>\n                </L7p:Predicates>\n            </L7p:ComparisonAssertion>\n            <L7p:SetVariable>\n                <L7p:Base64Expression stringValue=\"ZmFsc2U=\"/>\n                <L7p:VariableToSet stringValue=\"refresh\"/>\n            </L7p:SetVariable>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Ensure ${refresh} is set, default=false\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:OneOrMore>\n        <L7p:SetVariable>\n            <L7p:Base64Expression stringValue=\"Y2Fzc2FuZHJhQ29ubmVjdGlvbnMuc29ydGVk\"/>\n            <L7p:VariableToSet stringValue=\"cacheKey\"/>\n        </L7p:SetVariable>\n        <wsp:OneOrMore wsp:Usage=\"Required\">\n            <wsp:All wsp:Usage=\"Required\">\n                <L7p:ComparisonAssertion>\n                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                    <L7p:Expression1 stringValue=\"${refresh}\"/>\n                    <L7p:Operator operatorNull=\"null\"/>\n                    <L7p:Predicates predicates=\"included\">\n                        <L7p:item dataType=\"included\">\n                            <L7p:Type variableDataType=\"string\"/>\n                        </L7p:item>\n                        <L7p:item binary=\"included\">\n                            <L7p:Negated booleanValue=\"true\"/>\n                            <L7p:RightValue stringValue=\"true\"/>\n                        </L7p:item>\n                    </L7p:Predicates>\n                </L7p:ComparisonAssertion>\n                <L7p:CacheLookup>\n                    <L7p:CacheEntryKey stringValue=\"${cacheKey}\"/>\n                    <L7p:CacheId stringValue=\"cassandraConnectionList\"/>\n                    <L7p:ContentTypeOverride stringValue=\"\"/>\n                    <L7p:MaxEntryAgeSeconds stringValue=\"${cacheAge}\"/>\n                    <L7p:OtherTargetMessageVariable stringValue=\"cassandraConnections.sorted\"/>\n                    <L7p:Target target=\"OTHER\"/>\n                </L7p:CacheLookup>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"Y2FjaGU=\"/>\n                    <L7p:VariableToSet stringValue=\"source\"/>\n                </L7p:SetVariable>\n                <L7p:AuditDetailAssertion>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// FINE\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Detail stringValue=\"==> Found cassandraConnections.sorted in the cache\"/>\n                    <L7p:Level stringValue=\"FINE\"/>\n                </L7p:AuditDetailAssertion>\n                <L7p:assertionComment>\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// Look in cache unless asked to refresh cache\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:assertionComment>\n            </wsp:All>\n            <wsp:All wsp:Usage=\"Required\">\n                <L7p:Encapsulated>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// GET cassandraConnections\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:EncapsulatedAssertionConfigGuid stringValue=\"c8a5a0d5-1ae2-4144-b538-5c311efc1560\"/>\n                    <L7p:EncapsulatedAssertionConfigName stringValue=\"Utility: Call Restman\"/>\n                    <L7p:Parameters mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"element\"/>\n                            <L7p:value stringValue=\"CassandraConnection\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"message\"/>\n                            <L7p:value stringValue=\"\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"method\"/>\n                            <L7p:value stringValue=\"GET\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"resource\"/>\n                            <L7p:value stringValue=\"cassandraConnections\"/>\n                        </L7p:entry>\n                    </L7p:Parameters>\n                </L7p:Encapsulated>\n                <wsp:OneOrMore wsp:Usage=\"Required\">\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:VariablePrefix stringValue=\"cassandraConnections\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/l7:List/l7:Item/l7:Resource/l7:CassandraConnection\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <L7p:TrueAssertion/>\n                    <L7p:assertionComment>\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// Extract the list of cassandra connections, never fail\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:assertionComment>\n                </wsp:OneOrMore>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz48Q2Fzc2FuZHJhQ29ubmVjdGlvbnM+\"/>\n                    <L7p:VariableToSet stringValue=\"cassandraConnections.sorted\"/>\n                </L7p:SetVariable>\n                <L7p:ForEachLoop L7p:Usage=\"Required\"\n                    loopVariable=\"cassandraConnections.elements\" variablePrefix=\"cassandraConnection\">\n                    <L7p:SetVariable>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Cast to message type for parsing\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:Base64Expression stringValue=\"JHtjYXNzYW5kcmFDb25uZWN0aW9uLmN1cnJlbnR9\"/>\n                        <L7p:ContentType stringValue=\"text/xml; charset=utf-8\"/>\n                        <L7p:DataType variableDataType=\"message\"/>\n                        <L7p:VariableToSet stringValue=\"cassandraConnection.xml\"/>\n                    </L7p:SetVariable>\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Retrieve the cassandra connection ID\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:VariablePrefix stringValue=\"id\"/>\n                        <L7p:XmlMsgSrc stringValue=\"cassandraConnection.xml\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/l7:CassandraConnection/@id\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// retrieve the cassandra connection name\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:VariablePrefix stringValue=\"name\"/>\n                        <L7p:XmlMsgSrc stringValue=\"cassandraConnection.xml\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/l7:CassandraConnection/l7:Name\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Retrieve the cassandra connection keyspace\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:VariablePrefix stringValue=\"keyspace\"/>\n                        <L7p:XmlMsgSrc stringValue=\"cassandraConnection.xml\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/l7:CassandraConnection/l7:Keyspace\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Retrieve the cassandra contact point\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:VariablePrefix stringValue=\"contactPoint\"/>\n                        <L7p:XmlMsgSrc stringValue=\"cassandraConnection.xml\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/l7:CassandraConnection/l7:ContactPoint\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Retrieve the cassandra port\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:VariablePrefix stringValue=\"port\"/>\n                        <L7p:XmlMsgSrc stringValue=\"cassandraConnection.xml\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/l7:CassandraConnection/l7:Port\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Retrieve the cassandra enabled state\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:VariablePrefix stringValue=\"enabled\"/>\n                        <L7p:XmlMsgSrc stringValue=\"cassandraConnection.xml\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/l7:CassandraConnection/l7:Enabled\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <L7p:SetVariable>\n                        <L7p:Base64Expression stringValue=\"JHtjYXNzYW5kcmFDb25uZWN0aW9ucy5zb3J0ZWR9PENhc3NhbmRyYUNvbm5lY3Rpb24gaWQ9IiR7aWQucmVzdWx0fSI+PE5hbWU+PCFbQ0RBVEFbJHtuYW1lLnJlc3VsdH1dXT48L05hbWU+PEtleXNwYWNlPjwhW0NEQVRBWyR7a2V5c3BhY2UucmVzdWx0fV1dPjwvS2V5c3BhY2U+PENvbnRhY3RQb2ludD48IVtDREFUQVske2NvbnRhY3RQb2ludC5yZXN1bHR9XV0+PC9Db250YWN0UG9pbnQ+PFBvcnQ+JHtwb3J0LnJlc3VsdH08L1BvcnQ+PEVuYWJsZWQ+JHtlbmFibGVkLnJlc3VsdH08L0VuYWJsZWQ+PC9DYXNzYW5kcmFDb25uZWN0aW9uPg==\"/>\n                        <L7p:VariableToSet stringValue=\"cassandraConnections.sorted\"/>\n                    </L7p:SetVariable>\n                    <L7p:assertionComment>\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// Build the list of cassandra connections\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:assertionComment>\n                </L7p:ForEachLoop>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"JHtjYXNzYW5kcmFDb25uZWN0aW9ucy5zb3J0ZWR9PC9DYXNzYW5kcmFDb25uZWN0aW9ucz4=\"/>\n                    <L7p:ContentType stringValue=\"text/xml; charset=utf-8\"/>\n                    <L7p:DataType variableDataType=\"message\"/>\n                    <L7p:VariableToSet stringValue=\"cassandraConnections.sorted\"/>\n                </L7p:SetVariable>\n                <L7p:XslTransformation>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// Sort the cassandra connections by name\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Direction intValue=\"-1\"/>\n                    <L7p:OtherTargetMessageVariable stringValue=\"cassandraConnections.sorted\"/>\n                    <L7p:ResourceInfo staticResourceInfo=\"included\">\n                        <L7p:Document stringValue=\"&lt;xsl:stylesheet version=&quot;1.0&quot; xmlns:l7=&quot;http://ns.l7tech.com/2010/04/gateway-management&quot; xmlns:xsl=&quot;http://www.w3.org/1999/XSL/Transform&quot;>&lt;xsl:template match=&quot;/CassandraConnections&quot;>    &lt;xsl:copy>        &lt;xsl:for-each select=&quot;CassandraConnection&quot;>            &lt;xsl:sort select=&quot;./Name&quot;/>            &lt;xsl:copy-of select=&quot;.&quot;/>        &lt;/xsl:for-each>    &lt;/xsl:copy>&lt;/xsl:template>&lt;/xsl:stylesheet>\"/>\n                    </L7p:ResourceInfo>\n                    <L7p:Target target=\"OTHER\"/>\n                    <L7p:TransformName stringValue=\"\"/>\n                    <L7p:XsltVersion stringValue=\"1.0\"/>\n                </L7p:XslTransformation>\n                <L7p:CacheStorage>\n                    <L7p:CacheEntryKey stringValue=\"${cacheKey}\"/>\n                    <L7p:CacheId stringValue=\"cassandraConnectionList\"/>\n                    <L7p:MaxEntries stringValue=\"1\"/>\n                    <L7p:MaxEntryAgeSeconds stringValue=\"${cacheAge}\"/>\n                    <L7p:MaxEntrySizeBytes stringValue=\"200000\"/>\n                    <L7p:OtherTargetMessageVariable stringValue=\"cassandraConnections.sorted\"/>\n                    <L7p:StoreSoapFaults booleanValue=\"true\"/>\n                    <L7p:Target target=\"OTHER\"/>\n                </L7p:CacheStorage>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"c3lzdGVt\"/>\n                    <L7p:VariableToSet stringValue=\"source\"/>\n                </L7p:SetVariable>\n                <L7p:AuditDetailAssertion>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// FINE\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Detail stringValue=\"==> Loaded cassandraConnections.sorted from system and stored to cache\"/>\n                    <L7p:Level stringValue=\"FINE\"/>\n                </L7p:AuditDetailAssertion>\n                <L7p:assertionComment>\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// Retrieve new list and cache\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:assertionComment>\n            </wsp:All>\n            <wsp:All wsp:Usage=\"Required\">\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"RXJyb3Igd2hlbiBsaXN0aW5nIGNhc3NhbmRyYSBjb25uZWN0aW9ucw==\"/>\n                    <L7p:VariableToSet stringValue=\"error.msg\"/>\n                </L7p:SetVariable>\n                <L7p:AuditDetailAssertion>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// WARNING\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Detail stringValue=\"==> Error listing cassandra connections in ${policy.name}\"/>\n                    <L7p:Level stringValue=\"WARNING\"/>\n                </L7p:AuditDetailAssertion>\n                <L7p:FalseAssertion/>\n                <L7p:assertionComment>\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// Failure - set ${error.msg}\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:assertionComment>\n            </wsp:All>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Caching logic\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:OneOrMore>\n        <L7p:Regex>\n            <L7p:AssertionComment assertionComment=\"included\">\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Add source attribute to /CassandraConnections element\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:AssertionComment>\n            <L7p:AutoTarget booleanValue=\"false\"/>\n            <L7p:OtherTargetMessageVariable stringValue=\"cassandraConnections.sorted\"/>\n            <L7p:Regex stringValue=\"&lt;CassandraConnections>\"/>\n            <L7p:Replace booleanValue=\"true\"/>\n            <L7p:Replacement stringValue=\"&lt;CassandraConnections source=&quot;${source}&quot;>\"/>\n            <L7p:Target target=\"OTHER\"/>\n        </L7p:Regex>\n        <L7p:AuditDetailAssertion>\n            <L7p:AssertionComment assertionComment=\"included\">\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// FINE\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:AssertionComment>\n            <L7p:Detail stringValue=\"==> Leaving Utility Fragment: ${policy.name}\"/>\n            <L7p:Level stringValue=\"FINE\"/>\n        </L7p:AuditDetailAssertion>\n    </wsp:All>\n</wsp:Policy>\n"
      },
      "policyRevisions": [
        {
          "goid": "bed4baf4ff33b7e528854c3965d9bb20",
          "ordinal": 1,
          "active": true,
          "author": "admin",
          "time": "2025-02-05T14:20:38.43Z",
          "xml": "<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<wsp:Policy xmlns:L7p=\"http://www.layer7tech.com/ws/policy\" xmlns:wsp=\"http://schemas.xmlsoap.org/ws/2002/12/policy\">\n    <wsp:All wsp:Usage=\"Required\">\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Policy fragment for &quot;Utility: List Cassandra Connections&quot; encapsulated assertion\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Call Restman and generate a sorted list of Cassandra connections\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** - Assumes an admin role user has been authenticated\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** - Caches results for ${cacheAge} seconds (default=300). To refresh the cache set ${refresh}=true when calling\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** - Returns a text/xml message variable in ${cassandraConnections.sorted}\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Inputs:\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - refresh (string)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - cacheAge (string)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Outputs:\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - cassandraConnections.sorted (message)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - error.msg (string)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** v1.0.0 - Jay MacDonald - 20201107 - Initial Version\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n        </L7p:CommentAssertion>\n        <L7p:AuditDetailAssertion>\n            <L7p:AssertionComment assertionComment=\"included\">\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// FINE\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:AssertionComment>\n            <L7p:Detail stringValue=\"==> Entering Utility Fragment: ${policy.name} (refresh=${refresh})\"/>\n            <L7p:Level stringValue=\"FINE\"/>\n        </L7p:AuditDetailAssertion>\n        <wsp:All wsp:Usage=\"Required\">\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** ${cassandraConnections.sorted} has the following schema:\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** \"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** &lt;CassandraConnections source=&quot;system|cache&quot;>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   &lt;CassandraConnection id=&quot;string&quot;>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**     &lt;Name>string&lt;/Name>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**     &lt;KeySpace>string&lt;/KeySpace>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**     &lt;ContactPoint>string&lt;/ContactPoint\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**     &lt;Port>integer&lt;/Port>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**     &lt;Enabled>boolean&lt;/Enabled>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   &lt;/CassandraConnection>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   ...\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** &lt;/CassandraConnections>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** \"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** Where:\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   Name = the name of the cassandra connection\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   KeySpace = the default keyspace the Gateway connects to\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   ContactPoint = the addresses of the nodes to connect to within the Cassandra servers\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   Port = the TCP port being listened to by the Cassandra servers\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   Enabled = true or false\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n            </L7p:CommentAssertion>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Description of ${cassandraConnections.sorted}\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:All>\n        <wsp:OneOrMore wsp:Usage=\"Required\">\n            <L7p:ComparisonAssertion>\n                <L7p:AssertionComment assertionComment=\"included\">\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// true or false\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:AssertionComment>\n                <L7p:CaseSensitive booleanValue=\"false\"/>\n                <L7p:Expression1 stringValue=\"${cacheAge}\"/>\n                <L7p:Operator operatorNull=\"null\"/>\n                <L7p:Predicates predicates=\"included\">\n                    <L7p:item dataType=\"included\">\n                        <L7p:Type variableDataType=\"int\"/>\n                    </L7p:item>\n                    <L7p:item binary=\"included\">\n                        <L7p:CaseSensitive booleanValue=\"false\"/>\n                        <L7p:Operator operator=\"GT\"/>\n                        <L7p:RightValue stringValue=\"0\"/>\n                    </L7p:item>\n                </L7p:Predicates>\n            </L7p:ComparisonAssertion>\n            <L7p:SetVariable>\n                <L7p:Base64Expression stringValue=\"MzAw\"/>\n                <L7p:DataType variableDataType=\"int\"/>\n                <L7p:VariableToSet stringValue=\"cacheAge\"/>\n            </L7p:SetVariable>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Ensure ${cacheAge} is set, default=300\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:OneOrMore>\n        <wsp:OneOrMore wsp:Usage=\"Required\">\n            <L7p:ComparisonAssertion>\n                <L7p:AssertionComment assertionComment=\"included\">\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// true or false\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:AssertionComment>\n                <L7p:CaseSensitive booleanValue=\"false\"/>\n                <L7p:Expression1 stringValue=\"${refresh}\"/>\n                <L7p:Operator operatorNull=\"null\"/>\n                <L7p:Predicates predicates=\"included\">\n                    <L7p:item dataType=\"included\">\n                        <L7p:Type variableDataType=\"string\"/>\n                    </L7p:item>\n                    <L7p:item regex=\"included\">\n                        <L7p:Pattern stringValue=\"^(true|false)$\"/>\n                    </L7p:item>\n                </L7p:Predicates>\n            </L7p:ComparisonAssertion>\n            <L7p:SetVariable>\n                <L7p:Base64Expression stringValue=\"ZmFsc2U=\"/>\n                <L7p:VariableToSet stringValue=\"refresh\"/>\n            </L7p:SetVariable>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Ensure ${refresh} is set, default=false\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:OneOrMore>\n        <L7p:SetVariable>\n            <L7p:Base64Expression stringValue=\"Y2Fzc2FuZHJhQ29ubmVjdGlvbnMuc29ydGVk\"/>\n            <L7p:VariableToSet stringValue=\"cacheKey\"/>\n        </L7p:SetVariable>\n        <wsp:OneOrMore wsp:Usage=\"Required\">\n            <wsp:All wsp:Usage=\"Required\">\n                <L7p:ComparisonAssertion>\n                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                    <L7p:Expression1 stringValue=\"${refresh}\"/>\n                    <L7p:Operator operatorNull=\"null\"/>\n                    <L7p:Predicates predicates=\"included\">\n                        <L7p:item dataType=\"included\">\n                            <L7p:Type variableDataType=\"string\"/>\n                        </L7p:item>\n                        <L7p:item binary=\"included\">\n                            <L7p:Negated booleanValue=\"true\"/>\n                            <L7p:RightValue stringValue=\"true\"/>\n                        </L7p:item>\n                    </L7p:Predicates>\n                </L7p:ComparisonAssertion>\n                <L7p:CacheLookup>\n                    <L7p:CacheEntryKey stringValue=\"${cacheKey}\"/>\n                    <L7p:CacheId stringValue=\"cassandraConnectionList\"/>\n                    <L7p:ContentTypeOverride stringValue=\"\"/>\n                    <L7p:MaxEntryAgeSeconds stringValue=\"${cacheAge}\"/>\n                    <L7p:OtherTargetMessageVariable stringValue=\"cassandraConnections.sorted\"/>\n                    <L7p:Target target=\"OTHER\"/>\n                </L7p:CacheLookup>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"Y2FjaGU=\"/>\n                    <L7p:VariableToSet stringValue=\"source\"/>\n                </L7p:SetVariable>\n                <L7p:AuditDetailAssertion>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// FINE\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Detail stringValue=\"==> Found cassandraConnections.sorted in the cache\"/>\n                    <L7p:Level stringValue=\"FINE\"/>\n                </L7p:AuditDetailAssertion>\n                <L7p:assertionComment>\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// Look in cache unless asked to refresh cache\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:assertionComment>\n            </wsp:All>\n            <wsp:All wsp:Usage=\"Required\">\n                <L7p:Encapsulated>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// GET cassandraConnections\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:EncapsulatedAssertionConfigGuid stringValue=\"c8a5a0d5-1ae2-4144-b538-5c311efc1560\"/>\n                    <L7p:EncapsulatedAssertionConfigName stringValue=\"Utility: Call Restman\"/>\n                    <L7p:Parameters mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"element\"/>\n                            <L7p:value stringValue=\"CassandraConnection\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"message\"/>\n                            <L7p:value stringValue=\"\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"method\"/>\n                            <L7p:value stringValue=\"GET\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"resource\"/>\n                            <L7p:value stringValue=\"cassandraConnections\"/>\n                        </L7p:entry>\n                    </L7p:Parameters>\n                </L7p:Encapsulated>\n                <wsp:OneOrMore wsp:Usage=\"Required\">\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:VariablePrefix stringValue=\"cassandraConnections\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/l7:List/l7:Item/l7:Resource/l7:CassandraConnection\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <L7p:TrueAssertion/>\n                    <L7p:assertionComment>\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// Extract the list of cassandra connections, never fail\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:assertionComment>\n                </wsp:OneOrMore>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz48Q2Fzc2FuZHJhQ29ubmVjdGlvbnM+\"/>\n                    <L7p:VariableToSet stringValue=\"cassandraConnections.sorted\"/>\n                </L7p:SetVariable>\n                <L7p:ForEachLoop L7p:Usage=\"Required\"\n                    loopVariable=\"cassandraConnections.elements\" variablePrefix=\"cassandraConnection\">\n                    <L7p:SetVariable>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Cast to message type for parsing\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:Base64Expression stringValue=\"JHtjYXNzYW5kcmFDb25uZWN0aW9uLmN1cnJlbnR9\"/>\n                        <L7p:ContentType stringValue=\"text/xml; charset=utf-8\"/>\n                        <L7p:DataType variableDataType=\"message\"/>\n                        <L7p:VariableToSet stringValue=\"cassandraConnection.xml\"/>\n                    </L7p:SetVariable>\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Retrieve the cassandra connection ID\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:VariablePrefix stringValue=\"id\"/>\n                        <L7p:XmlMsgSrc stringValue=\"cassandraConnection.xml\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/l7:CassandraConnection/@id\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// retrieve the cassandra connection name\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:VariablePrefix stringValue=\"name\"/>\n                        <L7p:XmlMsgSrc stringValue=\"cassandraConnection.xml\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/l7:CassandraConnection/l7:Name\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Retrieve the cassandra connection keyspace\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:VariablePrefix stringValue=\"keyspace\"/>\n                        <L7p:XmlMsgSrc stringValue=\"cassandraConnection.xml\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/l7:CassandraConnection/l7:Keyspace\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Retrieve the cassandra contact point\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:VariablePrefix stringValue=\"contactPoint\"/>\n                        <L7p:XmlMsgSrc stringValue=\"cassandraConnection.xml\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/l7:CassandraConnection/l7:ContactPoint\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Retrieve the cassandra port\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:VariablePrefix stringValue=\"port\"/>\n                        <L7p:XmlMsgSrc stringValue=\"cassandraConnection.xml\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/l7:CassandraConnection/l7:Port\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Retrieve the cassandra enabled state\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:VariablePrefix stringValue=\"enabled\"/>\n                        <L7p:XmlMsgSrc stringValue=\"cassandraConnection.xml\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/l7:CassandraConnection/l7:Enabled\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <L7p:SetVariable>\n                        <L7p:Base64Expression stringValue=\"JHtjYXNzYW5kcmFDb25uZWN0aW9ucy5zb3J0ZWR9PENhc3NhbmRyYUNvbm5lY3Rpb24gaWQ9IiR7aWQucmVzdWx0fSI+PE5hbWU+PCFbQ0RBVEFbJHtuYW1lLnJlc3VsdH1dXT48L05hbWU+PEtleXNwYWNlPjwhW0NEQVRBWyR7a2V5c3BhY2UucmVzdWx0fV1dPjwvS2V5c3BhY2U+PENvbnRhY3RQb2ludD48IVtDREFUQVske2NvbnRhY3RQb2ludC5yZXN1bHR9XV0+PC9Db250YWN0UG9pbnQ+PFBvcnQ+JHtwb3J0LnJlc3VsdH08L1BvcnQ+PEVuYWJsZWQ+JHtlbmFibGVkLnJlc3VsdH08L0VuYWJsZWQ+PC9DYXNzYW5kcmFDb25uZWN0aW9uPg==\"/>\n                        <L7p:VariableToSet stringValue=\"cassandraConnections.sorted\"/>\n                    </L7p:SetVariable>\n                    <L7p:assertionComment>\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// Build the list of cassandra connections\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:assertionComment>\n                </L7p:ForEachLoop>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"JHtjYXNzYW5kcmFDb25uZWN0aW9ucy5zb3J0ZWR9PC9DYXNzYW5kcmFDb25uZWN0aW9ucz4=\"/>\n                    <L7p:ContentType stringValue=\"text/xml; charset=utf-8\"/>\n                    <L7p:DataType variableDataType=\"message\"/>\n                    <L7p:VariableToSet stringValue=\"cassandraConnections.sorted\"/>\n                </L7p:SetVariable>\n                <L7p:XslTransformation>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// Sort the cassandra connections by name\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Direction intValue=\"-1\"/>\n                    <L7p:OtherTargetMessageVariable stringValue=\"cassandraConnections.sorted\"/>\n                    <L7p:ResourceInfo staticResourceInfo=\"included\">\n                        <L7p:Document stringValue=\"&lt;xsl:stylesheet version=&quot;1.0&quot; xmlns:l7=&quot;http://ns.l7tech.com/2010/04/gateway-management&quot; xmlns:xsl=&quot;http://www.w3.org/1999/XSL/Transform&quot;>&lt;xsl:template match=&quot;/CassandraConnections&quot;>    &lt;xsl:copy>        &lt;xsl:for-each select=&quot;CassandraConnection&quot;>            &lt;xsl:sort select=&quot;./Name&quot;/>            &lt;xsl:copy-of select=&quot;.&quot;/>        &lt;/xsl:for-each>    &lt;/xsl:copy>&lt;/xsl:template>&lt;/xsl:stylesheet>\"/>\n                    </L7p:ResourceInfo>\n                    <L7p:Target target=\"OTHER\"/>\n                    <L7p:TransformName stringValue=\"\"/>\n                    <L7p:XsltVersion stringValue=\"1.0\"/>\n                </L7p:XslTransformation>\n                <L7p:CacheStorage>\n                    <L7p:CacheEntryKey stringValue=\"${cacheKey}\"/>\n                    <L7p:CacheId stringValue=\"cassandraConnectionList\"/>\n                    <L7p:MaxEntries stringValue=\"1\"/>\n                    <L7p:MaxEntryAgeSeconds stringValue=\"${cacheAge}\"/>\n                    <L7p:MaxEntrySizeBytes stringValue=\"200000\"/>\n                    <L7p:OtherTargetMessageVariable stringValue=\"cassandraConnections.sorted\"/>\n                    <L7p:StoreSoapFaults booleanValue=\"true\"/>\n                    <L7p:Target target=\"OTHER\"/>\n                </L7p:CacheStorage>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"c3lzdGVt\"/>\n                    <L7p:VariableToSet stringValue=\"source\"/>\n                </L7p:SetVariable>\n                <L7p:AuditDetailAssertion>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// FINE\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Detail stringValue=\"==> Loaded cassandraConnections.sorted from system and stored to cache\"/>\n                    <L7p:Level stringValue=\"FINE\"/>\n                </L7p:AuditDetailAssertion>\n                <L7p:assertionComment>\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// Retrieve new list and cache\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:assertionComment>\n            </wsp:All>\n            <wsp:All wsp:Usage=\"Required\">\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"RXJyb3Igd2hlbiBsaXN0aW5nIGNhc3NhbmRyYSBjb25uZWN0aW9ucw==\"/>\n                    <L7p:VariableToSet stringValue=\"error.msg\"/>\n                </L7p:SetVariable>\n                <L7p:AuditDetailAssertion>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// WARNING\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Detail stringValue=\"==> Error listing cassandra connections in ${policy.name}\"/>\n                    <L7p:Level stringValue=\"WARNING\"/>\n                </L7p:AuditDetailAssertion>\n                <L7p:FalseAssertion/>\n                <L7p:assertionComment>\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// Failure - set ${error.msg}\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:assertionComment>\n            </wsp:All>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Caching logic\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:OneOrMore>\n        <L7p:Regex>\n            <L7p:AssertionComment assertionComment=\"included\">\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Add source attribute to /CassandraConnections element\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:AssertionComment>\n            <L7p:AutoTarget booleanValue=\"false\"/>\n            <L7p:OtherTargetMessageVariable stringValue=\"cassandraConnections.sorted\"/>\n            <L7p:Regex stringValue=\"&lt;CassandraConnections>\"/>\n            <L7p:Replace booleanValue=\"true\"/>\n            <L7p:Replacement stringValue=\"&lt;CassandraConnections source=&quot;${source}&quot;>\"/>\n            <L7p:Target target=\"OTHER\"/>\n        </L7p:Regex>\n        <L7p:AuditDetailAssertion>\n            <L7p:AssertionComment assertionComment=\"included\">\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// FINE\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:AssertionComment>\n            <L7p:Detail stringValue=\"==> Leaving Utility Fragment: ${policy.name}\"/>\n            <L7p:Level stringValue=\"FINE\"/>\n        </L7p:AuditDetailAssertion>\n    </wsp:All>\n</wsp:Policy>\n"
        }
      ]
    },
    {
      "guid": "5d651487-691b-4060-8de1-b91c798cdd58",
      "name": "Utility: List Cluster Properties",
      "policyType": "FRAGMENT",
      "checksum": "7f285e12563c9274fd1a092097df25afb7332bee",
      "folderPath": "/Gateway Management Utilities/fragments",
      "soap": false,
      "policy": {
        "xml": "<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<wsp:Policy xmlns:L7p=\"http://www.layer7tech.com/ws/policy\" xmlns:wsp=\"http://schemas.xmlsoap.org/ws/2002/12/policy\">\n    <wsp:All wsp:Usage=\"Required\">\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Policy fragment for &quot;Utility: List Cluster Properties&quot; encapsulated assertion\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Call Restman and generate a sorted list of cluster properties\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** - Assumes an admin role user has been authenticated\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** - Caches results for ${cacheAge} seconds (default=300). To refresh the cache set ${refresh}=true when calling\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** - Returns a text/xml message variable in ${clusterProperties.sorted}\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Inputs:\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - refresh (string)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - cacheAge (string)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Outputs:\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - clusterProperties.sorted (message)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - error.msg (string)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** v1.0.0 - Jay MacDonald - 20201107 - Initial Version\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n        </L7p:CommentAssertion>\n        <L7p:AuditDetailAssertion>\n            <L7p:AssertionComment assertionComment=\"included\">\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// FINE\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:AssertionComment>\n            <L7p:Detail stringValue=\"==> Entering Utility Fragment: ${policy.name} (refresh=${refresh})\"/>\n            <L7p:Level stringValue=\"FINE\"/>\n        </L7p:AuditDetailAssertion>\n        <wsp:All wsp:Usage=\"Required\">\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** ${clusterProperties.sorted} has the following schema:\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** \"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** &lt;ClusterProperties source=&quot;system|cache&quot;>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   &lt;ClusterProperty id=&quot;string&quot;>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**     &lt;Name>string&lt;/Name>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**     &lt;Value>string&lt;/Value>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   &lt;/ClusterProperty>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   ...\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** &lt;/ClusterProperties>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** \"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** Where:\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   Name = the name of the cluster property\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   Value = the value of the cluster property\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n            </L7p:CommentAssertion>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Description of ${clusterProperties.sorted}\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:All>\n        <wsp:OneOrMore wsp:Usage=\"Required\">\n            <L7p:ComparisonAssertion>\n                <L7p:AssertionComment assertionComment=\"included\">\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// true or false\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:AssertionComment>\n                <L7p:CaseSensitive booleanValue=\"false\"/>\n                <L7p:Expression1 stringValue=\"${cacheAge}\"/>\n                <L7p:Operator operatorNull=\"null\"/>\n                <L7p:Predicates predicates=\"included\">\n                    <L7p:item dataType=\"included\">\n                        <L7p:Type variableDataType=\"int\"/>\n                    </L7p:item>\n                    <L7p:item binary=\"included\">\n                        <L7p:CaseSensitive booleanValue=\"false\"/>\n                        <L7p:Operator operator=\"GT\"/>\n                        <L7p:RightValue stringValue=\"0\"/>\n                    </L7p:item>\n                </L7p:Predicates>\n            </L7p:ComparisonAssertion>\n            <L7p:SetVariable>\n                <L7p:Base64Expression stringValue=\"MzAw\"/>\n                <L7p:DataType variableDataType=\"int\"/>\n                <L7p:VariableToSet stringValue=\"cacheAge\"/>\n            </L7p:SetVariable>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Ensure ${cacheAge} is set, default=300\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:OneOrMore>\n        <wsp:OneOrMore wsp:Usage=\"Required\">\n            <L7p:ComparisonAssertion>\n                <L7p:AssertionComment assertionComment=\"included\">\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// true or false\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:AssertionComment>\n                <L7p:CaseSensitive booleanValue=\"false\"/>\n                <L7p:Expression1 stringValue=\"${refresh}\"/>\n                <L7p:Operator operatorNull=\"null\"/>\n                <L7p:Predicates predicates=\"included\">\n                    <L7p:item dataType=\"included\">\n                        <L7p:Type variableDataType=\"string\"/>\n                    </L7p:item>\n                    <L7p:item regex=\"included\">\n                        <L7p:Pattern stringValue=\"^(true|false)$\"/>\n                    </L7p:item>\n                </L7p:Predicates>\n            </L7p:ComparisonAssertion>\n            <L7p:SetVariable>\n                <L7p:Base64Expression stringValue=\"ZmFsc2U=\"/>\n                <L7p:VariableToSet stringValue=\"refresh\"/>\n            </L7p:SetVariable>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Ensure ${refresh} is set, default=false\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:OneOrMore>\n        <L7p:SetVariable>\n            <L7p:Base64Expression stringValue=\"Y2x1c3RlclByb3BlcnRpZXMuc29ydGVk\"/>\n            <L7p:VariableToSet stringValue=\"cacheKey\"/>\n        </L7p:SetVariable>\n        <wsp:OneOrMore wsp:Usage=\"Required\">\n            <wsp:All wsp:Usage=\"Required\">\n                <L7p:ComparisonAssertion>\n                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                    <L7p:Expression1 stringValue=\"${refresh}\"/>\n                    <L7p:Operator operatorNull=\"null\"/>\n                    <L7p:Predicates predicates=\"included\">\n                        <L7p:item dataType=\"included\">\n                            <L7p:Type variableDataType=\"string\"/>\n                        </L7p:item>\n                        <L7p:item binary=\"included\">\n                            <L7p:Negated booleanValue=\"true\"/>\n                            <L7p:RightValue stringValue=\"true\"/>\n                        </L7p:item>\n                    </L7p:Predicates>\n                </L7p:ComparisonAssertion>\n                <L7p:CacheLookup>\n                    <L7p:CacheEntryKey stringValue=\"${cacheKey}\"/>\n                    <L7p:CacheId stringValue=\"clusterPropertyList\"/>\n                    <L7p:ContentTypeOverride stringValue=\"\"/>\n                    <L7p:MaxEntryAgeSeconds stringValue=\"${cacheAge}\"/>\n                    <L7p:OtherTargetMessageVariable stringValue=\"clusterProperties.sorted\"/>\n                    <L7p:Target target=\"OTHER\"/>\n                </L7p:CacheLookup>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"Y2FjaGU=\"/>\n                    <L7p:VariableToSet stringValue=\"source\"/>\n                </L7p:SetVariable>\n                <L7p:AuditDetailAssertion>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// FINE\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Detail stringValue=\"==> Found clusterProperties.sorted in the cache\"/>\n                    <L7p:Level stringValue=\"FINE\"/>\n                </L7p:AuditDetailAssertion>\n                <L7p:assertionComment>\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// Look in cache unless asked to refresh cache\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:assertionComment>\n            </wsp:All>\n            <wsp:All wsp:Usage=\"Required\">\n                <L7p:Encapsulated>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// GET clusterProperties\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:EncapsulatedAssertionConfigGuid stringValue=\"c8a5a0d5-1ae2-4144-b538-5c311efc1560\"/>\n                    <L7p:EncapsulatedAssertionConfigName stringValue=\"Utility: Call Restman\"/>\n                    <L7p:Parameters mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"element\"/>\n                            <L7p:value stringValue=\"ClusterProperty\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"message\"/>\n                            <L7p:value stringValue=\"\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"method\"/>\n                            <L7p:value stringValue=\"GET\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"resource\"/>\n                            <L7p:value stringValue=\"clusterProperties\"/>\n                        </L7p:entry>\n                    </L7p:Parameters>\n                </L7p:Encapsulated>\n                <wsp:OneOrMore wsp:Usage=\"Required\">\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:VariablePrefix stringValue=\"clusterProperties\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/l7:List/l7:Item/l7:Resource/l7:ClusterProperty\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <L7p:TrueAssertion/>\n                    <L7p:assertionComment>\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// Extract the list of cluster properties, never fail\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:assertionComment>\n                </wsp:OneOrMore>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz48Q2x1c3RlclByb3BlcnRpZXM+\"/>\n                    <L7p:VariableToSet stringValue=\"clusterProperties.sorted\"/>\n                </L7p:SetVariable>\n                <L7p:ForEachLoop L7p:Usage=\"Required\"\n                    loopVariable=\"clusterProperties.elements\" variablePrefix=\"clusterProperty\">\n                    <L7p:SetVariable>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Cast to message type for parsing\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:Base64Expression stringValue=\"JHtjbHVzdGVyUHJvcGVydHkuY3VycmVudH0=\"/>\n                        <L7p:ContentType stringValue=\"text/xml; charset=utf-8\"/>\n                        <L7p:DataType variableDataType=\"message\"/>\n                        <L7p:VariableToSet stringValue=\"clusterProperty.xml\"/>\n                    </L7p:SetVariable>\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Retrieve the cluster property ID\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:VariablePrefix stringValue=\"id\"/>\n                        <L7p:XmlMsgSrc stringValue=\"clusterProperty.xml\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/l7:ClusterProperty/@id\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// retrieve the cluster property name\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:VariablePrefix stringValue=\"name\"/>\n                        <L7p:XmlMsgSrc stringValue=\"clusterProperty.xml\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/l7:ClusterProperty/l7:Name\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Retrieve the cluster property value\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:VariablePrefix stringValue=\"value\"/>\n                        <L7p:XmlMsgSrc stringValue=\"clusterProperty.xml\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/l7:ClusterProperty/l7:Value\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <L7p:SetVariable>\n                        <L7p:Base64Expression stringValue=\"JHtjbHVzdGVyUHJvcGVydGllcy5zb3J0ZWR9PENsdXN0ZXJQcm9wZXJ0eSBpZD0iJHtpZC5yZXN1bHR9Ij48TmFtZT48IVtDREFUQVske25hbWUucmVzdWx0fV1dPjwvTmFtZT48VmFsdWU+PCFbQ0RBVEFbJHt2YWx1ZS5yZXN1bHR9XV0+PC9WYWx1ZT48L0NsdXN0ZXJQcm9wZXJ0eT4=\"/>\n                        <L7p:VariableToSet stringValue=\"clusterProperties.sorted\"/>\n                    </L7p:SetVariable>\n                    <L7p:assertionComment>\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// Build the list of cluster properties\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:assertionComment>\n                </L7p:ForEachLoop>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"JHtjbHVzdGVyUHJvcGVydGllcy5zb3J0ZWR9PC9DbHVzdGVyUHJvcGVydGllcz4=\"/>\n                    <L7p:ContentType stringValue=\"text/xml; charset=utf-8\"/>\n                    <L7p:DataType variableDataType=\"message\"/>\n                    <L7p:VariableToSet stringValue=\"clusterProperties.sorted\"/>\n                </L7p:SetVariable>\n                <L7p:XslTransformation>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// Sort the cluster properties by name\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Direction intValue=\"-1\"/>\n                    <L7p:OtherTargetMessageVariable stringValue=\"clusterProperties.sorted\"/>\n                    <L7p:ResourceInfo staticResourceInfo=\"included\">\n                        <L7p:Document stringValue=\"&lt;xsl:stylesheet version=&quot;1.0&quot; xmlns:l7=&quot;http://ns.l7tech.com/2010/04/gateway-management&quot; xmlns:xsl=&quot;http://www.w3.org/1999/XSL/Transform&quot;>&lt;xsl:template match=&quot;/ClusterProperties&quot;>    &lt;xsl:copy>        &lt;xsl:for-each select=&quot;ClusterProperty&quot;>            &lt;xsl:sort select=&quot;./Name&quot;/>            &lt;xsl:copy-of select=&quot;.&quot;/>        &lt;/xsl:for-each>    &lt;/xsl:copy>&lt;/xsl:template>&lt;/xsl:stylesheet>\"/>\n                    </L7p:ResourceInfo>\n                    <L7p:Target target=\"OTHER\"/>\n                    <L7p:TransformName stringValue=\"\"/>\n                    <L7p:XsltVersion stringValue=\"1.0\"/>\n                </L7p:XslTransformation>\n                <L7p:CacheStorage>\n                    <L7p:CacheEntryKey stringValue=\"${cacheKey}\"/>\n                    <L7p:CacheId stringValue=\"clusterPropertyList\"/>\n                    <L7p:MaxEntries stringValue=\"1\"/>\n                    <L7p:MaxEntryAgeSeconds stringValue=\"${cacheAge}\"/>\n                    <L7p:MaxEntrySizeBytes stringValue=\"200000\"/>\n                    <L7p:OtherTargetMessageVariable stringValue=\"clusterProperties.sorted\"/>\n                    <L7p:StoreSoapFaults booleanValue=\"true\"/>\n                    <L7p:Target target=\"OTHER\"/>\n                </L7p:CacheStorage>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"c3lzdGVt\"/>\n                    <L7p:VariableToSet stringValue=\"source\"/>\n                </L7p:SetVariable>\n                <L7p:AuditDetailAssertion>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// FINE\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Detail stringValue=\"==> Loaded clusterProperties.sorted from system and stored to cache\"/>\n                    <L7p:Level stringValue=\"FINE\"/>\n                </L7p:AuditDetailAssertion>\n                <L7p:assertionComment>\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// Retrieve new list and cache\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:assertionComment>\n            </wsp:All>\n            <wsp:All wsp:Usage=\"Required\">\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"RXJyb3Igd2hlbiBsaXN0aW5nIGNsdXN0ZXIgcHJvcGVydGllcw==\"/>\n                    <L7p:VariableToSet stringValue=\"error.msg\"/>\n                </L7p:SetVariable>\n                <L7p:AuditDetailAssertion>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// WARNING\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Detail stringValue=\"==> Error listing cluster properties in ${policy.name}\"/>\n                    <L7p:Level stringValue=\"WARNING\"/>\n                </L7p:AuditDetailAssertion>\n                <L7p:FalseAssertion/>\n                <L7p:assertionComment>\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// Failure - set ${error.msg}\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:assertionComment>\n            </wsp:All>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Caching logic\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:OneOrMore>\n        <L7p:Regex>\n            <L7p:AssertionComment assertionComment=\"included\">\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Add source attribute to /ClusterProperties element\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:AssertionComment>\n            <L7p:AutoTarget booleanValue=\"false\"/>\n            <L7p:OtherTargetMessageVariable stringValue=\"clusterProperties.sorted\"/>\n            <L7p:Regex stringValue=\"&lt;ClusterProperties>\"/>\n            <L7p:Replace booleanValue=\"true\"/>\n            <L7p:Replacement stringValue=\"&lt;ClusterProperties source=&quot;${source}&quot;>\"/>\n            <L7p:Target target=\"OTHER\"/>\n        </L7p:Regex>\n        <L7p:AuditDetailAssertion>\n            <L7p:AssertionComment assertionComment=\"included\">\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// FINE\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:AssertionComment>\n            <L7p:Detail stringValue=\"==> Leaving Utility Fragment: ${policy.name}\"/>\n            <L7p:Level stringValue=\"FINE\"/>\n        </L7p:AuditDetailAssertion>\n    </wsp:All>\n</wsp:Policy>\n"
      },
      "policyRevisions": [
        {
          "goid": "bed4baf4ff33b7e528854c3965d9bb24",
          "ordinal": 1,
          "active": true,
          "author": "admin",
          "time": "2025-02-05T14:20:38.44Z",
          "xml": "<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<wsp:Policy xmlns:L7p=\"http://www.layer7tech.com/ws/policy\" xmlns:wsp=\"http://schemas.xmlsoap.org/ws/2002/12/policy\">\n    <wsp:All wsp:Usage=\"Required\">\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Policy fragment for &quot;Utility: List Cluster Properties&quot; encapsulated assertion\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Call Restman and generate a sorted list of cluster properties\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** - Assumes an admin role user has been authenticated\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** - Caches results for ${cacheAge} seconds (default=300). To refresh the cache set ${refresh}=true when calling\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** - Returns a text/xml message variable in ${clusterProperties.sorted}\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Inputs:\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - refresh (string)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - cacheAge (string)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Outputs:\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - clusterProperties.sorted (message)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - error.msg (string)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** v1.0.0 - Jay MacDonald - 20201107 - Initial Version\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n        </L7p:CommentAssertion>\n        <L7p:AuditDetailAssertion>\n            <L7p:AssertionComment assertionComment=\"included\">\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// FINE\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:AssertionComment>\n            <L7p:Detail stringValue=\"==> Entering Utility Fragment: ${policy.name} (refresh=${refresh})\"/>\n            <L7p:Level stringValue=\"FINE\"/>\n        </L7p:AuditDetailAssertion>\n        <wsp:All wsp:Usage=\"Required\">\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** ${clusterProperties.sorted} has the following schema:\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** \"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** &lt;ClusterProperties source=&quot;system|cache&quot;>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   &lt;ClusterProperty id=&quot;string&quot;>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**     &lt;Name>string&lt;/Name>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**     &lt;Value>string&lt;/Value>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   &lt;/ClusterProperty>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   ...\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** &lt;/ClusterProperties>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** \"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** Where:\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   Name = the name of the cluster property\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   Value = the value of the cluster property\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n            </L7p:CommentAssertion>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Description of ${clusterProperties.sorted}\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:All>\n        <wsp:OneOrMore wsp:Usage=\"Required\">\n            <L7p:ComparisonAssertion>\n                <L7p:AssertionComment assertionComment=\"included\">\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// true or false\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:AssertionComment>\n                <L7p:CaseSensitive booleanValue=\"false\"/>\n                <L7p:Expression1 stringValue=\"${cacheAge}\"/>\n                <L7p:Operator operatorNull=\"null\"/>\n                <L7p:Predicates predicates=\"included\">\n                    <L7p:item dataType=\"included\">\n                        <L7p:Type variableDataType=\"int\"/>\n                    </L7p:item>\n                    <L7p:item binary=\"included\">\n                        <L7p:CaseSensitive booleanValue=\"false\"/>\n                        <L7p:Operator operator=\"GT\"/>\n                        <L7p:RightValue stringValue=\"0\"/>\n                    </L7p:item>\n                </L7p:Predicates>\n            </L7p:ComparisonAssertion>\n            <L7p:SetVariable>\n                <L7p:Base64Expression stringValue=\"MzAw\"/>\n                <L7p:DataType variableDataType=\"int\"/>\n                <L7p:VariableToSet stringValue=\"cacheAge\"/>\n            </L7p:SetVariable>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Ensure ${cacheAge} is set, default=300\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:OneOrMore>\n        <wsp:OneOrMore wsp:Usage=\"Required\">\n            <L7p:ComparisonAssertion>\n                <L7p:AssertionComment assertionComment=\"included\">\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// true or false\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:AssertionComment>\n                <L7p:CaseSensitive booleanValue=\"false\"/>\n                <L7p:Expression1 stringValue=\"${refresh}\"/>\n                <L7p:Operator operatorNull=\"null\"/>\n                <L7p:Predicates predicates=\"included\">\n                    <L7p:item dataType=\"included\">\n                        <L7p:Type variableDataType=\"string\"/>\n                    </L7p:item>\n                    <L7p:item regex=\"included\">\n                        <L7p:Pattern stringValue=\"^(true|false)$\"/>\n                    </L7p:item>\n                </L7p:Predicates>\n            </L7p:ComparisonAssertion>\n            <L7p:SetVariable>\n                <L7p:Base64Expression stringValue=\"ZmFsc2U=\"/>\n                <L7p:VariableToSet stringValue=\"refresh\"/>\n            </L7p:SetVariable>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Ensure ${refresh} is set, default=false\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:OneOrMore>\n        <L7p:SetVariable>\n            <L7p:Base64Expression stringValue=\"Y2x1c3RlclByb3BlcnRpZXMuc29ydGVk\"/>\n            <L7p:VariableToSet stringValue=\"cacheKey\"/>\n        </L7p:SetVariable>\n        <wsp:OneOrMore wsp:Usage=\"Required\">\n            <wsp:All wsp:Usage=\"Required\">\n                <L7p:ComparisonAssertion>\n                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                    <L7p:Expression1 stringValue=\"${refresh}\"/>\n                    <L7p:Operator operatorNull=\"null\"/>\n                    <L7p:Predicates predicates=\"included\">\n                        <L7p:item dataType=\"included\">\n                            <L7p:Type variableDataType=\"string\"/>\n                        </L7p:item>\n                        <L7p:item binary=\"included\">\n                            <L7p:Negated booleanValue=\"true\"/>\n                            <L7p:RightValue stringValue=\"true\"/>\n                        </L7p:item>\n                    </L7p:Predicates>\n                </L7p:ComparisonAssertion>\n                <L7p:CacheLookup>\n                    <L7p:CacheEntryKey stringValue=\"${cacheKey}\"/>\n                    <L7p:CacheId stringValue=\"clusterPropertyList\"/>\n                    <L7p:ContentTypeOverride stringValue=\"\"/>\n                    <L7p:MaxEntryAgeSeconds stringValue=\"${cacheAge}\"/>\n                    <L7p:OtherTargetMessageVariable stringValue=\"clusterProperties.sorted\"/>\n                    <L7p:Target target=\"OTHER\"/>\n                </L7p:CacheLookup>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"Y2FjaGU=\"/>\n                    <L7p:VariableToSet stringValue=\"source\"/>\n                </L7p:SetVariable>\n                <L7p:AuditDetailAssertion>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// FINE\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Detail stringValue=\"==> Found clusterProperties.sorted in the cache\"/>\n                    <L7p:Level stringValue=\"FINE\"/>\n                </L7p:AuditDetailAssertion>\n                <L7p:assertionComment>\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// Look in cache unless asked to refresh cache\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:assertionComment>\n            </wsp:All>\n            <wsp:All wsp:Usage=\"Required\">\n                <L7p:Encapsulated>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// GET clusterProperties\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:EncapsulatedAssertionConfigGuid stringValue=\"c8a5a0d5-1ae2-4144-b538-5c311efc1560\"/>\n                    <L7p:EncapsulatedAssertionConfigName stringValue=\"Utility: Call Restman\"/>\n                    <L7p:Parameters mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"element\"/>\n                            <L7p:value stringValue=\"ClusterProperty\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"message\"/>\n                            <L7p:value stringValue=\"\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"method\"/>\n                            <L7p:value stringValue=\"GET\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"resource\"/>\n                            <L7p:value stringValue=\"clusterProperties\"/>\n                        </L7p:entry>\n                    </L7p:Parameters>\n                </L7p:Encapsulated>\n                <wsp:OneOrMore wsp:Usage=\"Required\">\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:VariablePrefix stringValue=\"clusterProperties\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/l7:List/l7:Item/l7:Resource/l7:ClusterProperty\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <L7p:TrueAssertion/>\n                    <L7p:assertionComment>\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// Extract the list of cluster properties, never fail\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:assertionComment>\n                </wsp:OneOrMore>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz48Q2x1c3RlclByb3BlcnRpZXM+\"/>\n                    <L7p:VariableToSet stringValue=\"clusterProperties.sorted\"/>\n                </L7p:SetVariable>\n                <L7p:ForEachLoop L7p:Usage=\"Required\"\n                    loopVariable=\"clusterProperties.elements\" variablePrefix=\"clusterProperty\">\n                    <L7p:SetVariable>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Cast to message type for parsing\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:Base64Expression stringValue=\"JHtjbHVzdGVyUHJvcGVydHkuY3VycmVudH0=\"/>\n                        <L7p:ContentType stringValue=\"text/xml; charset=utf-8\"/>\n                        <L7p:DataType variableDataType=\"message\"/>\n                        <L7p:VariableToSet stringValue=\"clusterProperty.xml\"/>\n                    </L7p:SetVariable>\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Retrieve the cluster property ID\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:VariablePrefix stringValue=\"id\"/>\n                        <L7p:XmlMsgSrc stringValue=\"clusterProperty.xml\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/l7:ClusterProperty/@id\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// retrieve the cluster property name\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:VariablePrefix stringValue=\"name\"/>\n                        <L7p:XmlMsgSrc stringValue=\"clusterProperty.xml\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/l7:ClusterProperty/l7:Name\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Retrieve the cluster property value\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:VariablePrefix stringValue=\"value\"/>\n                        <L7p:XmlMsgSrc stringValue=\"clusterProperty.xml\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/l7:ClusterProperty/l7:Value\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <L7p:SetVariable>\n                        <L7p:Base64Expression stringValue=\"JHtjbHVzdGVyUHJvcGVydGllcy5zb3J0ZWR9PENsdXN0ZXJQcm9wZXJ0eSBpZD0iJHtpZC5yZXN1bHR9Ij48TmFtZT48IVtDREFUQVske25hbWUucmVzdWx0fV1dPjwvTmFtZT48VmFsdWU+PCFbQ0RBVEFbJHt2YWx1ZS5yZXN1bHR9XV0+PC9WYWx1ZT48L0NsdXN0ZXJQcm9wZXJ0eT4=\"/>\n                        <L7p:VariableToSet stringValue=\"clusterProperties.sorted\"/>\n                    </L7p:SetVariable>\n                    <L7p:assertionComment>\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// Build the list of cluster properties\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:assertionComment>\n                </L7p:ForEachLoop>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"JHtjbHVzdGVyUHJvcGVydGllcy5zb3J0ZWR9PC9DbHVzdGVyUHJvcGVydGllcz4=\"/>\n                    <L7p:ContentType stringValue=\"text/xml; charset=utf-8\"/>\n                    <L7p:DataType variableDataType=\"message\"/>\n                    <L7p:VariableToSet stringValue=\"clusterProperties.sorted\"/>\n                </L7p:SetVariable>\n                <L7p:XslTransformation>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// Sort the cluster properties by name\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Direction intValue=\"-1\"/>\n                    <L7p:OtherTargetMessageVariable stringValue=\"clusterProperties.sorted\"/>\n                    <L7p:ResourceInfo staticResourceInfo=\"included\">\n                        <L7p:Document stringValue=\"&lt;xsl:stylesheet version=&quot;1.0&quot; xmlns:l7=&quot;http://ns.l7tech.com/2010/04/gateway-management&quot; xmlns:xsl=&quot;http://www.w3.org/1999/XSL/Transform&quot;>&lt;xsl:template match=&quot;/ClusterProperties&quot;>    &lt;xsl:copy>        &lt;xsl:for-each select=&quot;ClusterProperty&quot;>            &lt;xsl:sort select=&quot;./Name&quot;/>            &lt;xsl:copy-of select=&quot;.&quot;/>        &lt;/xsl:for-each>    &lt;/xsl:copy>&lt;/xsl:template>&lt;/xsl:stylesheet>\"/>\n                    </L7p:ResourceInfo>\n                    <L7p:Target target=\"OTHER\"/>\n                    <L7p:TransformName stringValue=\"\"/>\n                    <L7p:XsltVersion stringValue=\"1.0\"/>\n                </L7p:XslTransformation>\n                <L7p:CacheStorage>\n                    <L7p:CacheEntryKey stringValue=\"${cacheKey}\"/>\n                    <L7p:CacheId stringValue=\"clusterPropertyList\"/>\n                    <L7p:MaxEntries stringValue=\"1\"/>\n                    <L7p:MaxEntryAgeSeconds stringValue=\"${cacheAge}\"/>\n                    <L7p:MaxEntrySizeBytes stringValue=\"200000\"/>\n                    <L7p:OtherTargetMessageVariable stringValue=\"clusterProperties.sorted\"/>\n                    <L7p:StoreSoapFaults booleanValue=\"true\"/>\n                    <L7p:Target target=\"OTHER\"/>\n                </L7p:CacheStorage>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"c3lzdGVt\"/>\n                    <L7p:VariableToSet stringValue=\"source\"/>\n                </L7p:SetVariable>\n                <L7p:AuditDetailAssertion>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// FINE\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Detail stringValue=\"==> Loaded clusterProperties.sorted from system and stored to cache\"/>\n                    <L7p:Level stringValue=\"FINE\"/>\n                </L7p:AuditDetailAssertion>\n                <L7p:assertionComment>\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// Retrieve new list and cache\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:assertionComment>\n            </wsp:All>\n            <wsp:All wsp:Usage=\"Required\">\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"RXJyb3Igd2hlbiBsaXN0aW5nIGNsdXN0ZXIgcHJvcGVydGllcw==\"/>\n                    <L7p:VariableToSet stringValue=\"error.msg\"/>\n                </L7p:SetVariable>\n                <L7p:AuditDetailAssertion>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// WARNING\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Detail stringValue=\"==> Error listing cluster properties in ${policy.name}\"/>\n                    <L7p:Level stringValue=\"WARNING\"/>\n                </L7p:AuditDetailAssertion>\n                <L7p:FalseAssertion/>\n                <L7p:assertionComment>\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// Failure - set ${error.msg}\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:assertionComment>\n            </wsp:All>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Caching logic\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:OneOrMore>\n        <L7p:Regex>\n            <L7p:AssertionComment assertionComment=\"included\">\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Add source attribute to /ClusterProperties element\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:AssertionComment>\n            <L7p:AutoTarget booleanValue=\"false\"/>\n            <L7p:OtherTargetMessageVariable stringValue=\"clusterProperties.sorted\"/>\n            <L7p:Regex stringValue=\"&lt;ClusterProperties>\"/>\n            <L7p:Replace booleanValue=\"true\"/>\n            <L7p:Replacement stringValue=\"&lt;ClusterProperties source=&quot;${source}&quot;>\"/>\n            <L7p:Target target=\"OTHER\"/>\n        </L7p:Regex>\n        <L7p:AuditDetailAssertion>\n            <L7p:AssertionComment assertionComment=\"included\">\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// FINE\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:AssertionComment>\n            <L7p:Detail stringValue=\"==> Leaving Utility Fragment: ${policy.name}\"/>\n            <L7p:Level stringValue=\"FINE\"/>\n        </L7p:AuditDetailAssertion>\n    </wsp:All>\n</wsp:Policy>\n"
        }
      ]
    },
    {
      "guid": "29e9d372-9141-4543-b5ac-873454847d38",
      "name": "Utility: List Email Listeners",
      "policyType": "FRAGMENT",
      "checksum": "8164f6d2047623590861db533bc04e7b873f8d45",
      "folderPath": "/Gateway Management Utilities/fragments",
      "soap": false,
      "policy": {
        "xml": "<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<wsp:Policy xmlns:L7p=\"http://www.layer7tech.com/ws/policy\" xmlns:wsp=\"http://schemas.xmlsoap.org/ws/2002/12/policy\">\n    <wsp:All wsp:Usage=\"Required\">\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Policy fragment for &quot;Utility: List Email Listeners&quot; encapsulated assertion\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Call Restman and generate a sorted list of email listeners\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** - Assumes an admin role user has been authenticated\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** - Caches results for ${cacheAge} seconds (default=300). To refresh the cache set ${refresh}=true when calling\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** - Returns a text/xml message variable in ${emailListeners.sorted}\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Inputs:\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - refresh (string)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - cacheAge (string)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Outputs:\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - emailListeners.sorted(message)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - error.msg (string)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** v1.0.0 - Jay MacDonald - 20201107 - Initial Version\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n        </L7p:CommentAssertion>\n        <L7p:AuditDetailAssertion>\n            <L7p:AssertionComment assertionComment=\"included\">\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// FINE\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:AssertionComment>\n            <L7p:Detail stringValue=\"==> Entering Utility Fragment: ${policy.name} (refresh=${refresh})\"/>\n            <L7p:Level stringValue=\"FINE\"/>\n        </L7p:AuditDetailAssertion>\n        <wsp:All wsp:Usage=\"Required\">\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** ${emailListeners.sorted} has the following schema:\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** \"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** &lt;EmailListeners source=&quot;system|cache&quot;>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   &lt;EmailListener id=&quot;string&quot;>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**     &lt;Name>string&lt;/Name>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**     &lt;Type>string&lt;/Type>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**     &lt;Hostname>string&lt;/Hostname>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**     &lt;Enabled>string&lt;/Enabled>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   &lt;/EmailListener>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   ...\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** &lt;/EmailListeners>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** \"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** Where:\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   Name = the name of the email listeners\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n            </L7p:CommentAssertion>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Description of ${emailListeners.sorted}\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:All>\n        <wsp:OneOrMore wsp:Usage=\"Required\">\n            <L7p:ComparisonAssertion>\n                <L7p:AssertionComment assertionComment=\"included\">\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// true or false\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:AssertionComment>\n                <L7p:CaseSensitive booleanValue=\"false\"/>\n                <L7p:Expression1 stringValue=\"${cacheAge}\"/>\n                <L7p:Operator operatorNull=\"null\"/>\n                <L7p:Predicates predicates=\"included\">\n                    <L7p:item dataType=\"included\">\n                        <L7p:Type variableDataType=\"int\"/>\n                    </L7p:item>\n                    <L7p:item binary=\"included\">\n                        <L7p:CaseSensitive booleanValue=\"false\"/>\n                        <L7p:Operator operator=\"GT\"/>\n                        <L7p:RightValue stringValue=\"0\"/>\n                    </L7p:item>\n                </L7p:Predicates>\n            </L7p:ComparisonAssertion>\n            <L7p:SetVariable>\n                <L7p:Base64Expression stringValue=\"MzAw\"/>\n                <L7p:DataType variableDataType=\"int\"/>\n                <L7p:VariableToSet stringValue=\"cacheAge\"/>\n            </L7p:SetVariable>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Ensure ${cacheAge} is set, default=300\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:OneOrMore>\n        <wsp:OneOrMore wsp:Usage=\"Required\">\n            <L7p:ComparisonAssertion>\n                <L7p:AssertionComment assertionComment=\"included\">\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// true or false\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:AssertionComment>\n                <L7p:CaseSensitive booleanValue=\"false\"/>\n                <L7p:Expression1 stringValue=\"${refresh}\"/>\n                <L7p:Operator operatorNull=\"null\"/>\n                <L7p:Predicates predicates=\"included\">\n                    <L7p:item dataType=\"included\">\n                        <L7p:Type variableDataType=\"string\"/>\n                    </L7p:item>\n                    <L7p:item regex=\"included\">\n                        <L7p:Pattern stringValue=\"^(true|false)$\"/>\n                    </L7p:item>\n                </L7p:Predicates>\n            </L7p:ComparisonAssertion>\n            <L7p:SetVariable>\n                <L7p:Base64Expression stringValue=\"ZmFsc2U=\"/>\n                <L7p:VariableToSet stringValue=\"refresh\"/>\n            </L7p:SetVariable>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Ensure ${refresh} is set, default=false\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:OneOrMore>\n        <L7p:SetVariable>\n            <L7p:Base64Expression stringValue=\"ZW1haWxMaXN0ZW5lcnMuc29ydGVk\"/>\n            <L7p:VariableToSet stringValue=\"cacheKey\"/>\n        </L7p:SetVariable>\n        <wsp:OneOrMore wsp:Usage=\"Required\">\n            <wsp:All wsp:Usage=\"Required\">\n                <L7p:ComparisonAssertion>\n                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                    <L7p:Expression1 stringValue=\"${refresh}\"/>\n                    <L7p:Operator operatorNull=\"null\"/>\n                    <L7p:Predicates predicates=\"included\">\n                        <L7p:item dataType=\"included\">\n                            <L7p:Type variableDataType=\"string\"/>\n                        </L7p:item>\n                        <L7p:item binary=\"included\">\n                            <L7p:Negated booleanValue=\"true\"/>\n                            <L7p:RightValue stringValue=\"true\"/>\n                        </L7p:item>\n                    </L7p:Predicates>\n                </L7p:ComparisonAssertion>\n                <L7p:CacheLookup>\n                    <L7p:CacheEntryKey stringValue=\"${cacheKey}\"/>\n                    <L7p:CacheId stringValue=\"emailListenerList\"/>\n                    <L7p:ContentTypeOverride stringValue=\"\"/>\n                    <L7p:MaxEntryAgeSeconds stringValue=\"${cacheAge}\"/>\n                    <L7p:OtherTargetMessageVariable stringValue=\"emailListeners.sorted\"/>\n                    <L7p:Target target=\"OTHER\"/>\n                </L7p:CacheLookup>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"Y2FjaGU=\"/>\n                    <L7p:VariableToSet stringValue=\"source\"/>\n                </L7p:SetVariable>\n                <L7p:AuditDetailAssertion>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// FINE\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Detail stringValue=\"==> Found emailListeners.sorted in the cache\"/>\n                    <L7p:Level stringValue=\"FINE\"/>\n                </L7p:AuditDetailAssertion>\n                <L7p:assertionComment>\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// Look in cache unless asked to refresh cache\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:assertionComment>\n            </wsp:All>\n            <wsp:All wsp:Usage=\"Required\">\n                <L7p:Encapsulated>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// GET emailListeners\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:EncapsulatedAssertionConfigGuid stringValue=\"c8a5a0d5-1ae2-4144-b538-5c311efc1560\"/>\n                    <L7p:EncapsulatedAssertionConfigName stringValue=\"Utility: Call Restman\"/>\n                    <L7p:Parameters mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"element\"/>\n                            <L7p:value stringValue=\"EmailListener\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"message\"/>\n                            <L7p:value stringValue=\"\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"method\"/>\n                            <L7p:value stringValue=\"GET\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"resource\"/>\n                            <L7p:value stringValue=\"emailListeners\"/>\n                        </L7p:entry>\n                    </L7p:Parameters>\n                </L7p:Encapsulated>\n                <wsp:OneOrMore wsp:Usage=\"Required\">\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:VariablePrefix stringValue=\"emailListeners\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/l7:List/l7:Item/l7:Resource/l7:EmailListener\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <L7p:TrueAssertion/>\n                    <L7p:assertionComment>\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// Extract the list of email listeners, never fail\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:assertionComment>\n                </wsp:OneOrMore>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz48RW1haWxMaXN0ZW5lcnM+\"/>\n                    <L7p:VariableToSet stringValue=\"emailListeners.sorted\"/>\n                </L7p:SetVariable>\n                <L7p:ForEachLoop L7p:Usage=\"Required\"\n                    loopVariable=\"emailListeners.elements\" variablePrefix=\"emailListener\">\n                    <L7p:SetVariable>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Cast to message type for parsing\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:Base64Expression stringValue=\"JHtlbWFpbExpc3RlbmVyLmN1cnJlbnR9\"/>\n                        <L7p:ContentType stringValue=\"text/xml; charset=utf-8\"/>\n                        <L7p:DataType variableDataType=\"message\"/>\n                        <L7p:VariableToSet stringValue=\"emailListener.xml\"/>\n                    </L7p:SetVariable>\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Retrieve the email listener ID\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:VariablePrefix stringValue=\"id\"/>\n                        <L7p:XmlMsgSrc stringValue=\"emailListener.xml\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/l7:EmailListener/@id\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// retrieve the email listener name\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:VariablePrefix stringValue=\"name\"/>\n                        <L7p:XmlMsgSrc stringValue=\"emailListener.xml\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/l7:EmailListener/l7:Name\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// retrieve the email listener enabled state\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:VariablePrefix stringValue=\"enabled\"/>\n                        <L7p:XmlMsgSrc stringValue=\"emailListener.xml\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/l7:EmailListener/l7:Active\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// retrieve the email listener type\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:VariablePrefix stringValue=\"type\"/>\n                        <L7p:XmlMsgSrc stringValue=\"emailListener.xml\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/l7:EmailListener/l7:ServerType\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// retrieve the email listener type\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:VariablePrefix stringValue=\"hostname\"/>\n                        <L7p:XmlMsgSrc stringValue=\"emailListener.xml\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/l7:EmailListener/l7:Hostname\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <L7p:SetVariable>\n                        <L7p:Base64Expression stringValue=\"JHtlbWFpbExpc3RlbmVycy5zb3J0ZWR9PEVtYWlsTGlzdGVuZXIgaWQ9IiR7aWQucmVzdWx0fSI+PE5hbWU+PCFbQ0RBVEFbJHtuYW1lLnJlc3VsdH1dXT48L05hbWU+PFR5cGU+JHt0eXBlLnJlc3VsdH08L1R5cGU+PEhvc3RuYW1lPiR7aG9zdG5hbWUucmVzdWx0fTwvSG9zdG5hbWU+PEVuYWJsZWQ+JHtlbmFibGVkLnJlc3VsdH08L0VuYWJsZWQ+PC9FbWFpbExpc3RlbmVyPg==\"/>\n                        <L7p:VariableToSet stringValue=\"emailListeners.sorted\"/>\n                    </L7p:SetVariable>\n                    <L7p:assertionComment>\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// Build the list of email listeners\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:assertionComment>\n                </L7p:ForEachLoop>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"JHtlbWFpbExpc3RlbmVycy5zb3J0ZWR9PC9FbWFpbExpc3RlbmVycz4=\"/>\n                    <L7p:ContentType stringValue=\"text/xml; charset=utf-8\"/>\n                    <L7p:DataType variableDataType=\"message\"/>\n                    <L7p:VariableToSet stringValue=\"emailListeners.sorted\"/>\n                </L7p:SetVariable>\n                <L7p:XslTransformation>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// Sort the email listeners by name\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Direction intValue=\"-1\"/>\n                    <L7p:OtherTargetMessageVariable stringValue=\"emailListeners.sorted\"/>\n                    <L7p:ResourceInfo staticResourceInfo=\"included\">\n                        <L7p:Document stringValue=\"&lt;xsl:stylesheet version=&quot;1.0&quot; xmlns:l7=&quot;http://ns.l7tech.com/2010/04/gateway-management&quot; xmlns:xsl=&quot;http://www.w3.org/1999/XSL/Transform&quot;>&lt;xsl:template match=&quot;/EmailListeners&quot;>    &lt;xsl:copy>        &lt;xsl:for-each select=&quot;EmailListener&quot;>            &lt;xsl:sort select=&quot;./Name&quot;/>            &lt;xsl:copy-of select=&quot;.&quot;/>        &lt;/xsl:for-each>    &lt;/xsl:copy>&lt;/xsl:template>&lt;/xsl:stylesheet>\"/>\n                    </L7p:ResourceInfo>\n                    <L7p:Target target=\"OTHER\"/>\n                    <L7p:TransformName stringValue=\"\"/>\n                    <L7p:XsltVersion stringValue=\"1.0\"/>\n                </L7p:XslTransformation>\n                <L7p:CacheStorage>\n                    <L7p:CacheEntryKey stringValue=\"${cacheKey}\"/>\n                    <L7p:CacheId stringValue=\"emailListenerList\"/>\n                    <L7p:MaxEntries stringValue=\"1\"/>\n                    <L7p:MaxEntryAgeSeconds stringValue=\"${cacheAge}\"/>\n                    <L7p:MaxEntrySizeBytes stringValue=\"200000\"/>\n                    <L7p:OtherTargetMessageVariable stringValue=\"emailListeners.sorted\"/>\n                    <L7p:StoreSoapFaults booleanValue=\"true\"/>\n                    <L7p:Target target=\"OTHER\"/>\n                </L7p:CacheStorage>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"c3lzdGVt\"/>\n                    <L7p:VariableToSet stringValue=\"source\"/>\n                </L7p:SetVariable>\n                <L7p:AuditDetailAssertion>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// FINE\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Detail stringValue=\"==> Loaded emailListeners.sorted from system and stored to cache\"/>\n                    <L7p:Level stringValue=\"FINE\"/>\n                </L7p:AuditDetailAssertion>\n                <L7p:assertionComment>\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// Retrieve new list and cache\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:assertionComment>\n            </wsp:All>\n            <wsp:All wsp:Usage=\"Required\">\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"RXJyb3Igd2hlbiBsaXN0aW5nIGVtYWlsIGxpc3RlbmVycw==\"/>\n                    <L7p:VariableToSet stringValue=\"error.msg\"/>\n                </L7p:SetVariable>\n                <L7p:AuditDetailAssertion>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// WARNING\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Detail stringValue=\"==> Error listing email listeners in ${policy.name}\"/>\n                    <L7p:Level stringValue=\"WARNING\"/>\n                </L7p:AuditDetailAssertion>\n                <L7p:FalseAssertion/>\n                <L7p:assertionComment>\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// Failure - set ${error.msg}\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:assertionComment>\n            </wsp:All>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Caching logic\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:OneOrMore>\n        <L7p:Regex>\n            <L7p:AssertionComment assertionComment=\"included\">\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Add source attribute to /EmailListeners element\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:AssertionComment>\n            <L7p:AutoTarget booleanValue=\"false\"/>\n            <L7p:OtherTargetMessageVariable stringValue=\"emailListeners.sorted\"/>\n            <L7p:Regex stringValue=\"&lt;EmailListeners>\"/>\n            <L7p:Replace booleanValue=\"true\"/>\n            <L7p:Replacement stringValue=\"&lt;EmailListeners source=&quot;${source}&quot;>\"/>\n            <L7p:Target target=\"OTHER\"/>\n        </L7p:Regex>\n        <L7p:AuditDetailAssertion>\n            <L7p:AssertionComment assertionComment=\"included\">\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// FINE\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:AssertionComment>\n            <L7p:Detail stringValue=\"==> Leaving Utility Fragment: ${policy.name}\"/>\n            <L7p:Level stringValue=\"FINE\"/>\n        </L7p:AuditDetailAssertion>\n    </wsp:All>\n</wsp:Policy>\n"
      },
      "policyRevisions": [
        {
          "goid": "bed4baf4ff33b7e528854c3965d9bb28",
          "ordinal": 1,
          "active": true,
          "author": "admin",
          "time": "2025-02-05T14:20:38.445Z",
          "xml": "<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<wsp:Policy xmlns:L7p=\"http://www.layer7tech.com/ws/policy\" xmlns:wsp=\"http://schemas.xmlsoap.org/ws/2002/12/policy\">\n    <wsp:All wsp:Usage=\"Required\">\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Policy fragment for &quot;Utility: List Email Listeners&quot; encapsulated assertion\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Call Restman and generate a sorted list of email listeners\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** - Assumes an admin role user has been authenticated\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** - Caches results for ${cacheAge} seconds (default=300). To refresh the cache set ${refresh}=true when calling\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** - Returns a text/xml message variable in ${emailListeners.sorted}\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Inputs:\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - refresh (string)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - cacheAge (string)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Outputs:\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - emailListeners.sorted(message)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - error.msg (string)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** v1.0.0 - Jay MacDonald - 20201107 - Initial Version\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n        </L7p:CommentAssertion>\n        <L7p:AuditDetailAssertion>\n            <L7p:AssertionComment assertionComment=\"included\">\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// FINE\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:AssertionComment>\n            <L7p:Detail stringValue=\"==> Entering Utility Fragment: ${policy.name} (refresh=${refresh})\"/>\n            <L7p:Level stringValue=\"FINE\"/>\n        </L7p:AuditDetailAssertion>\n        <wsp:All wsp:Usage=\"Required\">\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** ${emailListeners.sorted} has the following schema:\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** \"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** &lt;EmailListeners source=&quot;system|cache&quot;>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   &lt;EmailListener id=&quot;string&quot;>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**     &lt;Name>string&lt;/Name>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**     &lt;Type>string&lt;/Type>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**     &lt;Hostname>string&lt;/Hostname>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**     &lt;Enabled>string&lt;/Enabled>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   &lt;/EmailListener>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   ...\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** &lt;/EmailListeners>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** \"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** Where:\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   Name = the name of the email listeners\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n            </L7p:CommentAssertion>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Description of ${emailListeners.sorted}\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:All>\n        <wsp:OneOrMore wsp:Usage=\"Required\">\n            <L7p:ComparisonAssertion>\n                <L7p:AssertionComment assertionComment=\"included\">\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// true or false\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:AssertionComment>\n                <L7p:CaseSensitive booleanValue=\"false\"/>\n                <L7p:Expression1 stringValue=\"${cacheAge}\"/>\n                <L7p:Operator operatorNull=\"null\"/>\n                <L7p:Predicates predicates=\"included\">\n                    <L7p:item dataType=\"included\">\n                        <L7p:Type variableDataType=\"int\"/>\n                    </L7p:item>\n                    <L7p:item binary=\"included\">\n                        <L7p:CaseSensitive booleanValue=\"false\"/>\n                        <L7p:Operator operator=\"GT\"/>\n                        <L7p:RightValue stringValue=\"0\"/>\n                    </L7p:item>\n                </L7p:Predicates>\n            </L7p:ComparisonAssertion>\n            <L7p:SetVariable>\n                <L7p:Base64Expression stringValue=\"MzAw\"/>\n                <L7p:DataType variableDataType=\"int\"/>\n                <L7p:VariableToSet stringValue=\"cacheAge\"/>\n            </L7p:SetVariable>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Ensure ${cacheAge} is set, default=300\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:OneOrMore>\n        <wsp:OneOrMore wsp:Usage=\"Required\">\n            <L7p:ComparisonAssertion>\n                <L7p:AssertionComment assertionComment=\"included\">\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// true or false\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:AssertionComment>\n                <L7p:CaseSensitive booleanValue=\"false\"/>\n                <L7p:Expression1 stringValue=\"${refresh}\"/>\n                <L7p:Operator operatorNull=\"null\"/>\n                <L7p:Predicates predicates=\"included\">\n                    <L7p:item dataType=\"included\">\n                        <L7p:Type variableDataType=\"string\"/>\n                    </L7p:item>\n                    <L7p:item regex=\"included\">\n                        <L7p:Pattern stringValue=\"^(true|false)$\"/>\n                    </L7p:item>\n                </L7p:Predicates>\n            </L7p:ComparisonAssertion>\n            <L7p:SetVariable>\n                <L7p:Base64Expression stringValue=\"ZmFsc2U=\"/>\n                <L7p:VariableToSet stringValue=\"refresh\"/>\n            </L7p:SetVariable>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Ensure ${refresh} is set, default=false\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:OneOrMore>\n        <L7p:SetVariable>\n            <L7p:Base64Expression stringValue=\"ZW1haWxMaXN0ZW5lcnMuc29ydGVk\"/>\n            <L7p:VariableToSet stringValue=\"cacheKey\"/>\n        </L7p:SetVariable>\n        <wsp:OneOrMore wsp:Usage=\"Required\">\n            <wsp:All wsp:Usage=\"Required\">\n                <L7p:ComparisonAssertion>\n                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                    <L7p:Expression1 stringValue=\"${refresh}\"/>\n                    <L7p:Operator operatorNull=\"null\"/>\n                    <L7p:Predicates predicates=\"included\">\n                        <L7p:item dataType=\"included\">\n                            <L7p:Type variableDataType=\"string\"/>\n                        </L7p:item>\n                        <L7p:item binary=\"included\">\n                            <L7p:Negated booleanValue=\"true\"/>\n                            <L7p:RightValue stringValue=\"true\"/>\n                        </L7p:item>\n                    </L7p:Predicates>\n                </L7p:ComparisonAssertion>\n                <L7p:CacheLookup>\n                    <L7p:CacheEntryKey stringValue=\"${cacheKey}\"/>\n                    <L7p:CacheId stringValue=\"emailListenerList\"/>\n                    <L7p:ContentTypeOverride stringValue=\"\"/>\n                    <L7p:MaxEntryAgeSeconds stringValue=\"${cacheAge}\"/>\n                    <L7p:OtherTargetMessageVariable stringValue=\"emailListeners.sorted\"/>\n                    <L7p:Target target=\"OTHER\"/>\n                </L7p:CacheLookup>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"Y2FjaGU=\"/>\n                    <L7p:VariableToSet stringValue=\"source\"/>\n                </L7p:SetVariable>\n                <L7p:AuditDetailAssertion>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// FINE\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Detail stringValue=\"==> Found emailListeners.sorted in the cache\"/>\n                    <L7p:Level stringValue=\"FINE\"/>\n                </L7p:AuditDetailAssertion>\n                <L7p:assertionComment>\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// Look in cache unless asked to refresh cache\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:assertionComment>\n            </wsp:All>\n            <wsp:All wsp:Usage=\"Required\">\n                <L7p:Encapsulated>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// GET emailListeners\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:EncapsulatedAssertionConfigGuid stringValue=\"c8a5a0d5-1ae2-4144-b538-5c311efc1560\"/>\n                    <L7p:EncapsulatedAssertionConfigName stringValue=\"Utility: Call Restman\"/>\n                    <L7p:Parameters mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"element\"/>\n                            <L7p:value stringValue=\"EmailListener\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"message\"/>\n                            <L7p:value stringValue=\"\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"method\"/>\n                            <L7p:value stringValue=\"GET\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"resource\"/>\n                            <L7p:value stringValue=\"emailListeners\"/>\n                        </L7p:entry>\n                    </L7p:Parameters>\n                </L7p:Encapsulated>\n                <wsp:OneOrMore wsp:Usage=\"Required\">\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:VariablePrefix stringValue=\"emailListeners\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/l7:List/l7:Item/l7:Resource/l7:EmailListener\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <L7p:TrueAssertion/>\n                    <L7p:assertionComment>\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// Extract the list of email listeners, never fail\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:assertionComment>\n                </wsp:OneOrMore>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz48RW1haWxMaXN0ZW5lcnM+\"/>\n                    <L7p:VariableToSet stringValue=\"emailListeners.sorted\"/>\n                </L7p:SetVariable>\n                <L7p:ForEachLoop L7p:Usage=\"Required\"\n                    loopVariable=\"emailListeners.elements\" variablePrefix=\"emailListener\">\n                    <L7p:SetVariable>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Cast to message type for parsing\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:Base64Expression stringValue=\"JHtlbWFpbExpc3RlbmVyLmN1cnJlbnR9\"/>\n                        <L7p:ContentType stringValue=\"text/xml; charset=utf-8\"/>\n                        <L7p:DataType variableDataType=\"message\"/>\n                        <L7p:VariableToSet stringValue=\"emailListener.xml\"/>\n                    </L7p:SetVariable>\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Retrieve the email listener ID\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:VariablePrefix stringValue=\"id\"/>\n                        <L7p:XmlMsgSrc stringValue=\"emailListener.xml\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/l7:EmailListener/@id\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// retrieve the email listener name\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:VariablePrefix stringValue=\"name\"/>\n                        <L7p:XmlMsgSrc stringValue=\"emailListener.xml\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/l7:EmailListener/l7:Name\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// retrieve the email listener enabled state\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:VariablePrefix stringValue=\"enabled\"/>\n                        <L7p:XmlMsgSrc stringValue=\"emailListener.xml\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/l7:EmailListener/l7:Active\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// retrieve the email listener type\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:VariablePrefix stringValue=\"type\"/>\n                        <L7p:XmlMsgSrc stringValue=\"emailListener.xml\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/l7:EmailListener/l7:ServerType\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// retrieve the email listener type\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:VariablePrefix stringValue=\"hostname\"/>\n                        <L7p:XmlMsgSrc stringValue=\"emailListener.xml\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/l7:EmailListener/l7:Hostname\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <L7p:SetVariable>\n                        <L7p:Base64Expression stringValue=\"JHtlbWFpbExpc3RlbmVycy5zb3J0ZWR9PEVtYWlsTGlzdGVuZXIgaWQ9IiR7aWQucmVzdWx0fSI+PE5hbWU+PCFbQ0RBVEFbJHtuYW1lLnJlc3VsdH1dXT48L05hbWU+PFR5cGU+JHt0eXBlLnJlc3VsdH08L1R5cGU+PEhvc3RuYW1lPiR7aG9zdG5hbWUucmVzdWx0fTwvSG9zdG5hbWU+PEVuYWJsZWQ+JHtlbmFibGVkLnJlc3VsdH08L0VuYWJsZWQ+PC9FbWFpbExpc3RlbmVyPg==\"/>\n                        <L7p:VariableToSet stringValue=\"emailListeners.sorted\"/>\n                    </L7p:SetVariable>\n                    <L7p:assertionComment>\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// Build the list of email listeners\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:assertionComment>\n                </L7p:ForEachLoop>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"JHtlbWFpbExpc3RlbmVycy5zb3J0ZWR9PC9FbWFpbExpc3RlbmVycz4=\"/>\n                    <L7p:ContentType stringValue=\"text/xml; charset=utf-8\"/>\n                    <L7p:DataType variableDataType=\"message\"/>\n                    <L7p:VariableToSet stringValue=\"emailListeners.sorted\"/>\n                </L7p:SetVariable>\n                <L7p:XslTransformation>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// Sort the email listeners by name\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Direction intValue=\"-1\"/>\n                    <L7p:OtherTargetMessageVariable stringValue=\"emailListeners.sorted\"/>\n                    <L7p:ResourceInfo staticResourceInfo=\"included\">\n                        <L7p:Document stringValue=\"&lt;xsl:stylesheet version=&quot;1.0&quot; xmlns:l7=&quot;http://ns.l7tech.com/2010/04/gateway-management&quot; xmlns:xsl=&quot;http://www.w3.org/1999/XSL/Transform&quot;>&lt;xsl:template match=&quot;/EmailListeners&quot;>    &lt;xsl:copy>        &lt;xsl:for-each select=&quot;EmailListener&quot;>            &lt;xsl:sort select=&quot;./Name&quot;/>            &lt;xsl:copy-of select=&quot;.&quot;/>        &lt;/xsl:for-each>    &lt;/xsl:copy>&lt;/xsl:template>&lt;/xsl:stylesheet>\"/>\n                    </L7p:ResourceInfo>\n                    <L7p:Target target=\"OTHER\"/>\n                    <L7p:TransformName stringValue=\"\"/>\n                    <L7p:XsltVersion stringValue=\"1.0\"/>\n                </L7p:XslTransformation>\n                <L7p:CacheStorage>\n                    <L7p:CacheEntryKey stringValue=\"${cacheKey}\"/>\n                    <L7p:CacheId stringValue=\"emailListenerList\"/>\n                    <L7p:MaxEntries stringValue=\"1\"/>\n                    <L7p:MaxEntryAgeSeconds stringValue=\"${cacheAge}\"/>\n                    <L7p:MaxEntrySizeBytes stringValue=\"200000\"/>\n                    <L7p:OtherTargetMessageVariable stringValue=\"emailListeners.sorted\"/>\n                    <L7p:StoreSoapFaults booleanValue=\"true\"/>\n                    <L7p:Target target=\"OTHER\"/>\n                </L7p:CacheStorage>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"c3lzdGVt\"/>\n                    <L7p:VariableToSet stringValue=\"source\"/>\n                </L7p:SetVariable>\n                <L7p:AuditDetailAssertion>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// FINE\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Detail stringValue=\"==> Loaded emailListeners.sorted from system and stored to cache\"/>\n                    <L7p:Level stringValue=\"FINE\"/>\n                </L7p:AuditDetailAssertion>\n                <L7p:assertionComment>\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// Retrieve new list and cache\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:assertionComment>\n            </wsp:All>\n            <wsp:All wsp:Usage=\"Required\">\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"RXJyb3Igd2hlbiBsaXN0aW5nIGVtYWlsIGxpc3RlbmVycw==\"/>\n                    <L7p:VariableToSet stringValue=\"error.msg\"/>\n                </L7p:SetVariable>\n                <L7p:AuditDetailAssertion>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// WARNING\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Detail stringValue=\"==> Error listing email listeners in ${policy.name}\"/>\n                    <L7p:Level stringValue=\"WARNING\"/>\n                </L7p:AuditDetailAssertion>\n                <L7p:FalseAssertion/>\n                <L7p:assertionComment>\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// Failure - set ${error.msg}\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:assertionComment>\n            </wsp:All>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Caching logic\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:OneOrMore>\n        <L7p:Regex>\n            <L7p:AssertionComment assertionComment=\"included\">\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Add source attribute to /EmailListeners element\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:AssertionComment>\n            <L7p:AutoTarget booleanValue=\"false\"/>\n            <L7p:OtherTargetMessageVariable stringValue=\"emailListeners.sorted\"/>\n            <L7p:Regex stringValue=\"&lt;EmailListeners>\"/>\n            <L7p:Replace booleanValue=\"true\"/>\n            <L7p:Replacement stringValue=\"&lt;EmailListeners source=&quot;${source}&quot;>\"/>\n            <L7p:Target target=\"OTHER\"/>\n        </L7p:Regex>\n        <L7p:AuditDetailAssertion>\n            <L7p:AssertionComment assertionComment=\"included\">\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// FINE\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:AssertionComment>\n            <L7p:Detail stringValue=\"==> Leaving Utility Fragment: ${policy.name}\"/>\n            <L7p:Level stringValue=\"FINE\"/>\n        </L7p:AuditDetailAssertion>\n    </wsp:All>\n</wsp:Policy>\n"
        }
      ]
    },
    {
      "guid": "63027bfb-ecd6-4219-944a-eb6661e11ebe",
      "name": "Utility: List Encapsulated Assertions",
      "policyType": "FRAGMENT",
      "checksum": "34282765ab2f135572090a623116d2e820b3fab5",
      "folderPath": "/Gateway Management Utilities/fragments",
      "soap": false,
      "policy": {
        "xml": "<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<wsp:Policy xmlns:L7p=\"http://www.layer7tech.com/ws/policy\" xmlns:wsp=\"http://schemas.xmlsoap.org/ws/2002/12/policy\">\n    <wsp:All wsp:Usage=\"Required\">\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Policy fragment for &quot;Utility: List Encapsulated Assertions&quot; encapsulated assertion\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Call Restman and generate a sorted list of encapsulated assertions\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** - Assumes an admin role user has been authenticated\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** - Caches results for ${cacheAge} seconds (default=300). To refresh the cache set ${refresh}=true when calling\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** - Returns a text/xml message variable in ${encapsulatedAssertions.sorted}\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Inputs:\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - refresh (string)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - cacheAge (string)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Outputs:\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - encapsulatedAssertions.sorted (message)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - error.msg (string)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** v1.0.0 - Jay MacDonald - 20201107 - Initial Version\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n        </L7p:CommentAssertion>\n        <L7p:AuditDetailAssertion>\n            <L7p:AssertionComment assertionComment=\"included\">\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// FINE\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:AssertionComment>\n            <L7p:Detail stringValue=\"==> Entering Utility Fragment: ${policy.name} (refresh=${refresh})\"/>\n            <L7p:Level stringValue=\"FINE\"/>\n        </L7p:AuditDetailAssertion>\n        <wsp:All wsp:Usage=\"Required\">\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** ${encapsulatedAssertions.sorted} has the following schema:\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** \"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** &lt;EncapsulatedAssertions source=&quot;system|cache&quot;>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   &lt;EncapsulatedAssertion id=&quot;string&quot;>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**     &lt;Name>string&lt;/Name>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**     &lt;GUID>string&lt;/GUID>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**     &lt;policyReference>string&lt;/policyReference>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   &lt;/EncapsulatedAssertion>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   ...\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** &lt;/EncapsulatedAssertions>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** \"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** Where:\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   Name = the name of the encapsulated assertion\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   GUID = the GUID for the encapsulated assertion\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   PolicyReference = the ID of the policy that maps to the encapsulated assertion\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n            </L7p:CommentAssertion>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Description of ${encapsulatedAssertions.sorted}\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:All>\n        <wsp:OneOrMore wsp:Usage=\"Required\">\n            <L7p:ComparisonAssertion>\n                <L7p:AssertionComment assertionComment=\"included\">\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// true or false\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:AssertionComment>\n                <L7p:CaseSensitive booleanValue=\"false\"/>\n                <L7p:Expression1 stringValue=\"${cacheAge}\"/>\n                <L7p:Operator operatorNull=\"null\"/>\n                <L7p:Predicates predicates=\"included\">\n                    <L7p:item dataType=\"included\">\n                        <L7p:Type variableDataType=\"int\"/>\n                    </L7p:item>\n                    <L7p:item binary=\"included\">\n                        <L7p:CaseSensitive booleanValue=\"false\"/>\n                        <L7p:Operator operator=\"GT\"/>\n                        <L7p:RightValue stringValue=\"0\"/>\n                    </L7p:item>\n                </L7p:Predicates>\n            </L7p:ComparisonAssertion>\n            <L7p:SetVariable>\n                <L7p:Base64Expression stringValue=\"MzAw\"/>\n                <L7p:DataType variableDataType=\"int\"/>\n                <L7p:VariableToSet stringValue=\"cacheAge\"/>\n            </L7p:SetVariable>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Ensure ${cacheAge} is set, default=300\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:OneOrMore>\n        <wsp:OneOrMore wsp:Usage=\"Required\">\n            <L7p:ComparisonAssertion>\n                <L7p:AssertionComment assertionComment=\"included\">\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// true or false\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:AssertionComment>\n                <L7p:CaseSensitive booleanValue=\"false\"/>\n                <L7p:Expression1 stringValue=\"${refresh}\"/>\n                <L7p:Operator operatorNull=\"null\"/>\n                <L7p:Predicates predicates=\"included\">\n                    <L7p:item dataType=\"included\">\n                        <L7p:Type variableDataType=\"string\"/>\n                    </L7p:item>\n                    <L7p:item regex=\"included\">\n                        <L7p:Pattern stringValue=\"^(true|false)$\"/>\n                    </L7p:item>\n                </L7p:Predicates>\n            </L7p:ComparisonAssertion>\n            <L7p:SetVariable>\n                <L7p:Base64Expression stringValue=\"ZmFsc2U=\"/>\n                <L7p:VariableToSet stringValue=\"refresh\"/>\n            </L7p:SetVariable>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Ensure ${refresh} is set, default=false\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:OneOrMore>\n        <L7p:SetVariable>\n            <L7p:Base64Expression stringValue=\"ZW5jYXBzdWxhdGVkQXNzZXJ0aW9ucy5zb3J0ZWQ=\"/>\n            <L7p:VariableToSet stringValue=\"cacheKey\"/>\n        </L7p:SetVariable>\n        <wsp:OneOrMore wsp:Usage=\"Required\">\n            <wsp:All wsp:Usage=\"Required\">\n                <L7p:ComparisonAssertion>\n                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                    <L7p:Expression1 stringValue=\"${refresh}\"/>\n                    <L7p:Operator operatorNull=\"null\"/>\n                    <L7p:Predicates predicates=\"included\">\n                        <L7p:item dataType=\"included\">\n                            <L7p:Type variableDataType=\"string\"/>\n                        </L7p:item>\n                        <L7p:item binary=\"included\">\n                            <L7p:Negated booleanValue=\"true\"/>\n                            <L7p:RightValue stringValue=\"true\"/>\n                        </L7p:item>\n                    </L7p:Predicates>\n                </L7p:ComparisonAssertion>\n                <L7p:CacheLookup>\n                    <L7p:CacheEntryKey stringValue=\"${cacheKey}\"/>\n                    <L7p:CacheId stringValue=\"encapsulatedAssertionList\"/>\n                    <L7p:ContentTypeOverride stringValue=\"\"/>\n                    <L7p:MaxEntryAgeSeconds stringValue=\"${cacheAge}\"/>\n                    <L7p:OtherTargetMessageVariable stringValue=\"encapsulatedAssertions.sorted\"/>\n                    <L7p:Target target=\"OTHER\"/>\n                </L7p:CacheLookup>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"Y2FjaGU=\"/>\n                    <L7p:VariableToSet stringValue=\"source\"/>\n                </L7p:SetVariable>\n                <L7p:AuditDetailAssertion>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// FINE\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Detail stringValue=\"==> Found encapsulatedAssertions.sorted in the cache\"/>\n                    <L7p:Level stringValue=\"FINE\"/>\n                </L7p:AuditDetailAssertion>\n                <L7p:assertionComment>\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// Look in cache unless asked to refresh cache\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:assertionComment>\n            </wsp:All>\n            <wsp:All wsp:Usage=\"Required\">\n                <L7p:Encapsulated>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// GET encapsulatedAssertions\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:EncapsulatedAssertionConfigGuid stringValue=\"c8a5a0d5-1ae2-4144-b538-5c311efc1560\"/>\n                    <L7p:EncapsulatedAssertionConfigName stringValue=\"Utility: Call Restman\"/>\n                    <L7p:Parameters mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"element\"/>\n                            <L7p:value stringValue=\"EncapsulatedAssertion\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"message\"/>\n                            <L7p:value stringValue=\"\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"method\"/>\n                            <L7p:value stringValue=\"GET\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"resource\"/>\n                            <L7p:value stringValue=\"encapsulatedAssertions\"/>\n                        </L7p:entry>\n                    </L7p:Parameters>\n                </L7p:Encapsulated>\n                <wsp:OneOrMore wsp:Usage=\"Required\">\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:VariablePrefix stringValue=\"encapsulatedAssertions\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/l7:List/l7:Item/l7:Resource/l7:EncapsulatedAssertion\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <L7p:TrueAssertion/>\n                    <L7p:assertionComment>\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// Extract the list of encapsulated assertions, never fail\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:assertionComment>\n                </wsp:OneOrMore>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz48RW5jYXBzdWxhdGVkQXNzZXJ0aW9ucz4=\"/>\n                    <L7p:VariableToSet stringValue=\"encapsulatedAssertions.sorted\"/>\n                </L7p:SetVariable>\n                <L7p:ForEachLoop L7p:Usage=\"Required\"\n                    loopVariable=\"encapsulatedAssertions.elements\" variablePrefix=\"encapsulatedAssertion\">\n                    <L7p:SetVariable>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Cast to message type for parsing\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:Base64Expression stringValue=\"JHtlbmNhcHN1bGF0ZWRBc3NlcnRpb24uY3VycmVudH0=\"/>\n                        <L7p:ContentType stringValue=\"text/xml; charset=utf-8\"/>\n                        <L7p:DataType variableDataType=\"message\"/>\n                        <L7p:VariableToSet stringValue=\"encapsulatedAssertion.xml\"/>\n                    </L7p:SetVariable>\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Retrieve the encapsulated assertion ID\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:VariablePrefix stringValue=\"id\"/>\n                        <L7p:XmlMsgSrc stringValue=\"encapsulatedAssertion.xml\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/l7:EncapsulatedAssertion/@id\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// retrieve the encapsulated assertion name\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:VariablePrefix stringValue=\"name\"/>\n                        <L7p:XmlMsgSrc stringValue=\"encapsulatedAssertion.xml\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/l7:EncapsulatedAssertion/l7:Name\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Retrieve the encapsulated assertion guid\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:VariablePrefix stringValue=\"guid\"/>\n                        <L7p:XmlMsgSrc stringValue=\"encapsulatedAssertion.xml\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/l7:EncapsulatedAssertion/l7:Guid\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Retrieve the encapsulated assertion guid\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:VariablePrefix stringValue=\"policyReference\"/>\n                        <L7p:XmlMsgSrc stringValue=\"encapsulatedAssertion.xml\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/l7:EncapsulatedAssertion/l7:PolicyReference/@id\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <L7p:SetVariable>\n                        <L7p:Base64Expression stringValue=\"JHtlbmNhcHN1bGF0ZWRBc3NlcnRpb25zLnNvcnRlZH08RW5jYXBzdWxhdGVkQXNzZXJ0aW9uIGlkPSIke2lkLnJlc3VsdH0iPjxOYW1lPjwhW0NEQVRBWyR7bmFtZS5yZXN1bHR9XV0+PC9OYW1lPjxHVUlEPiR7Z3VpZC5yZXN1bHR9PC9HVUlEPjxQb2xpY3lSZWZlcmVuY2U+JHtwb2xpY3lSZWZlcmVuY2UucmVzdWx0fTwvUG9saWN5UmVmZXJlbmNlPjwvRW5jYXBzdWxhdGVkQXNzZXJ0aW9uPg==\"/>\n                        <L7p:VariableToSet stringValue=\"encapsulatedAssertions.sorted\"/>\n                    </L7p:SetVariable>\n                    <L7p:assertionComment>\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// Build the list of encapsulated assertions\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:assertionComment>\n                </L7p:ForEachLoop>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"JHtlbmNhcHN1bGF0ZWRBc3NlcnRpb25zLnNvcnRlZH08L0VuY2Fwc3VsYXRlZEFzc2VydGlvbnM+\"/>\n                    <L7p:ContentType stringValue=\"text/xml; charset=utf-8\"/>\n                    <L7p:DataType variableDataType=\"message\"/>\n                    <L7p:VariableToSet stringValue=\"encapsulatedAssertions.sorted\"/>\n                </L7p:SetVariable>\n                <L7p:XslTransformation>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// Sort the encapsulated assertions by name\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Direction intValue=\"-1\"/>\n                    <L7p:OtherTargetMessageVariable stringValue=\"encapsulatedAssertions.sorted\"/>\n                    <L7p:ResourceInfo staticResourceInfo=\"included\">\n                        <L7p:Document stringValue=\"&lt;xsl:stylesheet version=&quot;1.0&quot; xmlns:l7=&quot;http://ns.l7tech.com/2010/04/gateway-management&quot; xmlns:xsl=&quot;http://www.w3.org/1999/XSL/Transform&quot;>&lt;xsl:template match=&quot;/EncapsulatedAssertions&quot;>    &lt;xsl:copy>        &lt;xsl:for-each select=&quot;EncapsulatedAssertion&quot;>            &lt;xsl:sort select=&quot;./Name&quot;/>            &lt;xsl:copy-of select=&quot;.&quot;/>        &lt;/xsl:for-each>    &lt;/xsl:copy>&lt;/xsl:template>&lt;/xsl:stylesheet>\"/>\n                    </L7p:ResourceInfo>\n                    <L7p:Target target=\"OTHER\"/>\n                    <L7p:TransformName stringValue=\"\"/>\n                    <L7p:XsltVersion stringValue=\"1.0\"/>\n                </L7p:XslTransformation>\n                <L7p:CacheStorage>\n                    <L7p:CacheEntryKey stringValue=\"${cacheKey}\"/>\n                    <L7p:CacheId stringValue=\"encapsulatedAssertionList\"/>\n                    <L7p:MaxEntries stringValue=\"1\"/>\n                    <L7p:MaxEntryAgeSeconds stringValue=\"${cacheAge}\"/>\n                    <L7p:MaxEntrySizeBytes stringValue=\"200000\"/>\n                    <L7p:OtherTargetMessageVariable stringValue=\"encapsulatedAssertions.sorted\"/>\n                    <L7p:StoreSoapFaults booleanValue=\"true\"/>\n                    <L7p:Target target=\"OTHER\"/>\n                </L7p:CacheStorage>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"c3lzdGVt\"/>\n                    <L7p:VariableToSet stringValue=\"source\"/>\n                </L7p:SetVariable>\n                <L7p:AuditDetailAssertion>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// FINE\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Detail stringValue=\"==> Loaded encapsulatedAssertions.sorted from system and stored to cache\"/>\n                    <L7p:Level stringValue=\"FINE\"/>\n                </L7p:AuditDetailAssertion>\n                <L7p:assertionComment>\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// Retrieve new list and cache\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:assertionComment>\n            </wsp:All>\n            <wsp:All wsp:Usage=\"Required\">\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"RXJyb3Igd2hlbiBsaXN0aW5nIGVuY2Fwc3VsYXRlZCBhc3NlcnRpb25z\"/>\n                    <L7p:VariableToSet stringValue=\"error.msg\"/>\n                </L7p:SetVariable>\n                <L7p:AuditDetailAssertion>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// WARNING\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Detail stringValue=\"==> Error listing encapsulated assertions in ${policy.name}\"/>\n                    <L7p:Level stringValue=\"WARNING\"/>\n                </L7p:AuditDetailAssertion>\n                <L7p:FalseAssertion/>\n                <L7p:assertionComment>\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// Failure - set ${error.msg}\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:assertionComment>\n            </wsp:All>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Caching logic\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:OneOrMore>\n        <L7p:Regex>\n            <L7p:AssertionComment assertionComment=\"included\">\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Add source attribute to /EncapsulatedAssertions element\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:AssertionComment>\n            <L7p:AutoTarget booleanValue=\"false\"/>\n            <L7p:OtherTargetMessageVariable stringValue=\"encapsulatedAssertions.sorted\"/>\n            <L7p:Regex stringValue=\"&lt;EncapsulatedAssertions>\"/>\n            <L7p:Replace booleanValue=\"true\"/>\n            <L7p:Replacement stringValue=\"&lt;EncapsulatedAssertions source=&quot;${source}&quot;>\"/>\n            <L7p:Target target=\"OTHER\"/>\n        </L7p:Regex>\n        <L7p:AuditDetailAssertion>\n            <L7p:AssertionComment assertionComment=\"included\">\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// FINE\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:AssertionComment>\n            <L7p:Detail stringValue=\"==> Leaving Utility Fragment: ${policy.name}\"/>\n            <L7p:Level stringValue=\"FINE\"/>\n        </L7p:AuditDetailAssertion>\n    </wsp:All>\n</wsp:Policy>\n"
      },
      "policyRevisions": [
        {
          "goid": "bed4baf4ff33b7e528854c3965d9bb2c",
          "ordinal": 1,
          "active": true,
          "author": "admin",
          "time": "2025-02-05T14:20:38.454Z",
          "xml": "<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<wsp:Policy xmlns:L7p=\"http://www.layer7tech.com/ws/policy\" xmlns:wsp=\"http://schemas.xmlsoap.org/ws/2002/12/policy\">\n    <wsp:All wsp:Usage=\"Required\">\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Policy fragment for &quot;Utility: List Encapsulated Assertions&quot; encapsulated assertion\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Call Restman and generate a sorted list of encapsulated assertions\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** - Assumes an admin role user has been authenticated\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** - Caches results for ${cacheAge} seconds (default=300). To refresh the cache set ${refresh}=true when calling\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** - Returns a text/xml message variable in ${encapsulatedAssertions.sorted}\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Inputs:\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - refresh (string)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - cacheAge (string)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Outputs:\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - encapsulatedAssertions.sorted (message)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - error.msg (string)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** v1.0.0 - Jay MacDonald - 20201107 - Initial Version\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n        </L7p:CommentAssertion>\n        <L7p:AuditDetailAssertion>\n            <L7p:AssertionComment assertionComment=\"included\">\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// FINE\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:AssertionComment>\n            <L7p:Detail stringValue=\"==> Entering Utility Fragment: ${policy.name} (refresh=${refresh})\"/>\n            <L7p:Level stringValue=\"FINE\"/>\n        </L7p:AuditDetailAssertion>\n        <wsp:All wsp:Usage=\"Required\">\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** ${encapsulatedAssertions.sorted} has the following schema:\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** \"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** &lt;EncapsulatedAssertions source=&quot;system|cache&quot;>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   &lt;EncapsulatedAssertion id=&quot;string&quot;>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**     &lt;Name>string&lt;/Name>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**     &lt;GUID>string&lt;/GUID>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**     &lt;policyReference>string&lt;/policyReference>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   &lt;/EncapsulatedAssertion>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   ...\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** &lt;/EncapsulatedAssertions>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** \"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** Where:\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   Name = the name of the encapsulated assertion\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   GUID = the GUID for the encapsulated assertion\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   PolicyReference = the ID of the policy that maps to the encapsulated assertion\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n            </L7p:CommentAssertion>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Description of ${encapsulatedAssertions.sorted}\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:All>\n        <wsp:OneOrMore wsp:Usage=\"Required\">\n            <L7p:ComparisonAssertion>\n                <L7p:AssertionComment assertionComment=\"included\">\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// true or false\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:AssertionComment>\n                <L7p:CaseSensitive booleanValue=\"false\"/>\n                <L7p:Expression1 stringValue=\"${cacheAge}\"/>\n                <L7p:Operator operatorNull=\"null\"/>\n                <L7p:Predicates predicates=\"included\">\n                    <L7p:item dataType=\"included\">\n                        <L7p:Type variableDataType=\"int\"/>\n                    </L7p:item>\n                    <L7p:item binary=\"included\">\n                        <L7p:CaseSensitive booleanValue=\"false\"/>\n                        <L7p:Operator operator=\"GT\"/>\n                        <L7p:RightValue stringValue=\"0\"/>\n                    </L7p:item>\n                </L7p:Predicates>\n            </L7p:ComparisonAssertion>\n            <L7p:SetVariable>\n                <L7p:Base64Expression stringValue=\"MzAw\"/>\n                <L7p:DataType variableDataType=\"int\"/>\n                <L7p:VariableToSet stringValue=\"cacheAge\"/>\n            </L7p:SetVariable>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Ensure ${cacheAge} is set, default=300\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:OneOrMore>\n        <wsp:OneOrMore wsp:Usage=\"Required\">\n            <L7p:ComparisonAssertion>\n                <L7p:AssertionComment assertionComment=\"included\">\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// true or false\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:AssertionComment>\n                <L7p:CaseSensitive booleanValue=\"false\"/>\n                <L7p:Expression1 stringValue=\"${refresh}\"/>\n                <L7p:Operator operatorNull=\"null\"/>\n                <L7p:Predicates predicates=\"included\">\n                    <L7p:item dataType=\"included\">\n                        <L7p:Type variableDataType=\"string\"/>\n                    </L7p:item>\n                    <L7p:item regex=\"included\">\n                        <L7p:Pattern stringValue=\"^(true|false)$\"/>\n                    </L7p:item>\n                </L7p:Predicates>\n            </L7p:ComparisonAssertion>\n            <L7p:SetVariable>\n                <L7p:Base64Expression stringValue=\"ZmFsc2U=\"/>\n                <L7p:VariableToSet stringValue=\"refresh\"/>\n            </L7p:SetVariable>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Ensure ${refresh} is set, default=false\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:OneOrMore>\n        <L7p:SetVariable>\n            <L7p:Base64Expression stringValue=\"ZW5jYXBzdWxhdGVkQXNzZXJ0aW9ucy5zb3J0ZWQ=\"/>\n            <L7p:VariableToSet stringValue=\"cacheKey\"/>\n        </L7p:SetVariable>\n        <wsp:OneOrMore wsp:Usage=\"Required\">\n            <wsp:All wsp:Usage=\"Required\">\n                <L7p:ComparisonAssertion>\n                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                    <L7p:Expression1 stringValue=\"${refresh}\"/>\n                    <L7p:Operator operatorNull=\"null\"/>\n                    <L7p:Predicates predicates=\"included\">\n                        <L7p:item dataType=\"included\">\n                            <L7p:Type variableDataType=\"string\"/>\n                        </L7p:item>\n                        <L7p:item binary=\"included\">\n                            <L7p:Negated booleanValue=\"true\"/>\n                            <L7p:RightValue stringValue=\"true\"/>\n                        </L7p:item>\n                    </L7p:Predicates>\n                </L7p:ComparisonAssertion>\n                <L7p:CacheLookup>\n                    <L7p:CacheEntryKey stringValue=\"${cacheKey}\"/>\n                    <L7p:CacheId stringValue=\"encapsulatedAssertionList\"/>\n                    <L7p:ContentTypeOverride stringValue=\"\"/>\n                    <L7p:MaxEntryAgeSeconds stringValue=\"${cacheAge}\"/>\n                    <L7p:OtherTargetMessageVariable stringValue=\"encapsulatedAssertions.sorted\"/>\n                    <L7p:Target target=\"OTHER\"/>\n                </L7p:CacheLookup>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"Y2FjaGU=\"/>\n                    <L7p:VariableToSet stringValue=\"source\"/>\n                </L7p:SetVariable>\n                <L7p:AuditDetailAssertion>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// FINE\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Detail stringValue=\"==> Found encapsulatedAssertions.sorted in the cache\"/>\n                    <L7p:Level stringValue=\"FINE\"/>\n                </L7p:AuditDetailAssertion>\n                <L7p:assertionComment>\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// Look in cache unless asked to refresh cache\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:assertionComment>\n            </wsp:All>\n            <wsp:All wsp:Usage=\"Required\">\n                <L7p:Encapsulated>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// GET encapsulatedAssertions\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:EncapsulatedAssertionConfigGuid stringValue=\"c8a5a0d5-1ae2-4144-b538-5c311efc1560\"/>\n                    <L7p:EncapsulatedAssertionConfigName stringValue=\"Utility: Call Restman\"/>\n                    <L7p:Parameters mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"element\"/>\n                            <L7p:value stringValue=\"EncapsulatedAssertion\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"message\"/>\n                            <L7p:value stringValue=\"\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"method\"/>\n                            <L7p:value stringValue=\"GET\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"resource\"/>\n                            <L7p:value stringValue=\"encapsulatedAssertions\"/>\n                        </L7p:entry>\n                    </L7p:Parameters>\n                </L7p:Encapsulated>\n                <wsp:OneOrMore wsp:Usage=\"Required\">\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:VariablePrefix stringValue=\"encapsulatedAssertions\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/l7:List/l7:Item/l7:Resource/l7:EncapsulatedAssertion\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <L7p:TrueAssertion/>\n                    <L7p:assertionComment>\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// Extract the list of encapsulated assertions, never fail\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:assertionComment>\n                </wsp:OneOrMore>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz48RW5jYXBzdWxhdGVkQXNzZXJ0aW9ucz4=\"/>\n                    <L7p:VariableToSet stringValue=\"encapsulatedAssertions.sorted\"/>\n                </L7p:SetVariable>\n                <L7p:ForEachLoop L7p:Usage=\"Required\"\n                    loopVariable=\"encapsulatedAssertions.elements\" variablePrefix=\"encapsulatedAssertion\">\n                    <L7p:SetVariable>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Cast to message type for parsing\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:Base64Expression stringValue=\"JHtlbmNhcHN1bGF0ZWRBc3NlcnRpb24uY3VycmVudH0=\"/>\n                        <L7p:ContentType stringValue=\"text/xml; charset=utf-8\"/>\n                        <L7p:DataType variableDataType=\"message\"/>\n                        <L7p:VariableToSet stringValue=\"encapsulatedAssertion.xml\"/>\n                    </L7p:SetVariable>\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Retrieve the encapsulated assertion ID\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:VariablePrefix stringValue=\"id\"/>\n                        <L7p:XmlMsgSrc stringValue=\"encapsulatedAssertion.xml\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/l7:EncapsulatedAssertion/@id\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// retrieve the encapsulated assertion name\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:VariablePrefix stringValue=\"name\"/>\n                        <L7p:XmlMsgSrc stringValue=\"encapsulatedAssertion.xml\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/l7:EncapsulatedAssertion/l7:Name\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Retrieve the encapsulated assertion guid\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:VariablePrefix stringValue=\"guid\"/>\n                        <L7p:XmlMsgSrc stringValue=\"encapsulatedAssertion.xml\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/l7:EncapsulatedAssertion/l7:Guid\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Retrieve the encapsulated assertion guid\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:VariablePrefix stringValue=\"policyReference\"/>\n                        <L7p:XmlMsgSrc stringValue=\"encapsulatedAssertion.xml\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/l7:EncapsulatedAssertion/l7:PolicyReference/@id\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <L7p:SetVariable>\n                        <L7p:Base64Expression stringValue=\"JHtlbmNhcHN1bGF0ZWRBc3NlcnRpb25zLnNvcnRlZH08RW5jYXBzdWxhdGVkQXNzZXJ0aW9uIGlkPSIke2lkLnJlc3VsdH0iPjxOYW1lPjwhW0NEQVRBWyR7bmFtZS5yZXN1bHR9XV0+PC9OYW1lPjxHVUlEPiR7Z3VpZC5yZXN1bHR9PC9HVUlEPjxQb2xpY3lSZWZlcmVuY2U+JHtwb2xpY3lSZWZlcmVuY2UucmVzdWx0fTwvUG9saWN5UmVmZXJlbmNlPjwvRW5jYXBzdWxhdGVkQXNzZXJ0aW9uPg==\"/>\n                        <L7p:VariableToSet stringValue=\"encapsulatedAssertions.sorted\"/>\n                    </L7p:SetVariable>\n                    <L7p:assertionComment>\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// Build the list of encapsulated assertions\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:assertionComment>\n                </L7p:ForEachLoop>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"JHtlbmNhcHN1bGF0ZWRBc3NlcnRpb25zLnNvcnRlZH08L0VuY2Fwc3VsYXRlZEFzc2VydGlvbnM+\"/>\n                    <L7p:ContentType stringValue=\"text/xml; charset=utf-8\"/>\n                    <L7p:DataType variableDataType=\"message\"/>\n                    <L7p:VariableToSet stringValue=\"encapsulatedAssertions.sorted\"/>\n                </L7p:SetVariable>\n                <L7p:XslTransformation>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// Sort the encapsulated assertions by name\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Direction intValue=\"-1\"/>\n                    <L7p:OtherTargetMessageVariable stringValue=\"encapsulatedAssertions.sorted\"/>\n                    <L7p:ResourceInfo staticResourceInfo=\"included\">\n                        <L7p:Document stringValue=\"&lt;xsl:stylesheet version=&quot;1.0&quot; xmlns:l7=&quot;http://ns.l7tech.com/2010/04/gateway-management&quot; xmlns:xsl=&quot;http://www.w3.org/1999/XSL/Transform&quot;>&lt;xsl:template match=&quot;/EncapsulatedAssertions&quot;>    &lt;xsl:copy>        &lt;xsl:for-each select=&quot;EncapsulatedAssertion&quot;>            &lt;xsl:sort select=&quot;./Name&quot;/>            &lt;xsl:copy-of select=&quot;.&quot;/>        &lt;/xsl:for-each>    &lt;/xsl:copy>&lt;/xsl:template>&lt;/xsl:stylesheet>\"/>\n                    </L7p:ResourceInfo>\n                    <L7p:Target target=\"OTHER\"/>\n                    <L7p:TransformName stringValue=\"\"/>\n                    <L7p:XsltVersion stringValue=\"1.0\"/>\n                </L7p:XslTransformation>\n                <L7p:CacheStorage>\n                    <L7p:CacheEntryKey stringValue=\"${cacheKey}\"/>\n                    <L7p:CacheId stringValue=\"encapsulatedAssertionList\"/>\n                    <L7p:MaxEntries stringValue=\"1\"/>\n                    <L7p:MaxEntryAgeSeconds stringValue=\"${cacheAge}\"/>\n                    <L7p:MaxEntrySizeBytes stringValue=\"200000\"/>\n                    <L7p:OtherTargetMessageVariable stringValue=\"encapsulatedAssertions.sorted\"/>\n                    <L7p:StoreSoapFaults booleanValue=\"true\"/>\n                    <L7p:Target target=\"OTHER\"/>\n                </L7p:CacheStorage>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"c3lzdGVt\"/>\n                    <L7p:VariableToSet stringValue=\"source\"/>\n                </L7p:SetVariable>\n                <L7p:AuditDetailAssertion>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// FINE\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Detail stringValue=\"==> Loaded encapsulatedAssertions.sorted from system and stored to cache\"/>\n                    <L7p:Level stringValue=\"FINE\"/>\n                </L7p:AuditDetailAssertion>\n                <L7p:assertionComment>\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// Retrieve new list and cache\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:assertionComment>\n            </wsp:All>\n            <wsp:All wsp:Usage=\"Required\">\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"RXJyb3Igd2hlbiBsaXN0aW5nIGVuY2Fwc3VsYXRlZCBhc3NlcnRpb25z\"/>\n                    <L7p:VariableToSet stringValue=\"error.msg\"/>\n                </L7p:SetVariable>\n                <L7p:AuditDetailAssertion>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// WARNING\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Detail stringValue=\"==> Error listing encapsulated assertions in ${policy.name}\"/>\n                    <L7p:Level stringValue=\"WARNING\"/>\n                </L7p:AuditDetailAssertion>\n                <L7p:FalseAssertion/>\n                <L7p:assertionComment>\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// Failure - set ${error.msg}\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:assertionComment>\n            </wsp:All>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Caching logic\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:OneOrMore>\n        <L7p:Regex>\n            <L7p:AssertionComment assertionComment=\"included\">\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Add source attribute to /EncapsulatedAssertions element\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:AssertionComment>\n            <L7p:AutoTarget booleanValue=\"false\"/>\n            <L7p:OtherTargetMessageVariable stringValue=\"encapsulatedAssertions.sorted\"/>\n            <L7p:Regex stringValue=\"&lt;EncapsulatedAssertions>\"/>\n            <L7p:Replace booleanValue=\"true\"/>\n            <L7p:Replacement stringValue=\"&lt;EncapsulatedAssertions source=&quot;${source}&quot;>\"/>\n            <L7p:Target target=\"OTHER\"/>\n        </L7p:Regex>\n        <L7p:AuditDetailAssertion>\n            <L7p:AssertionComment assertionComment=\"included\">\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// FINE\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:AssertionComment>\n            <L7p:Detail stringValue=\"==> Leaving Utility Fragment: ${policy.name}\"/>\n            <L7p:Level stringValue=\"FINE\"/>\n        </L7p:AuditDetailAssertion>\n    </wsp:All>\n</wsp:Policy>\n"
        }
      ]
    },
    {
      "guid": "219cafb1-ca3d-40e9-8270-f7d95673c74b",
      "name": "Utility: List Folders",
      "policyType": "FRAGMENT",
      "checksum": "d09172bf10352ce8bc62b1161fa9ab56ff387316",
      "folderPath": "/Gateway Management Utilities/fragments",
      "soap": false,
      "policy": {
        "xml": "<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<wsp:Policy xmlns:L7p=\"http://www.layer7tech.com/ws/policy\" xmlns:wsp=\"http://schemas.xmlsoap.org/ws/2002/12/policy\">\n    <wsp:All wsp:Usage=\"Required\">\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Policy fragment for &quot;Utility: List Folders&quot; encapsulated assertion\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Call Restman and generate a sorted list of folders\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** - Assumes an admin role user has been authenticated\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** - Caches results for ${cacheAge} seconds (default=300). To refresh the cache set ${refresh}=true when calling\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** - Returns a text/xml message variable in ${folders.sorted}\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Inputs:\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - refresh (string)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - cacheAge (string)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Outputs:\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - folders.sorted (message)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - error.msg (string)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** v1.0.0 - Jay MacDonald - 20201107 - Initial Version\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n        </L7p:CommentAssertion>\n        <L7p:AuditDetailAssertion>\n            <L7p:AssertionComment assertionComment=\"included\">\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// FINE\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:AssertionComment>\n            <L7p:Detail stringValue=\"==> Entering Utility Fragment: ${policy.name} (refresh=${refresh})\"/>\n            <L7p:Level stringValue=\"FINE\"/>\n        </L7p:AuditDetailAssertion>\n        <wsp:All wsp:Usage=\"Required\">\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** ${folders.sorted} has the following schema:\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** \"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** &lt;Folders source=&quot;system|cache&quot; rootId=&quot;string&quot;>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   &lt;Folder id=&quot;string&quot; folderId=&quot;string&quot;>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**     &lt;Name>string&lt;/Name>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**     &lt;FolderPath>string&lt;/FolderPath>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**     &lt;IdPath>string&lt;/IdPath>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   &lt;/Folder>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   ...\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** &lt;/Folders>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** \"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** Where:\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   Name = the name of the folder (i.e. no path)\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   FolderPath = the path to the folder without the folder's name\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   IdPath = the path to this folder expressed as folder ids\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   FullPath = the path to the folder with the folder's name\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** \"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** Content of folder element is the full path to the folder\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n            </L7p:CommentAssertion>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Description of ${folders.sorted}\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:All>\n        <wsp:OneOrMore wsp:Usage=\"Required\">\n            <L7p:ComparisonAssertion>\n                <L7p:AssertionComment assertionComment=\"included\">\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// true or false\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:AssertionComment>\n                <L7p:CaseSensitive booleanValue=\"false\"/>\n                <L7p:Expression1 stringValue=\"${cacheAge}\"/>\n                <L7p:Operator operatorNull=\"null\"/>\n                <L7p:Predicates predicates=\"included\">\n                    <L7p:item dataType=\"included\">\n                        <L7p:Type variableDataType=\"int\"/>\n                    </L7p:item>\n                    <L7p:item binary=\"included\">\n                        <L7p:CaseSensitive booleanValue=\"false\"/>\n                        <L7p:Operator operator=\"GT\"/>\n                        <L7p:RightValue stringValue=\"0\"/>\n                    </L7p:item>\n                </L7p:Predicates>\n            </L7p:ComparisonAssertion>\n            <L7p:SetVariable>\n                <L7p:Base64Expression stringValue=\"MzAw\"/>\n                <L7p:DataType variableDataType=\"int\"/>\n                <L7p:VariableToSet stringValue=\"cacheAge\"/>\n            </L7p:SetVariable>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Ensure ${cacheAge} is set, default=300\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:OneOrMore>\n        <wsp:OneOrMore wsp:Usage=\"Required\">\n            <L7p:ComparisonAssertion>\n                <L7p:AssertionComment assertionComment=\"included\">\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// true or false\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:AssertionComment>\n                <L7p:CaseSensitive booleanValue=\"false\"/>\n                <L7p:Expression1 stringValue=\"${refresh}\"/>\n                <L7p:Operator operatorNull=\"null\"/>\n                <L7p:Predicates predicates=\"included\">\n                    <L7p:item dataType=\"included\">\n                        <L7p:Type variableDataType=\"string\"/>\n                    </L7p:item>\n                    <L7p:item regex=\"included\">\n                        <L7p:Pattern stringValue=\"^(true|false)$\"/>\n                    </L7p:item>\n                </L7p:Predicates>\n            </L7p:ComparisonAssertion>\n            <L7p:SetVariable>\n                <L7p:Base64Expression stringValue=\"ZmFsc2U=\"/>\n                <L7p:VariableToSet stringValue=\"refresh\"/>\n            </L7p:SetVariable>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Ensure ${refresh} is set, default=false\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:OneOrMore>\n        <L7p:SetVariable>\n            <L7p:Base64Expression stringValue=\"Zm9sZGVycy5zb3J0ZWQ=\"/>\n            <L7p:VariableToSet stringValue=\"cacheKey\"/>\n        </L7p:SetVariable>\n        <L7p:SetVariable>\n            <L7p:Base64Expression stringValue=\"PCEtLSBUZW1wbGF0ZSBvZiAxMDAwIGluZGV4ZXMgdG8gY3JlYXRlIGEgZm9yIGxvb3AgLS0+DQo8Zm9yTG9vcFRlbXBsYXRlPg0KICA8aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPg0KICA8aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPg0KICA8aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPg0KICA8aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPg0KICA8aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPg0KICA8aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPg0KICA8aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPg0KICA8aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPg0KICA8aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPg0KICA8aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPg0KICA8aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPg0KICA8aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPg0KICA8aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPg0KICA8aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPg0KICA8aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPg0KICA8aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPg0KICA8aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPg0KICA8aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPg0KICA8aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPg0KICA8aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPg0KICA8aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPg0KICA8aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPg0KICA8aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPg0KICA8aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPg0KICA8aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPg0KICA8aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPg0KICA8aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPg0KICA8aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPg0KICA8aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPg0KICA8aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPg0KICA8aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPg0KICA8aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPg0KICA8aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPg0KICA8aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPg0KICA8aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPg0KICA8aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPg0KICA8aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPg0KICA8aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPg0KICA8aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPg0KICA8aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPg0KICA8aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPg0KICA8aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPg0KICA8aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPg0KICA8aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPg0KICA8aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPg0KICA8aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPg0KICA8aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPg0KICA8aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPg0KICA8aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPg0KICA8aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPg0KPC9mb3JMb29wVGVtcGxhdGU+\"/>\n            <L7p:ContentType stringValue=\"text/xml; charset=utf-8\"/>\n            <L7p:DataType variableDataType=\"message\"/>\n            <L7p:VariableToSet stringValue=\"forLoop.template\"/>\n        </L7p:SetVariable>\n        <L7p:ResponseXpathAssertion>\n            <L7p:AssertionComment assertionComment=\"included\">\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Create ${forLoop.results} for looping up to 1000 times\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:AssertionComment>\n            <L7p:VariablePrefix stringValue=\"forLoop\"/>\n            <L7p:XmlMsgSrc stringValue=\"forLoop.template\"/>\n            <L7p:XpathExpression xpathExpressionValue=\"included\">\n                <L7p:Expression stringValue=\"/forLoopTemplate/i\"/>\n                <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n            </L7p:XpathExpression>\n        </L7p:ResponseXpathAssertion>\n        <wsp:OneOrMore wsp:Usage=\"Required\">\n            <wsp:All wsp:Usage=\"Required\">\n                <L7p:ComparisonAssertion>\n                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                    <L7p:Expression1 stringValue=\"${refresh}\"/>\n                    <L7p:Operator operatorNull=\"null\"/>\n                    <L7p:Predicates predicates=\"included\">\n                        <L7p:item dataType=\"included\">\n                            <L7p:Type variableDataType=\"string\"/>\n                        </L7p:item>\n                        <L7p:item binary=\"included\">\n                            <L7p:Negated booleanValue=\"true\"/>\n                            <L7p:RightValue stringValue=\"true\"/>\n                        </L7p:item>\n                    </L7p:Predicates>\n                </L7p:ComparisonAssertion>\n                <L7p:CacheLookup>\n                    <L7p:CacheEntryKey stringValue=\"${cacheKey}\"/>\n                    <L7p:CacheId stringValue=\"folderList\"/>\n                    <L7p:ContentTypeOverride stringValue=\"\"/>\n                    <L7p:MaxEntryAgeSeconds stringValue=\"${cacheAge}\"/>\n                    <L7p:OtherTargetMessageVariable stringValue=\"folders.sorted\"/>\n                    <L7p:Target target=\"OTHER\"/>\n                </L7p:CacheLookup>\n                <L7p:ResponseXpathAssertion>\n                    <L7p:VariablePrefix stringValue=\"rootId\"/>\n                    <L7p:XmlMsgSrc stringValue=\"folders.sorted\"/>\n                    <L7p:XpathExpression xpathExpressionValue=\"included\">\n                        <L7p:Expression stringValue=\"/Folders/@rootId\"/>\n                        <L7p:Namespaces mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"s\"/>\n                                <L7p:value stringValue=\"http://schemas.xmlsoap.org/soap/envelope/\"/>\n                            </L7p:entry>\n                        </L7p:Namespaces>\n                        <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                    </L7p:XpathExpression>\n                </L7p:ResponseXpathAssertion>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"Y2FjaGU=\"/>\n                    <L7p:VariableToSet stringValue=\"source\"/>\n                </L7p:SetVariable>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"JHtyb290SWQucmVzdWx0fQ==\"/>\n                    <L7p:VariableToSet stringValue=\"folders.rootId\"/>\n                </L7p:SetVariable>\n                <L7p:AuditDetailAssertion>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// FINE\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Detail stringValue=\"==> Found folders.sorted in the cache\"/>\n                    <L7p:Level stringValue=\"FINE\"/>\n                </L7p:AuditDetailAssertion>\n                <L7p:assertionComment>\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// Look in cache unless asked to refresh cache\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:assertionComment>\n            </wsp:All>\n            <wsp:All wsp:Usage=\"Required\">\n                <L7p:Encapsulated>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// GET folders\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:EncapsulatedAssertionConfigGuid stringValue=\"c8a5a0d5-1ae2-4144-b538-5c311efc1560\"/>\n                    <L7p:EncapsulatedAssertionConfigName stringValue=\"Utility: Call Restman\"/>\n                    <L7p:Parameters mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"element\"/>\n                            <L7p:value stringValue=\"Folder\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"message\"/>\n                            <L7p:value stringValue=\"\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"method\"/>\n                            <L7p:value stringValue=\"GET\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"resource\"/>\n                            <L7p:value stringValue=\"folders\"/>\n                        </L7p:entry>\n                    </L7p:Parameters>\n                </L7p:Encapsulated>\n                <L7p:ResponseXpathAssertion>\n                    <L7p:VariablePrefix stringValue=\"folders\"/>\n                    <L7p:XpathExpression xpathExpressionValue=\"included\">\n                        <L7p:Expression stringValue=\"/l7:List/l7:Item[l7:Type='FOLDER']/l7:Resource/l7:Folder\"/>\n                        <L7p:Namespaces mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"l7\"/>\n                                <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                            </L7p:entry>\n                        </L7p:Namespaces>\n                        <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                    </L7p:XpathExpression>\n                </L7p:ResponseXpathAssertion>\n                <L7p:ForEachLoop L7p:Usage=\"Required\"\n                    loopVariable=\"folders.elements\" variablePrefix=\"folder.getroot\">\n                    <L7p:SetVariable>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Cast to message type for parsing\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:Base64Expression stringValue=\"JHtmb2xkZXIuZ2V0cm9vdC5jdXJyZW50fQ==\"/>\n                        <L7p:ContentType stringValue=\"text/xml; charset=utf-8\"/>\n                        <L7p:DataType variableDataType=\"message\"/>\n                        <L7p:VariableToSet stringValue=\"folder.xml\"/>\n                    </L7p:SetVariable>\n                    <wsp:OneOrMore wsp:Usage=\"Required\">\n                        <L7p:ResponseXpathAssertion>\n                            <L7p:VariablePrefix stringValue=\"\"/>\n                            <L7p:XmlMsgSrc stringValue=\"folder.xml\"/>\n                            <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                <L7p:Expression stringValue=\"/l7:Folder/@folderId\"/>\n                                <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                    </L7p:entry>\n                                </L7p:Namespaces>\n                                <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                            </L7p:XpathExpression>\n                        </L7p:ResponseXpathAssertion>\n                        <wsp:All wsp:Usage=\"Required\">\n                            <L7p:ResponseXpathAssertion>\n                                <L7p:VariablePrefix stringValue=\"rootId\"/>\n                                <L7p:XmlMsgSrc stringValue=\"folder.xml\"/>\n                                <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                    <L7p:Expression stringValue=\"/l7:Folder/@id\"/>\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                                </L7p:XpathExpression>\n                            </L7p:ResponseXpathAssertion>\n                            <L7p:SetVariable>\n                                <L7p:Base64Expression stringValue=\"JHtyb290SWQucmVzdWx0fQ==\"/>\n                                <L7p:VariableToSet stringValue=\"folders.rootId\"/>\n                            </L7p:SetVariable>\n                            <L7p:SetVariable>\n                                <L7p:Base64Expression stringValue=\"dHJ1ZQ==\"/>\n                                <L7p:VariableToSet stringValue=\"folder.getroot.break\"/>\n                            </L7p:SetVariable>\n                            <L7p:assertionComment>\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Set ${folders.rootId}\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:assertionComment>\n                        </wsp:All>\n                        <L7p:assertionComment>\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// If we find @folderId then this is not the root node, else assign and break\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:assertionComment>\n                    </wsp:OneOrMore>\n                    <L7p:assertionComment>\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// Determine ID of root node -> ${rootId}\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:assertionComment>\n                </L7p:ForEachLoop>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz48Rm9sZGVycz4=\"/>\n                    <L7p:VariableToSet stringValue=\"folders.sorted\"/>\n                </L7p:SetVariable>\n                <L7p:ForEachLoop L7p:Usage=\"Required\"\n                    loopVariable=\"folders.elements\" variablePrefix=\"folder\">\n                    <L7p:SetVariable>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Cast to message type for parsing\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:Base64Expression stringValue=\"JHtmb2xkZXIuY3VycmVudH0=\"/>\n                        <L7p:ContentType stringValue=\"text/xml; charset=utf-8\"/>\n                        <L7p:DataType variableDataType=\"message\"/>\n                        <L7p:VariableToSet stringValue=\"folder.xml\"/>\n                    </L7p:SetVariable>\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// retrieve the folder name\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:VariablePrefix stringValue=\"name\"/>\n                        <L7p:XmlMsgSrc stringValue=\"folder.xml\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/l7:Folder/l7:Name\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Retrieve the folder ID\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:VariablePrefix stringValue=\"id\"/>\n                        <L7p:XmlMsgSrc stringValue=\"folder.xml\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/l7:Folder/@id\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <wsp:OneOrMore wsp:Usage=\"Required\">\n                        <L7p:ComparisonAssertion>\n                            <L7p:AssertionComment assertionComment=\"included\">\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Root node is always &lt; 0\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:AssertionComment>\n                            <L7p:CaseSensitive booleanValue=\"false\"/>\n                            <L7p:Expression1 stringValue=\"${id.result}\"/>\n                            <L7p:Expression2 stringValue=\"${folders.rootId}\"/>\n                            <L7p:Negate booleanValue=\"true\"/>\n                            <L7p:Predicates predicates=\"included\">\n                                <L7p:item binary=\"included\">\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:Negated booleanValue=\"true\"/>\n                                    <L7p:RightValue stringValue=\"${folders.rootId}\"/>\n                                </L7p:item>\n                            </L7p:Predicates>\n                        </L7p:ComparisonAssertion>\n                        <L7p:SetVariable>\n                            <L7p:Base64Expression stringValue=\"\"/>\n                            <L7p:VariableToSet stringValue=\"name.result\"/>\n                        </L7p:SetVariable>\n                        <L7p:assertionComment>\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Handle Root Node\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:assertionComment>\n                    </wsp:OneOrMore>\n                    <wsp:OneOrMore wsp:Usage=\"Required\">\n                        <L7p:ResponseXpathAssertion>\n                            <L7p:AssertionComment assertionComment=\"included\">\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Retrieve the parent folder ID\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:AssertionComment>\n                            <L7p:VariablePrefix stringValue=\"folderId\"/>\n                            <L7p:XmlMsgSrc stringValue=\"folder.xml\"/>\n                            <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                <L7p:Expression stringValue=\"/l7:Folder/@folderId\"/>\n                                <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                    </L7p:entry>\n                                </L7p:Namespaces>\n                                <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                            </L7p:XpathExpression>\n                        </L7p:ResponseXpathAssertion>\n                        <L7p:SetVariable>\n                            <L7p:Base64Expression stringValue=\"\"/>\n                            <L7p:VariableToSet stringValue=\"folderId.result\"/>\n                        </L7p:SetVariable>\n                        <L7p:assertionComment>\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Extract folderId to get parent, set to empty if not founf (i.e. root folder)\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:assertionComment>\n                    </wsp:OneOrMore>\n                    <L7p:CommentAssertion>\n                        <L7p:Comment stringValue=\"** Build out the folder path.\"/>\n                    </L7p:CommentAssertion>\n                    <wsp:All wsp:Usage=\"Required\">\n                        <L7p:CommentAssertion>\n                            <L7p:Comment stringValue=\"*********************************************************************************************\"/>\n                        </L7p:CommentAssertion>\n                        <L7p:CommentAssertion>\n                            <L7p:Comment stringValue=\"** Each folder's definition only indicates it own ID and the ID of its parent folder. To build out\"/>\n                        </L7p:CommentAssertion>\n                        <L7p:CommentAssertion>\n                            <L7p:Comment stringValue=\"**   the full path we must iterate back from the folder to the root. This is done by setting up an\"/>\n                        </L7p:CommentAssertion>\n                        <L7p:CommentAssertion>\n                            <L7p:Comment stringValue=\"**   arbitrarily long loop condition (using the ${forLoop.template} variable) and use recursion to\"/>\n                        </L7p:CommentAssertion>\n                        <L7p:CommentAssertion>\n                            <L7p:Comment stringValue=\"**   work back to the root, pulling the parent folder from the response and\"/>\n                        </L7p:CommentAssertion>\n                        <L7p:CommentAssertion>\n                            <L7p:Comment stringValue=\"**   prepending the folder name to the path each time. We take advantage of the fact that the\"/>\n                        </L7p:CommentAssertion>\n                        <L7p:CommentAssertion>\n                            <L7p:Comment stringValue=\"**   root node does not have a parent folder declared so the XPath will fail when it is reached,\"/>\n                        </L7p:CommentAssertion>\n                        <L7p:CommentAssertion>\n                            <L7p:Comment stringValue=\"**   thus terminating the Run Assertion for Each item loop. By wrapping that in an At Least One\"/>\n                        </L7p:CommentAssertion>\n                        <L7p:CommentAssertion>\n                            <L7p:Comment stringValue=\"**   folder we ensure success by appending the folder itself to the path.\"/>\n                        </L7p:CommentAssertion>\n                        <L7p:CommentAssertion>\n                            <L7p:Comment stringValue=\"** \"/>\n                        </L7p:CommentAssertion>\n                        <L7p:CommentAssertion>\n                            <L7p:Comment stringValue=\"** Note that the Root Node has to be handled explicitly when encountered.\"/>\n                        </L7p:CommentAssertion>\n                        <L7p:CommentAssertion>\n                            <L7p:Comment stringValue=\"** \"/>\n                        </L7p:CommentAssertion>\n                        <L7p:CommentAssertion>\n                            <L7p:Comment stringValue=\"**                         Easy Peasy, eh?\"/>\n                        </L7p:CommentAssertion>\n                        <L7p:CommentAssertion>\n                            <L7p:Comment stringValue=\"*********************************************************************************************\"/>\n                        </L7p:CommentAssertion>\n                        <L7p:assertionComment>\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Comment block to describe how paths are built\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:assertionComment>\n                    </wsp:All>\n                    <L7p:SetVariable>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Initialize the path variable to empty\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:Base64Expression stringValue=\"\"/>\n                        <L7p:VariableToSet stringValue=\"path\"/>\n                    </L7p:SetVariable>\n                    <L7p:SetVariable>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Initialize the path variable to empty\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:Base64Expression stringValue=\"JHtpZC5yZXN1bHR9\"/>\n                        <L7p:VariableToSet stringValue=\"idPath\"/>\n                    </L7p:SetVariable>\n                    <L7p:SetVariable>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Set a starting point for the iteration\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:Base64Expression stringValue=\"JHtmb2xkZXIueG1sLm1haW5wYXJ0fQ==\"/>\n                        <L7p:ContentType stringValue=\"text/xml; charset=utf-8\"/>\n                        <L7p:DataType variableDataType=\"message\"/>\n                        <L7p:VariableToSet stringValue=\"this.folder\"/>\n                    </L7p:SetVariable>\n                    <wsp:OneOrMore wsp:Usage=\"Required\">\n                        <L7p:ForEachLoop L7p:Usage=\"Required\"\n                            loopVariable=\"forLoop.results\" variablePrefix=\"i\">\n                            <L7p:ResponseXpathAssertion>\n                                <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Retrieve the folder's parent ID\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:AssertionComment>\n                                <L7p:VariablePrefix stringValue=\"parentId\"/>\n                                <L7p:XmlMsgSrc stringValue=\"this.folder\"/>\n                                <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                    <L7p:Expression stringValue=\"/l7:Folder/@folderId\"/>\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                                </L7p:XpathExpression>\n                            </L7p:ResponseXpathAssertion>\n                            <L7p:ResponseXpathAssertion>\n                                <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Get the parent folder from the Response\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:AssertionComment>\n                                <L7p:VariablePrefix stringValue=\"parentFolder\"/>\n                                <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                    <L7p:Expression stringValue=\"/l7:List/l7:Item/l7:Resource/l7:Folder[@id=$parentId.result]\"/>\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                                </L7p:XpathExpression>\n                            </L7p:ResponseXpathAssertion>\n                            <L7p:SetVariable>\n                                <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Cast as a message type\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:AssertionComment>\n                                <L7p:Base64Expression stringValue=\"JHtwYXJlbnRGb2xkZXIuZWxlbWVudH0=\"/>\n                                <L7p:ContentType stringValue=\"text/xml; charset=utf-8\"/>\n                                <L7p:DataType variableDataType=\"message\"/>\n                                <L7p:VariableToSet stringValue=\"this.folder\"/>\n                            </L7p:SetVariable>\n                            <L7p:ResponseXpathAssertion>\n                                <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// retrieve the folder name\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:AssertionComment>\n                                <L7p:VariablePrefix stringValue=\"parentName\"/>\n                                <L7p:XmlMsgSrc stringValue=\"this.folder\"/>\n                                <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                    <L7p:Expression stringValue=\"/l7:Folder/l7:Name\"/>\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                                </L7p:XpathExpression>\n                            </L7p:ResponseXpathAssertion>\n                            <wsp:OneOrMore wsp:Usage=\"Required\">\n                                <L7p:ComparisonAssertion>\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:Expression1 stringValue=\"${parentId.result}\"/>\n                                    <L7p:Expression2 stringValue=\"${folders.rootId}\"/>\n                                    <L7p:Negate booleanValue=\"true\"/>\n                                    <L7p:Predicates predicates=\"included\">\n                                    <L7p:item binary=\"included\">\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:Negated booleanValue=\"true\"/>\n                                    <L7p:RightValue stringValue=\"${folders.rootId}\"/>\n                                    </L7p:item>\n                                    </L7p:Predicates>\n                                </L7p:ComparisonAssertion>\n                                <wsp:All wsp:Usage=\"Required\">\n                                    <L7p:SetVariable>\n                                    <L7p:Base64Expression stringValue=\"\"/>\n                                    <L7p:VariableToSet stringValue=\"parentName.result\"/>\n                                    </L7p:SetVariable>\n                                    <L7p:SetVariable>\n                                    <L7p:Base64Expression stringValue=\"\"/>\n                                    <L7p:VariableToSet stringValue=\"parentId.result\"/>\n                                    </L7p:SetVariable>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Blank out ${parentName.result} and ${parentId.result}\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                </wsp:All>\n                                <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Handle Root Node\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:assertionComment>\n                            </wsp:OneOrMore>\n                            <L7p:SetVariable>\n                                <L7p:Base64Expression stringValue=\"JHtwYXJlbnRJZC5yZXN1bHR9LyR7aWRQYXRofQ==\"/>\n                                <L7p:VariableToSet stringValue=\"idPath\"/>\n                            </L7p:SetVariable>\n                            <L7p:SetVariable>\n                                <L7p:Base64Expression stringValue=\"JHtwYXJlbnROYW1lLnJlc3VsdH0vJHtwYXRofQ==\"/>\n                                <L7p:VariableToSet stringValue=\"path\"/>\n                            </L7p:SetVariable>\n                            <L7p:assertionComment>\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// ${forLoop.result} was set earlier\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:assertionComment>\n                        </L7p:ForEachLoop>\n                        <L7p:SetVariable>\n                            <L7p:AssertionComment assertionComment=\"included\">\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Append the folder name to the path\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:AssertionComment>\n                            <L7p:Base64Expression stringValue=\"JHtwYXRofSR7bmFtZS5yZXN1bHR9Lw==\"/>\n                            <L7p:VariableToSet stringValue=\"path\"/>\n                        </L7p:SetVariable>\n                        <L7p:assertionComment>\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// The Run for Each will always fail once the root folder is encountered, at which point append the folder name\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:assertionComment>\n                    </wsp:OneOrMore>\n                    <L7p:SetVariable>\n                        <L7p:Base64Expression stringValue=\"JHtmb2xkZXJzLnNvcnRlZH08Rm9sZGVyIGlkPSIke2lkLnJlc3VsdH0iIGZvbGRlcklkPSIke2ZvbGRlcklkLnJlc3VsdH0iPjxOYW1lPjwhW0NEQVRBWyR7bmFtZS5yZXN1bHR9XV0+PC9OYW1lPjxGb2xkZXJQYXRoPjwhW0NEQVRBWyR7cGF0aH1dXT48L0ZvbGRlclBhdGg+PElkUGF0aD4ke2lkUGF0aH08L0lkUGF0aD48L0ZvbGRlcj4=\"/>\n                        <L7p:VariableToSet stringValue=\"folders.sorted\"/>\n                    </L7p:SetVariable>\n                    <L7p:assertionComment>\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// Build the list of folders\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:assertionComment>\n                </L7p:ForEachLoop>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"JHtmb2xkZXJzLnNvcnRlZH08L0ZvbGRlcnM+\"/>\n                    <L7p:ContentType stringValue=\"text/xml; charset=utf-8\"/>\n                    <L7p:DataType variableDataType=\"message\"/>\n                    <L7p:VariableToSet stringValue=\"folders.sorted\"/>\n                </L7p:SetVariable>\n                <L7p:XslTransformation>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// Sort the folders by name\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Direction intValue=\"-1\"/>\n                    <L7p:OtherTargetMessageVariable stringValue=\"folders.sorted\"/>\n                    <L7p:ResourceInfo staticResourceInfo=\"included\">\n                        <L7p:Document stringValue=\"&lt;xsl:stylesheet version=&quot;1.0&quot; xmlns:l7=&quot;http://ns.l7tech.com/2010/04/gateway-management&quot; xmlns:xsl=&quot;http://www.w3.org/1999/XSL/Transform&quot;>&lt;xsl:template match=&quot;/Folders&quot;>    &lt;xsl:copy>        &lt;xsl:for-each select=&quot;Folder&quot;>            &lt;xsl:sort select=&quot;./FolderPath&quot;/>            &lt;xsl:sort select=&quot;./Name&quot;/>            &lt;xsl:copy-of select=&quot;.&quot;/>        &lt;/xsl:for-each>    &lt;/xsl:copy>&lt;/xsl:template>&lt;/xsl:stylesheet>\"/>\n                    </L7p:ResourceInfo>\n                    <L7p:Target target=\"OTHER\"/>\n                    <L7p:TransformName stringValue=\"\"/>\n                    <L7p:XsltVersion stringValue=\"1.0\"/>\n                </L7p:XslTransformation>\n                <L7p:Regex>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// Add rootId attribute to /Folders element\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:AutoTarget booleanValue=\"false\"/>\n                    <L7p:OtherTargetMessageVariable stringValue=\"folders.sorted\"/>\n                    <L7p:Regex stringValue=\"&lt;Folders>\"/>\n                    <L7p:Replace booleanValue=\"true\"/>\n                    <L7p:Replacement stringValue=\"&lt;Folders rootId=&quot;${folders.rootId}&quot;>\"/>\n                    <L7p:Target target=\"OTHER\"/>\n                </L7p:Regex>\n                <L7p:CacheStorage>\n                    <L7p:CacheEntryKey stringValue=\"${cacheKey}\"/>\n                    <L7p:CacheId stringValue=\"folderList\"/>\n                    <L7p:MaxEntries stringValue=\"1\"/>\n                    <L7p:MaxEntryAgeSeconds stringValue=\"${cacheAge}\"/>\n                    <L7p:MaxEntrySizeBytes stringValue=\"200000\"/>\n                    <L7p:OtherTargetMessageVariable stringValue=\"folders.sorted\"/>\n                    <L7p:StoreSoapFaults booleanValue=\"true\"/>\n                    <L7p:Target target=\"OTHER\"/>\n                </L7p:CacheStorage>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"c3lzdGVt\"/>\n                    <L7p:VariableToSet stringValue=\"source\"/>\n                </L7p:SetVariable>\n                <L7p:AuditDetailAssertion>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// FINE\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Detail stringValue=\"==> Loaded folders.sorted from system and stored to cache\"/>\n                    <L7p:Level stringValue=\"FINE\"/>\n                </L7p:AuditDetailAssertion>\n                <L7p:assertionComment>\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// Retrieve new list and cache\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:assertionComment>\n            </wsp:All>\n            <wsp:All wsp:Usage=\"Required\">\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"RXJyb3Igd2hlbiBsaXN0aW5nIGZvbGRlcnM=\"/>\n                    <L7p:VariableToSet stringValue=\"error.msg\"/>\n                </L7p:SetVariable>\n                <L7p:AuditDetailAssertion>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// WARNING\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Detail stringValue=\"==> Error listing folders in ${policy.name}\"/>\n                    <L7p:Level stringValue=\"WARNING\"/>\n                </L7p:AuditDetailAssertion>\n                <L7p:FalseAssertion/>\n                <L7p:assertionComment>\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// Failure - set ${error.msg}\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:assertionComment>\n            </wsp:All>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Caching logic\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:OneOrMore>\n        <L7p:Regex>\n            <L7p:AssertionComment assertionComment=\"included\">\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Add source attribute to /Folders element\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:AssertionComment>\n            <L7p:AutoTarget booleanValue=\"false\"/>\n            <L7p:OtherTargetMessageVariable stringValue=\"folders.sorted\"/>\n            <L7p:Regex stringValue=\"&lt;Folders rootId\"/>\n            <L7p:Replace booleanValue=\"true\"/>\n            <L7p:Replacement stringValue=\"&lt;Folders source=&quot;${source}&quot; rootId\"/>\n            <L7p:Target target=\"OTHER\"/>\n        </L7p:Regex>\n        <L7p:AuditDetailAssertion>\n            <L7p:AssertionComment assertionComment=\"included\">\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// FINE\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:AssertionComment>\n            <L7p:Detail stringValue=\"==> Leaving Utility Fragment: ${policy.name}\"/>\n            <L7p:Level stringValue=\"FINE\"/>\n        </L7p:AuditDetailAssertion>\n    </wsp:All>\n</wsp:Policy>\n"
      },
      "policyRevisions": [
        {
          "goid": "bed4baf4ff33b7e528854c3965d9bb30",
          "ordinal": 1,
          "active": true,
          "author": "admin",
          "time": "2025-02-05T14:20:38.464Z",
          "xml": "<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<wsp:Policy xmlns:L7p=\"http://www.layer7tech.com/ws/policy\" xmlns:wsp=\"http://schemas.xmlsoap.org/ws/2002/12/policy\">\n    <wsp:All wsp:Usage=\"Required\">\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Policy fragment for &quot;Utility: List Folders&quot; encapsulated assertion\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Call Restman and generate a sorted list of folders\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** - Assumes an admin role user has been authenticated\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** - Caches results for ${cacheAge} seconds (default=300). To refresh the cache set ${refresh}=true when calling\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** - Returns a text/xml message variable in ${folders.sorted}\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Inputs:\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - refresh (string)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - cacheAge (string)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Outputs:\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - folders.sorted (message)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - error.msg (string)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** v1.0.0 - Jay MacDonald - 20201107 - Initial Version\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n        </L7p:CommentAssertion>\n        <L7p:AuditDetailAssertion>\n            <L7p:AssertionComment assertionComment=\"included\">\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// FINE\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:AssertionComment>\n            <L7p:Detail stringValue=\"==> Entering Utility Fragment: ${policy.name} (refresh=${refresh})\"/>\n            <L7p:Level stringValue=\"FINE\"/>\n        </L7p:AuditDetailAssertion>\n        <wsp:All wsp:Usage=\"Required\">\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** ${folders.sorted} has the following schema:\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** \"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** &lt;Folders source=&quot;system|cache&quot; rootId=&quot;string&quot;>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   &lt;Folder id=&quot;string&quot; folderId=&quot;string&quot;>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**     &lt;Name>string&lt;/Name>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**     &lt;FolderPath>string&lt;/FolderPath>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**     &lt;IdPath>string&lt;/IdPath>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   &lt;/Folder>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   ...\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** &lt;/Folders>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** \"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** Where:\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   Name = the name of the folder (i.e. no path)\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   FolderPath = the path to the folder without the folder's name\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   IdPath = the path to this folder expressed as folder ids\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   FullPath = the path to the folder with the folder's name\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** \"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** Content of folder element is the full path to the folder\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n            </L7p:CommentAssertion>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Description of ${folders.sorted}\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:All>\n        <wsp:OneOrMore wsp:Usage=\"Required\">\n            <L7p:ComparisonAssertion>\n                <L7p:AssertionComment assertionComment=\"included\">\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// true or false\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:AssertionComment>\n                <L7p:CaseSensitive booleanValue=\"false\"/>\n                <L7p:Expression1 stringValue=\"${cacheAge}\"/>\n                <L7p:Operator operatorNull=\"null\"/>\n                <L7p:Predicates predicates=\"included\">\n                    <L7p:item dataType=\"included\">\n                        <L7p:Type variableDataType=\"int\"/>\n                    </L7p:item>\n                    <L7p:item binary=\"included\">\n                        <L7p:CaseSensitive booleanValue=\"false\"/>\n                        <L7p:Operator operator=\"GT\"/>\n                        <L7p:RightValue stringValue=\"0\"/>\n                    </L7p:item>\n                </L7p:Predicates>\n            </L7p:ComparisonAssertion>\n            <L7p:SetVariable>\n                <L7p:Base64Expression stringValue=\"MzAw\"/>\n                <L7p:DataType variableDataType=\"int\"/>\n                <L7p:VariableToSet stringValue=\"cacheAge\"/>\n            </L7p:SetVariable>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Ensure ${cacheAge} is set, default=300\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:OneOrMore>\n        <wsp:OneOrMore wsp:Usage=\"Required\">\n            <L7p:ComparisonAssertion>\n                <L7p:AssertionComment assertionComment=\"included\">\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// true or false\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:AssertionComment>\n                <L7p:CaseSensitive booleanValue=\"false\"/>\n                <L7p:Expression1 stringValue=\"${refresh}\"/>\n                <L7p:Operator operatorNull=\"null\"/>\n                <L7p:Predicates predicates=\"included\">\n                    <L7p:item dataType=\"included\">\n                        <L7p:Type variableDataType=\"string\"/>\n                    </L7p:item>\n                    <L7p:item regex=\"included\">\n                        <L7p:Pattern stringValue=\"^(true|false)$\"/>\n                    </L7p:item>\n                </L7p:Predicates>\n            </L7p:ComparisonAssertion>\n            <L7p:SetVariable>\n                <L7p:Base64Expression stringValue=\"ZmFsc2U=\"/>\n                <L7p:VariableToSet stringValue=\"refresh\"/>\n            </L7p:SetVariable>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Ensure ${refresh} is set, default=false\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:OneOrMore>\n        <L7p:SetVariable>\n            <L7p:Base64Expression stringValue=\"Zm9sZGVycy5zb3J0ZWQ=\"/>\n            <L7p:VariableToSet stringValue=\"cacheKey\"/>\n        </L7p:SetVariable>\n        <L7p:SetVariable>\n            <L7p:Base64Expression stringValue=\"PCEtLSBUZW1wbGF0ZSBvZiAxMDAwIGluZGV4ZXMgdG8gY3JlYXRlIGEgZm9yIGxvb3AgLS0+DQo8Zm9yTG9vcFRlbXBsYXRlPg0KICA8aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPg0KICA8aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPg0KICA8aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPg0KICA8aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPg0KICA8aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPg0KICA8aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPg0KICA8aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPg0KICA8aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPg0KICA8aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPg0KICA8aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPg0KICA8aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPg0KICA8aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPg0KICA8aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPg0KICA8aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPg0KICA8aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPg0KICA8aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPg0KICA8aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPg0KICA8aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPg0KICA8aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPg0KICA8aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPg0KICA8aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPg0KICA8aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPg0KICA8aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPg0KICA8aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPg0KICA8aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPg0KICA8aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPg0KICA8aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPg0KICA8aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPg0KICA8aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPg0KICA8aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPg0KICA8aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPg0KICA8aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPg0KICA8aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPg0KICA8aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPg0KICA8aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPg0KICA8aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPg0KICA8aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPg0KICA8aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPg0KICA8aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPg0KICA8aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPg0KICA8aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPg0KICA8aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPg0KICA8aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPg0KICA8aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPg0KICA8aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPg0KICA8aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPg0KICA8aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPg0KICA8aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPg0KICA8aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPg0KICA8aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPjxpLz48aS8+PGkvPg0KPC9mb3JMb29wVGVtcGxhdGU+\"/>\n            <L7p:ContentType stringValue=\"text/xml; charset=utf-8\"/>\n            <L7p:DataType variableDataType=\"message\"/>\n            <L7p:VariableToSet stringValue=\"forLoop.template\"/>\n        </L7p:SetVariable>\n        <L7p:ResponseXpathAssertion>\n            <L7p:AssertionComment assertionComment=\"included\">\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Create ${forLoop.results} for looping up to 1000 times\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:AssertionComment>\n            <L7p:VariablePrefix stringValue=\"forLoop\"/>\n            <L7p:XmlMsgSrc stringValue=\"forLoop.template\"/>\n            <L7p:XpathExpression xpathExpressionValue=\"included\">\n                <L7p:Expression stringValue=\"/forLoopTemplate/i\"/>\n                <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n            </L7p:XpathExpression>\n        </L7p:ResponseXpathAssertion>\n        <wsp:OneOrMore wsp:Usage=\"Required\">\n            <wsp:All wsp:Usage=\"Required\">\n                <L7p:ComparisonAssertion>\n                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                    <L7p:Expression1 stringValue=\"${refresh}\"/>\n                    <L7p:Operator operatorNull=\"null\"/>\n                    <L7p:Predicates predicates=\"included\">\n                        <L7p:item dataType=\"included\">\n                            <L7p:Type variableDataType=\"string\"/>\n                        </L7p:item>\n                        <L7p:item binary=\"included\">\n                            <L7p:Negated booleanValue=\"true\"/>\n                            <L7p:RightValue stringValue=\"true\"/>\n                        </L7p:item>\n                    </L7p:Predicates>\n                </L7p:ComparisonAssertion>\n                <L7p:CacheLookup>\n                    <L7p:CacheEntryKey stringValue=\"${cacheKey}\"/>\n                    <L7p:CacheId stringValue=\"folderList\"/>\n                    <L7p:ContentTypeOverride stringValue=\"\"/>\n                    <L7p:MaxEntryAgeSeconds stringValue=\"${cacheAge}\"/>\n                    <L7p:OtherTargetMessageVariable stringValue=\"folders.sorted\"/>\n                    <L7p:Target target=\"OTHER\"/>\n                </L7p:CacheLookup>\n                <L7p:ResponseXpathAssertion>\n                    <L7p:VariablePrefix stringValue=\"rootId\"/>\n                    <L7p:XmlMsgSrc stringValue=\"folders.sorted\"/>\n                    <L7p:XpathExpression xpathExpressionValue=\"included\">\n                        <L7p:Expression stringValue=\"/Folders/@rootId\"/>\n                        <L7p:Namespaces mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"s\"/>\n                                <L7p:value stringValue=\"http://schemas.xmlsoap.org/soap/envelope/\"/>\n                            </L7p:entry>\n                        </L7p:Namespaces>\n                        <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                    </L7p:XpathExpression>\n                </L7p:ResponseXpathAssertion>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"Y2FjaGU=\"/>\n                    <L7p:VariableToSet stringValue=\"source\"/>\n                </L7p:SetVariable>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"JHtyb290SWQucmVzdWx0fQ==\"/>\n                    <L7p:VariableToSet stringValue=\"folders.rootId\"/>\n                </L7p:SetVariable>\n                <L7p:AuditDetailAssertion>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// FINE\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Detail stringValue=\"==> Found folders.sorted in the cache\"/>\n                    <L7p:Level stringValue=\"FINE\"/>\n                </L7p:AuditDetailAssertion>\n                <L7p:assertionComment>\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// Look in cache unless asked to refresh cache\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:assertionComment>\n            </wsp:All>\n            <wsp:All wsp:Usage=\"Required\">\n                <L7p:Encapsulated>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// GET folders\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:EncapsulatedAssertionConfigGuid stringValue=\"c8a5a0d5-1ae2-4144-b538-5c311efc1560\"/>\n                    <L7p:EncapsulatedAssertionConfigName stringValue=\"Utility: Call Restman\"/>\n                    <L7p:Parameters mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"element\"/>\n                            <L7p:value stringValue=\"Folder\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"message\"/>\n                            <L7p:value stringValue=\"\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"method\"/>\n                            <L7p:value stringValue=\"GET\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"resource\"/>\n                            <L7p:value stringValue=\"folders\"/>\n                        </L7p:entry>\n                    </L7p:Parameters>\n                </L7p:Encapsulated>\n                <L7p:ResponseXpathAssertion>\n                    <L7p:VariablePrefix stringValue=\"folders\"/>\n                    <L7p:XpathExpression xpathExpressionValue=\"included\">\n                        <L7p:Expression stringValue=\"/l7:List/l7:Item[l7:Type='FOLDER']/l7:Resource/l7:Folder\"/>\n                        <L7p:Namespaces mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"l7\"/>\n                                <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                            </L7p:entry>\n                        </L7p:Namespaces>\n                        <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                    </L7p:XpathExpression>\n                </L7p:ResponseXpathAssertion>\n                <L7p:ForEachLoop L7p:Usage=\"Required\"\n                    loopVariable=\"folders.elements\" variablePrefix=\"folder.getroot\">\n                    <L7p:SetVariable>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Cast to message type for parsing\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:Base64Expression stringValue=\"JHtmb2xkZXIuZ2V0cm9vdC5jdXJyZW50fQ==\"/>\n                        <L7p:ContentType stringValue=\"text/xml; charset=utf-8\"/>\n                        <L7p:DataType variableDataType=\"message\"/>\n                        <L7p:VariableToSet stringValue=\"folder.xml\"/>\n                    </L7p:SetVariable>\n                    <wsp:OneOrMore wsp:Usage=\"Required\">\n                        <L7p:ResponseXpathAssertion>\n                            <L7p:VariablePrefix stringValue=\"\"/>\n                            <L7p:XmlMsgSrc stringValue=\"folder.xml\"/>\n                            <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                <L7p:Expression stringValue=\"/l7:Folder/@folderId\"/>\n                                <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                    </L7p:entry>\n                                </L7p:Namespaces>\n                                <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                            </L7p:XpathExpression>\n                        </L7p:ResponseXpathAssertion>\n                        <wsp:All wsp:Usage=\"Required\">\n                            <L7p:ResponseXpathAssertion>\n                                <L7p:VariablePrefix stringValue=\"rootId\"/>\n                                <L7p:XmlMsgSrc stringValue=\"folder.xml\"/>\n                                <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                    <L7p:Expression stringValue=\"/l7:Folder/@id\"/>\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                                </L7p:XpathExpression>\n                            </L7p:ResponseXpathAssertion>\n                            <L7p:SetVariable>\n                                <L7p:Base64Expression stringValue=\"JHtyb290SWQucmVzdWx0fQ==\"/>\n                                <L7p:VariableToSet stringValue=\"folders.rootId\"/>\n                            </L7p:SetVariable>\n                            <L7p:SetVariable>\n                                <L7p:Base64Expression stringValue=\"dHJ1ZQ==\"/>\n                                <L7p:VariableToSet stringValue=\"folder.getroot.break\"/>\n                            </L7p:SetVariable>\n                            <L7p:assertionComment>\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Set ${folders.rootId}\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:assertionComment>\n                        </wsp:All>\n                        <L7p:assertionComment>\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// If we find @folderId then this is not the root node, else assign and break\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:assertionComment>\n                    </wsp:OneOrMore>\n                    <L7p:assertionComment>\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// Determine ID of root node -> ${rootId}\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:assertionComment>\n                </L7p:ForEachLoop>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz48Rm9sZGVycz4=\"/>\n                    <L7p:VariableToSet stringValue=\"folders.sorted\"/>\n                </L7p:SetVariable>\n                <L7p:ForEachLoop L7p:Usage=\"Required\"\n                    loopVariable=\"folders.elements\" variablePrefix=\"folder\">\n                    <L7p:SetVariable>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Cast to message type for parsing\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:Base64Expression stringValue=\"JHtmb2xkZXIuY3VycmVudH0=\"/>\n                        <L7p:ContentType stringValue=\"text/xml; charset=utf-8\"/>\n                        <L7p:DataType variableDataType=\"message\"/>\n                        <L7p:VariableToSet stringValue=\"folder.xml\"/>\n                    </L7p:SetVariable>\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// retrieve the folder name\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:VariablePrefix stringValue=\"name\"/>\n                        <L7p:XmlMsgSrc stringValue=\"folder.xml\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/l7:Folder/l7:Name\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Retrieve the folder ID\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:VariablePrefix stringValue=\"id\"/>\n                        <L7p:XmlMsgSrc stringValue=\"folder.xml\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/l7:Folder/@id\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <wsp:OneOrMore wsp:Usage=\"Required\">\n                        <L7p:ComparisonAssertion>\n                            <L7p:AssertionComment assertionComment=\"included\">\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Root node is always &lt; 0\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:AssertionComment>\n                            <L7p:CaseSensitive booleanValue=\"false\"/>\n                            <L7p:Expression1 stringValue=\"${id.result}\"/>\n                            <L7p:Expression2 stringValue=\"${folders.rootId}\"/>\n                            <L7p:Negate booleanValue=\"true\"/>\n                            <L7p:Predicates predicates=\"included\">\n                                <L7p:item binary=\"included\">\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:Negated booleanValue=\"true\"/>\n                                    <L7p:RightValue stringValue=\"${folders.rootId}\"/>\n                                </L7p:item>\n                            </L7p:Predicates>\n                        </L7p:ComparisonAssertion>\n                        <L7p:SetVariable>\n                            <L7p:Base64Expression stringValue=\"\"/>\n                            <L7p:VariableToSet stringValue=\"name.result\"/>\n                        </L7p:SetVariable>\n                        <L7p:assertionComment>\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Handle Root Node\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:assertionComment>\n                    </wsp:OneOrMore>\n                    <wsp:OneOrMore wsp:Usage=\"Required\">\n                        <L7p:ResponseXpathAssertion>\n                            <L7p:AssertionComment assertionComment=\"included\">\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Retrieve the parent folder ID\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:AssertionComment>\n                            <L7p:VariablePrefix stringValue=\"folderId\"/>\n                            <L7p:XmlMsgSrc stringValue=\"folder.xml\"/>\n                            <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                <L7p:Expression stringValue=\"/l7:Folder/@folderId\"/>\n                                <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                    </L7p:entry>\n                                </L7p:Namespaces>\n                                <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                            </L7p:XpathExpression>\n                        </L7p:ResponseXpathAssertion>\n                        <L7p:SetVariable>\n                            <L7p:Base64Expression stringValue=\"\"/>\n                            <L7p:VariableToSet stringValue=\"folderId.result\"/>\n                        </L7p:SetVariable>\n                        <L7p:assertionComment>\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Extract folderId to get parent, set to empty if not founf (i.e. root folder)\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:assertionComment>\n                    </wsp:OneOrMore>\n                    <L7p:CommentAssertion>\n                        <L7p:Comment stringValue=\"** Build out the folder path.\"/>\n                    </L7p:CommentAssertion>\n                    <wsp:All wsp:Usage=\"Required\">\n                        <L7p:CommentAssertion>\n                            <L7p:Comment stringValue=\"*********************************************************************************************\"/>\n                        </L7p:CommentAssertion>\n                        <L7p:CommentAssertion>\n                            <L7p:Comment stringValue=\"** Each folder's definition only indicates it own ID and the ID of its parent folder. To build out\"/>\n                        </L7p:CommentAssertion>\n                        <L7p:CommentAssertion>\n                            <L7p:Comment stringValue=\"**   the full path we must iterate back from the folder to the root. This is done by setting up an\"/>\n                        </L7p:CommentAssertion>\n                        <L7p:CommentAssertion>\n                            <L7p:Comment stringValue=\"**   arbitrarily long loop condition (using the ${forLoop.template} variable) and use recursion to\"/>\n                        </L7p:CommentAssertion>\n                        <L7p:CommentAssertion>\n                            <L7p:Comment stringValue=\"**   work back to the root, pulling the parent folder from the response and\"/>\n                        </L7p:CommentAssertion>\n                        <L7p:CommentAssertion>\n                            <L7p:Comment stringValue=\"**   prepending the folder name to the path each time. We take advantage of the fact that the\"/>\n                        </L7p:CommentAssertion>\n                        <L7p:CommentAssertion>\n                            <L7p:Comment stringValue=\"**   root node does not have a parent folder declared so the XPath will fail when it is reached,\"/>\n                        </L7p:CommentAssertion>\n                        <L7p:CommentAssertion>\n                            <L7p:Comment stringValue=\"**   thus terminating the Run Assertion for Each item loop. By wrapping that in an At Least One\"/>\n                        </L7p:CommentAssertion>\n                        <L7p:CommentAssertion>\n                            <L7p:Comment stringValue=\"**   folder we ensure success by appending the folder itself to the path.\"/>\n                        </L7p:CommentAssertion>\n                        <L7p:CommentAssertion>\n                            <L7p:Comment stringValue=\"** \"/>\n                        </L7p:CommentAssertion>\n                        <L7p:CommentAssertion>\n                            <L7p:Comment stringValue=\"** Note that the Root Node has to be handled explicitly when encountered.\"/>\n                        </L7p:CommentAssertion>\n                        <L7p:CommentAssertion>\n                            <L7p:Comment stringValue=\"** \"/>\n                        </L7p:CommentAssertion>\n                        <L7p:CommentAssertion>\n                            <L7p:Comment stringValue=\"**                         Easy Peasy, eh?\"/>\n                        </L7p:CommentAssertion>\n                        <L7p:CommentAssertion>\n                            <L7p:Comment stringValue=\"*********************************************************************************************\"/>\n                        </L7p:CommentAssertion>\n                        <L7p:assertionComment>\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Comment block to describe how paths are built\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:assertionComment>\n                    </wsp:All>\n                    <L7p:SetVariable>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Initialize the path variable to empty\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:Base64Expression stringValue=\"\"/>\n                        <L7p:VariableToSet stringValue=\"path\"/>\n                    </L7p:SetVariable>\n                    <L7p:SetVariable>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Initialize the path variable to empty\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:Base64Expression stringValue=\"JHtpZC5yZXN1bHR9\"/>\n                        <L7p:VariableToSet stringValue=\"idPath\"/>\n                    </L7p:SetVariable>\n                    <L7p:SetVariable>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Set a starting point for the iteration\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:Base64Expression stringValue=\"JHtmb2xkZXIueG1sLm1haW5wYXJ0fQ==\"/>\n                        <L7p:ContentType stringValue=\"text/xml; charset=utf-8\"/>\n                        <L7p:DataType variableDataType=\"message\"/>\n                        <L7p:VariableToSet stringValue=\"this.folder\"/>\n                    </L7p:SetVariable>\n                    <wsp:OneOrMore wsp:Usage=\"Required\">\n                        <L7p:ForEachLoop L7p:Usage=\"Required\"\n                            loopVariable=\"forLoop.results\" variablePrefix=\"i\">\n                            <L7p:ResponseXpathAssertion>\n                                <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Retrieve the folder's parent ID\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:AssertionComment>\n                                <L7p:VariablePrefix stringValue=\"parentId\"/>\n                                <L7p:XmlMsgSrc stringValue=\"this.folder\"/>\n                                <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                    <L7p:Expression stringValue=\"/l7:Folder/@folderId\"/>\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                                </L7p:XpathExpression>\n                            </L7p:ResponseXpathAssertion>\n                            <L7p:ResponseXpathAssertion>\n                                <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Get the parent folder from the Response\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:AssertionComment>\n                                <L7p:VariablePrefix stringValue=\"parentFolder\"/>\n                                <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                    <L7p:Expression stringValue=\"/l7:List/l7:Item/l7:Resource/l7:Folder[@id=$parentId.result]\"/>\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                                </L7p:XpathExpression>\n                            </L7p:ResponseXpathAssertion>\n                            <L7p:SetVariable>\n                                <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Cast as a message type\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:AssertionComment>\n                                <L7p:Base64Expression stringValue=\"JHtwYXJlbnRGb2xkZXIuZWxlbWVudH0=\"/>\n                                <L7p:ContentType stringValue=\"text/xml; charset=utf-8\"/>\n                                <L7p:DataType variableDataType=\"message\"/>\n                                <L7p:VariableToSet stringValue=\"this.folder\"/>\n                            </L7p:SetVariable>\n                            <L7p:ResponseXpathAssertion>\n                                <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// retrieve the folder name\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:AssertionComment>\n                                <L7p:VariablePrefix stringValue=\"parentName\"/>\n                                <L7p:XmlMsgSrc stringValue=\"this.folder\"/>\n                                <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                    <L7p:Expression stringValue=\"/l7:Folder/l7:Name\"/>\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                                </L7p:XpathExpression>\n                            </L7p:ResponseXpathAssertion>\n                            <wsp:OneOrMore wsp:Usage=\"Required\">\n                                <L7p:ComparisonAssertion>\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:Expression1 stringValue=\"${parentId.result}\"/>\n                                    <L7p:Expression2 stringValue=\"${folders.rootId}\"/>\n                                    <L7p:Negate booleanValue=\"true\"/>\n                                    <L7p:Predicates predicates=\"included\">\n                                    <L7p:item binary=\"included\">\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:Negated booleanValue=\"true\"/>\n                                    <L7p:RightValue stringValue=\"${folders.rootId}\"/>\n                                    </L7p:item>\n                                    </L7p:Predicates>\n                                </L7p:ComparisonAssertion>\n                                <wsp:All wsp:Usage=\"Required\">\n                                    <L7p:SetVariable>\n                                    <L7p:Base64Expression stringValue=\"\"/>\n                                    <L7p:VariableToSet stringValue=\"parentName.result\"/>\n                                    </L7p:SetVariable>\n                                    <L7p:SetVariable>\n                                    <L7p:Base64Expression stringValue=\"\"/>\n                                    <L7p:VariableToSet stringValue=\"parentId.result\"/>\n                                    </L7p:SetVariable>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Blank out ${parentName.result} and ${parentId.result}\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                </wsp:All>\n                                <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Handle Root Node\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:assertionComment>\n                            </wsp:OneOrMore>\n                            <L7p:SetVariable>\n                                <L7p:Base64Expression stringValue=\"JHtwYXJlbnRJZC5yZXN1bHR9LyR7aWRQYXRofQ==\"/>\n                                <L7p:VariableToSet stringValue=\"idPath\"/>\n                            </L7p:SetVariable>\n                            <L7p:SetVariable>\n                                <L7p:Base64Expression stringValue=\"JHtwYXJlbnROYW1lLnJlc3VsdH0vJHtwYXRofQ==\"/>\n                                <L7p:VariableToSet stringValue=\"path\"/>\n                            </L7p:SetVariable>\n                            <L7p:assertionComment>\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// ${forLoop.result} was set earlier\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:assertionComment>\n                        </L7p:ForEachLoop>\n                        <L7p:SetVariable>\n                            <L7p:AssertionComment assertionComment=\"included\">\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Append the folder name to the path\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:AssertionComment>\n                            <L7p:Base64Expression stringValue=\"JHtwYXRofSR7bmFtZS5yZXN1bHR9Lw==\"/>\n                            <L7p:VariableToSet stringValue=\"path\"/>\n                        </L7p:SetVariable>\n                        <L7p:assertionComment>\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// The Run for Each will always fail once the root folder is encountered, at which point append the folder name\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:assertionComment>\n                    </wsp:OneOrMore>\n                    <L7p:SetVariable>\n                        <L7p:Base64Expression stringValue=\"JHtmb2xkZXJzLnNvcnRlZH08Rm9sZGVyIGlkPSIke2lkLnJlc3VsdH0iIGZvbGRlcklkPSIke2ZvbGRlcklkLnJlc3VsdH0iPjxOYW1lPjwhW0NEQVRBWyR7bmFtZS5yZXN1bHR9XV0+PC9OYW1lPjxGb2xkZXJQYXRoPjwhW0NEQVRBWyR7cGF0aH1dXT48L0ZvbGRlclBhdGg+PElkUGF0aD4ke2lkUGF0aH08L0lkUGF0aD48L0ZvbGRlcj4=\"/>\n                        <L7p:VariableToSet stringValue=\"folders.sorted\"/>\n                    </L7p:SetVariable>\n                    <L7p:assertionComment>\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// Build the list of folders\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:assertionComment>\n                </L7p:ForEachLoop>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"JHtmb2xkZXJzLnNvcnRlZH08L0ZvbGRlcnM+\"/>\n                    <L7p:ContentType stringValue=\"text/xml; charset=utf-8\"/>\n                    <L7p:DataType variableDataType=\"message\"/>\n                    <L7p:VariableToSet stringValue=\"folders.sorted\"/>\n                </L7p:SetVariable>\n                <L7p:XslTransformation>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// Sort the folders by name\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Direction intValue=\"-1\"/>\n                    <L7p:OtherTargetMessageVariable stringValue=\"folders.sorted\"/>\n                    <L7p:ResourceInfo staticResourceInfo=\"included\">\n                        <L7p:Document stringValue=\"&lt;xsl:stylesheet version=&quot;1.0&quot; xmlns:l7=&quot;http://ns.l7tech.com/2010/04/gateway-management&quot; xmlns:xsl=&quot;http://www.w3.org/1999/XSL/Transform&quot;>&lt;xsl:template match=&quot;/Folders&quot;>    &lt;xsl:copy>        &lt;xsl:for-each select=&quot;Folder&quot;>            &lt;xsl:sort select=&quot;./FolderPath&quot;/>            &lt;xsl:sort select=&quot;./Name&quot;/>            &lt;xsl:copy-of select=&quot;.&quot;/>        &lt;/xsl:for-each>    &lt;/xsl:copy>&lt;/xsl:template>&lt;/xsl:stylesheet>\"/>\n                    </L7p:ResourceInfo>\n                    <L7p:Target target=\"OTHER\"/>\n                    <L7p:TransformName stringValue=\"\"/>\n                    <L7p:XsltVersion stringValue=\"1.0\"/>\n                </L7p:XslTransformation>\n                <L7p:Regex>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// Add rootId attribute to /Folders element\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:AutoTarget booleanValue=\"false\"/>\n                    <L7p:OtherTargetMessageVariable stringValue=\"folders.sorted\"/>\n                    <L7p:Regex stringValue=\"&lt;Folders>\"/>\n                    <L7p:Replace booleanValue=\"true\"/>\n                    <L7p:Replacement stringValue=\"&lt;Folders rootId=&quot;${folders.rootId}&quot;>\"/>\n                    <L7p:Target target=\"OTHER\"/>\n                </L7p:Regex>\n                <L7p:CacheStorage>\n                    <L7p:CacheEntryKey stringValue=\"${cacheKey}\"/>\n                    <L7p:CacheId stringValue=\"folderList\"/>\n                    <L7p:MaxEntries stringValue=\"1\"/>\n                    <L7p:MaxEntryAgeSeconds stringValue=\"${cacheAge}\"/>\n                    <L7p:MaxEntrySizeBytes stringValue=\"200000\"/>\n                    <L7p:OtherTargetMessageVariable stringValue=\"folders.sorted\"/>\n                    <L7p:StoreSoapFaults booleanValue=\"true\"/>\n                    <L7p:Target target=\"OTHER\"/>\n                </L7p:CacheStorage>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"c3lzdGVt\"/>\n                    <L7p:VariableToSet stringValue=\"source\"/>\n                </L7p:SetVariable>\n                <L7p:AuditDetailAssertion>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// FINE\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Detail stringValue=\"==> Loaded folders.sorted from system and stored to cache\"/>\n                    <L7p:Level stringValue=\"FINE\"/>\n                </L7p:AuditDetailAssertion>\n                <L7p:assertionComment>\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// Retrieve new list and cache\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:assertionComment>\n            </wsp:All>\n            <wsp:All wsp:Usage=\"Required\">\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"RXJyb3Igd2hlbiBsaXN0aW5nIGZvbGRlcnM=\"/>\n                    <L7p:VariableToSet stringValue=\"error.msg\"/>\n                </L7p:SetVariable>\n                <L7p:AuditDetailAssertion>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// WARNING\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Detail stringValue=\"==> Error listing folders in ${policy.name}\"/>\n                    <L7p:Level stringValue=\"WARNING\"/>\n                </L7p:AuditDetailAssertion>\n                <L7p:FalseAssertion/>\n                <L7p:assertionComment>\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// Failure - set ${error.msg}\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:assertionComment>\n            </wsp:All>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Caching logic\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:OneOrMore>\n        <L7p:Regex>\n            <L7p:AssertionComment assertionComment=\"included\">\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Add source attribute to /Folders element\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:AssertionComment>\n            <L7p:AutoTarget booleanValue=\"false\"/>\n            <L7p:OtherTargetMessageVariable stringValue=\"folders.sorted\"/>\n            <L7p:Regex stringValue=\"&lt;Folders rootId\"/>\n            <L7p:Replace booleanValue=\"true\"/>\n            <L7p:Replacement stringValue=\"&lt;Folders source=&quot;${source}&quot; rootId\"/>\n            <L7p:Target target=\"OTHER\"/>\n        </L7p:Regex>\n        <L7p:AuditDetailAssertion>\n            <L7p:AssertionComment assertionComment=\"included\">\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// FINE\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:AssertionComment>\n            <L7p:Detail stringValue=\"==> Leaving Utility Fragment: ${policy.name}\"/>\n            <L7p:Level stringValue=\"FINE\"/>\n        </L7p:AuditDetailAssertion>\n    </wsp:All>\n</wsp:Policy>\n"
        }
      ]
    },
    {
      "guid": "635c9c5a-6aa0-4b8f-b74f-b2dbb3de6a05",
      "name": "Utility: List Generic Entities",
      "policyType": "FRAGMENT",
      "checksum": "644ae9eb22a2b0237b0700b1899813c64d804449",
      "folderPath": "/Gateway Management Utilities/fragments",
      "soap": false,
      "policy": {
        "xml": "<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<wsp:Policy xmlns:L7p=\"http://www.layer7tech.com/ws/policy\" xmlns:wsp=\"http://schemas.xmlsoap.org/ws/2002/12/policy\">\n    <wsp:All wsp:Usage=\"Required\">\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Policy fragment for &quot;Utility: List Generic Entities&quot; encapsulated assertion\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Call Restman and generate a sorted list of generic entities\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** - Assumes an admin role user has been authenticated\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** - Caches results for ${cacheAge} seconds (default=300). To refresh the cache set ${refresh}=true when calling\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** - Returns a text/xml message variable in ${genericEntities.sorted}\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Inputs:\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - refresh (string)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - cacheAge (string)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Outputs:\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - genericEntities.sorted (message)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - error.msg (string)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** v1.0.0 - Jay MacDonald - 20201107 - Initial Version\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n        </L7p:CommentAssertion>\n        <L7p:AuditDetailAssertion>\n            <L7p:AssertionComment assertionComment=\"included\">\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// FINE\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:AssertionComment>\n            <L7p:Detail stringValue=\"==> Entering Utility Fragment: ${policy.name} (refresh=${refresh})\"/>\n            <L7p:Level stringValue=\"FINE\"/>\n        </L7p:AuditDetailAssertion>\n        <wsp:All wsp:Usage=\"Required\">\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** ${genericEntities.sorted} has the following schema:\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** \"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** &lt;GenericEntities source=&quot;system|cache&quot;>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   &lt;GenericEntity id=&quot;string&quot;>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**     &lt;Name>string&lt;/Name>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**     &lt;Description>string&lt;/Description>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**     &lt;EntityClassName>string&lt;/EntityClassName>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**     &lt;Enabled>boolean&lt;/Enabled>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   &lt;/GenericEntity>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   ...\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** &lt;/GenericEntities>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n            </L7p:CommentAssertion>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Description of ${genericEntities.sorted}\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:All>\n        <wsp:OneOrMore wsp:Usage=\"Required\">\n            <L7p:ComparisonAssertion>\n                <L7p:AssertionComment assertionComment=\"included\">\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// true or false\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:AssertionComment>\n                <L7p:CaseSensitive booleanValue=\"false\"/>\n                <L7p:Expression1 stringValue=\"${cacheAge}\"/>\n                <L7p:Operator operatorNull=\"null\"/>\n                <L7p:Predicates predicates=\"included\">\n                    <L7p:item dataType=\"included\">\n                        <L7p:Type variableDataType=\"int\"/>\n                    </L7p:item>\n                    <L7p:item binary=\"included\">\n                        <L7p:CaseSensitive booleanValue=\"false\"/>\n                        <L7p:Operator operator=\"GT\"/>\n                        <L7p:RightValue stringValue=\"0\"/>\n                    </L7p:item>\n                </L7p:Predicates>\n            </L7p:ComparisonAssertion>\n            <L7p:SetVariable>\n                <L7p:Base64Expression stringValue=\"MzAw\"/>\n                <L7p:DataType variableDataType=\"int\"/>\n                <L7p:VariableToSet stringValue=\"cacheAge\"/>\n            </L7p:SetVariable>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Ensure ${cacheAge} is set, default=300\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:OneOrMore>\n        <wsp:OneOrMore wsp:Usage=\"Required\">\n            <L7p:ComparisonAssertion>\n                <L7p:AssertionComment assertionComment=\"included\">\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// true or false\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:AssertionComment>\n                <L7p:CaseSensitive booleanValue=\"false\"/>\n                <L7p:Expression1 stringValue=\"${refresh}\"/>\n                <L7p:Operator operatorNull=\"null\"/>\n                <L7p:Predicates predicates=\"included\">\n                    <L7p:item dataType=\"included\">\n                        <L7p:Type variableDataType=\"string\"/>\n                    </L7p:item>\n                    <L7p:item regex=\"included\">\n                        <L7p:Pattern stringValue=\"^(true|false)$\"/>\n                    </L7p:item>\n                </L7p:Predicates>\n            </L7p:ComparisonAssertion>\n            <L7p:SetVariable>\n                <L7p:Base64Expression stringValue=\"ZmFsc2U=\"/>\n                <L7p:VariableToSet stringValue=\"refresh\"/>\n            </L7p:SetVariable>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Ensure ${refresh} is set, default=false\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:OneOrMore>\n        <L7p:SetVariable>\n            <L7p:Base64Expression stringValue=\"Z2VuZXJpY0VudGl0aWVzLnNvcnRlZA==\"/>\n            <L7p:VariableToSet stringValue=\"cacheKey\"/>\n        </L7p:SetVariable>\n        <wsp:OneOrMore wsp:Usage=\"Required\">\n            <wsp:All wsp:Usage=\"Required\">\n                <L7p:ComparisonAssertion>\n                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                    <L7p:Expression1 stringValue=\"${refresh}\"/>\n                    <L7p:Operator operatorNull=\"null\"/>\n                    <L7p:Predicates predicates=\"included\">\n                        <L7p:item dataType=\"included\">\n                            <L7p:Type variableDataType=\"string\"/>\n                        </L7p:item>\n                        <L7p:item binary=\"included\">\n                            <L7p:Negated booleanValue=\"true\"/>\n                            <L7p:RightValue stringValue=\"true\"/>\n                        </L7p:item>\n                    </L7p:Predicates>\n                </L7p:ComparisonAssertion>\n                <L7p:CacheLookup>\n                    <L7p:CacheEntryKey stringValue=\"${cacheKey}\"/>\n                    <L7p:CacheId stringValue=\"genericEntityList\"/>\n                    <L7p:ContentTypeOverride stringValue=\"\"/>\n                    <L7p:MaxEntryAgeSeconds stringValue=\"${cacheAge}\"/>\n                    <L7p:OtherTargetMessageVariable stringValue=\"genericEntities.sorted\"/>\n                    <L7p:Target target=\"OTHER\"/>\n                </L7p:CacheLookup>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"Y2FjaGU=\"/>\n                    <L7p:VariableToSet stringValue=\"source\"/>\n                </L7p:SetVariable>\n                <L7p:AuditDetailAssertion>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// FINE\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Detail stringValue=\"==> Found genericEntities.sorted in the cache\"/>\n                    <L7p:Level stringValue=\"FINE\"/>\n                </L7p:AuditDetailAssertion>\n                <L7p:assertionComment>\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// Look in cache unless asked to refresh cache\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:assertionComment>\n            </wsp:All>\n            <wsp:All wsp:Usage=\"Required\">\n                <L7p:Encapsulated>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// GET genericEntities\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:EncapsulatedAssertionConfigGuid stringValue=\"c8a5a0d5-1ae2-4144-b538-5c311efc1560\"/>\n                    <L7p:EncapsulatedAssertionConfigName stringValue=\"Utility: Call Restman\"/>\n                    <L7p:Parameters mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"element\"/>\n                            <L7p:value stringValue=\"GenericEntity\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"message\"/>\n                            <L7p:value stringValue=\"\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"method\"/>\n                            <L7p:value stringValue=\"GET\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"resource\"/>\n                            <L7p:value stringValue=\"genericEntities\"/>\n                        </L7p:entry>\n                    </L7p:Parameters>\n                </L7p:Encapsulated>\n                <wsp:OneOrMore wsp:Usage=\"Required\">\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:VariablePrefix stringValue=\"genericEntities\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/l7:List/l7:Item/l7:Resource/l7:GenericEntity\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <L7p:TrueAssertion/>\n                    <L7p:assertionComment>\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// Extract the list of generic entities, never fail\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:assertionComment>\n                </wsp:OneOrMore>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz48R2VuZXJpY0VudGl0aWVzPg==\"/>\n                    <L7p:VariableToSet stringValue=\"genericEntities.sorted\"/>\n                </L7p:SetVariable>\n                <L7p:ForEachLoop L7p:Usage=\"Required\"\n                    loopVariable=\"genericEntities.elements\" variablePrefix=\"genericEntity\">\n                    <L7p:SetVariable>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Cast to message type for parsing\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:Base64Expression stringValue=\"JHtnZW5lcmljRW50aXR5LmN1cnJlbnR9\"/>\n                        <L7p:ContentType stringValue=\"text/xml; charset=utf-8\"/>\n                        <L7p:DataType variableDataType=\"message\"/>\n                        <L7p:VariableToSet stringValue=\"genericEntity.xml\"/>\n                    </L7p:SetVariable>\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Retrieve the generic entity ID\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:VariablePrefix stringValue=\"id\"/>\n                        <L7p:XmlMsgSrc stringValue=\"genericEntity.xml\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/l7:GenericEntity/@id\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// retrieve the generic entity name\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:VariablePrefix stringValue=\"name\"/>\n                        <L7p:XmlMsgSrc stringValue=\"genericEntity.xml\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/l7:GenericEntity/l7:Name\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <wsp:OneOrMore wsp:Usage=\"Required\">\n                        <L7p:ResponseXpathAssertion>\n                            <L7p:AssertionComment assertionComment=\"included\">\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// retrieve the generic entity name\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:AssertionComment>\n                            <L7p:VariablePrefix stringValue=\"description\"/>\n                            <L7p:XmlMsgSrc stringValue=\"genericEntity.xml\"/>\n                            <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                <L7p:Expression stringValue=\"/l7:GenericEntity/l7:Description\"/>\n                                <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                    </L7p:entry>\n                                </L7p:Namespaces>\n                                <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                            </L7p:XpathExpression>\n                        </L7p:ResponseXpathAssertion>\n                        <L7p:SetVariable>\n                            <L7p:Base64Expression stringValue=\"\"/>\n                            <L7p:VariableToSet stringValue=\"description.result\"/>\n                        </L7p:SetVariable>\n                        <L7p:assertionComment>\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Description is option\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:assertionComment>\n                    </wsp:OneOrMore>\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Retrieve the generic entity class name\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:VariablePrefix stringValue=\"entityClassName\"/>\n                        <L7p:XmlMsgSrc stringValue=\"genericEntity.xml\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/l7:GenericEntity/l7:EntityClassName\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Retrieve the generic entity enabled state\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:VariablePrefix stringValue=\"enabled\"/>\n                        <L7p:XmlMsgSrc stringValue=\"genericEntity.xml\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/l7:GenericEntity/l7:Enabled\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <L7p:SetVariable>\n                        <L7p:Base64Expression stringValue=\"JHtnZW5lcmljRW50aXRpZXMuc29ydGVkfTxHZW5lcmljRW50aXR5IGlkPSIke2lkLnJlc3VsdH0iPjxOYW1lPjwhW0NEQVRBWyR7bmFtZS5yZXN1bHR9XV0+PC9OYW1lPjxFbnRpdHlDbGFzc05hbWU+JHtlbnRpdHlDbGFzc05hbWUucmVzdWx0fTwvRW50aXR5Q2xhc3NOYW1lPjxEZXNjcmlwdGlvbj48IVtDREFUQVske2Rlc2NyaXB0aW9uLnJlc3VsdH1dXT48L0Rlc2NyaXB0aW9uPjxFbmFibGVkPiR7ZW5hYmxlZC5yZXN1bHR9PC9FbmFibGVkPjwvR2VuZXJpY0VudGl0eT4=\"/>\n                        <L7p:VariableToSet stringValue=\"genericEntities.sorted\"/>\n                    </L7p:SetVariable>\n                    <L7p:assertionComment>\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// Build the list of generic entities\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:assertionComment>\n                </L7p:ForEachLoop>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"JHtnZW5lcmljRW50aXRpZXMuc29ydGVkfTwvR2VuZXJpY0VudGl0aWVzPg==\"/>\n                    <L7p:ContentType stringValue=\"text/xml; charset=utf-8\"/>\n                    <L7p:DataType variableDataType=\"message\"/>\n                    <L7p:VariableToSet stringValue=\"genericEntities.sorted\"/>\n                </L7p:SetVariable>\n                <L7p:XslTransformation>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// Sort the generic entities by name\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Direction intValue=\"-1\"/>\n                    <L7p:OtherTargetMessageVariable stringValue=\"genericEntities.sorted\"/>\n                    <L7p:ResourceInfo staticResourceInfo=\"included\">\n                        <L7p:Document stringValue=\"&lt;xsl:stylesheet version=&quot;1.0&quot; xmlns:l7=&quot;http://ns.l7tech.com/2010/04/gateway-management&quot; xmlns:xsl=&quot;http://www.w3.org/1999/XSL/Transform&quot;>&lt;xsl:template match=&quot;/GenericEntities&quot;>    &lt;xsl:copy>        &lt;xsl:for-each select=&quot;GenericEntity&quot;>            &lt;xsl:sort select=&quot;./Name&quot;/>            &lt;xsl:copy-of select=&quot;.&quot;/>        &lt;/xsl:for-each>    &lt;/xsl:copy>&lt;/xsl:template>&lt;/xsl:stylesheet>\"/>\n                    </L7p:ResourceInfo>\n                    <L7p:Target target=\"OTHER\"/>\n                    <L7p:TransformName stringValue=\"\"/>\n                    <L7p:XsltVersion stringValue=\"1.0\"/>\n                </L7p:XslTransformation>\n                <L7p:CacheStorage>\n                    <L7p:CacheEntryKey stringValue=\"${cacheKey}\"/>\n                    <L7p:CacheId stringValue=\"genericEntityList\"/>\n                    <L7p:MaxEntries stringValue=\"1\"/>\n                    <L7p:MaxEntryAgeSeconds stringValue=\"${cacheAge}\"/>\n                    <L7p:MaxEntrySizeBytes stringValue=\"200000\"/>\n                    <L7p:OtherTargetMessageVariable stringValue=\"genericEntities.sorted\"/>\n                    <L7p:StoreSoapFaults booleanValue=\"true\"/>\n                    <L7p:Target target=\"OTHER\"/>\n                </L7p:CacheStorage>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"c3lzdGVt\"/>\n                    <L7p:VariableToSet stringValue=\"source\"/>\n                </L7p:SetVariable>\n                <L7p:AuditDetailAssertion>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// FINE\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Detail stringValue=\"==> Loaded genericEntities.sorted from system and stored to cache\"/>\n                    <L7p:Level stringValue=\"FINE\"/>\n                </L7p:AuditDetailAssertion>\n                <L7p:assertionComment>\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// Retrieve new list and cache\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:assertionComment>\n            </wsp:All>\n            <wsp:All wsp:Usage=\"Required\">\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"RXJyb3Igd2hlbiBsaXN0aW5nIGdlbmVyaWMgZW50aXRpZXM=\"/>\n                    <L7p:VariableToSet stringValue=\"error.msg\"/>\n                </L7p:SetVariable>\n                <L7p:AuditDetailAssertion>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// WARNING\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Detail stringValue=\"==> Error listing generic entities in ${policy.name}\"/>\n                    <L7p:Level stringValue=\"WARNING\"/>\n                </L7p:AuditDetailAssertion>\n                <L7p:FalseAssertion/>\n                <L7p:assertionComment>\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// Failure - set ${error.msg}\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:assertionComment>\n            </wsp:All>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Caching logic\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:OneOrMore>\n        <L7p:Regex>\n            <L7p:AssertionComment assertionComment=\"included\">\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Add source attribute to /GenericEntities element\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:AssertionComment>\n            <L7p:AutoTarget booleanValue=\"false\"/>\n            <L7p:OtherTargetMessageVariable stringValue=\"genericEntities.sorted\"/>\n            <L7p:Regex stringValue=\"&lt;GenericEntities>\"/>\n            <L7p:Replace booleanValue=\"true\"/>\n            <L7p:Replacement stringValue=\"&lt;GenericEntities source=&quot;${source}&quot;>\"/>\n            <L7p:Target target=\"OTHER\"/>\n        </L7p:Regex>\n        <L7p:AuditDetailAssertion>\n            <L7p:AssertionComment assertionComment=\"included\">\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// FINE\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:AssertionComment>\n            <L7p:Detail stringValue=\"==> Leaving Utility Fragment: ${policy.name}\"/>\n            <L7p:Level stringValue=\"FINE\"/>\n        </L7p:AuditDetailAssertion>\n    </wsp:All>\n</wsp:Policy>\n"
      },
      "policyRevisions": [
        {
          "goid": "bed4baf4ff33b7e528854c3965d9bb34",
          "ordinal": 1,
          "active": true,
          "author": "admin",
          "time": "2025-02-05T14:20:38.477Z",
          "xml": "<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<wsp:Policy xmlns:L7p=\"http://www.layer7tech.com/ws/policy\" xmlns:wsp=\"http://schemas.xmlsoap.org/ws/2002/12/policy\">\n    <wsp:All wsp:Usage=\"Required\">\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Policy fragment for &quot;Utility: List Generic Entities&quot; encapsulated assertion\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Call Restman and generate a sorted list of generic entities\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** - Assumes an admin role user has been authenticated\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** - Caches results for ${cacheAge} seconds (default=300). To refresh the cache set ${refresh}=true when calling\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** - Returns a text/xml message variable in ${genericEntities.sorted}\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Inputs:\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - refresh (string)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - cacheAge (string)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Outputs:\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - genericEntities.sorted (message)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - error.msg (string)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** v1.0.0 - Jay MacDonald - 20201107 - Initial Version\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n        </L7p:CommentAssertion>\n        <L7p:AuditDetailAssertion>\n            <L7p:AssertionComment assertionComment=\"included\">\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// FINE\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:AssertionComment>\n            <L7p:Detail stringValue=\"==> Entering Utility Fragment: ${policy.name} (refresh=${refresh})\"/>\n            <L7p:Level stringValue=\"FINE\"/>\n        </L7p:AuditDetailAssertion>\n        <wsp:All wsp:Usage=\"Required\">\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** ${genericEntities.sorted} has the following schema:\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** \"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** &lt;GenericEntities source=&quot;system|cache&quot;>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   &lt;GenericEntity id=&quot;string&quot;>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**     &lt;Name>string&lt;/Name>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**     &lt;Description>string&lt;/Description>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**     &lt;EntityClassName>string&lt;/EntityClassName>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**     &lt;Enabled>boolean&lt;/Enabled>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   &lt;/GenericEntity>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   ...\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** &lt;/GenericEntities>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n            </L7p:CommentAssertion>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Description of ${genericEntities.sorted}\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:All>\n        <wsp:OneOrMore wsp:Usage=\"Required\">\n            <L7p:ComparisonAssertion>\n                <L7p:AssertionComment assertionComment=\"included\">\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// true or false\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:AssertionComment>\n                <L7p:CaseSensitive booleanValue=\"false\"/>\n                <L7p:Expression1 stringValue=\"${cacheAge}\"/>\n                <L7p:Operator operatorNull=\"null\"/>\n                <L7p:Predicates predicates=\"included\">\n                    <L7p:item dataType=\"included\">\n                        <L7p:Type variableDataType=\"int\"/>\n                    </L7p:item>\n                    <L7p:item binary=\"included\">\n                        <L7p:CaseSensitive booleanValue=\"false\"/>\n                        <L7p:Operator operator=\"GT\"/>\n                        <L7p:RightValue stringValue=\"0\"/>\n                    </L7p:item>\n                </L7p:Predicates>\n            </L7p:ComparisonAssertion>\n            <L7p:SetVariable>\n                <L7p:Base64Expression stringValue=\"MzAw\"/>\n                <L7p:DataType variableDataType=\"int\"/>\n                <L7p:VariableToSet stringValue=\"cacheAge\"/>\n            </L7p:SetVariable>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Ensure ${cacheAge} is set, default=300\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:OneOrMore>\n        <wsp:OneOrMore wsp:Usage=\"Required\">\n            <L7p:ComparisonAssertion>\n                <L7p:AssertionComment assertionComment=\"included\">\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// true or false\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:AssertionComment>\n                <L7p:CaseSensitive booleanValue=\"false\"/>\n                <L7p:Expression1 stringValue=\"${refresh}\"/>\n                <L7p:Operator operatorNull=\"null\"/>\n                <L7p:Predicates predicates=\"included\">\n                    <L7p:item dataType=\"included\">\n                        <L7p:Type variableDataType=\"string\"/>\n                    </L7p:item>\n                    <L7p:item regex=\"included\">\n                        <L7p:Pattern stringValue=\"^(true|false)$\"/>\n                    </L7p:item>\n                </L7p:Predicates>\n            </L7p:ComparisonAssertion>\n            <L7p:SetVariable>\n                <L7p:Base64Expression stringValue=\"ZmFsc2U=\"/>\n                <L7p:VariableToSet stringValue=\"refresh\"/>\n            </L7p:SetVariable>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Ensure ${refresh} is set, default=false\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:OneOrMore>\n        <L7p:SetVariable>\n            <L7p:Base64Expression stringValue=\"Z2VuZXJpY0VudGl0aWVzLnNvcnRlZA==\"/>\n            <L7p:VariableToSet stringValue=\"cacheKey\"/>\n        </L7p:SetVariable>\n        <wsp:OneOrMore wsp:Usage=\"Required\">\n            <wsp:All wsp:Usage=\"Required\">\n                <L7p:ComparisonAssertion>\n                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                    <L7p:Expression1 stringValue=\"${refresh}\"/>\n                    <L7p:Operator operatorNull=\"null\"/>\n                    <L7p:Predicates predicates=\"included\">\n                        <L7p:item dataType=\"included\">\n                            <L7p:Type variableDataType=\"string\"/>\n                        </L7p:item>\n                        <L7p:item binary=\"included\">\n                            <L7p:Negated booleanValue=\"true\"/>\n                            <L7p:RightValue stringValue=\"true\"/>\n                        </L7p:item>\n                    </L7p:Predicates>\n                </L7p:ComparisonAssertion>\n                <L7p:CacheLookup>\n                    <L7p:CacheEntryKey stringValue=\"${cacheKey}\"/>\n                    <L7p:CacheId stringValue=\"genericEntityList\"/>\n                    <L7p:ContentTypeOverride stringValue=\"\"/>\n                    <L7p:MaxEntryAgeSeconds stringValue=\"${cacheAge}\"/>\n                    <L7p:OtherTargetMessageVariable stringValue=\"genericEntities.sorted\"/>\n                    <L7p:Target target=\"OTHER\"/>\n                </L7p:CacheLookup>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"Y2FjaGU=\"/>\n                    <L7p:VariableToSet stringValue=\"source\"/>\n                </L7p:SetVariable>\n                <L7p:AuditDetailAssertion>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// FINE\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Detail stringValue=\"==> Found genericEntities.sorted in the cache\"/>\n                    <L7p:Level stringValue=\"FINE\"/>\n                </L7p:AuditDetailAssertion>\n                <L7p:assertionComment>\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// Look in cache unless asked to refresh cache\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:assertionComment>\n            </wsp:All>\n            <wsp:All wsp:Usage=\"Required\">\n                <L7p:Encapsulated>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// GET genericEntities\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:EncapsulatedAssertionConfigGuid stringValue=\"c8a5a0d5-1ae2-4144-b538-5c311efc1560\"/>\n                    <L7p:EncapsulatedAssertionConfigName stringValue=\"Utility: Call Restman\"/>\n                    <L7p:Parameters mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"element\"/>\n                            <L7p:value stringValue=\"GenericEntity\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"message\"/>\n                            <L7p:value stringValue=\"\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"method\"/>\n                            <L7p:value stringValue=\"GET\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"resource\"/>\n                            <L7p:value stringValue=\"genericEntities\"/>\n                        </L7p:entry>\n                    </L7p:Parameters>\n                </L7p:Encapsulated>\n                <wsp:OneOrMore wsp:Usage=\"Required\">\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:VariablePrefix stringValue=\"genericEntities\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/l7:List/l7:Item/l7:Resource/l7:GenericEntity\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <L7p:TrueAssertion/>\n                    <L7p:assertionComment>\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// Extract the list of generic entities, never fail\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:assertionComment>\n                </wsp:OneOrMore>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz48R2VuZXJpY0VudGl0aWVzPg==\"/>\n                    <L7p:VariableToSet stringValue=\"genericEntities.sorted\"/>\n                </L7p:SetVariable>\n                <L7p:ForEachLoop L7p:Usage=\"Required\"\n                    loopVariable=\"genericEntities.elements\" variablePrefix=\"genericEntity\">\n                    <L7p:SetVariable>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Cast to message type for parsing\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:Base64Expression stringValue=\"JHtnZW5lcmljRW50aXR5LmN1cnJlbnR9\"/>\n                        <L7p:ContentType stringValue=\"text/xml; charset=utf-8\"/>\n                        <L7p:DataType variableDataType=\"message\"/>\n                        <L7p:VariableToSet stringValue=\"genericEntity.xml\"/>\n                    </L7p:SetVariable>\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Retrieve the generic entity ID\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:VariablePrefix stringValue=\"id\"/>\n                        <L7p:XmlMsgSrc stringValue=\"genericEntity.xml\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/l7:GenericEntity/@id\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// retrieve the generic entity name\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:VariablePrefix stringValue=\"name\"/>\n                        <L7p:XmlMsgSrc stringValue=\"genericEntity.xml\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/l7:GenericEntity/l7:Name\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <wsp:OneOrMore wsp:Usage=\"Required\">\n                        <L7p:ResponseXpathAssertion>\n                            <L7p:AssertionComment assertionComment=\"included\">\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// retrieve the generic entity name\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:AssertionComment>\n                            <L7p:VariablePrefix stringValue=\"description\"/>\n                            <L7p:XmlMsgSrc stringValue=\"genericEntity.xml\"/>\n                            <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                <L7p:Expression stringValue=\"/l7:GenericEntity/l7:Description\"/>\n                                <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                    </L7p:entry>\n                                </L7p:Namespaces>\n                                <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                            </L7p:XpathExpression>\n                        </L7p:ResponseXpathAssertion>\n                        <L7p:SetVariable>\n                            <L7p:Base64Expression stringValue=\"\"/>\n                            <L7p:VariableToSet stringValue=\"description.result\"/>\n                        </L7p:SetVariable>\n                        <L7p:assertionComment>\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Description is option\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:assertionComment>\n                    </wsp:OneOrMore>\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Retrieve the generic entity class name\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:VariablePrefix stringValue=\"entityClassName\"/>\n                        <L7p:XmlMsgSrc stringValue=\"genericEntity.xml\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/l7:GenericEntity/l7:EntityClassName\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Retrieve the generic entity enabled state\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:VariablePrefix stringValue=\"enabled\"/>\n                        <L7p:XmlMsgSrc stringValue=\"genericEntity.xml\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/l7:GenericEntity/l7:Enabled\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <L7p:SetVariable>\n                        <L7p:Base64Expression stringValue=\"JHtnZW5lcmljRW50aXRpZXMuc29ydGVkfTxHZW5lcmljRW50aXR5IGlkPSIke2lkLnJlc3VsdH0iPjxOYW1lPjwhW0NEQVRBWyR7bmFtZS5yZXN1bHR9XV0+PC9OYW1lPjxFbnRpdHlDbGFzc05hbWU+JHtlbnRpdHlDbGFzc05hbWUucmVzdWx0fTwvRW50aXR5Q2xhc3NOYW1lPjxEZXNjcmlwdGlvbj48IVtDREFUQVske2Rlc2NyaXB0aW9uLnJlc3VsdH1dXT48L0Rlc2NyaXB0aW9uPjxFbmFibGVkPiR7ZW5hYmxlZC5yZXN1bHR9PC9FbmFibGVkPjwvR2VuZXJpY0VudGl0eT4=\"/>\n                        <L7p:VariableToSet stringValue=\"genericEntities.sorted\"/>\n                    </L7p:SetVariable>\n                    <L7p:assertionComment>\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// Build the list of generic entities\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:assertionComment>\n                </L7p:ForEachLoop>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"JHtnZW5lcmljRW50aXRpZXMuc29ydGVkfTwvR2VuZXJpY0VudGl0aWVzPg==\"/>\n                    <L7p:ContentType stringValue=\"text/xml; charset=utf-8\"/>\n                    <L7p:DataType variableDataType=\"message\"/>\n                    <L7p:VariableToSet stringValue=\"genericEntities.sorted\"/>\n                </L7p:SetVariable>\n                <L7p:XslTransformation>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// Sort the generic entities by name\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Direction intValue=\"-1\"/>\n                    <L7p:OtherTargetMessageVariable stringValue=\"genericEntities.sorted\"/>\n                    <L7p:ResourceInfo staticResourceInfo=\"included\">\n                        <L7p:Document stringValue=\"&lt;xsl:stylesheet version=&quot;1.0&quot; xmlns:l7=&quot;http://ns.l7tech.com/2010/04/gateway-management&quot; xmlns:xsl=&quot;http://www.w3.org/1999/XSL/Transform&quot;>&lt;xsl:template match=&quot;/GenericEntities&quot;>    &lt;xsl:copy>        &lt;xsl:for-each select=&quot;GenericEntity&quot;>            &lt;xsl:sort select=&quot;./Name&quot;/>            &lt;xsl:copy-of select=&quot;.&quot;/>        &lt;/xsl:for-each>    &lt;/xsl:copy>&lt;/xsl:template>&lt;/xsl:stylesheet>\"/>\n                    </L7p:ResourceInfo>\n                    <L7p:Target target=\"OTHER\"/>\n                    <L7p:TransformName stringValue=\"\"/>\n                    <L7p:XsltVersion stringValue=\"1.0\"/>\n                </L7p:XslTransformation>\n                <L7p:CacheStorage>\n                    <L7p:CacheEntryKey stringValue=\"${cacheKey}\"/>\n                    <L7p:CacheId stringValue=\"genericEntityList\"/>\n                    <L7p:MaxEntries stringValue=\"1\"/>\n                    <L7p:MaxEntryAgeSeconds stringValue=\"${cacheAge}\"/>\n                    <L7p:MaxEntrySizeBytes stringValue=\"200000\"/>\n                    <L7p:OtherTargetMessageVariable stringValue=\"genericEntities.sorted\"/>\n                    <L7p:StoreSoapFaults booleanValue=\"true\"/>\n                    <L7p:Target target=\"OTHER\"/>\n                </L7p:CacheStorage>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"c3lzdGVt\"/>\n                    <L7p:VariableToSet stringValue=\"source\"/>\n                </L7p:SetVariable>\n                <L7p:AuditDetailAssertion>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// FINE\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Detail stringValue=\"==> Loaded genericEntities.sorted from system and stored to cache\"/>\n                    <L7p:Level stringValue=\"FINE\"/>\n                </L7p:AuditDetailAssertion>\n                <L7p:assertionComment>\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// Retrieve new list and cache\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:assertionComment>\n            </wsp:All>\n            <wsp:All wsp:Usage=\"Required\">\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"RXJyb3Igd2hlbiBsaXN0aW5nIGdlbmVyaWMgZW50aXRpZXM=\"/>\n                    <L7p:VariableToSet stringValue=\"error.msg\"/>\n                </L7p:SetVariable>\n                <L7p:AuditDetailAssertion>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// WARNING\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Detail stringValue=\"==> Error listing generic entities in ${policy.name}\"/>\n                    <L7p:Level stringValue=\"WARNING\"/>\n                </L7p:AuditDetailAssertion>\n                <L7p:FalseAssertion/>\n                <L7p:assertionComment>\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// Failure - set ${error.msg}\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:assertionComment>\n            </wsp:All>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Caching logic\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:OneOrMore>\n        <L7p:Regex>\n            <L7p:AssertionComment assertionComment=\"included\">\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Add source attribute to /GenericEntities element\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:AssertionComment>\n            <L7p:AutoTarget booleanValue=\"false\"/>\n            <L7p:OtherTargetMessageVariable stringValue=\"genericEntities.sorted\"/>\n            <L7p:Regex stringValue=\"&lt;GenericEntities>\"/>\n            <L7p:Replace booleanValue=\"true\"/>\n            <L7p:Replacement stringValue=\"&lt;GenericEntities source=&quot;${source}&quot;>\"/>\n            <L7p:Target target=\"OTHER\"/>\n        </L7p:Regex>\n        <L7p:AuditDetailAssertion>\n            <L7p:AssertionComment assertionComment=\"included\">\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// FINE\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:AssertionComment>\n            <L7p:Detail stringValue=\"==> Leaving Utility Fragment: ${policy.name}\"/>\n            <L7p:Level stringValue=\"FINE\"/>\n        </L7p:AuditDetailAssertion>\n    </wsp:All>\n</wsp:Policy>\n"
        }
      ]
    },
    {
      "guid": "7cbd12a3-9650-4652-be81-8d14a80d5ef3",
      "name": "Utility: List Groups",
      "policyType": "FRAGMENT",
      "checksum": "816ead2a21a480223480ca991f3294ef4652d142",
      "folderPath": "/Gateway Management Utilities/fragments",
      "soap": false,
      "policy": {
        "xml": "<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<wsp:Policy xmlns:L7p=\"http://www.layer7tech.com/ws/policy\" xmlns:wsp=\"http://schemas.xmlsoap.org/ws/2002/12/policy\">\n    <wsp:All wsp:Usage=\"Required\">\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Policy fragment for &quot;Utility: List Groups&quot; encapsulated assertion\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Call Restman and generate a sorted list of IIP groups\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** - Assumes an admin role user has been authenticated\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** - Caches results for ${cacheAge} seconds (default=300). To refresh the cache set ${refresh}=true when calling\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** - Returns a text/xml message variable in ${groups.sorted}\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Inputs:\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - identityProviderIds (string)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - refresh (string)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - cacheAge (string)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Outputs:\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - groups.sorted (message)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - error.msg (string)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** v1.0.0 - Jay MacDonald - 20201107 - Initial Version\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n        </L7p:CommentAssertion>\n        <L7p:AuditDetailAssertion>\n            <L7p:AssertionComment assertionComment=\"included\">\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// FINE\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:AssertionComment>\n            <L7p:Detail stringValue=\"==> Entering Utility Fragment: ${policy.name} (refresh=${refresh})\"/>\n            <L7p:Level stringValue=\"FINE\"/>\n        </L7p:AuditDetailAssertion>\n        <wsp:All wsp:Usage=\"Required\">\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** ${groups.sorted} has the following schema:\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** \"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** &lt;Groups source=&quot;system|cache&quot;>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   &lt;Group id=&quot;string&quot; providerId=&quot;string&quot; providerType=&quot;string&quot; providerName=&quot;string&quot;>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**     &lt;Name>string&lt;/Name>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**     &lt;Description>string&lt;/Description>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   &lt;/Group>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   ...\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** &lt;/Groups>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n            </L7p:CommentAssertion>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Description of ${groups.sorted}\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:All>\n        <wsp:OneOrMore wsp:Usage=\"Required\">\n            <L7p:ComparisonAssertion>\n                <L7p:AssertionComment assertionComment=\"included\">\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// true or false\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:AssertionComment>\n                <L7p:CaseSensitive booleanValue=\"false\"/>\n                <L7p:Expression1 stringValue=\"${cacheAge}\"/>\n                <L7p:Operator operatorNull=\"null\"/>\n                <L7p:Predicates predicates=\"included\">\n                    <L7p:item dataType=\"included\">\n                        <L7p:Type variableDataType=\"int\"/>\n                    </L7p:item>\n                    <L7p:item binary=\"included\">\n                        <L7p:CaseSensitive booleanValue=\"false\"/>\n                        <L7p:Operator operator=\"GT\"/>\n                        <L7p:RightValue stringValue=\"0\"/>\n                    </L7p:item>\n                </L7p:Predicates>\n            </L7p:ComparisonAssertion>\n            <L7p:SetVariable>\n                <L7p:Base64Expression stringValue=\"MzAw\"/>\n                <L7p:DataType variableDataType=\"int\"/>\n                <L7p:VariableToSet stringValue=\"cacheAge\"/>\n            </L7p:SetVariable>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Ensure ${cacheAge} is set, default=300\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:OneOrMore>\n        <wsp:OneOrMore wsp:Usage=\"Required\">\n            <L7p:ComparisonAssertion>\n                <L7p:AssertionComment assertionComment=\"included\">\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// true or false\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:AssertionComment>\n                <L7p:CaseSensitive booleanValue=\"false\"/>\n                <L7p:Expression1 stringValue=\"${refresh}\"/>\n                <L7p:Operator operatorNull=\"null\"/>\n                <L7p:Predicates predicates=\"included\">\n                    <L7p:item dataType=\"included\">\n                        <L7p:Type variableDataType=\"string\"/>\n                    </L7p:item>\n                    <L7p:item regex=\"included\">\n                        <L7p:Pattern stringValue=\"^(true|false)$\"/>\n                    </L7p:item>\n                </L7p:Predicates>\n            </L7p:ComparisonAssertion>\n            <L7p:SetVariable>\n                <L7p:Base64Expression stringValue=\"ZmFsc2U=\"/>\n                <L7p:VariableToSet stringValue=\"refresh\"/>\n            </L7p:SetVariable>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Ensure ${refresh} is set, default=false\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:OneOrMore>\n        <L7p:SetVariable>\n            <L7p:Base64Expression stringValue=\"Z3JvdXBzLnNvcnRlZA==\"/>\n            <L7p:VariableToSet stringValue=\"cacheKey\"/>\n        </L7p:SetVariable>\n        <wsp:OneOrMore wsp:Usage=\"Required\">\n            <wsp:All wsp:Usage=\"Required\">\n                <L7p:ComparisonAssertion>\n                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                    <L7p:Expression1 stringValue=\"${refresh}\"/>\n                    <L7p:Operator operatorNull=\"null\"/>\n                    <L7p:Predicates predicates=\"included\">\n                        <L7p:item dataType=\"included\">\n                            <L7p:Type variableDataType=\"string\"/>\n                        </L7p:item>\n                        <L7p:item binary=\"included\">\n                            <L7p:Negated booleanValue=\"true\"/>\n                            <L7p:RightValue stringValue=\"true\"/>\n                        </L7p:item>\n                    </L7p:Predicates>\n                </L7p:ComparisonAssertion>\n                <L7p:CacheLookup>\n                    <L7p:CacheEntryKey stringValue=\"${cacheKey}\"/>\n                    <L7p:CacheId stringValue=\"groupList\"/>\n                    <L7p:ContentTypeOverride stringValue=\"\"/>\n                    <L7p:MaxEntryAgeSeconds stringValue=\"${cacheAge}\"/>\n                    <L7p:OtherTargetMessageVariable stringValue=\"groups.sorted\"/>\n                    <L7p:Target target=\"OTHER\"/>\n                </L7p:CacheLookup>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"Y2FjaGU=\"/>\n                    <L7p:VariableToSet stringValue=\"source\"/>\n                </L7p:SetVariable>\n                <L7p:AuditDetailAssertion>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// FINE\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Detail stringValue=\"==> Found groups.sorted in the cache\"/>\n                    <L7p:Level stringValue=\"FINE\"/>\n                </L7p:AuditDetailAssertion>\n                <L7p:assertionComment>\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// Look in cache unless asked to refresh cache\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:assertionComment>\n            </wsp:All>\n            <wsp:All wsp:Usage=\"Required\">\n                <L7p:Encapsulated>\n                    <L7p:EncapsulatedAssertionConfigGuid stringValue=\"1ab6158d-33ce-4fa6-a7d8-2b8dc8e31faf\"/>\n                    <L7p:EncapsulatedAssertionConfigName stringValue=\"Utility: List Identity Providers\"/>\n                    <L7p:Parameters mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"cacheAge\"/>\n                            <L7p:value stringValue=\"${cacheAge}\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"refresh\"/>\n                            <L7p:value stringValue=\"${refresh}\"/>\n                        </L7p:entry>\n                    </L7p:Parameters>\n                </L7p:Encapsulated>\n                <wsp:OneOrMore wsp:Usage=\"Required\">\n                    <wsp:All wsp:Usage=\"Required\">\n                        <L7p:ComparisonAssertion>\n                            <L7p:CaseSensitive booleanValue=\"false\"/>\n                            <L7p:Expression1 stringValue=\"${identityProviderIds}\"/>\n                            <L7p:Expression2 stringValue=\"\"/>\n                            <L7p:Negate booleanValue=\"true\"/>\n                            <L7p:Operator operator=\"EMPTY\"/>\n                            <L7p:Predicates predicates=\"included\">\n                                <L7p:item binary=\"included\">\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:Negated booleanValue=\"true\"/>\n                                    <L7p:Operator operator=\"EMPTY\"/>\n                                    <L7p:RightValue stringValue=\"\"/>\n                                </L7p:item>\n                            </L7p:Predicates>\n                        </L7p:ComparisonAssertion>\n                        <L7p:Split>\n                            <L7p:InputVariable stringValue=\"identityProviderIds\"/>\n                            <L7p:OutputVariable stringValue=\"identityProviderIds.results\"/>\n                        </L7p:Split>\n                        <L7p:assertionComment>\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// identity provider ids is set so split into ${identityProviderIds.results}\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:assertionComment>\n                    </wsp:All>\n                    <wsp:All wsp:Usage=\"Required\">\n                        <L7p:ResponseXpathAssertion>\n                            <L7p:VariablePrefix stringValue=\"identityProviderIds\"/>\n                            <L7p:XmlMsgSrc stringValue=\"identityProviders.sorted\"/>\n                            <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                <L7p:Expression stringValue=\"/IdentityProviders/IdentityProvider[Type='Internal' or Type='Federated']/@id\"/>\n                                <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"s\"/>\n                                    <L7p:value stringValue=\"http://schemas.xmlsoap.org/soap/envelope/\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                    </L7p:entry>\n                                </L7p:Namespaces>\n                                <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                            </L7p:XpathExpression>\n                        </L7p:ResponseXpathAssertion>\n                        <L7p:assertionComment>\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// No identity provider ids set, so get list of them\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:assertionComment>\n                    </wsp:All>\n                    <L7p:assertionComment>\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// If identityProviderId is not set, find list of all of them\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:assertionComment>\n                </wsp:OneOrMore>\n                <L7p:AuditDetailAssertion>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// FINE\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Detail stringValue=\"==> identityProviderIds.results ${identityProviderIds.results}\"/>\n                    <L7p:Level stringValue=\"FINE\"/>\n                </L7p:AuditDetailAssertion>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz48R3JvdXBzPg==\"/>\n                    <L7p:VariableToSet stringValue=\"groups.sorted\"/>\n                </L7p:SetVariable>\n                <L7p:ForEachLoop L7p:Usage=\"Required\"\n                    loopVariable=\"identityProviderIds.results\" variablePrefix=\"identityProviderId\">\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Retrieve the type of the identity provider\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:VariablePrefix stringValue=\"providerType\"/>\n                        <L7p:XmlMsgSrc stringValue=\"identityProviders.sorted\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/IdentityProviders/IdentityProvider[@id=$identityProviderId.current]/Type\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Retrieve the type of the identity provider\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:VariablePrefix stringValue=\"providerName\"/>\n                        <L7p:XmlMsgSrc stringValue=\"identityProviders.sorted\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/IdentityProviders/IdentityProvider[@id=$identityProviderId.current]/Name\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <L7p:AuditDetailAssertion>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// FINE\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:Detail stringValue=\"==> Searching for groups in ${providerName.result}\"/>\n                        <L7p:Level stringValue=\"FINE\"/>\n                    </L7p:AuditDetailAssertion>\n                    <L7p:Encapsulated>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// GET groups\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:EncapsulatedAssertionConfigGuid stringValue=\"c8a5a0d5-1ae2-4144-b538-5c311efc1560\"/>\n                        <L7p:EncapsulatedAssertionConfigName stringValue=\"Utility: Call Restman\"/>\n                        <L7p:Parameters mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"element\"/>\n                                <L7p:value stringValue=\"Group\"/>\n                            </L7p:entry>\n                            <L7p:entry>\n                                <L7p:key stringValue=\"message\"/>\n                                <L7p:value stringValue=\"\"/>\n                            </L7p:entry>\n                            <L7p:entry>\n                                <L7p:key stringValue=\"method\"/>\n                                <L7p:value stringValue=\"GET\"/>\n                            </L7p:entry>\n                            <L7p:entry>\n                                <L7p:key stringValue=\"resource\"/>\n                                <L7p:value stringValue=\"identityProviders/${identityProviderId.current}/groups\"/>\n                            </L7p:entry>\n                        </L7p:Parameters>\n                    </L7p:Encapsulated>\n                    <L7p:AuditDetailAssertion>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// FINE\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:Detail stringValue=\"${response.mainpart}\"/>\n                        <L7p:Level stringValue=\"FINE\"/>\n                    </L7p:AuditDetailAssertion>\n                    <wsp:OneOrMore wsp:Usage=\"Required\">\n                        <L7p:ResponseXpathAssertion>\n                            <L7p:VariablePrefix stringValue=\"groups\"/>\n                            <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                <L7p:Expression stringValue=\"/l7:List/l7:Item/l7:Resource/l7:Group\"/>\n                                <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                    </L7p:entry>\n                                </L7p:Namespaces>\n                                <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                            </L7p:XpathExpression>\n                        </L7p:ResponseXpathAssertion>\n                        <L7p:TrueAssertion/>\n                        <L7p:assertionComment>\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Extract the list of groups, never fail\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:assertionComment>\n                    </wsp:OneOrMore>\n                    <L7p:ForEachLoop L7p:Usage=\"Required\"\n                        loopVariable=\"groups.elements\" variablePrefix=\"group\">\n                        <L7p:SetVariable>\n                            <L7p:AssertionComment assertionComment=\"included\">\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Cast to message type for parsing\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:AssertionComment>\n                            <L7p:Base64Expression stringValue=\"JHtncm91cC5jdXJyZW50fQ==\"/>\n                            <L7p:ContentType stringValue=\"text/xml; charset=utf-8\"/>\n                            <L7p:DataType variableDataType=\"message\"/>\n                            <L7p:VariableToSet stringValue=\"group.xml\"/>\n                        </L7p:SetVariable>\n                        <L7p:ResponseXpathAssertion>\n                            <L7p:AssertionComment assertionComment=\"included\">\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Retrieve the group ID\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:AssertionComment>\n                            <L7p:VariablePrefix stringValue=\"id\"/>\n                            <L7p:XmlMsgSrc stringValue=\"group.xml\"/>\n                            <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                <L7p:Expression stringValue=\"/l7:Group/@id\"/>\n                                <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                    </L7p:entry>\n                                </L7p:Namespaces>\n                                <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                            </L7p:XpathExpression>\n                        </L7p:ResponseXpathAssertion>\n                        <L7p:ResponseXpathAssertion>\n                            <L7p:AssertionComment assertionComment=\"included\">\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Retrieve the group's provider ID\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:AssertionComment>\n                            <L7p:VariablePrefix stringValue=\"providerId\"/>\n                            <L7p:XmlMsgSrc stringValue=\"group.xml\"/>\n                            <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                <L7p:Expression stringValue=\"/l7:Group/@providerId\"/>\n                                <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                    </L7p:entry>\n                                </L7p:Namespaces>\n                                <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                            </L7p:XpathExpression>\n                        </L7p:ResponseXpathAssertion>\n                        <L7p:ResponseXpathAssertion>\n                            <L7p:AssertionComment assertionComment=\"included\">\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// retrieve the group name\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:AssertionComment>\n                            <L7p:VariablePrefix stringValue=\"name\"/>\n                            <L7p:XmlMsgSrc stringValue=\"group.xml\"/>\n                            <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                <L7p:Expression stringValue=\"/l7:Group/l7:Name\"/>\n                                <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                    </L7p:entry>\n                                </L7p:Namespaces>\n                                <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                            </L7p:XpathExpression>\n                        </L7p:ResponseXpathAssertion>\n                        <L7p:ResponseXpathAssertion>\n                            <L7p:AssertionComment assertionComment=\"included\">\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// retrieve the group description\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:AssertionComment>\n                            <L7p:VariablePrefix stringValue=\"description\"/>\n                            <L7p:XmlMsgSrc stringValue=\"group.xml\"/>\n                            <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                <L7p:Expression stringValue=\"/l7:Group/l7:Description\"/>\n                                <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                    </L7p:entry>\n                                </L7p:Namespaces>\n                                <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                            </L7p:XpathExpression>\n                        </L7p:ResponseXpathAssertion>\n                        <L7p:SetVariable>\n                            <L7p:Base64Expression stringValue=\"JHtncm91cHMuc29ydGVkfTxHcm91cCBpZD0iJHtpZC5yZXN1bHR9IiBwcm92aWRlcklkPSIke3Byb3ZpZGVySWQucmVzdWx0fSIgcHJvdmlkZXJUeXBlPSIke3Byb3ZpZGVyVHlwZS5yZXN1bHR9IiBwcm92aWRlck5hbWU9IiR7cHJvdmlkZXJOYW1lLnJlc3VsdH0iPjxOYW1lPjwhW0NEQVRBWyR7bmFtZS5yZXN1bHR9XV0+PC9OYW1lPjxEZXNjcmlwdGlvbj48IVtDREFUQVske2Rlc2NyaXB0aW9uLnJlc3VsdH1dXT48L0Rlc2NyaXB0aW9uPjwvR3JvdXA+\"/>\n                            <L7p:VariableToSet stringValue=\"groups.sorted\"/>\n                        </L7p:SetVariable>\n                        <L7p:assertionComment>\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Build the list of groups\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:assertionComment>\n                    </L7p:ForEachLoop>\n                </L7p:ForEachLoop>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"JHtncm91cHMuc29ydGVkfTwvR3JvdXBzPg==\"/>\n                    <L7p:ContentType stringValue=\"text/xml; charset=utf-8\"/>\n                    <L7p:DataType variableDataType=\"message\"/>\n                    <L7p:VariableToSet stringValue=\"groups.sorted\"/>\n                </L7p:SetVariable>\n                <L7p:XslTransformation>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// Sort the groups by identity provider and group name\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Direction intValue=\"-1\"/>\n                    <L7p:OtherTargetMessageVariable stringValue=\"groups.sorted\"/>\n                    <L7p:ResourceInfo staticResourceInfo=\"included\">\n                        <L7p:Document stringValue=\"&lt;xsl:stylesheet version=&quot;1.0&quot; xmlns:l7=&quot;http://ns.l7tech.com/2010/04/gateway-management&quot; xmlns:xsl=&quot;http://www.w3.org/1999/XSL/Transform&quot;>&lt;xsl:template match=&quot;/Groups&quot;>    &lt;xsl:copy>        &lt;xsl:for-each select=&quot;Group&quot;>            &lt;xsl:sort select=&quot;./@providerName&quot;/>            &lt;xsl:sort select=&quot;./Name&quot;/>            &lt;xsl:copy-of select=&quot;.&quot;/>        &lt;/xsl:for-each>    &lt;/xsl:copy>&lt;/xsl:template>&lt;/xsl:stylesheet>\"/>\n                    </L7p:ResourceInfo>\n                    <L7p:Target target=\"OTHER\"/>\n                    <L7p:TransformName stringValue=\"\"/>\n                    <L7p:XsltVersion stringValue=\"1.0\"/>\n                </L7p:XslTransformation>\n                <L7p:CacheStorage>\n                    <L7p:CacheEntryKey stringValue=\"${cacheKey}\"/>\n                    <L7p:CacheId stringValue=\"groupList\"/>\n                    <L7p:MaxEntries stringValue=\"1\"/>\n                    <L7p:MaxEntryAgeSeconds stringValue=\"${cacheAge}\"/>\n                    <L7p:MaxEntrySizeBytes stringValue=\"200000\"/>\n                    <L7p:OtherTargetMessageVariable stringValue=\"groups.sorted\"/>\n                    <L7p:StoreSoapFaults booleanValue=\"true\"/>\n                    <L7p:Target target=\"OTHER\"/>\n                </L7p:CacheStorage>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"c3lzdGVt\"/>\n                    <L7p:VariableToSet stringValue=\"source\"/>\n                </L7p:SetVariable>\n                <L7p:AuditDetailAssertion>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// FINE\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Detail stringValue=\"==> Loaded groups.sorted from system and stored to cache\"/>\n                    <L7p:Level stringValue=\"FINE\"/>\n                </L7p:AuditDetailAssertion>\n                <L7p:assertionComment>\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// Retrieve new list and cache\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:assertionComment>\n            </wsp:All>\n            <wsp:All wsp:Usage=\"Required\">\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"RXJyb3Igd2hlbiBsaXN0aW5nIGdyb3Vwcw==\"/>\n                    <L7p:VariableToSet stringValue=\"error.msg\"/>\n                </L7p:SetVariable>\n                <L7p:AuditDetailAssertion>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// WARNING\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Detail stringValue=\"==> Error listing groups in ${policy.name}\"/>\n                    <L7p:Level stringValue=\"WARNING\"/>\n                </L7p:AuditDetailAssertion>\n                <L7p:FalseAssertion/>\n                <L7p:assertionComment>\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// Failure - set ${error.msg}\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:assertionComment>\n            </wsp:All>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Caching logic\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:OneOrMore>\n        <L7p:Regex>\n            <L7p:AssertionComment assertionComment=\"included\">\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Add source attribute to /Groups element\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:AssertionComment>\n            <L7p:AutoTarget booleanValue=\"false\"/>\n            <L7p:OtherTargetMessageVariable stringValue=\"groups.sorted\"/>\n            <L7p:Regex stringValue=\"&lt;Groups>\"/>\n            <L7p:Replace booleanValue=\"true\"/>\n            <L7p:Replacement stringValue=\"&lt;Groups source=&quot;${source}&quot;>\"/>\n            <L7p:Target target=\"OTHER\"/>\n        </L7p:Regex>\n        <L7p:AuditDetailAssertion>\n            <L7p:AssertionComment assertionComment=\"included\">\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// FINE\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:AssertionComment>\n            <L7p:Detail stringValue=\"==> Leaving Utility Fragment: ${policy.name}\"/>\n            <L7p:Level stringValue=\"FINE\"/>\n        </L7p:AuditDetailAssertion>\n    </wsp:All>\n</wsp:Policy>\n"
      },
      "policyRevisions": [
        {
          "goid": "bed4baf4ff33b7e528854c3965d9bb38",
          "ordinal": 1,
          "active": true,
          "author": "admin",
          "time": "2025-02-05T14:20:38.488Z",
          "xml": "<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<wsp:Policy xmlns:L7p=\"http://www.layer7tech.com/ws/policy\" xmlns:wsp=\"http://schemas.xmlsoap.org/ws/2002/12/policy\">\n    <wsp:All wsp:Usage=\"Required\">\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Policy fragment for &quot;Utility: List Groups&quot; encapsulated assertion\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Call Restman and generate a sorted list of IIP groups\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** - Assumes an admin role user has been authenticated\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** - Caches results for ${cacheAge} seconds (default=300). To refresh the cache set ${refresh}=true when calling\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** - Returns a text/xml message variable in ${groups.sorted}\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Inputs:\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - identityProviderIds (string)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - refresh (string)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - cacheAge (string)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Outputs:\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - groups.sorted (message)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - error.msg (string)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** v1.0.0 - Jay MacDonald - 20201107 - Initial Version\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n        </L7p:CommentAssertion>\n        <L7p:AuditDetailAssertion>\n            <L7p:AssertionComment assertionComment=\"included\">\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// FINE\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:AssertionComment>\n            <L7p:Detail stringValue=\"==> Entering Utility Fragment: ${policy.name} (refresh=${refresh})\"/>\n            <L7p:Level stringValue=\"FINE\"/>\n        </L7p:AuditDetailAssertion>\n        <wsp:All wsp:Usage=\"Required\">\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** ${groups.sorted} has the following schema:\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** \"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** &lt;Groups source=&quot;system|cache&quot;>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   &lt;Group id=&quot;string&quot; providerId=&quot;string&quot; providerType=&quot;string&quot; providerName=&quot;string&quot;>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**     &lt;Name>string&lt;/Name>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**     &lt;Description>string&lt;/Description>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   &lt;/Group>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   ...\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** &lt;/Groups>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n            </L7p:CommentAssertion>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Description of ${groups.sorted}\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:All>\n        <wsp:OneOrMore wsp:Usage=\"Required\">\n            <L7p:ComparisonAssertion>\n                <L7p:AssertionComment assertionComment=\"included\">\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// true or false\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:AssertionComment>\n                <L7p:CaseSensitive booleanValue=\"false\"/>\n                <L7p:Expression1 stringValue=\"${cacheAge}\"/>\n                <L7p:Operator operatorNull=\"null\"/>\n                <L7p:Predicates predicates=\"included\">\n                    <L7p:item dataType=\"included\">\n                        <L7p:Type variableDataType=\"int\"/>\n                    </L7p:item>\n                    <L7p:item binary=\"included\">\n                        <L7p:CaseSensitive booleanValue=\"false\"/>\n                        <L7p:Operator operator=\"GT\"/>\n                        <L7p:RightValue stringValue=\"0\"/>\n                    </L7p:item>\n                </L7p:Predicates>\n            </L7p:ComparisonAssertion>\n            <L7p:SetVariable>\n                <L7p:Base64Expression stringValue=\"MzAw\"/>\n                <L7p:DataType variableDataType=\"int\"/>\n                <L7p:VariableToSet stringValue=\"cacheAge\"/>\n            </L7p:SetVariable>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Ensure ${cacheAge} is set, default=300\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:OneOrMore>\n        <wsp:OneOrMore wsp:Usage=\"Required\">\n            <L7p:ComparisonAssertion>\n                <L7p:AssertionComment assertionComment=\"included\">\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// true or false\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:AssertionComment>\n                <L7p:CaseSensitive booleanValue=\"false\"/>\n                <L7p:Expression1 stringValue=\"${refresh}\"/>\n                <L7p:Operator operatorNull=\"null\"/>\n                <L7p:Predicates predicates=\"included\">\n                    <L7p:item dataType=\"included\">\n                        <L7p:Type variableDataType=\"string\"/>\n                    </L7p:item>\n                    <L7p:item regex=\"included\">\n                        <L7p:Pattern stringValue=\"^(true|false)$\"/>\n                    </L7p:item>\n                </L7p:Predicates>\n            </L7p:ComparisonAssertion>\n            <L7p:SetVariable>\n                <L7p:Base64Expression stringValue=\"ZmFsc2U=\"/>\n                <L7p:VariableToSet stringValue=\"refresh\"/>\n            </L7p:SetVariable>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Ensure ${refresh} is set, default=false\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:OneOrMore>\n        <L7p:SetVariable>\n            <L7p:Base64Expression stringValue=\"Z3JvdXBzLnNvcnRlZA==\"/>\n            <L7p:VariableToSet stringValue=\"cacheKey\"/>\n        </L7p:SetVariable>\n        <wsp:OneOrMore wsp:Usage=\"Required\">\n            <wsp:All wsp:Usage=\"Required\">\n                <L7p:ComparisonAssertion>\n                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                    <L7p:Expression1 stringValue=\"${refresh}\"/>\n                    <L7p:Operator operatorNull=\"null\"/>\n                    <L7p:Predicates predicates=\"included\">\n                        <L7p:item dataType=\"included\">\n                            <L7p:Type variableDataType=\"string\"/>\n                        </L7p:item>\n                        <L7p:item binary=\"included\">\n                            <L7p:Negated booleanValue=\"true\"/>\n                            <L7p:RightValue stringValue=\"true\"/>\n                        </L7p:item>\n                    </L7p:Predicates>\n                </L7p:ComparisonAssertion>\n                <L7p:CacheLookup>\n                    <L7p:CacheEntryKey stringValue=\"${cacheKey}\"/>\n                    <L7p:CacheId stringValue=\"groupList\"/>\n                    <L7p:ContentTypeOverride stringValue=\"\"/>\n                    <L7p:MaxEntryAgeSeconds stringValue=\"${cacheAge}\"/>\n                    <L7p:OtherTargetMessageVariable stringValue=\"groups.sorted\"/>\n                    <L7p:Target target=\"OTHER\"/>\n                </L7p:CacheLookup>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"Y2FjaGU=\"/>\n                    <L7p:VariableToSet stringValue=\"source\"/>\n                </L7p:SetVariable>\n                <L7p:AuditDetailAssertion>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// FINE\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Detail stringValue=\"==> Found groups.sorted in the cache\"/>\n                    <L7p:Level stringValue=\"FINE\"/>\n                </L7p:AuditDetailAssertion>\n                <L7p:assertionComment>\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// Look in cache unless asked to refresh cache\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:assertionComment>\n            </wsp:All>\n            <wsp:All wsp:Usage=\"Required\">\n                <L7p:Encapsulated>\n                    <L7p:EncapsulatedAssertionConfigGuid stringValue=\"1ab6158d-33ce-4fa6-a7d8-2b8dc8e31faf\"/>\n                    <L7p:EncapsulatedAssertionConfigName stringValue=\"Utility: List Identity Providers\"/>\n                    <L7p:Parameters mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"cacheAge\"/>\n                            <L7p:value stringValue=\"${cacheAge}\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"refresh\"/>\n                            <L7p:value stringValue=\"${refresh}\"/>\n                        </L7p:entry>\n                    </L7p:Parameters>\n                </L7p:Encapsulated>\n                <wsp:OneOrMore wsp:Usage=\"Required\">\n                    <wsp:All wsp:Usage=\"Required\">\n                        <L7p:ComparisonAssertion>\n                            <L7p:CaseSensitive booleanValue=\"false\"/>\n                            <L7p:Expression1 stringValue=\"${identityProviderIds}\"/>\n                            <L7p:Expression2 stringValue=\"\"/>\n                            <L7p:Negate booleanValue=\"true\"/>\n                            <L7p:Operator operator=\"EMPTY\"/>\n                            <L7p:Predicates predicates=\"included\">\n                                <L7p:item binary=\"included\">\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:Negated booleanValue=\"true\"/>\n                                    <L7p:Operator operator=\"EMPTY\"/>\n                                    <L7p:RightValue stringValue=\"\"/>\n                                </L7p:item>\n                            </L7p:Predicates>\n                        </L7p:ComparisonAssertion>\n                        <L7p:Split>\n                            <L7p:InputVariable stringValue=\"identityProviderIds\"/>\n                            <L7p:OutputVariable stringValue=\"identityProviderIds.results\"/>\n                        </L7p:Split>\n                        <L7p:assertionComment>\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// identity provider ids is set so split into ${identityProviderIds.results}\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:assertionComment>\n                    </wsp:All>\n                    <wsp:All wsp:Usage=\"Required\">\n                        <L7p:ResponseXpathAssertion>\n                            <L7p:VariablePrefix stringValue=\"identityProviderIds\"/>\n                            <L7p:XmlMsgSrc stringValue=\"identityProviders.sorted\"/>\n                            <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                <L7p:Expression stringValue=\"/IdentityProviders/IdentityProvider[Type='Internal' or Type='Federated']/@id\"/>\n                                <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"s\"/>\n                                    <L7p:value stringValue=\"http://schemas.xmlsoap.org/soap/envelope/\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                    </L7p:entry>\n                                </L7p:Namespaces>\n                                <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                            </L7p:XpathExpression>\n                        </L7p:ResponseXpathAssertion>\n                        <L7p:assertionComment>\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// No identity provider ids set, so get list of them\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:assertionComment>\n                    </wsp:All>\n                    <L7p:assertionComment>\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// If identityProviderId is not set, find list of all of them\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:assertionComment>\n                </wsp:OneOrMore>\n                <L7p:AuditDetailAssertion>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// FINE\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Detail stringValue=\"==> identityProviderIds.results ${identityProviderIds.results}\"/>\n                    <L7p:Level stringValue=\"FINE\"/>\n                </L7p:AuditDetailAssertion>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz48R3JvdXBzPg==\"/>\n                    <L7p:VariableToSet stringValue=\"groups.sorted\"/>\n                </L7p:SetVariable>\n                <L7p:ForEachLoop L7p:Usage=\"Required\"\n                    loopVariable=\"identityProviderIds.results\" variablePrefix=\"identityProviderId\">\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Retrieve the type of the identity provider\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:VariablePrefix stringValue=\"providerType\"/>\n                        <L7p:XmlMsgSrc stringValue=\"identityProviders.sorted\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/IdentityProviders/IdentityProvider[@id=$identityProviderId.current]/Type\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Retrieve the type of the identity provider\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:VariablePrefix stringValue=\"providerName\"/>\n                        <L7p:XmlMsgSrc stringValue=\"identityProviders.sorted\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/IdentityProviders/IdentityProvider[@id=$identityProviderId.current]/Name\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <L7p:AuditDetailAssertion>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// FINE\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:Detail stringValue=\"==> Searching for groups in ${providerName.result}\"/>\n                        <L7p:Level stringValue=\"FINE\"/>\n                    </L7p:AuditDetailAssertion>\n                    <L7p:Encapsulated>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// GET groups\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:EncapsulatedAssertionConfigGuid stringValue=\"c8a5a0d5-1ae2-4144-b538-5c311efc1560\"/>\n                        <L7p:EncapsulatedAssertionConfigName stringValue=\"Utility: Call Restman\"/>\n                        <L7p:Parameters mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"element\"/>\n                                <L7p:value stringValue=\"Group\"/>\n                            </L7p:entry>\n                            <L7p:entry>\n                                <L7p:key stringValue=\"message\"/>\n                                <L7p:value stringValue=\"\"/>\n                            </L7p:entry>\n                            <L7p:entry>\n                                <L7p:key stringValue=\"method\"/>\n                                <L7p:value stringValue=\"GET\"/>\n                            </L7p:entry>\n                            <L7p:entry>\n                                <L7p:key stringValue=\"resource\"/>\n                                <L7p:value stringValue=\"identityProviders/${identityProviderId.current}/groups\"/>\n                            </L7p:entry>\n                        </L7p:Parameters>\n                    </L7p:Encapsulated>\n                    <L7p:AuditDetailAssertion>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// FINE\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:Detail stringValue=\"${response.mainpart}\"/>\n                        <L7p:Level stringValue=\"FINE\"/>\n                    </L7p:AuditDetailAssertion>\n                    <wsp:OneOrMore wsp:Usage=\"Required\">\n                        <L7p:ResponseXpathAssertion>\n                            <L7p:VariablePrefix stringValue=\"groups\"/>\n                            <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                <L7p:Expression stringValue=\"/l7:List/l7:Item/l7:Resource/l7:Group\"/>\n                                <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                    </L7p:entry>\n                                </L7p:Namespaces>\n                                <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                            </L7p:XpathExpression>\n                        </L7p:ResponseXpathAssertion>\n                        <L7p:TrueAssertion/>\n                        <L7p:assertionComment>\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Extract the list of groups, never fail\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:assertionComment>\n                    </wsp:OneOrMore>\n                    <L7p:ForEachLoop L7p:Usage=\"Required\"\n                        loopVariable=\"groups.elements\" variablePrefix=\"group\">\n                        <L7p:SetVariable>\n                            <L7p:AssertionComment assertionComment=\"included\">\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Cast to message type for parsing\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:AssertionComment>\n                            <L7p:Base64Expression stringValue=\"JHtncm91cC5jdXJyZW50fQ==\"/>\n                            <L7p:ContentType stringValue=\"text/xml; charset=utf-8\"/>\n                            <L7p:DataType variableDataType=\"message\"/>\n                            <L7p:VariableToSet stringValue=\"group.xml\"/>\n                        </L7p:SetVariable>\n                        <L7p:ResponseXpathAssertion>\n                            <L7p:AssertionComment assertionComment=\"included\">\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Retrieve the group ID\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:AssertionComment>\n                            <L7p:VariablePrefix stringValue=\"id\"/>\n                            <L7p:XmlMsgSrc stringValue=\"group.xml\"/>\n                            <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                <L7p:Expression stringValue=\"/l7:Group/@id\"/>\n                                <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                    </L7p:entry>\n                                </L7p:Namespaces>\n                                <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                            </L7p:XpathExpression>\n                        </L7p:ResponseXpathAssertion>\n                        <L7p:ResponseXpathAssertion>\n                            <L7p:AssertionComment assertionComment=\"included\">\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Retrieve the group's provider ID\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:AssertionComment>\n                            <L7p:VariablePrefix stringValue=\"providerId\"/>\n                            <L7p:XmlMsgSrc stringValue=\"group.xml\"/>\n                            <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                <L7p:Expression stringValue=\"/l7:Group/@providerId\"/>\n                                <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                    </L7p:entry>\n                                </L7p:Namespaces>\n                                <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                            </L7p:XpathExpression>\n                        </L7p:ResponseXpathAssertion>\n                        <L7p:ResponseXpathAssertion>\n                            <L7p:AssertionComment assertionComment=\"included\">\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// retrieve the group name\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:AssertionComment>\n                            <L7p:VariablePrefix stringValue=\"name\"/>\n                            <L7p:XmlMsgSrc stringValue=\"group.xml\"/>\n                            <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                <L7p:Expression stringValue=\"/l7:Group/l7:Name\"/>\n                                <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                    </L7p:entry>\n                                </L7p:Namespaces>\n                                <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                            </L7p:XpathExpression>\n                        </L7p:ResponseXpathAssertion>\n                        <L7p:ResponseXpathAssertion>\n                            <L7p:AssertionComment assertionComment=\"included\">\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// retrieve the group description\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:AssertionComment>\n                            <L7p:VariablePrefix stringValue=\"description\"/>\n                            <L7p:XmlMsgSrc stringValue=\"group.xml\"/>\n                            <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                <L7p:Expression stringValue=\"/l7:Group/l7:Description\"/>\n                                <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                    </L7p:entry>\n                                </L7p:Namespaces>\n                                <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                            </L7p:XpathExpression>\n                        </L7p:ResponseXpathAssertion>\n                        <L7p:SetVariable>\n                            <L7p:Base64Expression stringValue=\"JHtncm91cHMuc29ydGVkfTxHcm91cCBpZD0iJHtpZC5yZXN1bHR9IiBwcm92aWRlcklkPSIke3Byb3ZpZGVySWQucmVzdWx0fSIgcHJvdmlkZXJUeXBlPSIke3Byb3ZpZGVyVHlwZS5yZXN1bHR9IiBwcm92aWRlck5hbWU9IiR7cHJvdmlkZXJOYW1lLnJlc3VsdH0iPjxOYW1lPjwhW0NEQVRBWyR7bmFtZS5yZXN1bHR9XV0+PC9OYW1lPjxEZXNjcmlwdGlvbj48IVtDREFUQVske2Rlc2NyaXB0aW9uLnJlc3VsdH1dXT48L0Rlc2NyaXB0aW9uPjwvR3JvdXA+\"/>\n                            <L7p:VariableToSet stringValue=\"groups.sorted\"/>\n                        </L7p:SetVariable>\n                        <L7p:assertionComment>\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Build the list of groups\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:assertionComment>\n                    </L7p:ForEachLoop>\n                </L7p:ForEachLoop>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"JHtncm91cHMuc29ydGVkfTwvR3JvdXBzPg==\"/>\n                    <L7p:ContentType stringValue=\"text/xml; charset=utf-8\"/>\n                    <L7p:DataType variableDataType=\"message\"/>\n                    <L7p:VariableToSet stringValue=\"groups.sorted\"/>\n                </L7p:SetVariable>\n                <L7p:XslTransformation>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// Sort the groups by identity provider and group name\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Direction intValue=\"-1\"/>\n                    <L7p:OtherTargetMessageVariable stringValue=\"groups.sorted\"/>\n                    <L7p:ResourceInfo staticResourceInfo=\"included\">\n                        <L7p:Document stringValue=\"&lt;xsl:stylesheet version=&quot;1.0&quot; xmlns:l7=&quot;http://ns.l7tech.com/2010/04/gateway-management&quot; xmlns:xsl=&quot;http://www.w3.org/1999/XSL/Transform&quot;>&lt;xsl:template match=&quot;/Groups&quot;>    &lt;xsl:copy>        &lt;xsl:for-each select=&quot;Group&quot;>            &lt;xsl:sort select=&quot;./@providerName&quot;/>            &lt;xsl:sort select=&quot;./Name&quot;/>            &lt;xsl:copy-of select=&quot;.&quot;/>        &lt;/xsl:for-each>    &lt;/xsl:copy>&lt;/xsl:template>&lt;/xsl:stylesheet>\"/>\n                    </L7p:ResourceInfo>\n                    <L7p:Target target=\"OTHER\"/>\n                    <L7p:TransformName stringValue=\"\"/>\n                    <L7p:XsltVersion stringValue=\"1.0\"/>\n                </L7p:XslTransformation>\n                <L7p:CacheStorage>\n                    <L7p:CacheEntryKey stringValue=\"${cacheKey}\"/>\n                    <L7p:CacheId stringValue=\"groupList\"/>\n                    <L7p:MaxEntries stringValue=\"1\"/>\n                    <L7p:MaxEntryAgeSeconds stringValue=\"${cacheAge}\"/>\n                    <L7p:MaxEntrySizeBytes stringValue=\"200000\"/>\n                    <L7p:OtherTargetMessageVariable stringValue=\"groups.sorted\"/>\n                    <L7p:StoreSoapFaults booleanValue=\"true\"/>\n                    <L7p:Target target=\"OTHER\"/>\n                </L7p:CacheStorage>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"c3lzdGVt\"/>\n                    <L7p:VariableToSet stringValue=\"source\"/>\n                </L7p:SetVariable>\n                <L7p:AuditDetailAssertion>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// FINE\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Detail stringValue=\"==> Loaded groups.sorted from system and stored to cache\"/>\n                    <L7p:Level stringValue=\"FINE\"/>\n                </L7p:AuditDetailAssertion>\n                <L7p:assertionComment>\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// Retrieve new list and cache\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:assertionComment>\n            </wsp:All>\n            <wsp:All wsp:Usage=\"Required\">\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"RXJyb3Igd2hlbiBsaXN0aW5nIGdyb3Vwcw==\"/>\n                    <L7p:VariableToSet stringValue=\"error.msg\"/>\n                </L7p:SetVariable>\n                <L7p:AuditDetailAssertion>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// WARNING\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Detail stringValue=\"==> Error listing groups in ${policy.name}\"/>\n                    <L7p:Level stringValue=\"WARNING\"/>\n                </L7p:AuditDetailAssertion>\n                <L7p:FalseAssertion/>\n                <L7p:assertionComment>\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// Failure - set ${error.msg}\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:assertionComment>\n            </wsp:All>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Caching logic\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:OneOrMore>\n        <L7p:Regex>\n            <L7p:AssertionComment assertionComment=\"included\">\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Add source attribute to /Groups element\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:AssertionComment>\n            <L7p:AutoTarget booleanValue=\"false\"/>\n            <L7p:OtherTargetMessageVariable stringValue=\"groups.sorted\"/>\n            <L7p:Regex stringValue=\"&lt;Groups>\"/>\n            <L7p:Replace booleanValue=\"true\"/>\n            <L7p:Replacement stringValue=\"&lt;Groups source=&quot;${source}&quot;>\"/>\n            <L7p:Target target=\"OTHER\"/>\n        </L7p:Regex>\n        <L7p:AuditDetailAssertion>\n            <L7p:AssertionComment assertionComment=\"included\">\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// FINE\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:AssertionComment>\n            <L7p:Detail stringValue=\"==> Leaving Utility Fragment: ${policy.name}\"/>\n            <L7p:Level stringValue=\"FINE\"/>\n        </L7p:AuditDetailAssertion>\n    </wsp:All>\n</wsp:Policy>\n"
        }
      ]
    },
    {
      "guid": "fbf889bf-cb0b-4067-ac18-4b0ff6d5e6c1",
      "name": "Utility: List HTTP Configurations",
      "policyType": "FRAGMENT",
      "checksum": "6277360ecf8557e5f6790a9f769b1a006b10777e",
      "folderPath": "/Gateway Management Utilities/fragments",
      "soap": false,
      "policy": {
        "xml": "<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<wsp:Policy xmlns:L7p=\"http://www.layer7tech.com/ws/policy\" xmlns:wsp=\"http://schemas.xmlsoap.org/ws/2002/12/policy\">\n    <wsp:All wsp:Usage=\"Required\">\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Policy fragment for &quot;Utility: List HTTP Configurations&quot; encapsulated assertion\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Call Restman and generate a sorted list of HTTP configurations\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** - Assumes an admin role user has been authenticated\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** - Caches results for ${cacheAge} seconds (default=300). To refresh the cache set ${refresh}=true when calling\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** - Returns a text/xml message variable in ${httpConfigurations.sorted}\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Inputs:\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - refresh (string)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - cacheAge (string)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Outputs:\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - httpConfigurations.sorted (message)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - error.msg (string)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** v1.0.0 - Jay MacDonald - 20201107 - Initial Version\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n        </L7p:CommentAssertion>\n        <L7p:AuditDetailAssertion>\n            <L7p:AssertionComment assertionComment=\"included\">\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// FINE\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:AssertionComment>\n            <L7p:Detail stringValue=\"==> Entering Utility Fragment: ${policy.name} (refresh=${refresh})\"/>\n            <L7p:Level stringValue=\"FINE\"/>\n        </L7p:AuditDetailAssertion>\n        <wsp:All wsp:Usage=\"Required\">\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** ${httpConfigurations.sorted} has the following schema:\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** \"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** &lt;HTTPConfigurations source=&quot;system|cache&quot;>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   &lt;HTTPConfiguration id=&quot;string&quot;>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**     &lt;Host>string&lt;/Host>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   &lt;/HTTPConfiguration>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   ...\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** &lt;/HTTPConfigurations>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** \"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** Where:\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   Host = the host name of the HTTP configuration\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n            </L7p:CommentAssertion>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Description of ${httpConfigurations.sorted}\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:All>\n        <wsp:OneOrMore wsp:Usage=\"Required\">\n            <L7p:ComparisonAssertion>\n                <L7p:AssertionComment assertionComment=\"included\">\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// true or false\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:AssertionComment>\n                <L7p:CaseSensitive booleanValue=\"false\"/>\n                <L7p:Expression1 stringValue=\"${cacheAge}\"/>\n                <L7p:Operator operatorNull=\"null\"/>\n                <L7p:Predicates predicates=\"included\">\n                    <L7p:item dataType=\"included\">\n                        <L7p:Type variableDataType=\"int\"/>\n                    </L7p:item>\n                    <L7p:item binary=\"included\">\n                        <L7p:CaseSensitive booleanValue=\"false\"/>\n                        <L7p:Operator operator=\"GT\"/>\n                        <L7p:RightValue stringValue=\"0\"/>\n                    </L7p:item>\n                </L7p:Predicates>\n            </L7p:ComparisonAssertion>\n            <L7p:SetVariable>\n                <L7p:Base64Expression stringValue=\"MzAw\"/>\n                <L7p:DataType variableDataType=\"int\"/>\n                <L7p:VariableToSet stringValue=\"cacheAge\"/>\n            </L7p:SetVariable>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Ensure ${cacheAge} is set, default=300\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:OneOrMore>\n        <wsp:OneOrMore wsp:Usage=\"Required\">\n            <L7p:ComparisonAssertion>\n                <L7p:AssertionComment assertionComment=\"included\">\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// true or false\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:AssertionComment>\n                <L7p:CaseSensitive booleanValue=\"false\"/>\n                <L7p:Expression1 stringValue=\"${refresh}\"/>\n                <L7p:Operator operatorNull=\"null\"/>\n                <L7p:Predicates predicates=\"included\">\n                    <L7p:item dataType=\"included\">\n                        <L7p:Type variableDataType=\"string\"/>\n                    </L7p:item>\n                    <L7p:item regex=\"included\">\n                        <L7p:Pattern stringValue=\"^(true|false)$\"/>\n                    </L7p:item>\n                </L7p:Predicates>\n            </L7p:ComparisonAssertion>\n            <L7p:SetVariable>\n                <L7p:Base64Expression stringValue=\"ZmFsc2U=\"/>\n                <L7p:VariableToSet stringValue=\"refresh\"/>\n            </L7p:SetVariable>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Ensure ${refresh} is set, default=false\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:OneOrMore>\n        <L7p:SetVariable>\n            <L7p:Base64Expression stringValue=\"aHR0cENvbmZpZ3VyYXRpb25zLnNvcnRlZA==\"/>\n            <L7p:VariableToSet stringValue=\"cacheKey\"/>\n        </L7p:SetVariable>\n        <wsp:OneOrMore wsp:Usage=\"Required\">\n            <wsp:All wsp:Usage=\"Required\">\n                <L7p:ComparisonAssertion>\n                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                    <L7p:Expression1 stringValue=\"${refresh}\"/>\n                    <L7p:Operator operatorNull=\"null\"/>\n                    <L7p:Predicates predicates=\"included\">\n                        <L7p:item dataType=\"included\">\n                            <L7p:Type variableDataType=\"string\"/>\n                        </L7p:item>\n                        <L7p:item binary=\"included\">\n                            <L7p:Negated booleanValue=\"true\"/>\n                            <L7p:RightValue stringValue=\"true\"/>\n                        </L7p:item>\n                    </L7p:Predicates>\n                </L7p:ComparisonAssertion>\n                <L7p:CacheLookup>\n                    <L7p:CacheEntryKey stringValue=\"${cacheKey}\"/>\n                    <L7p:CacheId stringValue=\"httpConfigurationList\"/>\n                    <L7p:ContentTypeOverride stringValue=\"\"/>\n                    <L7p:MaxEntryAgeSeconds stringValue=\"${cacheAge}\"/>\n                    <L7p:OtherTargetMessageVariable stringValue=\"httpConfigurations.sorted\"/>\n                    <L7p:Target target=\"OTHER\"/>\n                </L7p:CacheLookup>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"Y2FjaGU=\"/>\n                    <L7p:VariableToSet stringValue=\"source\"/>\n                </L7p:SetVariable>\n                <L7p:AuditDetailAssertion>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// FINE\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Detail stringValue=\"==> Found httpConfigurations.sorted in the cache\"/>\n                    <L7p:Level stringValue=\"FINE\"/>\n                </L7p:AuditDetailAssertion>\n                <L7p:assertionComment>\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// Look in cache unless asked to refresh cache\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:assertionComment>\n            </wsp:All>\n            <wsp:All wsp:Usage=\"Required\">\n                <L7p:Encapsulated>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// GET httpConfigurations\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:EncapsulatedAssertionConfigGuid stringValue=\"c8a5a0d5-1ae2-4144-b538-5c311efc1560\"/>\n                    <L7p:EncapsulatedAssertionConfigName stringValue=\"Utility: Call Restman\"/>\n                    <L7p:Parameters mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"element\"/>\n                            <L7p:value stringValue=\"HttpConfiguration\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"message\"/>\n                            <L7p:value stringValue=\"\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"method\"/>\n                            <L7p:value stringValue=\"GET\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"resource\"/>\n                            <L7p:value stringValue=\"httpConfigurations\"/>\n                        </L7p:entry>\n                    </L7p:Parameters>\n                </L7p:Encapsulated>\n                <wsp:OneOrMore wsp:Usage=\"Required\">\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:VariablePrefix stringValue=\"httpConfigurations\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/l7:List/l7:Item/l7:Resource/l7:HttpConfiguration\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <L7p:TrueAssertion/>\n                    <L7p:assertionComment>\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// Extract the list of HTTP configurations, never fail\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:assertionComment>\n                </wsp:OneOrMore>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz48SFRUUENvbmZpZ3VyYXRpb25zPg==\"/>\n                    <L7p:VariableToSet stringValue=\"httpConfigurations.sorted\"/>\n                </L7p:SetVariable>\n                <L7p:ForEachLoop L7p:Usage=\"Required\"\n                    loopVariable=\"httpConfigurations.elements\" variablePrefix=\"httpConfiguration\">\n                    <L7p:SetVariable>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Cast to message type for parsing\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:Base64Expression stringValue=\"JHtodHRwQ29uZmlndXJhdGlvbi5jdXJyZW50fQ==\"/>\n                        <L7p:ContentType stringValue=\"text/xml; charset=utf-8\"/>\n                        <L7p:DataType variableDataType=\"message\"/>\n                        <L7p:VariableToSet stringValue=\"httpConfiguration.xml\"/>\n                    </L7p:SetVariable>\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Retrieve the HTTP configuration ID\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:VariablePrefix stringValue=\"id\"/>\n                        <L7p:XmlMsgSrc stringValue=\"httpConfiguration.xml\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/l7:HttpConfiguration/@id\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// retrieve the HTTP configuration name\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:VariablePrefix stringValue=\"host\"/>\n                        <L7p:XmlMsgSrc stringValue=\"httpConfiguration.xml\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/l7:HttpConfiguration/l7:Host\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <L7p:SetVariable>\n                        <L7p:Base64Expression stringValue=\"JHtodHRwQ29uZmlndXJhdGlvbnMuc29ydGVkfTxIVFRQQ29uZmlndXJhdGlvbiBpZD0iJHtpZC5yZXN1bHR9Ij48SG9zdD48IVtDREFUQVske2hvc3QucmVzdWx0fV1dPjwvSG9zdD48L0hUVFBDb25maWd1cmF0aW9uPg==\"/>\n                        <L7p:VariableToSet stringValue=\"httpConfigurations.sorted\"/>\n                    </L7p:SetVariable>\n                    <L7p:assertionComment>\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// Build the list of HTTP configuration\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:assertionComment>\n                </L7p:ForEachLoop>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"JHtodHRwQ29uZmlndXJhdGlvbnMuc29ydGVkfTwvSFRUUENvbmZpZ3VyYXRpb25zPg==\"/>\n                    <L7p:ContentType stringValue=\"text/xml; charset=utf-8\"/>\n                    <L7p:DataType variableDataType=\"message\"/>\n                    <L7p:VariableToSet stringValue=\"httpConfigurations.sorted\"/>\n                </L7p:SetVariable>\n                <L7p:XslTransformation>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// Sort the HTTP configurations by name\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Direction intValue=\"-1\"/>\n                    <L7p:OtherTargetMessageVariable stringValue=\"httpConfigurations.sorted\"/>\n                    <L7p:ResourceInfo staticResourceInfo=\"included\">\n                        <L7p:Document stringValue=\"&lt;xsl:stylesheet version=&quot;1.0&quot; xmlns:l7=&quot;http://ns.l7tech.com/2010/04/gateway-management&quot; xmlns:xsl=&quot;http://www.w3.org/1999/XSL/Transform&quot;>&lt;xsl:template match=&quot;/HTTPConfigurations&quot;>    &lt;xsl:copy>        &lt;xsl:for-each select=&quot;HTTPConfiguration&quot;>            &lt;xsl:sort select=&quot;./Host&quot;/>            &lt;xsl:copy-of select=&quot;.&quot;/>        &lt;/xsl:for-each>    &lt;/xsl:copy>&lt;/xsl:template>&lt;/xsl:stylesheet>\"/>\n                    </L7p:ResourceInfo>\n                    <L7p:Target target=\"OTHER\"/>\n                    <L7p:TransformName stringValue=\"\"/>\n                    <L7p:XsltVersion stringValue=\"1.0\"/>\n                </L7p:XslTransformation>\n                <L7p:CacheStorage>\n                    <L7p:CacheEntryKey stringValue=\"${cacheKey}\"/>\n                    <L7p:CacheId stringValue=\"httpConfigurationList\"/>\n                    <L7p:MaxEntries stringValue=\"1\"/>\n                    <L7p:MaxEntryAgeSeconds stringValue=\"${cacheAge}\"/>\n                    <L7p:MaxEntrySizeBytes stringValue=\"200000\"/>\n                    <L7p:OtherTargetMessageVariable stringValue=\"httpConfigurations.sorted\"/>\n                    <L7p:StoreSoapFaults booleanValue=\"true\"/>\n                    <L7p:Target target=\"OTHER\"/>\n                </L7p:CacheStorage>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"c3lzdGVt\"/>\n                    <L7p:VariableToSet stringValue=\"source\"/>\n                </L7p:SetVariable>\n                <L7p:AuditDetailAssertion>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// FINE\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Detail stringValue=\"==> Loaded httpConfigurations.sorted from system and stored to cache\"/>\n                    <L7p:Level stringValue=\"FINE\"/>\n                </L7p:AuditDetailAssertion>\n                <L7p:assertionComment>\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// Retrieve new list and cache\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:assertionComment>\n            </wsp:All>\n            <wsp:All wsp:Usage=\"Required\">\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"RXJyb3Igd2hlbiBsaXN0aW5nIEhUVFAgY29uZmlndXJhdGlvbnM=\"/>\n                    <L7p:VariableToSet stringValue=\"error.msg\"/>\n                </L7p:SetVariable>\n                <L7p:AuditDetailAssertion>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// WARNING\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Detail stringValue=\"==> Error listing HTTP configurations in ${policy.name}\"/>\n                    <L7p:Level stringValue=\"WARNING\"/>\n                </L7p:AuditDetailAssertion>\n                <L7p:FalseAssertion/>\n                <L7p:assertionComment>\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// Failure - set ${error.msg}\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:assertionComment>\n            </wsp:All>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Caching logic\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:OneOrMore>\n        <L7p:Regex>\n            <L7p:AssertionComment assertionComment=\"included\">\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Add source attribute to /HTTPConfigurations element\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:AssertionComment>\n            <L7p:AutoTarget booleanValue=\"false\"/>\n            <L7p:OtherTargetMessageVariable stringValue=\"httpConfigurations.sorted\"/>\n            <L7p:Regex stringValue=\"&lt;HTTPConfigurations>\"/>\n            <L7p:Replace booleanValue=\"true\"/>\n            <L7p:Replacement stringValue=\"&lt;HTTPConfigurations source=&quot;${source}&quot;>\"/>\n            <L7p:Target target=\"OTHER\"/>\n        </L7p:Regex>\n        <L7p:AuditDetailAssertion>\n            <L7p:AssertionComment assertionComment=\"included\">\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// FINE\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:AssertionComment>\n            <L7p:Detail stringValue=\"==> Leaving Utility Fragment: ${policy.name}\"/>\n            <L7p:Level stringValue=\"FINE\"/>\n        </L7p:AuditDetailAssertion>\n    </wsp:All>\n</wsp:Policy>\n"
      },
      "policyRevisions": [
        {
          "goid": "bed4baf4ff33b7e528854c3965d9bb3c",
          "ordinal": 1,
          "active": true,
          "author": "admin",
          "time": "2025-02-05T14:20:38.5Z",
          "xml": "<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<wsp:Policy xmlns:L7p=\"http://www.layer7tech.com/ws/policy\" xmlns:wsp=\"http://schemas.xmlsoap.org/ws/2002/12/policy\">\n    <wsp:All wsp:Usage=\"Required\">\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Policy fragment for &quot;Utility: List HTTP Configurations&quot; encapsulated assertion\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Call Restman and generate a sorted list of HTTP configurations\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** - Assumes an admin role user has been authenticated\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** - Caches results for ${cacheAge} seconds (default=300). To refresh the cache set ${refresh}=true when calling\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** - Returns a text/xml message variable in ${httpConfigurations.sorted}\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Inputs:\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - refresh (string)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - cacheAge (string)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Outputs:\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - httpConfigurations.sorted (message)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - error.msg (string)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** v1.0.0 - Jay MacDonald - 20201107 - Initial Version\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n        </L7p:CommentAssertion>\n        <L7p:AuditDetailAssertion>\n            <L7p:AssertionComment assertionComment=\"included\">\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// FINE\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:AssertionComment>\n            <L7p:Detail stringValue=\"==> Entering Utility Fragment: ${policy.name} (refresh=${refresh})\"/>\n            <L7p:Level stringValue=\"FINE\"/>\n        </L7p:AuditDetailAssertion>\n        <wsp:All wsp:Usage=\"Required\">\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** ${httpConfigurations.sorted} has the following schema:\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** \"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** &lt;HTTPConfigurations source=&quot;system|cache&quot;>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   &lt;HTTPConfiguration id=&quot;string&quot;>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**     &lt;Host>string&lt;/Host>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   &lt;/HTTPConfiguration>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   ...\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** &lt;/HTTPConfigurations>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** \"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** Where:\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   Host = the host name of the HTTP configuration\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n            </L7p:CommentAssertion>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Description of ${httpConfigurations.sorted}\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:All>\n        <wsp:OneOrMore wsp:Usage=\"Required\">\n            <L7p:ComparisonAssertion>\n                <L7p:AssertionComment assertionComment=\"included\">\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// true or false\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:AssertionComment>\n                <L7p:CaseSensitive booleanValue=\"false\"/>\n                <L7p:Expression1 stringValue=\"${cacheAge}\"/>\n                <L7p:Operator operatorNull=\"null\"/>\n                <L7p:Predicates predicates=\"included\">\n                    <L7p:item dataType=\"included\">\n                        <L7p:Type variableDataType=\"int\"/>\n                    </L7p:item>\n                    <L7p:item binary=\"included\">\n                        <L7p:CaseSensitive booleanValue=\"false\"/>\n                        <L7p:Operator operator=\"GT\"/>\n                        <L7p:RightValue stringValue=\"0\"/>\n                    </L7p:item>\n                </L7p:Predicates>\n            </L7p:ComparisonAssertion>\n            <L7p:SetVariable>\n                <L7p:Base64Expression stringValue=\"MzAw\"/>\n                <L7p:DataType variableDataType=\"int\"/>\n                <L7p:VariableToSet stringValue=\"cacheAge\"/>\n            </L7p:SetVariable>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Ensure ${cacheAge} is set, default=300\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:OneOrMore>\n        <wsp:OneOrMore wsp:Usage=\"Required\">\n            <L7p:ComparisonAssertion>\n                <L7p:AssertionComment assertionComment=\"included\">\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// true or false\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:AssertionComment>\n                <L7p:CaseSensitive booleanValue=\"false\"/>\n                <L7p:Expression1 stringValue=\"${refresh}\"/>\n                <L7p:Operator operatorNull=\"null\"/>\n                <L7p:Predicates predicates=\"included\">\n                    <L7p:item dataType=\"included\">\n                        <L7p:Type variableDataType=\"string\"/>\n                    </L7p:item>\n                    <L7p:item regex=\"included\">\n                        <L7p:Pattern stringValue=\"^(true|false)$\"/>\n                    </L7p:item>\n                </L7p:Predicates>\n            </L7p:ComparisonAssertion>\n            <L7p:SetVariable>\n                <L7p:Base64Expression stringValue=\"ZmFsc2U=\"/>\n                <L7p:VariableToSet stringValue=\"refresh\"/>\n            </L7p:SetVariable>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Ensure ${refresh} is set, default=false\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:OneOrMore>\n        <L7p:SetVariable>\n            <L7p:Base64Expression stringValue=\"aHR0cENvbmZpZ3VyYXRpb25zLnNvcnRlZA==\"/>\n            <L7p:VariableToSet stringValue=\"cacheKey\"/>\n        </L7p:SetVariable>\n        <wsp:OneOrMore wsp:Usage=\"Required\">\n            <wsp:All wsp:Usage=\"Required\">\n                <L7p:ComparisonAssertion>\n                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                    <L7p:Expression1 stringValue=\"${refresh}\"/>\n                    <L7p:Operator operatorNull=\"null\"/>\n                    <L7p:Predicates predicates=\"included\">\n                        <L7p:item dataType=\"included\">\n                            <L7p:Type variableDataType=\"string\"/>\n                        </L7p:item>\n                        <L7p:item binary=\"included\">\n                            <L7p:Negated booleanValue=\"true\"/>\n                            <L7p:RightValue stringValue=\"true\"/>\n                        </L7p:item>\n                    </L7p:Predicates>\n                </L7p:ComparisonAssertion>\n                <L7p:CacheLookup>\n                    <L7p:CacheEntryKey stringValue=\"${cacheKey}\"/>\n                    <L7p:CacheId stringValue=\"httpConfigurationList\"/>\n                    <L7p:ContentTypeOverride stringValue=\"\"/>\n                    <L7p:MaxEntryAgeSeconds stringValue=\"${cacheAge}\"/>\n                    <L7p:OtherTargetMessageVariable stringValue=\"httpConfigurations.sorted\"/>\n                    <L7p:Target target=\"OTHER\"/>\n                </L7p:CacheLookup>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"Y2FjaGU=\"/>\n                    <L7p:VariableToSet stringValue=\"source\"/>\n                </L7p:SetVariable>\n                <L7p:AuditDetailAssertion>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// FINE\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Detail stringValue=\"==> Found httpConfigurations.sorted in the cache\"/>\n                    <L7p:Level stringValue=\"FINE\"/>\n                </L7p:AuditDetailAssertion>\n                <L7p:assertionComment>\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// Look in cache unless asked to refresh cache\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:assertionComment>\n            </wsp:All>\n            <wsp:All wsp:Usage=\"Required\">\n                <L7p:Encapsulated>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// GET httpConfigurations\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:EncapsulatedAssertionConfigGuid stringValue=\"c8a5a0d5-1ae2-4144-b538-5c311efc1560\"/>\n                    <L7p:EncapsulatedAssertionConfigName stringValue=\"Utility: Call Restman\"/>\n                    <L7p:Parameters mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"element\"/>\n                            <L7p:value stringValue=\"HttpConfiguration\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"message\"/>\n                            <L7p:value stringValue=\"\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"method\"/>\n                            <L7p:value stringValue=\"GET\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"resource\"/>\n                            <L7p:value stringValue=\"httpConfigurations\"/>\n                        </L7p:entry>\n                    </L7p:Parameters>\n                </L7p:Encapsulated>\n                <wsp:OneOrMore wsp:Usage=\"Required\">\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:VariablePrefix stringValue=\"httpConfigurations\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/l7:List/l7:Item/l7:Resource/l7:HttpConfiguration\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <L7p:TrueAssertion/>\n                    <L7p:assertionComment>\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// Extract the list of HTTP configurations, never fail\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:assertionComment>\n                </wsp:OneOrMore>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz48SFRUUENvbmZpZ3VyYXRpb25zPg==\"/>\n                    <L7p:VariableToSet stringValue=\"httpConfigurations.sorted\"/>\n                </L7p:SetVariable>\n                <L7p:ForEachLoop L7p:Usage=\"Required\"\n                    loopVariable=\"httpConfigurations.elements\" variablePrefix=\"httpConfiguration\">\n                    <L7p:SetVariable>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Cast to message type for parsing\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:Base64Expression stringValue=\"JHtodHRwQ29uZmlndXJhdGlvbi5jdXJyZW50fQ==\"/>\n                        <L7p:ContentType stringValue=\"text/xml; charset=utf-8\"/>\n                        <L7p:DataType variableDataType=\"message\"/>\n                        <L7p:VariableToSet stringValue=\"httpConfiguration.xml\"/>\n                    </L7p:SetVariable>\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Retrieve the HTTP configuration ID\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:VariablePrefix stringValue=\"id\"/>\n                        <L7p:XmlMsgSrc stringValue=\"httpConfiguration.xml\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/l7:HttpConfiguration/@id\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// retrieve the HTTP configuration name\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:VariablePrefix stringValue=\"host\"/>\n                        <L7p:XmlMsgSrc stringValue=\"httpConfiguration.xml\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/l7:HttpConfiguration/l7:Host\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <L7p:SetVariable>\n                        <L7p:Base64Expression stringValue=\"JHtodHRwQ29uZmlndXJhdGlvbnMuc29ydGVkfTxIVFRQQ29uZmlndXJhdGlvbiBpZD0iJHtpZC5yZXN1bHR9Ij48SG9zdD48IVtDREFUQVske2hvc3QucmVzdWx0fV1dPjwvSG9zdD48L0hUVFBDb25maWd1cmF0aW9uPg==\"/>\n                        <L7p:VariableToSet stringValue=\"httpConfigurations.sorted\"/>\n                    </L7p:SetVariable>\n                    <L7p:assertionComment>\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// Build the list of HTTP configuration\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:assertionComment>\n                </L7p:ForEachLoop>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"JHtodHRwQ29uZmlndXJhdGlvbnMuc29ydGVkfTwvSFRUUENvbmZpZ3VyYXRpb25zPg==\"/>\n                    <L7p:ContentType stringValue=\"text/xml; charset=utf-8\"/>\n                    <L7p:DataType variableDataType=\"message\"/>\n                    <L7p:VariableToSet stringValue=\"httpConfigurations.sorted\"/>\n                </L7p:SetVariable>\n                <L7p:XslTransformation>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// Sort the HTTP configurations by name\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Direction intValue=\"-1\"/>\n                    <L7p:OtherTargetMessageVariable stringValue=\"httpConfigurations.sorted\"/>\n                    <L7p:ResourceInfo staticResourceInfo=\"included\">\n                        <L7p:Document stringValue=\"&lt;xsl:stylesheet version=&quot;1.0&quot; xmlns:l7=&quot;http://ns.l7tech.com/2010/04/gateway-management&quot; xmlns:xsl=&quot;http://www.w3.org/1999/XSL/Transform&quot;>&lt;xsl:template match=&quot;/HTTPConfigurations&quot;>    &lt;xsl:copy>        &lt;xsl:for-each select=&quot;HTTPConfiguration&quot;>            &lt;xsl:sort select=&quot;./Host&quot;/>            &lt;xsl:copy-of select=&quot;.&quot;/>        &lt;/xsl:for-each>    &lt;/xsl:copy>&lt;/xsl:template>&lt;/xsl:stylesheet>\"/>\n                    </L7p:ResourceInfo>\n                    <L7p:Target target=\"OTHER\"/>\n                    <L7p:TransformName stringValue=\"\"/>\n                    <L7p:XsltVersion stringValue=\"1.0\"/>\n                </L7p:XslTransformation>\n                <L7p:CacheStorage>\n                    <L7p:CacheEntryKey stringValue=\"${cacheKey}\"/>\n                    <L7p:CacheId stringValue=\"httpConfigurationList\"/>\n                    <L7p:MaxEntries stringValue=\"1\"/>\n                    <L7p:MaxEntryAgeSeconds stringValue=\"${cacheAge}\"/>\n                    <L7p:MaxEntrySizeBytes stringValue=\"200000\"/>\n                    <L7p:OtherTargetMessageVariable stringValue=\"httpConfigurations.sorted\"/>\n                    <L7p:StoreSoapFaults booleanValue=\"true\"/>\n                    <L7p:Target target=\"OTHER\"/>\n                </L7p:CacheStorage>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"c3lzdGVt\"/>\n                    <L7p:VariableToSet stringValue=\"source\"/>\n                </L7p:SetVariable>\n                <L7p:AuditDetailAssertion>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// FINE\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Detail stringValue=\"==> Loaded httpConfigurations.sorted from system and stored to cache\"/>\n                    <L7p:Level stringValue=\"FINE\"/>\n                </L7p:AuditDetailAssertion>\n                <L7p:assertionComment>\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// Retrieve new list and cache\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:assertionComment>\n            </wsp:All>\n            <wsp:All wsp:Usage=\"Required\">\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"RXJyb3Igd2hlbiBsaXN0aW5nIEhUVFAgY29uZmlndXJhdGlvbnM=\"/>\n                    <L7p:VariableToSet stringValue=\"error.msg\"/>\n                </L7p:SetVariable>\n                <L7p:AuditDetailAssertion>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// WARNING\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Detail stringValue=\"==> Error listing HTTP configurations in ${policy.name}\"/>\n                    <L7p:Level stringValue=\"WARNING\"/>\n                </L7p:AuditDetailAssertion>\n                <L7p:FalseAssertion/>\n                <L7p:assertionComment>\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// Failure - set ${error.msg}\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:assertionComment>\n            </wsp:All>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Caching logic\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:OneOrMore>\n        <L7p:Regex>\n            <L7p:AssertionComment assertionComment=\"included\">\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Add source attribute to /HTTPConfigurations element\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:AssertionComment>\n            <L7p:AutoTarget booleanValue=\"false\"/>\n            <L7p:OtherTargetMessageVariable stringValue=\"httpConfigurations.sorted\"/>\n            <L7p:Regex stringValue=\"&lt;HTTPConfigurations>\"/>\n            <L7p:Replace booleanValue=\"true\"/>\n            <L7p:Replacement stringValue=\"&lt;HTTPConfigurations source=&quot;${source}&quot;>\"/>\n            <L7p:Target target=\"OTHER\"/>\n        </L7p:Regex>\n        <L7p:AuditDetailAssertion>\n            <L7p:AssertionComment assertionComment=\"included\">\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// FINE\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:AssertionComment>\n            <L7p:Detail stringValue=\"==> Leaving Utility Fragment: ${policy.name}\"/>\n            <L7p:Level stringValue=\"FINE\"/>\n        </L7p:AuditDetailAssertion>\n    </wsp:All>\n</wsp:Policy>\n"
        }
      ]
    },
    {
      "guid": "7618087f-f586-421d-aeb4-68541e0ebf3a",
      "name": "Utility: List Identity Providers",
      "policyType": "FRAGMENT",
      "checksum": "51d8f721a6e0314f8f90ec266cc8df1e0db1dfd6",
      "folderPath": "/Gateway Management Utilities/fragments",
      "soap": false,
      "policy": {
        "xml": "<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<wsp:Policy xmlns:L7p=\"http://www.layer7tech.com/ws/policy\" xmlns:wsp=\"http://schemas.xmlsoap.org/ws/2002/12/policy\">\n    <wsp:All wsp:Usage=\"Required\">\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Policy fragment for &quot;Utility: List Identity Providers&quot; encapsulated assertion\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Call Restman and generate a sorted list of identity providers\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** - Assumes an admin role user has been authenticated\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** - Caches results for ${cacheAge} seconds (default=300). To refresh the cache set ${refresh}=true when calling\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** - Returns a text/xml message variable in ${identityProviders.sorted}\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Inputs:\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - refresh (string)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - cacheAge (string)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Outputs:\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - identityProviders.sorted (message)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - error.msg (string)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** v1.0.0 - Jay MacDonald - 20201107 - Initial Version\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n        </L7p:CommentAssertion>\n        <L7p:AuditDetailAssertion>\n            <L7p:AssertionComment assertionComment=\"included\">\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// FINE\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:AssertionComment>\n            <L7p:Detail stringValue=\"==> Entering Utility Fragment: ${policy.name} (refresh=${refresh})\"/>\n            <L7p:Level stringValue=\"FINE\"/>\n        </L7p:AuditDetailAssertion>\n        <wsp:All wsp:Usage=\"Required\">\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** ${identityProviders.sorted} has the following schema:\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** \"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** &lt;IdentityProviders source=&quot;system|cache&quot;>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   &lt;IdentityProvider id=&quot;string&quot;>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**     &lt;Name>string&lt;/Name>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**     &lt;Type>string&lt;/Type>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   &lt;/IdentityProvider>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   ...\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** &lt;/IdentityProviders>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** \"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** Where:\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   Name = the name of the identity provider\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   Type = the type of identity provider\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n            </L7p:CommentAssertion>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Description of ${identityProviders.sorted}\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:All>\n        <wsp:OneOrMore wsp:Usage=\"Required\">\n            <L7p:ComparisonAssertion>\n                <L7p:AssertionComment assertionComment=\"included\">\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// true or false\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:AssertionComment>\n                <L7p:CaseSensitive booleanValue=\"false\"/>\n                <L7p:Expression1 stringValue=\"${cacheAge}\"/>\n                <L7p:Operator operatorNull=\"null\"/>\n                <L7p:Predicates predicates=\"included\">\n                    <L7p:item dataType=\"included\">\n                        <L7p:Type variableDataType=\"int\"/>\n                    </L7p:item>\n                    <L7p:item binary=\"included\">\n                        <L7p:CaseSensitive booleanValue=\"false\"/>\n                        <L7p:Operator operator=\"GT\"/>\n                        <L7p:RightValue stringValue=\"0\"/>\n                    </L7p:item>\n                </L7p:Predicates>\n            </L7p:ComparisonAssertion>\n            <L7p:SetVariable>\n                <L7p:Base64Expression stringValue=\"MzAw\"/>\n                <L7p:DataType variableDataType=\"int\"/>\n                <L7p:VariableToSet stringValue=\"cacheAge\"/>\n            </L7p:SetVariable>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Ensure ${cacheAge} is set, default=300\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:OneOrMore>\n        <wsp:OneOrMore wsp:Usage=\"Required\">\n            <L7p:ComparisonAssertion>\n                <L7p:AssertionComment assertionComment=\"included\">\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// true or false\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:AssertionComment>\n                <L7p:CaseSensitive booleanValue=\"false\"/>\n                <L7p:Expression1 stringValue=\"${refresh}\"/>\n                <L7p:Operator operatorNull=\"null\"/>\n                <L7p:Predicates predicates=\"included\">\n                    <L7p:item dataType=\"included\">\n                        <L7p:Type variableDataType=\"string\"/>\n                    </L7p:item>\n                    <L7p:item regex=\"included\">\n                        <L7p:Pattern stringValue=\"^(true|false)$\"/>\n                    </L7p:item>\n                </L7p:Predicates>\n            </L7p:ComparisonAssertion>\n            <L7p:SetVariable>\n                <L7p:Base64Expression stringValue=\"ZmFsc2U=\"/>\n                <L7p:VariableToSet stringValue=\"refresh\"/>\n            </L7p:SetVariable>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Ensure ${refresh} is set, default=false\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:OneOrMore>\n        <L7p:SetVariable>\n            <L7p:Base64Expression stringValue=\"aWRlbnRpdHlQcm92aWRlcnMuc29ydGVk\"/>\n            <L7p:VariableToSet stringValue=\"cacheKey\"/>\n        </L7p:SetVariable>\n        <wsp:OneOrMore wsp:Usage=\"Required\">\n            <wsp:All wsp:Usage=\"Required\">\n                <L7p:ComparisonAssertion>\n                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                    <L7p:Expression1 stringValue=\"${refresh}\"/>\n                    <L7p:Operator operatorNull=\"null\"/>\n                    <L7p:Predicates predicates=\"included\">\n                        <L7p:item dataType=\"included\">\n                            <L7p:Type variableDataType=\"string\"/>\n                        </L7p:item>\n                        <L7p:item binary=\"included\">\n                            <L7p:Negated booleanValue=\"true\"/>\n                            <L7p:RightValue stringValue=\"true\"/>\n                        </L7p:item>\n                    </L7p:Predicates>\n                </L7p:ComparisonAssertion>\n                <L7p:CacheLookup>\n                    <L7p:CacheEntryKey stringValue=\"${cacheKey}\"/>\n                    <L7p:CacheId stringValue=\"identityProviderList\"/>\n                    <L7p:ContentTypeOverride stringValue=\"\"/>\n                    <L7p:MaxEntryAgeSeconds stringValue=\"${cacheAge}\"/>\n                    <L7p:OtherTargetMessageVariable stringValue=\"identityProviders.sorted\"/>\n                    <L7p:Target target=\"OTHER\"/>\n                </L7p:CacheLookup>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"Y2FjaGU=\"/>\n                    <L7p:VariableToSet stringValue=\"source\"/>\n                </L7p:SetVariable>\n                <L7p:AuditDetailAssertion>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// FINE\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Detail stringValue=\"==> Found identityProviders.sorted in the cache\"/>\n                    <L7p:Level stringValue=\"FINE\"/>\n                </L7p:AuditDetailAssertion>\n                <L7p:assertionComment>\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// Look in cache unless asked to refresh cache\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:assertionComment>\n            </wsp:All>\n            <wsp:All wsp:Usage=\"Required\">\n                <L7p:Encapsulated>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// GET identityProviders\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:EncapsulatedAssertionConfigGuid stringValue=\"c8a5a0d5-1ae2-4144-b538-5c311efc1560\"/>\n                    <L7p:EncapsulatedAssertionConfigName stringValue=\"Utility: Call Restman\"/>\n                    <L7p:Parameters mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"element\"/>\n                            <L7p:value stringValue=\"IdentityProvider\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"message\"/>\n                            <L7p:value stringValue=\"\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"method\"/>\n                            <L7p:value stringValue=\"GET\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"resource\"/>\n                            <L7p:value stringValue=\"identityProviders\"/>\n                        </L7p:entry>\n                    </L7p:Parameters>\n                </L7p:Encapsulated>\n                <wsp:OneOrMore wsp:Usage=\"Required\">\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:VariablePrefix stringValue=\"identityProviders\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/l7:List/l7:Item/l7:Resource/l7:IdentityProvider\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <L7p:TrueAssertion/>\n                    <L7p:assertionComment>\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// Extract the list of identity providers, never fail\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:assertionComment>\n                </wsp:OneOrMore>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz48SWRlbnRpdHlQcm92aWRlcnM+\"/>\n                    <L7p:VariableToSet stringValue=\"identityProviders.sorted\"/>\n                </L7p:SetVariable>\n                <L7p:ForEachLoop L7p:Usage=\"Required\"\n                    loopVariable=\"identityProviders.elements\" variablePrefix=\"identityProvider\">\n                    <L7p:SetVariable>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Cast to message type for parsing\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:Base64Expression stringValue=\"JHtpZGVudGl0eVByb3ZpZGVyLmN1cnJlbnR9\"/>\n                        <L7p:ContentType stringValue=\"text/xml; charset=utf-8\"/>\n                        <L7p:DataType variableDataType=\"message\"/>\n                        <L7p:VariableToSet stringValue=\"identityProvider.xml\"/>\n                    </L7p:SetVariable>\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Retrieve the identity provider ID\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:VariablePrefix stringValue=\"id\"/>\n                        <L7p:XmlMsgSrc stringValue=\"identityProvider.xml\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/l7:IdentityProvider/@id\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// retrieve the identity provider name\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:VariablePrefix stringValue=\"name\"/>\n                        <L7p:XmlMsgSrc stringValue=\"identityProvider.xml\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/l7:IdentityProvider/l7:Name\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Retrieve the identity provider type\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:VariablePrefix stringValue=\"type\"/>\n                        <L7p:XmlMsgSrc stringValue=\"identityProvider.xml\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/l7:IdentityProvider/l7:IdentityProviderType\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <L7p:SetVariable>\n                        <L7p:Base64Expression stringValue=\"JHtpZGVudGl0eVByb3ZpZGVycy5zb3J0ZWR9PElkZW50aXR5UHJvdmlkZXIgaWQ9IiR7aWQucmVzdWx0fSI+PE5hbWU+PCFbQ0RBVEFbJHtuYW1lLnJlc3VsdH1dXT48L05hbWU+PFR5cGU+JHt0eXBlLnJlc3VsdH08L1R5cGU+PC9JZGVudGl0eVByb3ZpZGVyPg==\"/>\n                        <L7p:VariableToSet stringValue=\"identityProviders.sorted\"/>\n                    </L7p:SetVariable>\n                    <L7p:assertionComment>\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// Build the list of identity provider\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:assertionComment>\n                </L7p:ForEachLoop>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"JHtpZGVudGl0eVByb3ZpZGVycy5zb3J0ZWR9PC9JZGVudGl0eVByb3ZpZGVycz4=\"/>\n                    <L7p:ContentType stringValue=\"text/xml; charset=utf-8\"/>\n                    <L7p:DataType variableDataType=\"message\"/>\n                    <L7p:VariableToSet stringValue=\"identityProviders.sorted\"/>\n                </L7p:SetVariable>\n                <L7p:XslTransformation>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// Sort the identity providers by name\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Direction intValue=\"-1\"/>\n                    <L7p:OtherTargetMessageVariable stringValue=\"identityProviders.sorted\"/>\n                    <L7p:ResourceInfo staticResourceInfo=\"included\">\n                        <L7p:Document stringValue=\"&lt;xsl:stylesheet version=&quot;1.0&quot; xmlns:l7=&quot;http://ns.l7tech.com/2010/04/gateway-management&quot; xmlns:xsl=&quot;http://www.w3.org/1999/XSL/Transform&quot;>&lt;xsl:template match=&quot;/IdentityProviders&quot;>    &lt;xsl:copy>        &lt;xsl:for-each select=&quot;IdentityProvider&quot;>            &lt;xsl:sort select=&quot;./Name&quot;/>            &lt;xsl:copy-of select=&quot;.&quot;/>        &lt;/xsl:for-each>    &lt;/xsl:copy>&lt;/xsl:template>&lt;/xsl:stylesheet>\"/>\n                    </L7p:ResourceInfo>\n                    <L7p:Target target=\"OTHER\"/>\n                    <L7p:TransformName stringValue=\"\"/>\n                    <L7p:XsltVersion stringValue=\"1.0\"/>\n                </L7p:XslTransformation>\n                <L7p:CacheStorage>\n                    <L7p:CacheEntryKey stringValue=\"${cacheKey}\"/>\n                    <L7p:CacheId stringValue=\"identityProviderList\"/>\n                    <L7p:MaxEntries stringValue=\"1\"/>\n                    <L7p:MaxEntryAgeSeconds stringValue=\"${cacheAge}\"/>\n                    <L7p:MaxEntrySizeBytes stringValue=\"200000\"/>\n                    <L7p:OtherTargetMessageVariable stringValue=\"identityProviders.sorted\"/>\n                    <L7p:StoreSoapFaults booleanValue=\"true\"/>\n                    <L7p:Target target=\"OTHER\"/>\n                </L7p:CacheStorage>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"c3lzdGVt\"/>\n                    <L7p:VariableToSet stringValue=\"source\"/>\n                </L7p:SetVariable>\n                <L7p:AuditDetailAssertion>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// FINE\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Detail stringValue=\"==> Loaded identityProviders.sorted from system and stored to cache\"/>\n                    <L7p:Level stringValue=\"FINE\"/>\n                </L7p:AuditDetailAssertion>\n                <L7p:assertionComment>\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// Retrieve new list and cache\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:assertionComment>\n            </wsp:All>\n            <wsp:All wsp:Usage=\"Required\">\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"RXJyb3Igd2hlbiBsaXN0aW5nIGlkZW50aXR5IHByb3ZpZGVycw==\"/>\n                    <L7p:VariableToSet stringValue=\"error.msg\"/>\n                </L7p:SetVariable>\n                <L7p:AuditDetailAssertion>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// WARNING\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Detail stringValue=\"==> Error listing identity providers in ${policy.name}\"/>\n                    <L7p:Level stringValue=\"WARNING\"/>\n                </L7p:AuditDetailAssertion>\n                <L7p:FalseAssertion/>\n                <L7p:assertionComment>\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// Failure - set ${error.msg}\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:assertionComment>\n            </wsp:All>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Caching logic\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:OneOrMore>\n        <L7p:Regex>\n            <L7p:AssertionComment assertionComment=\"included\">\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Add source attribute to /IdentityProviders element\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:AssertionComment>\n            <L7p:AutoTarget booleanValue=\"false\"/>\n            <L7p:OtherTargetMessageVariable stringValue=\"identityProviders.sorted\"/>\n            <L7p:Regex stringValue=\"&lt;IdentityProviders>\"/>\n            <L7p:Replace booleanValue=\"true\"/>\n            <L7p:Replacement stringValue=\"&lt;IdentityProviders source=&quot;${source}&quot;>\"/>\n            <L7p:Target target=\"OTHER\"/>\n        </L7p:Regex>\n        <L7p:AuditDetailAssertion>\n            <L7p:AssertionComment assertionComment=\"included\">\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// FINE\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:AssertionComment>\n            <L7p:Detail stringValue=\"==> Leaving Utility Fragment: ${policy.name}\"/>\n            <L7p:Level stringValue=\"FINE\"/>\n        </L7p:AuditDetailAssertion>\n    </wsp:All>\n</wsp:Policy>\n"
      },
      "policyRevisions": [
        {
          "goid": "bed4baf4ff33b7e528854c3965d9bb40",
          "ordinal": 1,
          "active": true,
          "author": "admin",
          "time": "2025-02-05T14:20:38.506Z",
          "xml": "<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<wsp:Policy xmlns:L7p=\"http://www.layer7tech.com/ws/policy\" xmlns:wsp=\"http://schemas.xmlsoap.org/ws/2002/12/policy\">\n    <wsp:All wsp:Usage=\"Required\">\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Policy fragment for &quot;Utility: List Identity Providers&quot; encapsulated assertion\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Call Restman and generate a sorted list of identity providers\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** - Assumes an admin role user has been authenticated\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** - Caches results for ${cacheAge} seconds (default=300). To refresh the cache set ${refresh}=true when calling\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** - Returns a text/xml message variable in ${identityProviders.sorted}\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Inputs:\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - refresh (string)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - cacheAge (string)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Outputs:\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - identityProviders.sorted (message)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - error.msg (string)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** v1.0.0 - Jay MacDonald - 20201107 - Initial Version\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n        </L7p:CommentAssertion>\n        <L7p:AuditDetailAssertion>\n            <L7p:AssertionComment assertionComment=\"included\">\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// FINE\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:AssertionComment>\n            <L7p:Detail stringValue=\"==> Entering Utility Fragment: ${policy.name} (refresh=${refresh})\"/>\n            <L7p:Level stringValue=\"FINE\"/>\n        </L7p:AuditDetailAssertion>\n        <wsp:All wsp:Usage=\"Required\">\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** ${identityProviders.sorted} has the following schema:\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** \"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** &lt;IdentityProviders source=&quot;system|cache&quot;>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   &lt;IdentityProvider id=&quot;string&quot;>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**     &lt;Name>string&lt;/Name>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**     &lt;Type>string&lt;/Type>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   &lt;/IdentityProvider>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   ...\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** &lt;/IdentityProviders>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** \"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** Where:\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   Name = the name of the identity provider\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   Type = the type of identity provider\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n            </L7p:CommentAssertion>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Description of ${identityProviders.sorted}\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:All>\n        <wsp:OneOrMore wsp:Usage=\"Required\">\n            <L7p:ComparisonAssertion>\n                <L7p:AssertionComment assertionComment=\"included\">\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// true or false\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:AssertionComment>\n                <L7p:CaseSensitive booleanValue=\"false\"/>\n                <L7p:Expression1 stringValue=\"${cacheAge}\"/>\n                <L7p:Operator operatorNull=\"null\"/>\n                <L7p:Predicates predicates=\"included\">\n                    <L7p:item dataType=\"included\">\n                        <L7p:Type variableDataType=\"int\"/>\n                    </L7p:item>\n                    <L7p:item binary=\"included\">\n                        <L7p:CaseSensitive booleanValue=\"false\"/>\n                        <L7p:Operator operator=\"GT\"/>\n                        <L7p:RightValue stringValue=\"0\"/>\n                    </L7p:item>\n                </L7p:Predicates>\n            </L7p:ComparisonAssertion>\n            <L7p:SetVariable>\n                <L7p:Base64Expression stringValue=\"MzAw\"/>\n                <L7p:DataType variableDataType=\"int\"/>\n                <L7p:VariableToSet stringValue=\"cacheAge\"/>\n            </L7p:SetVariable>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Ensure ${cacheAge} is set, default=300\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:OneOrMore>\n        <wsp:OneOrMore wsp:Usage=\"Required\">\n            <L7p:ComparisonAssertion>\n                <L7p:AssertionComment assertionComment=\"included\">\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// true or false\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:AssertionComment>\n                <L7p:CaseSensitive booleanValue=\"false\"/>\n                <L7p:Expression1 stringValue=\"${refresh}\"/>\n                <L7p:Operator operatorNull=\"null\"/>\n                <L7p:Predicates predicates=\"included\">\n                    <L7p:item dataType=\"included\">\n                        <L7p:Type variableDataType=\"string\"/>\n                    </L7p:item>\n                    <L7p:item regex=\"included\">\n                        <L7p:Pattern stringValue=\"^(true|false)$\"/>\n                    </L7p:item>\n                </L7p:Predicates>\n            </L7p:ComparisonAssertion>\n            <L7p:SetVariable>\n                <L7p:Base64Expression stringValue=\"ZmFsc2U=\"/>\n                <L7p:VariableToSet stringValue=\"refresh\"/>\n            </L7p:SetVariable>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Ensure ${refresh} is set, default=false\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:OneOrMore>\n        <L7p:SetVariable>\n            <L7p:Base64Expression stringValue=\"aWRlbnRpdHlQcm92aWRlcnMuc29ydGVk\"/>\n            <L7p:VariableToSet stringValue=\"cacheKey\"/>\n        </L7p:SetVariable>\n        <wsp:OneOrMore wsp:Usage=\"Required\">\n            <wsp:All wsp:Usage=\"Required\">\n                <L7p:ComparisonAssertion>\n                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                    <L7p:Expression1 stringValue=\"${refresh}\"/>\n                    <L7p:Operator operatorNull=\"null\"/>\n                    <L7p:Predicates predicates=\"included\">\n                        <L7p:item dataType=\"included\">\n                            <L7p:Type variableDataType=\"string\"/>\n                        </L7p:item>\n                        <L7p:item binary=\"included\">\n                            <L7p:Negated booleanValue=\"true\"/>\n                            <L7p:RightValue stringValue=\"true\"/>\n                        </L7p:item>\n                    </L7p:Predicates>\n                </L7p:ComparisonAssertion>\n                <L7p:CacheLookup>\n                    <L7p:CacheEntryKey stringValue=\"${cacheKey}\"/>\n                    <L7p:CacheId stringValue=\"identityProviderList\"/>\n                    <L7p:ContentTypeOverride stringValue=\"\"/>\n                    <L7p:MaxEntryAgeSeconds stringValue=\"${cacheAge}\"/>\n                    <L7p:OtherTargetMessageVariable stringValue=\"identityProviders.sorted\"/>\n                    <L7p:Target target=\"OTHER\"/>\n                </L7p:CacheLookup>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"Y2FjaGU=\"/>\n                    <L7p:VariableToSet stringValue=\"source\"/>\n                </L7p:SetVariable>\n                <L7p:AuditDetailAssertion>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// FINE\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Detail stringValue=\"==> Found identityProviders.sorted in the cache\"/>\n                    <L7p:Level stringValue=\"FINE\"/>\n                </L7p:AuditDetailAssertion>\n                <L7p:assertionComment>\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// Look in cache unless asked to refresh cache\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:assertionComment>\n            </wsp:All>\n            <wsp:All wsp:Usage=\"Required\">\n                <L7p:Encapsulated>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// GET identityProviders\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:EncapsulatedAssertionConfigGuid stringValue=\"c8a5a0d5-1ae2-4144-b538-5c311efc1560\"/>\n                    <L7p:EncapsulatedAssertionConfigName stringValue=\"Utility: Call Restman\"/>\n                    <L7p:Parameters mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"element\"/>\n                            <L7p:value stringValue=\"IdentityProvider\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"message\"/>\n                            <L7p:value stringValue=\"\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"method\"/>\n                            <L7p:value stringValue=\"GET\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"resource\"/>\n                            <L7p:value stringValue=\"identityProviders\"/>\n                        </L7p:entry>\n                    </L7p:Parameters>\n                </L7p:Encapsulated>\n                <wsp:OneOrMore wsp:Usage=\"Required\">\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:VariablePrefix stringValue=\"identityProviders\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/l7:List/l7:Item/l7:Resource/l7:IdentityProvider\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <L7p:TrueAssertion/>\n                    <L7p:assertionComment>\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// Extract the list of identity providers, never fail\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:assertionComment>\n                </wsp:OneOrMore>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz48SWRlbnRpdHlQcm92aWRlcnM+\"/>\n                    <L7p:VariableToSet stringValue=\"identityProviders.sorted\"/>\n                </L7p:SetVariable>\n                <L7p:ForEachLoop L7p:Usage=\"Required\"\n                    loopVariable=\"identityProviders.elements\" variablePrefix=\"identityProvider\">\n                    <L7p:SetVariable>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Cast to message type for parsing\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:Base64Expression stringValue=\"JHtpZGVudGl0eVByb3ZpZGVyLmN1cnJlbnR9\"/>\n                        <L7p:ContentType stringValue=\"text/xml; charset=utf-8\"/>\n                        <L7p:DataType variableDataType=\"message\"/>\n                        <L7p:VariableToSet stringValue=\"identityProvider.xml\"/>\n                    </L7p:SetVariable>\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Retrieve the identity provider ID\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:VariablePrefix stringValue=\"id\"/>\n                        <L7p:XmlMsgSrc stringValue=\"identityProvider.xml\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/l7:IdentityProvider/@id\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// retrieve the identity provider name\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:VariablePrefix stringValue=\"name\"/>\n                        <L7p:XmlMsgSrc stringValue=\"identityProvider.xml\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/l7:IdentityProvider/l7:Name\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Retrieve the identity provider type\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:VariablePrefix stringValue=\"type\"/>\n                        <L7p:XmlMsgSrc stringValue=\"identityProvider.xml\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/l7:IdentityProvider/l7:IdentityProviderType\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <L7p:SetVariable>\n                        <L7p:Base64Expression stringValue=\"JHtpZGVudGl0eVByb3ZpZGVycy5zb3J0ZWR9PElkZW50aXR5UHJvdmlkZXIgaWQ9IiR7aWQucmVzdWx0fSI+PE5hbWU+PCFbQ0RBVEFbJHtuYW1lLnJlc3VsdH1dXT48L05hbWU+PFR5cGU+JHt0eXBlLnJlc3VsdH08L1R5cGU+PC9JZGVudGl0eVByb3ZpZGVyPg==\"/>\n                        <L7p:VariableToSet stringValue=\"identityProviders.sorted\"/>\n                    </L7p:SetVariable>\n                    <L7p:assertionComment>\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// Build the list of identity provider\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:assertionComment>\n                </L7p:ForEachLoop>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"JHtpZGVudGl0eVByb3ZpZGVycy5zb3J0ZWR9PC9JZGVudGl0eVByb3ZpZGVycz4=\"/>\n                    <L7p:ContentType stringValue=\"text/xml; charset=utf-8\"/>\n                    <L7p:DataType variableDataType=\"message\"/>\n                    <L7p:VariableToSet stringValue=\"identityProviders.sorted\"/>\n                </L7p:SetVariable>\n                <L7p:XslTransformation>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// Sort the identity providers by name\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Direction intValue=\"-1\"/>\n                    <L7p:OtherTargetMessageVariable stringValue=\"identityProviders.sorted\"/>\n                    <L7p:ResourceInfo staticResourceInfo=\"included\">\n                        <L7p:Document stringValue=\"&lt;xsl:stylesheet version=&quot;1.0&quot; xmlns:l7=&quot;http://ns.l7tech.com/2010/04/gateway-management&quot; xmlns:xsl=&quot;http://www.w3.org/1999/XSL/Transform&quot;>&lt;xsl:template match=&quot;/IdentityProviders&quot;>    &lt;xsl:copy>        &lt;xsl:for-each select=&quot;IdentityProvider&quot;>            &lt;xsl:sort select=&quot;./Name&quot;/>            &lt;xsl:copy-of select=&quot;.&quot;/>        &lt;/xsl:for-each>    &lt;/xsl:copy>&lt;/xsl:template>&lt;/xsl:stylesheet>\"/>\n                    </L7p:ResourceInfo>\n                    <L7p:Target target=\"OTHER\"/>\n                    <L7p:TransformName stringValue=\"\"/>\n                    <L7p:XsltVersion stringValue=\"1.0\"/>\n                </L7p:XslTransformation>\n                <L7p:CacheStorage>\n                    <L7p:CacheEntryKey stringValue=\"${cacheKey}\"/>\n                    <L7p:CacheId stringValue=\"identityProviderList\"/>\n                    <L7p:MaxEntries stringValue=\"1\"/>\n                    <L7p:MaxEntryAgeSeconds stringValue=\"${cacheAge}\"/>\n                    <L7p:MaxEntrySizeBytes stringValue=\"200000\"/>\n                    <L7p:OtherTargetMessageVariable stringValue=\"identityProviders.sorted\"/>\n                    <L7p:StoreSoapFaults booleanValue=\"true\"/>\n                    <L7p:Target target=\"OTHER\"/>\n                </L7p:CacheStorage>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"c3lzdGVt\"/>\n                    <L7p:VariableToSet stringValue=\"source\"/>\n                </L7p:SetVariable>\n                <L7p:AuditDetailAssertion>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// FINE\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Detail stringValue=\"==> Loaded identityProviders.sorted from system and stored to cache\"/>\n                    <L7p:Level stringValue=\"FINE\"/>\n                </L7p:AuditDetailAssertion>\n                <L7p:assertionComment>\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// Retrieve new list and cache\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:assertionComment>\n            </wsp:All>\n            <wsp:All wsp:Usage=\"Required\">\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"RXJyb3Igd2hlbiBsaXN0aW5nIGlkZW50aXR5IHByb3ZpZGVycw==\"/>\n                    <L7p:VariableToSet stringValue=\"error.msg\"/>\n                </L7p:SetVariable>\n                <L7p:AuditDetailAssertion>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// WARNING\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Detail stringValue=\"==> Error listing identity providers in ${policy.name}\"/>\n                    <L7p:Level stringValue=\"WARNING\"/>\n                </L7p:AuditDetailAssertion>\n                <L7p:FalseAssertion/>\n                <L7p:assertionComment>\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// Failure - set ${error.msg}\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:assertionComment>\n            </wsp:All>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Caching logic\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:OneOrMore>\n        <L7p:Regex>\n            <L7p:AssertionComment assertionComment=\"included\">\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Add source attribute to /IdentityProviders element\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:AssertionComment>\n            <L7p:AutoTarget booleanValue=\"false\"/>\n            <L7p:OtherTargetMessageVariable stringValue=\"identityProviders.sorted\"/>\n            <L7p:Regex stringValue=\"&lt;IdentityProviders>\"/>\n            <L7p:Replace booleanValue=\"true\"/>\n            <L7p:Replacement stringValue=\"&lt;IdentityProviders source=&quot;${source}&quot;>\"/>\n            <L7p:Target target=\"OTHER\"/>\n        </L7p:Regex>\n        <L7p:AuditDetailAssertion>\n            <L7p:AssertionComment assertionComment=\"included\">\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// FINE\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:AssertionComment>\n            <L7p:Detail stringValue=\"==> Leaving Utility Fragment: ${policy.name}\"/>\n            <L7p:Level stringValue=\"FINE\"/>\n        </L7p:AuditDetailAssertion>\n    </wsp:All>\n</wsp:Policy>\n"
        }
      ]
    },
    {
      "guid": "98bdf50c-2273-441a-8d94-d91f0a1bc268",
      "name": "Utility: List JDBC Connections",
      "policyType": "FRAGMENT",
      "checksum": "64809ec4f2ac6a5fe3c665576017879238ad02ed",
      "folderPath": "/Gateway Management Utilities/fragments",
      "soap": false,
      "policy": {
        "xml": "<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<wsp:Policy xmlns:L7p=\"http://www.layer7tech.com/ws/policy\" xmlns:wsp=\"http://schemas.xmlsoap.org/ws/2002/12/policy\">\n    <wsp:All wsp:Usage=\"Required\">\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Policy fragment for &quot;Utility: List JDBC Connections&quot; encapsulated assertion\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Call Restman and generate a sorted list of JDBC connections\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** - Assumes an admin role user has been authenticated\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** - Caches results for ${cacheAge} seconds (default=300). To refresh the cache set ${refresh}=true when calling\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** - Returns a text/xml message variable in ${jdbcConnections.sorted}\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Inputs:\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - refresh (string)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - cacheAge (string)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Outputs:\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - jdbcConnections.sorted (message)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - error.msg (string)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** v1.0.0 - Jay MacDonald - 20201107 - Initial Version\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n        </L7p:CommentAssertion>\n        <L7p:AuditDetailAssertion>\n            <L7p:AssertionComment assertionComment=\"included\">\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// FINE\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:AssertionComment>\n            <L7p:Detail stringValue=\"==> Entering Utility Fragment: ${policy.name} (refresh=${refresh})\"/>\n            <L7p:Level stringValue=\"FINE\"/>\n        </L7p:AuditDetailAssertion>\n        <wsp:All wsp:Usage=\"Required\">\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** ${jdbcConnections.sorted} has the following schema:\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** \"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** &lt;JDBCConnections source=&quot;system|cache&quot;>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   &lt;JDBCConnection id=&quot;string&quot;>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**     &lt;Name>string&lt;/Name>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**     &lt;JDBCURL>string&lt;/JDBCURL>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**     &lt;DriverClass>string&lt;/DriverClass>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**     &lt;Enabled>boolean&lt;/Enabled>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**     &lt;MaxPoolSize>integer&lt;/MaxPoolSize>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**     &lt;MinPoolSize>integer&lt;/MinPoolSize>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   &lt;/JDBCConnection>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   ...\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** &lt;/JDBCConnections>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** \"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** Where:\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   Name = the name of the JDBC connection\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   JDBCURL = the JDBC connection URL\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   DriverClass = the driver class\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   Enabled = true or false\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   MaxPoolSize = the maximum connection pool size\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   MinPoolSize = the minimum connection pool size\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n            </L7p:CommentAssertion>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Description of ${jdbcConnections.sorted}\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:All>\n        <wsp:OneOrMore wsp:Usage=\"Required\">\n            <L7p:ComparisonAssertion>\n                <L7p:AssertionComment assertionComment=\"included\">\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// true or false\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:AssertionComment>\n                <L7p:CaseSensitive booleanValue=\"false\"/>\n                <L7p:Expression1 stringValue=\"${cacheAge}\"/>\n                <L7p:Operator operatorNull=\"null\"/>\n                <L7p:Predicates predicates=\"included\">\n                    <L7p:item dataType=\"included\">\n                        <L7p:Type variableDataType=\"int\"/>\n                    </L7p:item>\n                    <L7p:item binary=\"included\">\n                        <L7p:CaseSensitive booleanValue=\"false\"/>\n                        <L7p:Operator operator=\"GT\"/>\n                        <L7p:RightValue stringValue=\"0\"/>\n                    </L7p:item>\n                </L7p:Predicates>\n            </L7p:ComparisonAssertion>\n            <L7p:SetVariable>\n                <L7p:Base64Expression stringValue=\"MzAw\"/>\n                <L7p:DataType variableDataType=\"int\"/>\n                <L7p:VariableToSet stringValue=\"cacheAge\"/>\n            </L7p:SetVariable>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Ensure ${cacheAge} is set, default=300\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:OneOrMore>\n        <wsp:OneOrMore wsp:Usage=\"Required\">\n            <L7p:ComparisonAssertion>\n                <L7p:AssertionComment assertionComment=\"included\">\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// true or false\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:AssertionComment>\n                <L7p:CaseSensitive booleanValue=\"false\"/>\n                <L7p:Expression1 stringValue=\"${refresh}\"/>\n                <L7p:Operator operatorNull=\"null\"/>\n                <L7p:Predicates predicates=\"included\">\n                    <L7p:item dataType=\"included\">\n                        <L7p:Type variableDataType=\"string\"/>\n                    </L7p:item>\n                    <L7p:item regex=\"included\">\n                        <L7p:Pattern stringValue=\"^(true|false)$\"/>\n                    </L7p:item>\n                </L7p:Predicates>\n            </L7p:ComparisonAssertion>\n            <L7p:SetVariable>\n                <L7p:Base64Expression stringValue=\"ZmFsc2U=\"/>\n                <L7p:VariableToSet stringValue=\"refresh\"/>\n            </L7p:SetVariable>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Ensure ${refresh} is set, default=false\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:OneOrMore>\n        <L7p:SetVariable>\n            <L7p:Base64Expression stringValue=\"amRiY0Nvbm5lY3Rpb25zLnNvcnRlZA==\"/>\n            <L7p:VariableToSet stringValue=\"cacheKey\"/>\n        </L7p:SetVariable>\n        <wsp:OneOrMore wsp:Usage=\"Required\">\n            <wsp:All wsp:Usage=\"Required\">\n                <L7p:ComparisonAssertion>\n                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                    <L7p:Expression1 stringValue=\"${refresh}\"/>\n                    <L7p:Operator operatorNull=\"null\"/>\n                    <L7p:Predicates predicates=\"included\">\n                        <L7p:item dataType=\"included\">\n                            <L7p:Type variableDataType=\"string\"/>\n                        </L7p:item>\n                        <L7p:item binary=\"included\">\n                            <L7p:Negated booleanValue=\"true\"/>\n                            <L7p:RightValue stringValue=\"true\"/>\n                        </L7p:item>\n                    </L7p:Predicates>\n                </L7p:ComparisonAssertion>\n                <L7p:CacheLookup>\n                    <L7p:CacheEntryKey stringValue=\"${cacheKey}\"/>\n                    <L7p:CacheId stringValue=\"jdbcConnectionList\"/>\n                    <L7p:ContentTypeOverride stringValue=\"\"/>\n                    <L7p:MaxEntryAgeSeconds stringValue=\"${cacheAge}\"/>\n                    <L7p:OtherTargetMessageVariable stringValue=\"jdbcConnections.sorted\"/>\n                    <L7p:Target target=\"OTHER\"/>\n                </L7p:CacheLookup>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"Y2FjaGU=\"/>\n                    <L7p:VariableToSet stringValue=\"source\"/>\n                </L7p:SetVariable>\n                <L7p:AuditDetailAssertion>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// FINE\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Detail stringValue=\"==> Found jdbcConnections.sorted in the cache\"/>\n                    <L7p:Level stringValue=\"FINE\"/>\n                </L7p:AuditDetailAssertion>\n                <L7p:assertionComment>\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// Look in cache unless asked to refresh cache\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:assertionComment>\n            </wsp:All>\n            <wsp:All wsp:Usage=\"Required\">\n                <L7p:Encapsulated>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// GET jdbcConnections\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:EncapsulatedAssertionConfigGuid stringValue=\"c8a5a0d5-1ae2-4144-b538-5c311efc1560\"/>\n                    <L7p:EncapsulatedAssertionConfigName stringValue=\"Utility: Call Restman\"/>\n                    <L7p:Parameters mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"element\"/>\n                            <L7p:value stringValue=\"JDBCConnection\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"message\"/>\n                            <L7p:value stringValue=\"\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"method\"/>\n                            <L7p:value stringValue=\"GET\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"resource\"/>\n                            <L7p:value stringValue=\"jdbcConnections\"/>\n                        </L7p:entry>\n                    </L7p:Parameters>\n                </L7p:Encapsulated>\n                <wsp:OneOrMore wsp:Usage=\"Required\">\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:VariablePrefix stringValue=\"jdbcConnections\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/l7:List/l7:Item/l7:Resource/l7:JDBCConnection\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <L7p:TrueAssertion/>\n                    <L7p:assertionComment>\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// Extract the list of JDBC connections, never fail\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:assertionComment>\n                </wsp:OneOrMore>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz48SkRCQ0Nvbm5lY3Rpb25zPg==\"/>\n                    <L7p:VariableToSet stringValue=\"jdbcConnections.sorted\"/>\n                </L7p:SetVariable>\n                <L7p:ForEachLoop L7p:Usage=\"Required\"\n                    loopVariable=\"jdbcConnections.elements\" variablePrefix=\"jdbcConnection\">\n                    <L7p:SetVariable>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Cast to message type for parsing\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:Base64Expression stringValue=\"JHtqZGJjQ29ubmVjdGlvbi5jdXJyZW50fQ==\"/>\n                        <L7p:ContentType stringValue=\"text/xml; charset=utf-8\"/>\n                        <L7p:DataType variableDataType=\"message\"/>\n                        <L7p:VariableToSet stringValue=\"jdbcConnection.xml\"/>\n                    </L7p:SetVariable>\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Retrieve the JDBC connection ID\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:VariablePrefix stringValue=\"id\"/>\n                        <L7p:XmlMsgSrc stringValue=\"jdbcConnection.xml\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/l7:JDBCConnection/@id\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// retrieve the JDBC connection name\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:VariablePrefix stringValue=\"name\"/>\n                        <L7p:XmlMsgSrc stringValue=\"jdbcConnection.xml\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/l7:JDBCConnection/l7:Name\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// retrieve the JDBC enabled state\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:VariablePrefix stringValue=\"enabled\"/>\n                        <L7p:XmlMsgSrc stringValue=\"jdbcConnection.xml\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/l7:JDBCConnection/l7:Enabled\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Retrieve the JDBC connection URL\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:VariablePrefix stringValue=\"jdbcUrl\"/>\n                        <L7p:XmlMsgSrc stringValue=\"jdbcConnection.xml\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/l7:JDBCConnection/l7:Extension/l7:JdbcUrl\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Retrieve the JDBC driver class\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:VariablePrefix stringValue=\"driverClass\"/>\n                        <L7p:XmlMsgSrc stringValue=\"jdbcConnection.xml\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/l7:JDBCConnection/l7:Extension/l7:DriverClass\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Retrieve the JDBC driver class\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:VariablePrefix stringValue=\"maxPoolSize\"/>\n                        <L7p:XmlMsgSrc stringValue=\"jdbcConnection.xml\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/l7:JDBCConnection/l7:Properties/l7:Property[@key='maximumPoolSize']/l7:IntegerValue\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Retrieve the JDBC driver class\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:VariablePrefix stringValue=\"minPoolSize\"/>\n                        <L7p:XmlMsgSrc stringValue=\"jdbcConnection.xml\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/l7:JDBCConnection/l7:Properties/l7:Property[@key='minimumPoolSize']/l7:IntegerValue\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <L7p:SetVariable>\n                        <L7p:Base64Expression stringValue=\"JHtqZGJjQ29ubmVjdGlvbnMuc29ydGVkfTxKREJDQ29ubmVjdGlvbiBpZD0iJHtpZC5yZXN1bHR9Ij48TmFtZT48IVtDREFUQVske25hbWUucmVzdWx0fV1dPjwvTmFtZT48SkRCQ1VSTD48IVtDREFUQVske2pkYmNVcmwucmVzdWx0fV1dPjwvSkRCQ1VSTD48RHJpdmVyQ2xhc3M+JHtkcml2ZXJDbGFzcy5yZXN1bHR9PC9Ecml2ZXJDbGFzcz48RW5hYmxlZD4ke2VuYWJsZWQucmVzdWx0fTwvRW5hYmxlZD48TWF4UG9vbFNpemU+JHttYXhQb29sU2l6ZS5yZXN1bHR9PC9NYXhQb29sU2l6ZT48TWluUG9vbFNpemU+JHttaW5Qb29sU2l6ZS5yZXN1bHR9PC9NaW5Qb29sU2l6ZT48L0pEQkNDb25uZWN0aW9uPg==\"/>\n                        <L7p:VariableToSet stringValue=\"jdbcConnections.sorted\"/>\n                    </L7p:SetVariable>\n                    <L7p:assertionComment>\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// Build the list of JDBC connections\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:assertionComment>\n                </L7p:ForEachLoop>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"JHtqZGJjQ29ubmVjdGlvbnMuc29ydGVkfTwvSkRCQ0Nvbm5lY3Rpb25zPg==\"/>\n                    <L7p:ContentType stringValue=\"text/xml; charset=utf-8\"/>\n                    <L7p:DataType variableDataType=\"message\"/>\n                    <L7p:VariableToSet stringValue=\"jdbcConnections.sorted\"/>\n                </L7p:SetVariable>\n                <L7p:XslTransformation>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// Sort the JDBC connections by name\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Direction intValue=\"-1\"/>\n                    <L7p:OtherTargetMessageVariable stringValue=\"jdbcConnections.sorted\"/>\n                    <L7p:ResourceInfo staticResourceInfo=\"included\">\n                        <L7p:Document stringValue=\"&lt;xsl:stylesheet version=&quot;1.0&quot; xmlns:l7=&quot;http://ns.l7tech.com/2010/04/gateway-management&quot; xmlns:xsl=&quot;http://www.w3.org/1999/XSL/Transform&quot;>&lt;xsl:template match=&quot;/JDBCConnections&quot;>    &lt;xsl:copy>        &lt;xsl:for-each select=&quot;JDBCConnection&quot;>            &lt;xsl:sort select=&quot;./Name&quot;/>            &lt;xsl:copy-of select=&quot;.&quot;/>        &lt;/xsl:for-each>    &lt;/xsl:copy>&lt;/xsl:template>&lt;/xsl:stylesheet>\"/>\n                    </L7p:ResourceInfo>\n                    <L7p:Target target=\"OTHER\"/>\n                    <L7p:TransformName stringValue=\"\"/>\n                    <L7p:XsltVersion stringValue=\"1.0\"/>\n                </L7p:XslTransformation>\n                <L7p:CacheStorage>\n                    <L7p:CacheEntryKey stringValue=\"${cacheKey}\"/>\n                    <L7p:CacheId stringValue=\"jdbcConnectionList\"/>\n                    <L7p:MaxEntries stringValue=\"1\"/>\n                    <L7p:MaxEntryAgeSeconds stringValue=\"${cacheAge}\"/>\n                    <L7p:MaxEntrySizeBytes stringValue=\"200000\"/>\n                    <L7p:OtherTargetMessageVariable stringValue=\"jdbcConnections.sorted\"/>\n                    <L7p:StoreSoapFaults booleanValue=\"true\"/>\n                    <L7p:Target target=\"OTHER\"/>\n                </L7p:CacheStorage>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"c3lzdGVt\"/>\n                    <L7p:VariableToSet stringValue=\"source\"/>\n                </L7p:SetVariable>\n                <L7p:AuditDetailAssertion>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// FINE\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Detail stringValue=\"==> Loaded jdbcConnections.sorted from system and stored to cache\"/>\n                    <L7p:Level stringValue=\"FINE\"/>\n                </L7p:AuditDetailAssertion>\n                <L7p:assertionComment>\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// Retrieve new list and cache\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:assertionComment>\n            </wsp:All>\n            <wsp:All wsp:Usage=\"Required\">\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"RXJyb3Igd2hlbiBsaXN0aW5nIEpEQkMgY29ubmVjdGlvbnM=\"/>\n                    <L7p:VariableToSet stringValue=\"error.msg\"/>\n                </L7p:SetVariable>\n                <L7p:AuditDetailAssertion>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// WARNING\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Detail stringValue=\"==> Error listing JDBC connections in ${policy.name}\"/>\n                    <L7p:Level stringValue=\"WARNING\"/>\n                </L7p:AuditDetailAssertion>\n                <L7p:FalseAssertion/>\n                <L7p:assertionComment>\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// Failure - set ${error.msg}\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:assertionComment>\n            </wsp:All>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Caching logic\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:OneOrMore>\n        <L7p:Regex>\n            <L7p:AssertionComment assertionComment=\"included\">\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Add source attribute to /JDBCConnections element\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:AssertionComment>\n            <L7p:AutoTarget booleanValue=\"false\"/>\n            <L7p:OtherTargetMessageVariable stringValue=\"jdbcConnections.sorted\"/>\n            <L7p:Regex stringValue=\"&lt;JDBCConnections>\"/>\n            <L7p:Replace booleanValue=\"true\"/>\n            <L7p:Replacement stringValue=\"&lt;JDBCConnections source=&quot;${source}&quot;>\"/>\n            <L7p:Target target=\"OTHER\"/>\n        </L7p:Regex>\n        <L7p:AuditDetailAssertion>\n            <L7p:AssertionComment assertionComment=\"included\">\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// FINE\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:AssertionComment>\n            <L7p:Detail stringValue=\"==> Leaving Utility Fragment: ${policy.name}\"/>\n            <L7p:Level stringValue=\"FINE\"/>\n        </L7p:AuditDetailAssertion>\n    </wsp:All>\n</wsp:Policy>\n"
      },
      "policyRevisions": [
        {
          "goid": "bed4baf4ff33b7e528854c3965d9bb44",
          "ordinal": 1,
          "active": true,
          "author": "admin",
          "time": "2025-02-05T14:20:38.514Z",
          "xml": "<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<wsp:Policy xmlns:L7p=\"http://www.layer7tech.com/ws/policy\" xmlns:wsp=\"http://schemas.xmlsoap.org/ws/2002/12/policy\">\n    <wsp:All wsp:Usage=\"Required\">\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Policy fragment for &quot;Utility: List JDBC Connections&quot; encapsulated assertion\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Call Restman and generate a sorted list of JDBC connections\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** - Assumes an admin role user has been authenticated\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** - Caches results for ${cacheAge} seconds (default=300). To refresh the cache set ${refresh}=true when calling\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** - Returns a text/xml message variable in ${jdbcConnections.sorted}\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Inputs:\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - refresh (string)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - cacheAge (string)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Outputs:\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - jdbcConnections.sorted (message)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - error.msg (string)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** v1.0.0 - Jay MacDonald - 20201107 - Initial Version\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n        </L7p:CommentAssertion>\n        <L7p:AuditDetailAssertion>\n            <L7p:AssertionComment assertionComment=\"included\">\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// FINE\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:AssertionComment>\n            <L7p:Detail stringValue=\"==> Entering Utility Fragment: ${policy.name} (refresh=${refresh})\"/>\n            <L7p:Level stringValue=\"FINE\"/>\n        </L7p:AuditDetailAssertion>\n        <wsp:All wsp:Usage=\"Required\">\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** ${jdbcConnections.sorted} has the following schema:\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** \"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** &lt;JDBCConnections source=&quot;system|cache&quot;>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   &lt;JDBCConnection id=&quot;string&quot;>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**     &lt;Name>string&lt;/Name>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**     &lt;JDBCURL>string&lt;/JDBCURL>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**     &lt;DriverClass>string&lt;/DriverClass>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**     &lt;Enabled>boolean&lt;/Enabled>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**     &lt;MaxPoolSize>integer&lt;/MaxPoolSize>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**     &lt;MinPoolSize>integer&lt;/MinPoolSize>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   &lt;/JDBCConnection>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   ...\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** &lt;/JDBCConnections>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** \"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** Where:\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   Name = the name of the JDBC connection\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   JDBCURL = the JDBC connection URL\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   DriverClass = the driver class\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   Enabled = true or false\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   MaxPoolSize = the maximum connection pool size\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   MinPoolSize = the minimum connection pool size\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n            </L7p:CommentAssertion>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Description of ${jdbcConnections.sorted}\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:All>\n        <wsp:OneOrMore wsp:Usage=\"Required\">\n            <L7p:ComparisonAssertion>\n                <L7p:AssertionComment assertionComment=\"included\">\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// true or false\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:AssertionComment>\n                <L7p:CaseSensitive booleanValue=\"false\"/>\n                <L7p:Expression1 stringValue=\"${cacheAge}\"/>\n                <L7p:Operator operatorNull=\"null\"/>\n                <L7p:Predicates predicates=\"included\">\n                    <L7p:item dataType=\"included\">\n                        <L7p:Type variableDataType=\"int\"/>\n                    </L7p:item>\n                    <L7p:item binary=\"included\">\n                        <L7p:CaseSensitive booleanValue=\"false\"/>\n                        <L7p:Operator operator=\"GT\"/>\n                        <L7p:RightValue stringValue=\"0\"/>\n                    </L7p:item>\n                </L7p:Predicates>\n            </L7p:ComparisonAssertion>\n            <L7p:SetVariable>\n                <L7p:Base64Expression stringValue=\"MzAw\"/>\n                <L7p:DataType variableDataType=\"int\"/>\n                <L7p:VariableToSet stringValue=\"cacheAge\"/>\n            </L7p:SetVariable>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Ensure ${cacheAge} is set, default=300\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:OneOrMore>\n        <wsp:OneOrMore wsp:Usage=\"Required\">\n            <L7p:ComparisonAssertion>\n                <L7p:AssertionComment assertionComment=\"included\">\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// true or false\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:AssertionComment>\n                <L7p:CaseSensitive booleanValue=\"false\"/>\n                <L7p:Expression1 stringValue=\"${refresh}\"/>\n                <L7p:Operator operatorNull=\"null\"/>\n                <L7p:Predicates predicates=\"included\">\n                    <L7p:item dataType=\"included\">\n                        <L7p:Type variableDataType=\"string\"/>\n                    </L7p:item>\n                    <L7p:item regex=\"included\">\n                        <L7p:Pattern stringValue=\"^(true|false)$\"/>\n                    </L7p:item>\n                </L7p:Predicates>\n            </L7p:ComparisonAssertion>\n            <L7p:SetVariable>\n                <L7p:Base64Expression stringValue=\"ZmFsc2U=\"/>\n                <L7p:VariableToSet stringValue=\"refresh\"/>\n            </L7p:SetVariable>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Ensure ${refresh} is set, default=false\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:OneOrMore>\n        <L7p:SetVariable>\n            <L7p:Base64Expression stringValue=\"amRiY0Nvbm5lY3Rpb25zLnNvcnRlZA==\"/>\n            <L7p:VariableToSet stringValue=\"cacheKey\"/>\n        </L7p:SetVariable>\n        <wsp:OneOrMore wsp:Usage=\"Required\">\n            <wsp:All wsp:Usage=\"Required\">\n                <L7p:ComparisonAssertion>\n                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                    <L7p:Expression1 stringValue=\"${refresh}\"/>\n                    <L7p:Operator operatorNull=\"null\"/>\n                    <L7p:Predicates predicates=\"included\">\n                        <L7p:item dataType=\"included\">\n                            <L7p:Type variableDataType=\"string\"/>\n                        </L7p:item>\n                        <L7p:item binary=\"included\">\n                            <L7p:Negated booleanValue=\"true\"/>\n                            <L7p:RightValue stringValue=\"true\"/>\n                        </L7p:item>\n                    </L7p:Predicates>\n                </L7p:ComparisonAssertion>\n                <L7p:CacheLookup>\n                    <L7p:CacheEntryKey stringValue=\"${cacheKey}\"/>\n                    <L7p:CacheId stringValue=\"jdbcConnectionList\"/>\n                    <L7p:ContentTypeOverride stringValue=\"\"/>\n                    <L7p:MaxEntryAgeSeconds stringValue=\"${cacheAge}\"/>\n                    <L7p:OtherTargetMessageVariable stringValue=\"jdbcConnections.sorted\"/>\n                    <L7p:Target target=\"OTHER\"/>\n                </L7p:CacheLookup>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"Y2FjaGU=\"/>\n                    <L7p:VariableToSet stringValue=\"source\"/>\n                </L7p:SetVariable>\n                <L7p:AuditDetailAssertion>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// FINE\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Detail stringValue=\"==> Found jdbcConnections.sorted in the cache\"/>\n                    <L7p:Level stringValue=\"FINE\"/>\n                </L7p:AuditDetailAssertion>\n                <L7p:assertionComment>\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// Look in cache unless asked to refresh cache\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:assertionComment>\n            </wsp:All>\n            <wsp:All wsp:Usage=\"Required\">\n                <L7p:Encapsulated>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// GET jdbcConnections\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:EncapsulatedAssertionConfigGuid stringValue=\"c8a5a0d5-1ae2-4144-b538-5c311efc1560\"/>\n                    <L7p:EncapsulatedAssertionConfigName stringValue=\"Utility: Call Restman\"/>\n                    <L7p:Parameters mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"element\"/>\n                            <L7p:value stringValue=\"JDBCConnection\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"message\"/>\n                            <L7p:value stringValue=\"\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"method\"/>\n                            <L7p:value stringValue=\"GET\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"resource\"/>\n                            <L7p:value stringValue=\"jdbcConnections\"/>\n                        </L7p:entry>\n                    </L7p:Parameters>\n                </L7p:Encapsulated>\n                <wsp:OneOrMore wsp:Usage=\"Required\">\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:VariablePrefix stringValue=\"jdbcConnections\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/l7:List/l7:Item/l7:Resource/l7:JDBCConnection\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <L7p:TrueAssertion/>\n                    <L7p:assertionComment>\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// Extract the list of JDBC connections, never fail\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:assertionComment>\n                </wsp:OneOrMore>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz48SkRCQ0Nvbm5lY3Rpb25zPg==\"/>\n                    <L7p:VariableToSet stringValue=\"jdbcConnections.sorted\"/>\n                </L7p:SetVariable>\n                <L7p:ForEachLoop L7p:Usage=\"Required\"\n                    loopVariable=\"jdbcConnections.elements\" variablePrefix=\"jdbcConnection\">\n                    <L7p:SetVariable>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Cast to message type for parsing\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:Base64Expression stringValue=\"JHtqZGJjQ29ubmVjdGlvbi5jdXJyZW50fQ==\"/>\n                        <L7p:ContentType stringValue=\"text/xml; charset=utf-8\"/>\n                        <L7p:DataType variableDataType=\"message\"/>\n                        <L7p:VariableToSet stringValue=\"jdbcConnection.xml\"/>\n                    </L7p:SetVariable>\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Retrieve the JDBC connection ID\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:VariablePrefix stringValue=\"id\"/>\n                        <L7p:XmlMsgSrc stringValue=\"jdbcConnection.xml\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/l7:JDBCConnection/@id\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// retrieve the JDBC connection name\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:VariablePrefix stringValue=\"name\"/>\n                        <L7p:XmlMsgSrc stringValue=\"jdbcConnection.xml\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/l7:JDBCConnection/l7:Name\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// retrieve the JDBC enabled state\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:VariablePrefix stringValue=\"enabled\"/>\n                        <L7p:XmlMsgSrc stringValue=\"jdbcConnection.xml\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/l7:JDBCConnection/l7:Enabled\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Retrieve the JDBC connection URL\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:VariablePrefix stringValue=\"jdbcUrl\"/>\n                        <L7p:XmlMsgSrc stringValue=\"jdbcConnection.xml\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/l7:JDBCConnection/l7:Extension/l7:JdbcUrl\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Retrieve the JDBC driver class\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:VariablePrefix stringValue=\"driverClass\"/>\n                        <L7p:XmlMsgSrc stringValue=\"jdbcConnection.xml\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/l7:JDBCConnection/l7:Extension/l7:DriverClass\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Retrieve the JDBC driver class\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:VariablePrefix stringValue=\"maxPoolSize\"/>\n                        <L7p:XmlMsgSrc stringValue=\"jdbcConnection.xml\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/l7:JDBCConnection/l7:Properties/l7:Property[@key='maximumPoolSize']/l7:IntegerValue\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Retrieve the JDBC driver class\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:VariablePrefix stringValue=\"minPoolSize\"/>\n                        <L7p:XmlMsgSrc stringValue=\"jdbcConnection.xml\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/l7:JDBCConnection/l7:Properties/l7:Property[@key='minimumPoolSize']/l7:IntegerValue\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <L7p:SetVariable>\n                        <L7p:Base64Expression stringValue=\"JHtqZGJjQ29ubmVjdGlvbnMuc29ydGVkfTxKREJDQ29ubmVjdGlvbiBpZD0iJHtpZC5yZXN1bHR9Ij48TmFtZT48IVtDREFUQVske25hbWUucmVzdWx0fV1dPjwvTmFtZT48SkRCQ1VSTD48IVtDREFUQVske2pkYmNVcmwucmVzdWx0fV1dPjwvSkRCQ1VSTD48RHJpdmVyQ2xhc3M+JHtkcml2ZXJDbGFzcy5yZXN1bHR9PC9Ecml2ZXJDbGFzcz48RW5hYmxlZD4ke2VuYWJsZWQucmVzdWx0fTwvRW5hYmxlZD48TWF4UG9vbFNpemU+JHttYXhQb29sU2l6ZS5yZXN1bHR9PC9NYXhQb29sU2l6ZT48TWluUG9vbFNpemU+JHttaW5Qb29sU2l6ZS5yZXN1bHR9PC9NaW5Qb29sU2l6ZT48L0pEQkNDb25uZWN0aW9uPg==\"/>\n                        <L7p:VariableToSet stringValue=\"jdbcConnections.sorted\"/>\n                    </L7p:SetVariable>\n                    <L7p:assertionComment>\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// Build the list of JDBC connections\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:assertionComment>\n                </L7p:ForEachLoop>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"JHtqZGJjQ29ubmVjdGlvbnMuc29ydGVkfTwvSkRCQ0Nvbm5lY3Rpb25zPg==\"/>\n                    <L7p:ContentType stringValue=\"text/xml; charset=utf-8\"/>\n                    <L7p:DataType variableDataType=\"message\"/>\n                    <L7p:VariableToSet stringValue=\"jdbcConnections.sorted\"/>\n                </L7p:SetVariable>\n                <L7p:XslTransformation>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// Sort the JDBC connections by name\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Direction intValue=\"-1\"/>\n                    <L7p:OtherTargetMessageVariable stringValue=\"jdbcConnections.sorted\"/>\n                    <L7p:ResourceInfo staticResourceInfo=\"included\">\n                        <L7p:Document stringValue=\"&lt;xsl:stylesheet version=&quot;1.0&quot; xmlns:l7=&quot;http://ns.l7tech.com/2010/04/gateway-management&quot; xmlns:xsl=&quot;http://www.w3.org/1999/XSL/Transform&quot;>&lt;xsl:template match=&quot;/JDBCConnections&quot;>    &lt;xsl:copy>        &lt;xsl:for-each select=&quot;JDBCConnection&quot;>            &lt;xsl:sort select=&quot;./Name&quot;/>            &lt;xsl:copy-of select=&quot;.&quot;/>        &lt;/xsl:for-each>    &lt;/xsl:copy>&lt;/xsl:template>&lt;/xsl:stylesheet>\"/>\n                    </L7p:ResourceInfo>\n                    <L7p:Target target=\"OTHER\"/>\n                    <L7p:TransformName stringValue=\"\"/>\n                    <L7p:XsltVersion stringValue=\"1.0\"/>\n                </L7p:XslTransformation>\n                <L7p:CacheStorage>\n                    <L7p:CacheEntryKey stringValue=\"${cacheKey}\"/>\n                    <L7p:CacheId stringValue=\"jdbcConnectionList\"/>\n                    <L7p:MaxEntries stringValue=\"1\"/>\n                    <L7p:MaxEntryAgeSeconds stringValue=\"${cacheAge}\"/>\n                    <L7p:MaxEntrySizeBytes stringValue=\"200000\"/>\n                    <L7p:OtherTargetMessageVariable stringValue=\"jdbcConnections.sorted\"/>\n                    <L7p:StoreSoapFaults booleanValue=\"true\"/>\n                    <L7p:Target target=\"OTHER\"/>\n                </L7p:CacheStorage>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"c3lzdGVt\"/>\n                    <L7p:VariableToSet stringValue=\"source\"/>\n                </L7p:SetVariable>\n                <L7p:AuditDetailAssertion>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// FINE\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Detail stringValue=\"==> Loaded jdbcConnections.sorted from system and stored to cache\"/>\n                    <L7p:Level stringValue=\"FINE\"/>\n                </L7p:AuditDetailAssertion>\n                <L7p:assertionComment>\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// Retrieve new list and cache\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:assertionComment>\n            </wsp:All>\n            <wsp:All wsp:Usage=\"Required\">\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"RXJyb3Igd2hlbiBsaXN0aW5nIEpEQkMgY29ubmVjdGlvbnM=\"/>\n                    <L7p:VariableToSet stringValue=\"error.msg\"/>\n                </L7p:SetVariable>\n                <L7p:AuditDetailAssertion>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// WARNING\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Detail stringValue=\"==> Error listing JDBC connections in ${policy.name}\"/>\n                    <L7p:Level stringValue=\"WARNING\"/>\n                </L7p:AuditDetailAssertion>\n                <L7p:FalseAssertion/>\n                <L7p:assertionComment>\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// Failure - set ${error.msg}\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:assertionComment>\n            </wsp:All>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Caching logic\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:OneOrMore>\n        <L7p:Regex>\n            <L7p:AssertionComment assertionComment=\"included\">\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Add source attribute to /JDBCConnections element\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:AssertionComment>\n            <L7p:AutoTarget booleanValue=\"false\"/>\n            <L7p:OtherTargetMessageVariable stringValue=\"jdbcConnections.sorted\"/>\n            <L7p:Regex stringValue=\"&lt;JDBCConnections>\"/>\n            <L7p:Replace booleanValue=\"true\"/>\n            <L7p:Replacement stringValue=\"&lt;JDBCConnections source=&quot;${source}&quot;>\"/>\n            <L7p:Target target=\"OTHER\"/>\n        </L7p:Regex>\n        <L7p:AuditDetailAssertion>\n            <L7p:AssertionComment assertionComment=\"included\">\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// FINE\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:AssertionComment>\n            <L7p:Detail stringValue=\"==> Leaving Utility Fragment: ${policy.name}\"/>\n            <L7p:Level stringValue=\"FINE\"/>\n        </L7p:AuditDetailAssertion>\n    </wsp:All>\n</wsp:Policy>\n"
        }
      ]
    },
    {
      "guid": "ce8a2a1e-7f41-470c-aa4a-0203afefb27c",
      "name": "Utility: List JMS Destinations",
      "policyType": "FRAGMENT",
      "checksum": "ccf90f1497ec4d01490cb8109a06cf9b8b94e06a",
      "folderPath": "/Gateway Management Utilities/fragments",
      "soap": false,
      "policy": {
        "xml": "<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<wsp:Policy xmlns:L7p=\"http://www.layer7tech.com/ws/policy\" xmlns:wsp=\"http://schemas.xmlsoap.org/ws/2002/12/policy\">\n    <wsp:All wsp:Usage=\"Required\">\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Policy fragment for &quot;Utility: List JMS Destinations&quot; encapsulated assertion\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Call Restman and generate a sorted list of JMS destinations\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** - Assumes an admin role user has been authenticated\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** - Caches results for ${cacheAge} seconds (default=300). To refresh the cache set ${refresh}=true when calling\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** - Returns a text/xml message variable in ${jmsDestinations.sorted}\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Inputs:\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - refresh (string)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - cacheAge (string)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Outputs:\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - jmsDestinations.sorted (message)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - error.msg (string)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** v1.0.0 - Jay MacDonald - 20201107 - Initial Version\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n        </L7p:CommentAssertion>\n        <L7p:AuditDetailAssertion>\n            <L7p:AssertionComment assertionComment=\"included\">\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// FINE\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:AssertionComment>\n            <L7p:Detail stringValue=\"==> Entering Utility Fragment: ${policy.name} (refresh=${refresh})\"/>\n            <L7p:Level stringValue=\"FINE\"/>\n        </L7p:AuditDetailAssertion>\n        <wsp:All wsp:Usage=\"Required\">\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** ${jmsDestinations.sorted} has the following schema:\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** \"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** &lt;JMSDestinations source=&quot;system|cache&quot;>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   &lt;JMSDestination id=&quot;string&quot;>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**     &lt;Name>string&lt;/Name>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**     &lt;Type>string&lt;/Type>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**     &lt;Direction>string&lt;/Direction>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**     &lt;Enabled>string&lt;/Enabled>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**     &lt;IsTemplate>string&lt;/IsTemplate>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   &lt;/JMSDestination>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   ...\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** &lt;/JMSDestinations>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** \"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** Where:\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   Name = the name of the JMS destination\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n            </L7p:CommentAssertion>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Description of ${jmsDestinations.sorted}\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:All>\n        <wsp:OneOrMore wsp:Usage=\"Required\">\n            <L7p:ComparisonAssertion>\n                <L7p:AssertionComment assertionComment=\"included\">\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// true or false\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:AssertionComment>\n                <L7p:CaseSensitive booleanValue=\"false\"/>\n                <L7p:Expression1 stringValue=\"${cacheAge}\"/>\n                <L7p:Operator operatorNull=\"null\"/>\n                <L7p:Predicates predicates=\"included\">\n                    <L7p:item dataType=\"included\">\n                        <L7p:Type variableDataType=\"int\"/>\n                    </L7p:item>\n                    <L7p:item binary=\"included\">\n                        <L7p:CaseSensitive booleanValue=\"false\"/>\n                        <L7p:Operator operator=\"GT\"/>\n                        <L7p:RightValue stringValue=\"0\"/>\n                    </L7p:item>\n                </L7p:Predicates>\n            </L7p:ComparisonAssertion>\n            <L7p:SetVariable>\n                <L7p:Base64Expression stringValue=\"MzAw\"/>\n                <L7p:DataType variableDataType=\"int\"/>\n                <L7p:VariableToSet stringValue=\"cacheAge\"/>\n            </L7p:SetVariable>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Ensure ${cacheAge} is set, default=300\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:OneOrMore>\n        <wsp:OneOrMore wsp:Usage=\"Required\">\n            <L7p:ComparisonAssertion>\n                <L7p:AssertionComment assertionComment=\"included\">\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// true or false\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:AssertionComment>\n                <L7p:CaseSensitive booleanValue=\"false\"/>\n                <L7p:Expression1 stringValue=\"${refresh}\"/>\n                <L7p:Operator operatorNull=\"null\"/>\n                <L7p:Predicates predicates=\"included\">\n                    <L7p:item dataType=\"included\">\n                        <L7p:Type variableDataType=\"string\"/>\n                    </L7p:item>\n                    <L7p:item regex=\"included\">\n                        <L7p:Pattern stringValue=\"^(true|false)$\"/>\n                    </L7p:item>\n                </L7p:Predicates>\n            </L7p:ComparisonAssertion>\n            <L7p:SetVariable>\n                <L7p:Base64Expression stringValue=\"ZmFsc2U=\"/>\n                <L7p:VariableToSet stringValue=\"refresh\"/>\n            </L7p:SetVariable>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Ensure ${refresh} is set, default=false\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:OneOrMore>\n        <L7p:SetVariable>\n            <L7p:Base64Expression stringValue=\"am1zRGVzdGluYXRpb25zLnNvcnRlZA==\"/>\n            <L7p:VariableToSet stringValue=\"cacheKey\"/>\n        </L7p:SetVariable>\n        <wsp:OneOrMore wsp:Usage=\"Required\">\n            <wsp:All wsp:Usage=\"Required\">\n                <L7p:ComparisonAssertion>\n                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                    <L7p:Expression1 stringValue=\"${refresh}\"/>\n                    <L7p:Operator operatorNull=\"null\"/>\n                    <L7p:Predicates predicates=\"included\">\n                        <L7p:item dataType=\"included\">\n                            <L7p:Type variableDataType=\"string\"/>\n                        </L7p:item>\n                        <L7p:item binary=\"included\">\n                            <L7p:Negated booleanValue=\"true\"/>\n                            <L7p:RightValue stringValue=\"true\"/>\n                        </L7p:item>\n                    </L7p:Predicates>\n                </L7p:ComparisonAssertion>\n                <L7p:CacheLookup>\n                    <L7p:CacheEntryKey stringValue=\"${cacheKey}\"/>\n                    <L7p:CacheId stringValue=\"jmsDestinationList\"/>\n                    <L7p:ContentTypeOverride stringValue=\"\"/>\n                    <L7p:MaxEntryAgeSeconds stringValue=\"${cacheAge}\"/>\n                    <L7p:OtherTargetMessageVariable stringValue=\"jmsDestinations.sorted\"/>\n                    <L7p:Target target=\"OTHER\"/>\n                </L7p:CacheLookup>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"Y2FjaGU=\"/>\n                    <L7p:VariableToSet stringValue=\"source\"/>\n                </L7p:SetVariable>\n                <L7p:AuditDetailAssertion>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// FINE\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Detail stringValue=\"==> Found jmsDestinations.sorted in the cache\"/>\n                    <L7p:Level stringValue=\"FINE\"/>\n                </L7p:AuditDetailAssertion>\n                <L7p:assertionComment>\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// Look in cache unless asked to refresh cache\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:assertionComment>\n            </wsp:All>\n            <wsp:All wsp:Usage=\"Required\">\n                <L7p:Encapsulated>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// GET jmsDestinations\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:EncapsulatedAssertionConfigGuid stringValue=\"c8a5a0d5-1ae2-4144-b538-5c311efc1560\"/>\n                    <L7p:EncapsulatedAssertionConfigName stringValue=\"Utility: Call Restman\"/>\n                    <L7p:Parameters mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"element\"/>\n                            <L7p:value stringValue=\"JMSDestination\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"message\"/>\n                            <L7p:value stringValue=\"\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"method\"/>\n                            <L7p:value stringValue=\"GET\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"resource\"/>\n                            <L7p:value stringValue=\"jmsDestinations\"/>\n                        </L7p:entry>\n                    </L7p:Parameters>\n                </L7p:Encapsulated>\n                <wsp:OneOrMore wsp:Usage=\"Required\">\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:VariablePrefix stringValue=\"jmsDestinations\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/l7:List/l7:Item/l7:Resource/l7:JMSDestination\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <L7p:TrueAssertion/>\n                    <L7p:assertionComment>\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// Extract the list of JMS destinations, never fail\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:assertionComment>\n                </wsp:OneOrMore>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz48Sk1TRGVzdGluYXRpb25zPg==\"/>\n                    <L7p:VariableToSet stringValue=\"jmsDestinations.sorted\"/>\n                </L7p:SetVariable>\n                <L7p:ForEachLoop L7p:Usage=\"Required\"\n                    loopVariable=\"jmsDestinations.elements\" variablePrefix=\"jmsDestination\">\n                    <L7p:SetVariable>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Cast to message type for parsing\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:Base64Expression stringValue=\"JHtqbXNEZXN0aW5hdGlvbi5jdXJyZW50fQ==\"/>\n                        <L7p:ContentType stringValue=\"text/xml; charset=utf-8\"/>\n                        <L7p:DataType variableDataType=\"message\"/>\n                        <L7p:VariableToSet stringValue=\"jmsDestination.xml\"/>\n                    </L7p:SetVariable>\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Retrieve the JMS destination ID\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:VariablePrefix stringValue=\"id\"/>\n                        <L7p:XmlMsgSrc stringValue=\"jmsDestination.xml\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/l7:JMSDestination/@id\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// retrieve the JMS destination name\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:VariablePrefix stringValue=\"name\"/>\n                        <L7p:XmlMsgSrc stringValue=\"jmsDestination.xml\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/l7:JMSDestination/l7:JMSDestinationDetail/l7:Name\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// retrieve the JMS Destination enabled state\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:VariablePrefix stringValue=\"enabled\"/>\n                        <L7p:XmlMsgSrc stringValue=\"jmsDestination.xml\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/l7:JMSDestination/l7:JMSDestinationDetail/l7:Enabled\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// retrieve the JMS Destination direction\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:VariablePrefix stringValue=\"inbound\"/>\n                        <L7p:XmlMsgSrc stringValue=\"jmsDestination.xml\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/l7:JMSDestination/l7:JMSDestinationDetail/l7:Inbound\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <wsp:OneOrMore wsp:Usage=\"Required\">\n                        <wsp:All wsp:Usage=\"Required\">\n                            <L7p:ComparisonAssertion>\n                                <L7p:CaseSensitive booleanValue=\"false\"/>\n                                <L7p:Expression1 stringValue=\"${inbound.result}\"/>\n                                <L7p:Operator operatorNull=\"null\"/>\n                                <L7p:Predicates predicates=\"included\">\n                                    <L7p:item dataType=\"included\">\n                                    <L7p:Type variableDataType=\"boolean\"/>\n                                    </L7p:item>\n                                    <L7p:item binary=\"included\">\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:RightValue stringValue=\"true\"/>\n                                    </L7p:item>\n                                </L7p:Predicates>\n                            </L7p:ComparisonAssertion>\n                            <L7p:SetVariable>\n                                <L7p:Base64Expression stringValue=\"aW5ib3VuZA==\"/>\n                                <L7p:VariableToSet stringValue=\"direction\"/>\n                            </L7p:SetVariable>\n                            <L7p:assertionComment>\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// ${inbound.result} == false\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:assertionComment>\n                        </wsp:All>\n                        <L7p:SetVariable>\n                            <L7p:Base64Expression stringValue=\"b3V0Ym91bmQ=\"/>\n                            <L7p:VariableToSet stringValue=\"direction\"/>\n                        </L7p:SetVariable>\n                        <L7p:assertionComment>\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Set ${direction} per ${inbound.result}\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:assertionComment>\n                    </wsp:OneOrMore>\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// retrieve the JMS Destination template state\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:VariablePrefix stringValue=\"template\"/>\n                        <L7p:XmlMsgSrc stringValue=\"jmsDestination.xml\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/l7:JMSDestination/l7:JMSDestinationDetail/l7:Template\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <wsp:OneOrMore wsp:Usage=\"Required\">\n                        <L7p:ResponseXpathAssertion>\n                            <L7p:AssertionComment assertionComment=\"included\">\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// retrieve the JMS Destination enabled state\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:AssertionComment>\n                            <L7p:VariablePrefix stringValue=\"type\"/>\n                            <L7p:XmlMsgSrc stringValue=\"jmsDestination.xml\"/>\n                            <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                <L7p:Expression stringValue=\"/l7:JMSDestination/l7:JMSConnection/l7:ProviderType\"/>\n                                <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                    </L7p:entry>\n                                </L7p:Namespaces>\n                                <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                            </L7p:XpathExpression>\n                        </L7p:ResponseXpathAssertion>\n                        <L7p:SetVariable>\n                            <L7p:Base64Expression stringValue=\"R2VuZXJpYyBKTVM=\"/>\n                            <L7p:VariableToSet stringValue=\"type.result\"/>\n                        </L7p:SetVariable>\n                        <L7p:assertionComment>\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Check for ProviderType element. If missing the assume Generic JMS\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:assertionComment>\n                    </wsp:OneOrMore>\n                    <L7p:SetVariable>\n                        <L7p:Base64Expression stringValue=\"JHtqbXNEZXN0aW5hdGlvbnMuc29ydGVkfTxKTVNEZXN0aW5hdGlvbiBpZD0iJHtpZC5yZXN1bHR9Ij48TmFtZT48IVtDREFUQVske25hbWUucmVzdWx0fV1dPjwvTmFtZT48RGlyZWN0aW9uPiR7ZGlyZWN0aW9ufTwvRGlyZWN0aW9uPjxJc1RlbXBsYXRlPiR7dGVtcGxhdGUucmVzdWx0fTwvSXNUZW1wbGF0ZT48RW5hYmxlZD4ke2VuYWJsZWQucmVzdWx0fTwvRW5hYmxlZD48VHlwZT4ke3R5cGUucmVzdWx0fTwvVHlwZT48L0pNU0Rlc3RpbmF0aW9uPg==\"/>\n                        <L7p:VariableToSet stringValue=\"jmsDestinations.sorted\"/>\n                    </L7p:SetVariable>\n                    <L7p:assertionComment>\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// Build the list of JMS destinations\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:assertionComment>\n                </L7p:ForEachLoop>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"JHtqbXNEZXN0aW5hdGlvbnMuc29ydGVkfTwvSk1TRGVzdGluYXRpb25zPg==\"/>\n                    <L7p:ContentType stringValue=\"text/xml; charset=utf-8\"/>\n                    <L7p:DataType variableDataType=\"message\"/>\n                    <L7p:VariableToSet stringValue=\"jmsDestinations.sorted\"/>\n                </L7p:SetVariable>\n                <L7p:XslTransformation>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// Sort the JMS destinations by name\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Direction intValue=\"-1\"/>\n                    <L7p:OtherTargetMessageVariable stringValue=\"jmsDestinations.sorted\"/>\n                    <L7p:ResourceInfo staticResourceInfo=\"included\">\n                        <L7p:Document stringValue=\"&lt;xsl:stylesheet version=&quot;1.0&quot; xmlns:l7=&quot;http://ns.l7tech.com/2010/04/gateway-management&quot; xmlns:xsl=&quot;http://www.w3.org/1999/XSL/Transform&quot;>&lt;xsl:template match=&quot;/JMSDestinations&quot;>    &lt;xsl:copy>        &lt;xsl:for-each select=&quot;JMSDestination&quot;>            &lt;xsl:sort select=&quot;./Name&quot;/>            &lt;xsl:copy-of select=&quot;.&quot;/>        &lt;/xsl:for-each>    &lt;/xsl:copy>&lt;/xsl:template>&lt;/xsl:stylesheet>\"/>\n                    </L7p:ResourceInfo>\n                    <L7p:Target target=\"OTHER\"/>\n                    <L7p:TransformName stringValue=\"\"/>\n                    <L7p:XsltVersion stringValue=\"1.0\"/>\n                </L7p:XslTransformation>\n                <L7p:CacheStorage>\n                    <L7p:CacheEntryKey stringValue=\"${cacheKey}\"/>\n                    <L7p:CacheId stringValue=\"jmsDestinationList\"/>\n                    <L7p:MaxEntries stringValue=\"1\"/>\n                    <L7p:MaxEntryAgeSeconds stringValue=\"${cacheAge}\"/>\n                    <L7p:MaxEntrySizeBytes stringValue=\"200000\"/>\n                    <L7p:OtherTargetMessageVariable stringValue=\"jmsDestinations.sorted\"/>\n                    <L7p:StoreSoapFaults booleanValue=\"true\"/>\n                    <L7p:Target target=\"OTHER\"/>\n                </L7p:CacheStorage>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"c3lzdGVt\"/>\n                    <L7p:VariableToSet stringValue=\"source\"/>\n                </L7p:SetVariable>\n                <L7p:AuditDetailAssertion>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// FINE\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Detail stringValue=\"==> Loaded jmsDestinations.sorted from system and stored to cache\"/>\n                    <L7p:Level stringValue=\"FINE\"/>\n                </L7p:AuditDetailAssertion>\n                <L7p:assertionComment>\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// Retrieve new list and cache\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:assertionComment>\n            </wsp:All>\n            <wsp:All wsp:Usage=\"Required\">\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"RXJyb3Igd2hlbiBsaXN0aW5nIEpNUyBkZXN0aW5hdGlvbnM=\"/>\n                    <L7p:VariableToSet stringValue=\"error.msg\"/>\n                </L7p:SetVariable>\n                <L7p:AuditDetailAssertion>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// WARNING\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Detail stringValue=\"==> Error listing JMS destinations in ${policy.name}\"/>\n                    <L7p:Level stringValue=\"WARNING\"/>\n                </L7p:AuditDetailAssertion>\n                <L7p:FalseAssertion/>\n                <L7p:assertionComment>\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// Failure - set ${error.msg}\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:assertionComment>\n            </wsp:All>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Caching logic\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:OneOrMore>\n        <L7p:Regex>\n            <L7p:AssertionComment assertionComment=\"included\">\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Add source attribute to /JMSDestinations element\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:AssertionComment>\n            <L7p:AutoTarget booleanValue=\"false\"/>\n            <L7p:OtherTargetMessageVariable stringValue=\"jmsDestinations.sorted\"/>\n            <L7p:Regex stringValue=\"&lt;JMSDestinations>\"/>\n            <L7p:Replace booleanValue=\"true\"/>\n            <L7p:Replacement stringValue=\"&lt;JMSDestinations source=&quot;${source}&quot;>\"/>\n            <L7p:Target target=\"OTHER\"/>\n        </L7p:Regex>\n        <L7p:AuditDetailAssertion>\n            <L7p:AssertionComment assertionComment=\"included\">\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// FINE\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:AssertionComment>\n            <L7p:Detail stringValue=\"==> Leaving Utility Fragment: ${policy.name}\"/>\n            <L7p:Level stringValue=\"FINE\"/>\n        </L7p:AuditDetailAssertion>\n    </wsp:All>\n</wsp:Policy>\n"
      },
      "policyRevisions": [
        {
          "goid": "bed4baf4ff33b7e528854c3965d9bb48",
          "ordinal": 1,
          "active": true,
          "author": "admin",
          "time": "2025-02-05T14:20:38.523Z",
          "xml": "<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<wsp:Policy xmlns:L7p=\"http://www.layer7tech.com/ws/policy\" xmlns:wsp=\"http://schemas.xmlsoap.org/ws/2002/12/policy\">\n    <wsp:All wsp:Usage=\"Required\">\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Policy fragment for &quot;Utility: List JMS Destinations&quot; encapsulated assertion\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Call Restman and generate a sorted list of JMS destinations\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** - Assumes an admin role user has been authenticated\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** - Caches results for ${cacheAge} seconds (default=300). To refresh the cache set ${refresh}=true when calling\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** - Returns a text/xml message variable in ${jmsDestinations.sorted}\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Inputs:\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - refresh (string)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - cacheAge (string)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Outputs:\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - jmsDestinations.sorted (message)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - error.msg (string)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** v1.0.0 - Jay MacDonald - 20201107 - Initial Version\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n        </L7p:CommentAssertion>\n        <L7p:AuditDetailAssertion>\n            <L7p:AssertionComment assertionComment=\"included\">\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// FINE\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:AssertionComment>\n            <L7p:Detail stringValue=\"==> Entering Utility Fragment: ${policy.name} (refresh=${refresh})\"/>\n            <L7p:Level stringValue=\"FINE\"/>\n        </L7p:AuditDetailAssertion>\n        <wsp:All wsp:Usage=\"Required\">\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** ${jmsDestinations.sorted} has the following schema:\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** \"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** &lt;JMSDestinations source=&quot;system|cache&quot;>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   &lt;JMSDestination id=&quot;string&quot;>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**     &lt;Name>string&lt;/Name>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**     &lt;Type>string&lt;/Type>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**     &lt;Direction>string&lt;/Direction>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**     &lt;Enabled>string&lt;/Enabled>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**     &lt;IsTemplate>string&lt;/IsTemplate>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   &lt;/JMSDestination>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   ...\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** &lt;/JMSDestinations>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** \"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** Where:\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   Name = the name of the JMS destination\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n            </L7p:CommentAssertion>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Description of ${jmsDestinations.sorted}\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:All>\n        <wsp:OneOrMore wsp:Usage=\"Required\">\n            <L7p:ComparisonAssertion>\n                <L7p:AssertionComment assertionComment=\"included\">\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// true or false\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:AssertionComment>\n                <L7p:CaseSensitive booleanValue=\"false\"/>\n                <L7p:Expression1 stringValue=\"${cacheAge}\"/>\n                <L7p:Operator operatorNull=\"null\"/>\n                <L7p:Predicates predicates=\"included\">\n                    <L7p:item dataType=\"included\">\n                        <L7p:Type variableDataType=\"int\"/>\n                    </L7p:item>\n                    <L7p:item binary=\"included\">\n                        <L7p:CaseSensitive booleanValue=\"false\"/>\n                        <L7p:Operator operator=\"GT\"/>\n                        <L7p:RightValue stringValue=\"0\"/>\n                    </L7p:item>\n                </L7p:Predicates>\n            </L7p:ComparisonAssertion>\n            <L7p:SetVariable>\n                <L7p:Base64Expression stringValue=\"MzAw\"/>\n                <L7p:DataType variableDataType=\"int\"/>\n                <L7p:VariableToSet stringValue=\"cacheAge\"/>\n            </L7p:SetVariable>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Ensure ${cacheAge} is set, default=300\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:OneOrMore>\n        <wsp:OneOrMore wsp:Usage=\"Required\">\n            <L7p:ComparisonAssertion>\n                <L7p:AssertionComment assertionComment=\"included\">\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// true or false\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:AssertionComment>\n                <L7p:CaseSensitive booleanValue=\"false\"/>\n                <L7p:Expression1 stringValue=\"${refresh}\"/>\n                <L7p:Operator operatorNull=\"null\"/>\n                <L7p:Predicates predicates=\"included\">\n                    <L7p:item dataType=\"included\">\n                        <L7p:Type variableDataType=\"string\"/>\n                    </L7p:item>\n                    <L7p:item regex=\"included\">\n                        <L7p:Pattern stringValue=\"^(true|false)$\"/>\n                    </L7p:item>\n                </L7p:Predicates>\n            </L7p:ComparisonAssertion>\n            <L7p:SetVariable>\n                <L7p:Base64Expression stringValue=\"ZmFsc2U=\"/>\n                <L7p:VariableToSet stringValue=\"refresh\"/>\n            </L7p:SetVariable>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Ensure ${refresh} is set, default=false\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:OneOrMore>\n        <L7p:SetVariable>\n            <L7p:Base64Expression stringValue=\"am1zRGVzdGluYXRpb25zLnNvcnRlZA==\"/>\n            <L7p:VariableToSet stringValue=\"cacheKey\"/>\n        </L7p:SetVariable>\n        <wsp:OneOrMore wsp:Usage=\"Required\">\n            <wsp:All wsp:Usage=\"Required\">\n                <L7p:ComparisonAssertion>\n                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                    <L7p:Expression1 stringValue=\"${refresh}\"/>\n                    <L7p:Operator operatorNull=\"null\"/>\n                    <L7p:Predicates predicates=\"included\">\n                        <L7p:item dataType=\"included\">\n                            <L7p:Type variableDataType=\"string\"/>\n                        </L7p:item>\n                        <L7p:item binary=\"included\">\n                            <L7p:Negated booleanValue=\"true\"/>\n                            <L7p:RightValue stringValue=\"true\"/>\n                        </L7p:item>\n                    </L7p:Predicates>\n                </L7p:ComparisonAssertion>\n                <L7p:CacheLookup>\n                    <L7p:CacheEntryKey stringValue=\"${cacheKey}\"/>\n                    <L7p:CacheId stringValue=\"jmsDestinationList\"/>\n                    <L7p:ContentTypeOverride stringValue=\"\"/>\n                    <L7p:MaxEntryAgeSeconds stringValue=\"${cacheAge}\"/>\n                    <L7p:OtherTargetMessageVariable stringValue=\"jmsDestinations.sorted\"/>\n                    <L7p:Target target=\"OTHER\"/>\n                </L7p:CacheLookup>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"Y2FjaGU=\"/>\n                    <L7p:VariableToSet stringValue=\"source\"/>\n                </L7p:SetVariable>\n                <L7p:AuditDetailAssertion>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// FINE\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Detail stringValue=\"==> Found jmsDestinations.sorted in the cache\"/>\n                    <L7p:Level stringValue=\"FINE\"/>\n                </L7p:AuditDetailAssertion>\n                <L7p:assertionComment>\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// Look in cache unless asked to refresh cache\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:assertionComment>\n            </wsp:All>\n            <wsp:All wsp:Usage=\"Required\">\n                <L7p:Encapsulated>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// GET jmsDestinations\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:EncapsulatedAssertionConfigGuid stringValue=\"c8a5a0d5-1ae2-4144-b538-5c311efc1560\"/>\n                    <L7p:EncapsulatedAssertionConfigName stringValue=\"Utility: Call Restman\"/>\n                    <L7p:Parameters mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"element\"/>\n                            <L7p:value stringValue=\"JMSDestination\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"message\"/>\n                            <L7p:value stringValue=\"\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"method\"/>\n                            <L7p:value stringValue=\"GET\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"resource\"/>\n                            <L7p:value stringValue=\"jmsDestinations\"/>\n                        </L7p:entry>\n                    </L7p:Parameters>\n                </L7p:Encapsulated>\n                <wsp:OneOrMore wsp:Usage=\"Required\">\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:VariablePrefix stringValue=\"jmsDestinations\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/l7:List/l7:Item/l7:Resource/l7:JMSDestination\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <L7p:TrueAssertion/>\n                    <L7p:assertionComment>\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// Extract the list of JMS destinations, never fail\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:assertionComment>\n                </wsp:OneOrMore>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz48Sk1TRGVzdGluYXRpb25zPg==\"/>\n                    <L7p:VariableToSet stringValue=\"jmsDestinations.sorted\"/>\n                </L7p:SetVariable>\n                <L7p:ForEachLoop L7p:Usage=\"Required\"\n                    loopVariable=\"jmsDestinations.elements\" variablePrefix=\"jmsDestination\">\n                    <L7p:SetVariable>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Cast to message type for parsing\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:Base64Expression stringValue=\"JHtqbXNEZXN0aW5hdGlvbi5jdXJyZW50fQ==\"/>\n                        <L7p:ContentType stringValue=\"text/xml; charset=utf-8\"/>\n                        <L7p:DataType variableDataType=\"message\"/>\n                        <L7p:VariableToSet stringValue=\"jmsDestination.xml\"/>\n                    </L7p:SetVariable>\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Retrieve the JMS destination ID\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:VariablePrefix stringValue=\"id\"/>\n                        <L7p:XmlMsgSrc stringValue=\"jmsDestination.xml\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/l7:JMSDestination/@id\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// retrieve the JMS destination name\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:VariablePrefix stringValue=\"name\"/>\n                        <L7p:XmlMsgSrc stringValue=\"jmsDestination.xml\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/l7:JMSDestination/l7:JMSDestinationDetail/l7:Name\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// retrieve the JMS Destination enabled state\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:VariablePrefix stringValue=\"enabled\"/>\n                        <L7p:XmlMsgSrc stringValue=\"jmsDestination.xml\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/l7:JMSDestination/l7:JMSDestinationDetail/l7:Enabled\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// retrieve the JMS Destination direction\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:VariablePrefix stringValue=\"inbound\"/>\n                        <L7p:XmlMsgSrc stringValue=\"jmsDestination.xml\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/l7:JMSDestination/l7:JMSDestinationDetail/l7:Inbound\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <wsp:OneOrMore wsp:Usage=\"Required\">\n                        <wsp:All wsp:Usage=\"Required\">\n                            <L7p:ComparisonAssertion>\n                                <L7p:CaseSensitive booleanValue=\"false\"/>\n                                <L7p:Expression1 stringValue=\"${inbound.result}\"/>\n                                <L7p:Operator operatorNull=\"null\"/>\n                                <L7p:Predicates predicates=\"included\">\n                                    <L7p:item dataType=\"included\">\n                                    <L7p:Type variableDataType=\"boolean\"/>\n                                    </L7p:item>\n                                    <L7p:item binary=\"included\">\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:RightValue stringValue=\"true\"/>\n                                    </L7p:item>\n                                </L7p:Predicates>\n                            </L7p:ComparisonAssertion>\n                            <L7p:SetVariable>\n                                <L7p:Base64Expression stringValue=\"aW5ib3VuZA==\"/>\n                                <L7p:VariableToSet stringValue=\"direction\"/>\n                            </L7p:SetVariable>\n                            <L7p:assertionComment>\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// ${inbound.result} == false\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:assertionComment>\n                        </wsp:All>\n                        <L7p:SetVariable>\n                            <L7p:Base64Expression stringValue=\"b3V0Ym91bmQ=\"/>\n                            <L7p:VariableToSet stringValue=\"direction\"/>\n                        </L7p:SetVariable>\n                        <L7p:assertionComment>\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Set ${direction} per ${inbound.result}\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:assertionComment>\n                    </wsp:OneOrMore>\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// retrieve the JMS Destination template state\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:VariablePrefix stringValue=\"template\"/>\n                        <L7p:XmlMsgSrc stringValue=\"jmsDestination.xml\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/l7:JMSDestination/l7:JMSDestinationDetail/l7:Template\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <wsp:OneOrMore wsp:Usage=\"Required\">\n                        <L7p:ResponseXpathAssertion>\n                            <L7p:AssertionComment assertionComment=\"included\">\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// retrieve the JMS Destination enabled state\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:AssertionComment>\n                            <L7p:VariablePrefix stringValue=\"type\"/>\n                            <L7p:XmlMsgSrc stringValue=\"jmsDestination.xml\"/>\n                            <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                <L7p:Expression stringValue=\"/l7:JMSDestination/l7:JMSConnection/l7:ProviderType\"/>\n                                <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                    </L7p:entry>\n                                </L7p:Namespaces>\n                                <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                            </L7p:XpathExpression>\n                        </L7p:ResponseXpathAssertion>\n                        <L7p:SetVariable>\n                            <L7p:Base64Expression stringValue=\"R2VuZXJpYyBKTVM=\"/>\n                            <L7p:VariableToSet stringValue=\"type.result\"/>\n                        </L7p:SetVariable>\n                        <L7p:assertionComment>\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Check for ProviderType element. If missing the assume Generic JMS\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:assertionComment>\n                    </wsp:OneOrMore>\n                    <L7p:SetVariable>\n                        <L7p:Base64Expression stringValue=\"JHtqbXNEZXN0aW5hdGlvbnMuc29ydGVkfTxKTVNEZXN0aW5hdGlvbiBpZD0iJHtpZC5yZXN1bHR9Ij48TmFtZT48IVtDREFUQVske25hbWUucmVzdWx0fV1dPjwvTmFtZT48RGlyZWN0aW9uPiR7ZGlyZWN0aW9ufTwvRGlyZWN0aW9uPjxJc1RlbXBsYXRlPiR7dGVtcGxhdGUucmVzdWx0fTwvSXNUZW1wbGF0ZT48RW5hYmxlZD4ke2VuYWJsZWQucmVzdWx0fTwvRW5hYmxlZD48VHlwZT4ke3R5cGUucmVzdWx0fTwvVHlwZT48L0pNU0Rlc3RpbmF0aW9uPg==\"/>\n                        <L7p:VariableToSet stringValue=\"jmsDestinations.sorted\"/>\n                    </L7p:SetVariable>\n                    <L7p:assertionComment>\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// Build the list of JMS destinations\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:assertionComment>\n                </L7p:ForEachLoop>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"JHtqbXNEZXN0aW5hdGlvbnMuc29ydGVkfTwvSk1TRGVzdGluYXRpb25zPg==\"/>\n                    <L7p:ContentType stringValue=\"text/xml; charset=utf-8\"/>\n                    <L7p:DataType variableDataType=\"message\"/>\n                    <L7p:VariableToSet stringValue=\"jmsDestinations.sorted\"/>\n                </L7p:SetVariable>\n                <L7p:XslTransformation>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// Sort the JMS destinations by name\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Direction intValue=\"-1\"/>\n                    <L7p:OtherTargetMessageVariable stringValue=\"jmsDestinations.sorted\"/>\n                    <L7p:ResourceInfo staticResourceInfo=\"included\">\n                        <L7p:Document stringValue=\"&lt;xsl:stylesheet version=&quot;1.0&quot; xmlns:l7=&quot;http://ns.l7tech.com/2010/04/gateway-management&quot; xmlns:xsl=&quot;http://www.w3.org/1999/XSL/Transform&quot;>&lt;xsl:template match=&quot;/JMSDestinations&quot;>    &lt;xsl:copy>        &lt;xsl:for-each select=&quot;JMSDestination&quot;>            &lt;xsl:sort select=&quot;./Name&quot;/>            &lt;xsl:copy-of select=&quot;.&quot;/>        &lt;/xsl:for-each>    &lt;/xsl:copy>&lt;/xsl:template>&lt;/xsl:stylesheet>\"/>\n                    </L7p:ResourceInfo>\n                    <L7p:Target target=\"OTHER\"/>\n                    <L7p:TransformName stringValue=\"\"/>\n                    <L7p:XsltVersion stringValue=\"1.0\"/>\n                </L7p:XslTransformation>\n                <L7p:CacheStorage>\n                    <L7p:CacheEntryKey stringValue=\"${cacheKey}\"/>\n                    <L7p:CacheId stringValue=\"jmsDestinationList\"/>\n                    <L7p:MaxEntries stringValue=\"1\"/>\n                    <L7p:MaxEntryAgeSeconds stringValue=\"${cacheAge}\"/>\n                    <L7p:MaxEntrySizeBytes stringValue=\"200000\"/>\n                    <L7p:OtherTargetMessageVariable stringValue=\"jmsDestinations.sorted\"/>\n                    <L7p:StoreSoapFaults booleanValue=\"true\"/>\n                    <L7p:Target target=\"OTHER\"/>\n                </L7p:CacheStorage>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"c3lzdGVt\"/>\n                    <L7p:VariableToSet stringValue=\"source\"/>\n                </L7p:SetVariable>\n                <L7p:AuditDetailAssertion>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// FINE\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Detail stringValue=\"==> Loaded jmsDestinations.sorted from system and stored to cache\"/>\n                    <L7p:Level stringValue=\"FINE\"/>\n                </L7p:AuditDetailAssertion>\n                <L7p:assertionComment>\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// Retrieve new list and cache\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:assertionComment>\n            </wsp:All>\n            <wsp:All wsp:Usage=\"Required\">\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"RXJyb3Igd2hlbiBsaXN0aW5nIEpNUyBkZXN0aW5hdGlvbnM=\"/>\n                    <L7p:VariableToSet stringValue=\"error.msg\"/>\n                </L7p:SetVariable>\n                <L7p:AuditDetailAssertion>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// WARNING\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Detail stringValue=\"==> Error listing JMS destinations in ${policy.name}\"/>\n                    <L7p:Level stringValue=\"WARNING\"/>\n                </L7p:AuditDetailAssertion>\n                <L7p:FalseAssertion/>\n                <L7p:assertionComment>\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// Failure - set ${error.msg}\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:assertionComment>\n            </wsp:All>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Caching logic\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:OneOrMore>\n        <L7p:Regex>\n            <L7p:AssertionComment assertionComment=\"included\">\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Add source attribute to /JMSDestinations element\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:AssertionComment>\n            <L7p:AutoTarget booleanValue=\"false\"/>\n            <L7p:OtherTargetMessageVariable stringValue=\"jmsDestinations.sorted\"/>\n            <L7p:Regex stringValue=\"&lt;JMSDestinations>\"/>\n            <L7p:Replace booleanValue=\"true\"/>\n            <L7p:Replacement stringValue=\"&lt;JMSDestinations source=&quot;${source}&quot;>\"/>\n            <L7p:Target target=\"OTHER\"/>\n        </L7p:Regex>\n        <L7p:AuditDetailAssertion>\n            <L7p:AssertionComment assertionComment=\"included\">\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// FINE\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:AssertionComment>\n            <L7p:Detail stringValue=\"==> Leaving Utility Fragment: ${policy.name}\"/>\n            <L7p:Level stringValue=\"FINE\"/>\n        </L7p:AuditDetailAssertion>\n    </wsp:All>\n</wsp:Policy>\n"
        }
      ]
    },
    {
      "guid": "d076c049-b5b3-4990-aad3-d9c35c3e17ef",
      "name": "Utility: List Listen Ports",
      "policyType": "FRAGMENT",
      "checksum": "e81c48410810a54fdb352ff0707746285b4d44f6",
      "folderPath": "/Gateway Management Utilities/fragments",
      "soap": false,
      "policy": {
        "xml": "<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<wsp:Policy xmlns:L7p=\"http://www.layer7tech.com/ws/policy\" xmlns:wsp=\"http://schemas.xmlsoap.org/ws/2002/12/policy\">\n    <wsp:All wsp:Usage=\"Required\">\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Policy fragment for &quot;Utility: List Listen Ports&quot; encapsulated assertion\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Call Restman and generate a sorted list of listen ports\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** - Assumes an admin role user has been authenticated\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** - Caches results for ${cacheAge} seconds (default=300). To refresh the cache set ${refresh}=true when calling\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** - Returns a text/xml message variable in ${listenPorts.sorted}\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Inputs:\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - refresh (string)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - cacheAge (string)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Outputs:\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - listenPorts.sorted (message)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - error.msg (string)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** v1.0.0 - Jay MacDonald - 20201107 - Initial Version\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n        </L7p:CommentAssertion>\n        <L7p:AuditDetailAssertion>\n            <L7p:AssertionComment assertionComment=\"included\">\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// FINE\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:AssertionComment>\n            <L7p:Detail stringValue=\"==> Entering Utility Fragment: ${policy.name} (refresh=${refresh})\"/>\n            <L7p:Level stringValue=\"FINE\"/>\n        </L7p:AuditDetailAssertion>\n        <wsp:All wsp:Usage=\"Required\">\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** ${listenPorts.sorted} has the following schema:\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** \"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** &lt;ListenPorts source=&quot;system|cache&quot;>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   &lt;ListenPort id=&quot;string&quot;>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**     &lt;Name>string&lt;/Name>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**     &lt;Protocol>string&lt;/Protocol>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**     &lt;Port>string&lt;/Port>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**     &lt;Enabled>string&lt;/Enabled>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   &lt;/ListenPort>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   ...\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** &lt;/ListenPorts>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n            </L7p:CommentAssertion>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Description of ${listenPorts.sorted}\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:All>\n        <wsp:OneOrMore wsp:Usage=\"Required\">\n            <L7p:ComparisonAssertion>\n                <L7p:AssertionComment assertionComment=\"included\">\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// true or false\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:AssertionComment>\n                <L7p:CaseSensitive booleanValue=\"false\"/>\n                <L7p:Expression1 stringValue=\"${cacheAge}\"/>\n                <L7p:Operator operatorNull=\"null\"/>\n                <L7p:Predicates predicates=\"included\">\n                    <L7p:item dataType=\"included\">\n                        <L7p:Type variableDataType=\"int\"/>\n                    </L7p:item>\n                    <L7p:item binary=\"included\">\n                        <L7p:CaseSensitive booleanValue=\"false\"/>\n                        <L7p:Operator operator=\"GT\"/>\n                        <L7p:RightValue stringValue=\"0\"/>\n                    </L7p:item>\n                </L7p:Predicates>\n            </L7p:ComparisonAssertion>\n            <L7p:SetVariable>\n                <L7p:Base64Expression stringValue=\"MzAw\"/>\n                <L7p:DataType variableDataType=\"int\"/>\n                <L7p:VariableToSet stringValue=\"cacheAge\"/>\n            </L7p:SetVariable>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Ensure ${cacheAge} is set, default=300\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:OneOrMore>\n        <wsp:OneOrMore wsp:Usage=\"Required\">\n            <L7p:ComparisonAssertion>\n                <L7p:AssertionComment assertionComment=\"included\">\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// true or false\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:AssertionComment>\n                <L7p:CaseSensitive booleanValue=\"false\"/>\n                <L7p:Expression1 stringValue=\"${refresh}\"/>\n                <L7p:Operator operatorNull=\"null\"/>\n                <L7p:Predicates predicates=\"included\">\n                    <L7p:item dataType=\"included\">\n                        <L7p:Type variableDataType=\"string\"/>\n                    </L7p:item>\n                    <L7p:item regex=\"included\">\n                        <L7p:Pattern stringValue=\"^(true|false)$\"/>\n                    </L7p:item>\n                </L7p:Predicates>\n            </L7p:ComparisonAssertion>\n            <L7p:SetVariable>\n                <L7p:Base64Expression stringValue=\"ZmFsc2U=\"/>\n                <L7p:VariableToSet stringValue=\"refresh\"/>\n            </L7p:SetVariable>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Ensure ${refresh} is set, default=false\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:OneOrMore>\n        <L7p:SetVariable>\n            <L7p:Base64Expression stringValue=\"bGlzdGVuUG9ydHMuc29ydGVk\"/>\n            <L7p:VariableToSet stringValue=\"cacheKey\"/>\n        </L7p:SetVariable>\n        <wsp:OneOrMore wsp:Usage=\"Required\">\n            <wsp:All wsp:Usage=\"Required\">\n                <L7p:ComparisonAssertion>\n                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                    <L7p:Expression1 stringValue=\"${refresh}\"/>\n                    <L7p:Operator operatorNull=\"null\"/>\n                    <L7p:Predicates predicates=\"included\">\n                        <L7p:item dataType=\"included\">\n                            <L7p:Type variableDataType=\"string\"/>\n                        </L7p:item>\n                        <L7p:item binary=\"included\">\n                            <L7p:Negated booleanValue=\"true\"/>\n                            <L7p:RightValue stringValue=\"true\"/>\n                        </L7p:item>\n                    </L7p:Predicates>\n                </L7p:ComparisonAssertion>\n                <L7p:CacheLookup>\n                    <L7p:CacheEntryKey stringValue=\"${cacheKey}\"/>\n                    <L7p:CacheId stringValue=\"listenPortList\"/>\n                    <L7p:ContentTypeOverride stringValue=\"\"/>\n                    <L7p:MaxEntryAgeSeconds stringValue=\"${cacheAge}\"/>\n                    <L7p:OtherTargetMessageVariable stringValue=\"listenPorts.sorted\"/>\n                    <L7p:Target target=\"OTHER\"/>\n                </L7p:CacheLookup>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"Y2FjaGU=\"/>\n                    <L7p:VariableToSet stringValue=\"source\"/>\n                </L7p:SetVariable>\n                <L7p:AuditDetailAssertion>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// FINE\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Detail stringValue=\"==> Found listenPorts.sorted in the cache\"/>\n                    <L7p:Level stringValue=\"FINE\"/>\n                </L7p:AuditDetailAssertion>\n                <L7p:assertionComment>\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// Look in cache unless asked to refresh cache\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:assertionComment>\n            </wsp:All>\n            <wsp:All wsp:Usage=\"Required\">\n                <L7p:Encapsulated>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// GET listenPorts\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:EncapsulatedAssertionConfigGuid stringValue=\"c8a5a0d5-1ae2-4144-b538-5c311efc1560\"/>\n                    <L7p:EncapsulatedAssertionConfigName stringValue=\"Utility: Call Restman\"/>\n                    <L7p:Parameters mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"element\"/>\n                            <L7p:value stringValue=\"ListenPort\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"message\"/>\n                            <L7p:value stringValue=\"\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"method\"/>\n                            <L7p:value stringValue=\"GET\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"resource\"/>\n                            <L7p:value stringValue=\"listenPorts\"/>\n                        </L7p:entry>\n                    </L7p:Parameters>\n                </L7p:Encapsulated>\n                <wsp:OneOrMore wsp:Usage=\"Required\">\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:VariablePrefix stringValue=\"listenPorts\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/l7:List/l7:Item/l7:Resource/l7:ListenPort\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <L7p:TrueAssertion/>\n                    <L7p:assertionComment>\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// Extract the list of listen ports, never fail\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:assertionComment>\n                </wsp:OneOrMore>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz48TGlzdGVuUG9ydHM+\"/>\n                    <L7p:VariableToSet stringValue=\"listenPorts.sorted\"/>\n                </L7p:SetVariable>\n                <L7p:ForEachLoop L7p:Usage=\"Required\"\n                    loopVariable=\"listenPorts.elements\" variablePrefix=\"listenPort\">\n                    <L7p:SetVariable>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Cast to message type for parsing\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:Base64Expression stringValue=\"JHtsaXN0ZW5Qb3J0LmN1cnJlbnR9\"/>\n                        <L7p:ContentType stringValue=\"text/xml; charset=utf-8\"/>\n                        <L7p:DataType variableDataType=\"message\"/>\n                        <L7p:VariableToSet stringValue=\"listenPort.xml\"/>\n                    </L7p:SetVariable>\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Retrieve the listen port ID\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:VariablePrefix stringValue=\"id\"/>\n                        <L7p:XmlMsgSrc stringValue=\"listenPort.xml\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/l7:ListenPort/@id\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// retrieve the listen port name\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:VariablePrefix stringValue=\"name\"/>\n                        <L7p:XmlMsgSrc stringValue=\"listenPort.xml\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/l7:ListenPort/l7:Name\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// retrieve the listen port enabled state\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:VariablePrefix stringValue=\"enabled\"/>\n                        <L7p:XmlMsgSrc stringValue=\"listenPort.xml\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/l7:ListenPort/l7:Enabled\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// retrieve the listen port protocol\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:VariablePrefix stringValue=\"protocol\"/>\n                        <L7p:XmlMsgSrc stringValue=\"listenPort.xml\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/l7:ListenPort/l7:Protocol\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// retrieve the listen port port\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:VariablePrefix stringValue=\"port\"/>\n                        <L7p:XmlMsgSrc stringValue=\"listenPort.xml\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/l7:ListenPort/l7:Port\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <L7p:SetVariable>\n                        <L7p:Base64Expression stringValue=\"JHtsaXN0ZW5Qb3J0cy5zb3J0ZWR9PExpc3RlblBvcnQgaWQ9IiR7aWQucmVzdWx0fSI+PE5hbWU+PCFbQ0RBVEFbJHtuYW1lLnJlc3VsdH1dXT48L05hbWU+PFByb3RvY29sPiR7cHJvdG9jb2wucmVzdWx0fTwvUHJvdG9jb2w+PFBvcnQ+JHtwb3J0LnJlc3VsdH08L1BvcnQ+PEVuYWJsZWQ+JHtlbmFibGVkLnJlc3VsdH08L0VuYWJsZWQ+PC9MaXN0ZW5Qb3J0Pg==\"/>\n                        <L7p:VariableToSet stringValue=\"listenPorts.sorted\"/>\n                    </L7p:SetVariable>\n                    <L7p:assertionComment>\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// Build the list of listen ports\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:assertionComment>\n                </L7p:ForEachLoop>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"JHtsaXN0ZW5Qb3J0cy5zb3J0ZWR9PC9MaXN0ZW5Qb3J0cz4=\"/>\n                    <L7p:ContentType stringValue=\"text/xml; charset=utf-8\"/>\n                    <L7p:DataType variableDataType=\"message\"/>\n                    <L7p:VariableToSet stringValue=\"listenPorts.sorted\"/>\n                </L7p:SetVariable>\n                <L7p:XslTransformation>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// Sort the listen ports by name\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Direction intValue=\"-1\"/>\n                    <L7p:OtherTargetMessageVariable stringValue=\"listenPorts.sorted\"/>\n                    <L7p:ResourceInfo staticResourceInfo=\"included\">\n                        <L7p:Document stringValue=\"&lt;xsl:stylesheet version=&quot;1.0&quot; xmlns:l7=&quot;http://ns.l7tech.com/2010/04/gateway-management&quot; xmlns:xsl=&quot;http://www.w3.org/1999/XSL/Transform&quot;>&lt;xsl:template match=&quot;/ListenPorts&quot;>    &lt;xsl:copy>        &lt;xsl:for-each select=&quot;ListenPort&quot;>            &lt;xsl:sort select=&quot;./Name&quot;/>            &lt;xsl:copy-of select=&quot;.&quot;/>        &lt;/xsl:for-each>    &lt;/xsl:copy>&lt;/xsl:template>&lt;/xsl:stylesheet>\"/>\n                    </L7p:ResourceInfo>\n                    <L7p:Target target=\"OTHER\"/>\n                    <L7p:TransformName stringValue=\"\"/>\n                    <L7p:XsltVersion stringValue=\"1.0\"/>\n                </L7p:XslTransformation>\n                <L7p:CacheStorage>\n                    <L7p:CacheEntryKey stringValue=\"${cacheKey}\"/>\n                    <L7p:CacheId stringValue=\"listenPortList\"/>\n                    <L7p:MaxEntries stringValue=\"1\"/>\n                    <L7p:MaxEntryAgeSeconds stringValue=\"${cacheAge}\"/>\n                    <L7p:MaxEntrySizeBytes stringValue=\"200000\"/>\n                    <L7p:OtherTargetMessageVariable stringValue=\"listenPorts.sorted\"/>\n                    <L7p:StoreSoapFaults booleanValue=\"true\"/>\n                    <L7p:Target target=\"OTHER\"/>\n                </L7p:CacheStorage>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"c3lzdGVt\"/>\n                    <L7p:VariableToSet stringValue=\"source\"/>\n                </L7p:SetVariable>\n                <L7p:AuditDetailAssertion>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// FINE\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Detail stringValue=\"==> Loaded listenPorts.sorted from system and stored to cache\"/>\n                    <L7p:Level stringValue=\"FINE\"/>\n                </L7p:AuditDetailAssertion>\n                <L7p:assertionComment>\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// Retrieve new list and cache\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:assertionComment>\n            </wsp:All>\n            <wsp:All wsp:Usage=\"Required\">\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"RXJyb3Igd2hlbiBsaXN0aW5nIGxpc3RlbiBwb3J0cw==\"/>\n                    <L7p:VariableToSet stringValue=\"error.msg\"/>\n                </L7p:SetVariable>\n                <L7p:AuditDetailAssertion>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// WARNING\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Detail stringValue=\"==> Error listing listen ports in ${policy.name}\"/>\n                    <L7p:Level stringValue=\"WARNING\"/>\n                </L7p:AuditDetailAssertion>\n                <L7p:FalseAssertion/>\n                <L7p:assertionComment>\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// Failure - set ${error.msg}\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:assertionComment>\n            </wsp:All>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Caching logic\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:OneOrMore>\n        <L7p:Regex>\n            <L7p:AssertionComment assertionComment=\"included\">\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Add source attribute to /ListenPorts element\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:AssertionComment>\n            <L7p:AutoTarget booleanValue=\"false\"/>\n            <L7p:OtherTargetMessageVariable stringValue=\"listenPorts.sorted\"/>\n            <L7p:Regex stringValue=\"&lt;ListenPorts>\"/>\n            <L7p:Replace booleanValue=\"true\"/>\n            <L7p:Replacement stringValue=\"&lt;ListenPorts source=&quot;${source}&quot;>\"/>\n            <L7p:Target target=\"OTHER\"/>\n        </L7p:Regex>\n        <L7p:AuditDetailAssertion>\n            <L7p:AssertionComment assertionComment=\"included\">\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// FINE\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:AssertionComment>\n            <L7p:Detail stringValue=\"==> Leaving Utility Fragment: ${policy.name}\"/>\n            <L7p:Level stringValue=\"FINE\"/>\n        </L7p:AuditDetailAssertion>\n    </wsp:All>\n</wsp:Policy>\n"
      },
      "policyRevisions": [
        {
          "goid": "bed4baf4ff33b7e528854c3965d9bb4c",
          "ordinal": 1,
          "active": true,
          "author": "admin",
          "time": "2025-02-05T14:20:38.536Z",
          "xml": "<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<wsp:Policy xmlns:L7p=\"http://www.layer7tech.com/ws/policy\" xmlns:wsp=\"http://schemas.xmlsoap.org/ws/2002/12/policy\">\n    <wsp:All wsp:Usage=\"Required\">\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Policy fragment for &quot;Utility: List Listen Ports&quot; encapsulated assertion\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Call Restman and generate a sorted list of listen ports\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** - Assumes an admin role user has been authenticated\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** - Caches results for ${cacheAge} seconds (default=300). To refresh the cache set ${refresh}=true when calling\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** - Returns a text/xml message variable in ${listenPorts.sorted}\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Inputs:\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - refresh (string)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - cacheAge (string)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Outputs:\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - listenPorts.sorted (message)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - error.msg (string)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** v1.0.0 - Jay MacDonald - 20201107 - Initial Version\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n        </L7p:CommentAssertion>\n        <L7p:AuditDetailAssertion>\n            <L7p:AssertionComment assertionComment=\"included\">\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// FINE\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:AssertionComment>\n            <L7p:Detail stringValue=\"==> Entering Utility Fragment: ${policy.name} (refresh=${refresh})\"/>\n            <L7p:Level stringValue=\"FINE\"/>\n        </L7p:AuditDetailAssertion>\n        <wsp:All wsp:Usage=\"Required\">\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** ${listenPorts.sorted} has the following schema:\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** \"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** &lt;ListenPorts source=&quot;system|cache&quot;>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   &lt;ListenPort id=&quot;string&quot;>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**     &lt;Name>string&lt;/Name>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**     &lt;Protocol>string&lt;/Protocol>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**     &lt;Port>string&lt;/Port>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**     &lt;Enabled>string&lt;/Enabled>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   &lt;/ListenPort>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   ...\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** &lt;/ListenPorts>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n            </L7p:CommentAssertion>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Description of ${listenPorts.sorted}\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:All>\n        <wsp:OneOrMore wsp:Usage=\"Required\">\n            <L7p:ComparisonAssertion>\n                <L7p:AssertionComment assertionComment=\"included\">\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// true or false\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:AssertionComment>\n                <L7p:CaseSensitive booleanValue=\"false\"/>\n                <L7p:Expression1 stringValue=\"${cacheAge}\"/>\n                <L7p:Operator operatorNull=\"null\"/>\n                <L7p:Predicates predicates=\"included\">\n                    <L7p:item dataType=\"included\">\n                        <L7p:Type variableDataType=\"int\"/>\n                    </L7p:item>\n                    <L7p:item binary=\"included\">\n                        <L7p:CaseSensitive booleanValue=\"false\"/>\n                        <L7p:Operator operator=\"GT\"/>\n                        <L7p:RightValue stringValue=\"0\"/>\n                    </L7p:item>\n                </L7p:Predicates>\n            </L7p:ComparisonAssertion>\n            <L7p:SetVariable>\n                <L7p:Base64Expression stringValue=\"MzAw\"/>\n                <L7p:DataType variableDataType=\"int\"/>\n                <L7p:VariableToSet stringValue=\"cacheAge\"/>\n            </L7p:SetVariable>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Ensure ${cacheAge} is set, default=300\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:OneOrMore>\n        <wsp:OneOrMore wsp:Usage=\"Required\">\n            <L7p:ComparisonAssertion>\n                <L7p:AssertionComment assertionComment=\"included\">\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// true or false\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:AssertionComment>\n                <L7p:CaseSensitive booleanValue=\"false\"/>\n                <L7p:Expression1 stringValue=\"${refresh}\"/>\n                <L7p:Operator operatorNull=\"null\"/>\n                <L7p:Predicates predicates=\"included\">\n                    <L7p:item dataType=\"included\">\n                        <L7p:Type variableDataType=\"string\"/>\n                    </L7p:item>\n                    <L7p:item regex=\"included\">\n                        <L7p:Pattern stringValue=\"^(true|false)$\"/>\n                    </L7p:item>\n                </L7p:Predicates>\n            </L7p:ComparisonAssertion>\n            <L7p:SetVariable>\n                <L7p:Base64Expression stringValue=\"ZmFsc2U=\"/>\n                <L7p:VariableToSet stringValue=\"refresh\"/>\n            </L7p:SetVariable>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Ensure ${refresh} is set, default=false\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:OneOrMore>\n        <L7p:SetVariable>\n            <L7p:Base64Expression stringValue=\"bGlzdGVuUG9ydHMuc29ydGVk\"/>\n            <L7p:VariableToSet stringValue=\"cacheKey\"/>\n        </L7p:SetVariable>\n        <wsp:OneOrMore wsp:Usage=\"Required\">\n            <wsp:All wsp:Usage=\"Required\">\n                <L7p:ComparisonAssertion>\n                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                    <L7p:Expression1 stringValue=\"${refresh}\"/>\n                    <L7p:Operator operatorNull=\"null\"/>\n                    <L7p:Predicates predicates=\"included\">\n                        <L7p:item dataType=\"included\">\n                            <L7p:Type variableDataType=\"string\"/>\n                        </L7p:item>\n                        <L7p:item binary=\"included\">\n                            <L7p:Negated booleanValue=\"true\"/>\n                            <L7p:RightValue stringValue=\"true\"/>\n                        </L7p:item>\n                    </L7p:Predicates>\n                </L7p:ComparisonAssertion>\n                <L7p:CacheLookup>\n                    <L7p:CacheEntryKey stringValue=\"${cacheKey}\"/>\n                    <L7p:CacheId stringValue=\"listenPortList\"/>\n                    <L7p:ContentTypeOverride stringValue=\"\"/>\n                    <L7p:MaxEntryAgeSeconds stringValue=\"${cacheAge}\"/>\n                    <L7p:OtherTargetMessageVariable stringValue=\"listenPorts.sorted\"/>\n                    <L7p:Target target=\"OTHER\"/>\n                </L7p:CacheLookup>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"Y2FjaGU=\"/>\n                    <L7p:VariableToSet stringValue=\"source\"/>\n                </L7p:SetVariable>\n                <L7p:AuditDetailAssertion>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// FINE\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Detail stringValue=\"==> Found listenPorts.sorted in the cache\"/>\n                    <L7p:Level stringValue=\"FINE\"/>\n                </L7p:AuditDetailAssertion>\n                <L7p:assertionComment>\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// Look in cache unless asked to refresh cache\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:assertionComment>\n            </wsp:All>\n            <wsp:All wsp:Usage=\"Required\">\n                <L7p:Encapsulated>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// GET listenPorts\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:EncapsulatedAssertionConfigGuid stringValue=\"c8a5a0d5-1ae2-4144-b538-5c311efc1560\"/>\n                    <L7p:EncapsulatedAssertionConfigName stringValue=\"Utility: Call Restman\"/>\n                    <L7p:Parameters mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"element\"/>\n                            <L7p:value stringValue=\"ListenPort\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"message\"/>\n                            <L7p:value stringValue=\"\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"method\"/>\n                            <L7p:value stringValue=\"GET\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"resource\"/>\n                            <L7p:value stringValue=\"listenPorts\"/>\n                        </L7p:entry>\n                    </L7p:Parameters>\n                </L7p:Encapsulated>\n                <wsp:OneOrMore wsp:Usage=\"Required\">\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:VariablePrefix stringValue=\"listenPorts\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/l7:List/l7:Item/l7:Resource/l7:ListenPort\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <L7p:TrueAssertion/>\n                    <L7p:assertionComment>\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// Extract the list of listen ports, never fail\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:assertionComment>\n                </wsp:OneOrMore>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz48TGlzdGVuUG9ydHM+\"/>\n                    <L7p:VariableToSet stringValue=\"listenPorts.sorted\"/>\n                </L7p:SetVariable>\n                <L7p:ForEachLoop L7p:Usage=\"Required\"\n                    loopVariable=\"listenPorts.elements\" variablePrefix=\"listenPort\">\n                    <L7p:SetVariable>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Cast to message type for parsing\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:Base64Expression stringValue=\"JHtsaXN0ZW5Qb3J0LmN1cnJlbnR9\"/>\n                        <L7p:ContentType stringValue=\"text/xml; charset=utf-8\"/>\n                        <L7p:DataType variableDataType=\"message\"/>\n                        <L7p:VariableToSet stringValue=\"listenPort.xml\"/>\n                    </L7p:SetVariable>\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Retrieve the listen port ID\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:VariablePrefix stringValue=\"id\"/>\n                        <L7p:XmlMsgSrc stringValue=\"listenPort.xml\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/l7:ListenPort/@id\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// retrieve the listen port name\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:VariablePrefix stringValue=\"name\"/>\n                        <L7p:XmlMsgSrc stringValue=\"listenPort.xml\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/l7:ListenPort/l7:Name\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// retrieve the listen port enabled state\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:VariablePrefix stringValue=\"enabled\"/>\n                        <L7p:XmlMsgSrc stringValue=\"listenPort.xml\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/l7:ListenPort/l7:Enabled\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// retrieve the listen port protocol\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:VariablePrefix stringValue=\"protocol\"/>\n                        <L7p:XmlMsgSrc stringValue=\"listenPort.xml\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/l7:ListenPort/l7:Protocol\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// retrieve the listen port port\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:VariablePrefix stringValue=\"port\"/>\n                        <L7p:XmlMsgSrc stringValue=\"listenPort.xml\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/l7:ListenPort/l7:Port\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <L7p:SetVariable>\n                        <L7p:Base64Expression stringValue=\"JHtsaXN0ZW5Qb3J0cy5zb3J0ZWR9PExpc3RlblBvcnQgaWQ9IiR7aWQucmVzdWx0fSI+PE5hbWU+PCFbQ0RBVEFbJHtuYW1lLnJlc3VsdH1dXT48L05hbWU+PFByb3RvY29sPiR7cHJvdG9jb2wucmVzdWx0fTwvUHJvdG9jb2w+PFBvcnQ+JHtwb3J0LnJlc3VsdH08L1BvcnQ+PEVuYWJsZWQ+JHtlbmFibGVkLnJlc3VsdH08L0VuYWJsZWQ+PC9MaXN0ZW5Qb3J0Pg==\"/>\n                        <L7p:VariableToSet stringValue=\"listenPorts.sorted\"/>\n                    </L7p:SetVariable>\n                    <L7p:assertionComment>\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// Build the list of listen ports\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:assertionComment>\n                </L7p:ForEachLoop>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"JHtsaXN0ZW5Qb3J0cy5zb3J0ZWR9PC9MaXN0ZW5Qb3J0cz4=\"/>\n                    <L7p:ContentType stringValue=\"text/xml; charset=utf-8\"/>\n                    <L7p:DataType variableDataType=\"message\"/>\n                    <L7p:VariableToSet stringValue=\"listenPorts.sorted\"/>\n                </L7p:SetVariable>\n                <L7p:XslTransformation>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// Sort the listen ports by name\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Direction intValue=\"-1\"/>\n                    <L7p:OtherTargetMessageVariable stringValue=\"listenPorts.sorted\"/>\n                    <L7p:ResourceInfo staticResourceInfo=\"included\">\n                        <L7p:Document stringValue=\"&lt;xsl:stylesheet version=&quot;1.0&quot; xmlns:l7=&quot;http://ns.l7tech.com/2010/04/gateway-management&quot; xmlns:xsl=&quot;http://www.w3.org/1999/XSL/Transform&quot;>&lt;xsl:template match=&quot;/ListenPorts&quot;>    &lt;xsl:copy>        &lt;xsl:for-each select=&quot;ListenPort&quot;>            &lt;xsl:sort select=&quot;./Name&quot;/>            &lt;xsl:copy-of select=&quot;.&quot;/>        &lt;/xsl:for-each>    &lt;/xsl:copy>&lt;/xsl:template>&lt;/xsl:stylesheet>\"/>\n                    </L7p:ResourceInfo>\n                    <L7p:Target target=\"OTHER\"/>\n                    <L7p:TransformName stringValue=\"\"/>\n                    <L7p:XsltVersion stringValue=\"1.0\"/>\n                </L7p:XslTransformation>\n                <L7p:CacheStorage>\n                    <L7p:CacheEntryKey stringValue=\"${cacheKey}\"/>\n                    <L7p:CacheId stringValue=\"listenPortList\"/>\n                    <L7p:MaxEntries stringValue=\"1\"/>\n                    <L7p:MaxEntryAgeSeconds stringValue=\"${cacheAge}\"/>\n                    <L7p:MaxEntrySizeBytes stringValue=\"200000\"/>\n                    <L7p:OtherTargetMessageVariable stringValue=\"listenPorts.sorted\"/>\n                    <L7p:StoreSoapFaults booleanValue=\"true\"/>\n                    <L7p:Target target=\"OTHER\"/>\n                </L7p:CacheStorage>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"c3lzdGVt\"/>\n                    <L7p:VariableToSet stringValue=\"source\"/>\n                </L7p:SetVariable>\n                <L7p:AuditDetailAssertion>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// FINE\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Detail stringValue=\"==> Loaded listenPorts.sorted from system and stored to cache\"/>\n                    <L7p:Level stringValue=\"FINE\"/>\n                </L7p:AuditDetailAssertion>\n                <L7p:assertionComment>\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// Retrieve new list and cache\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:assertionComment>\n            </wsp:All>\n            <wsp:All wsp:Usage=\"Required\">\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"RXJyb3Igd2hlbiBsaXN0aW5nIGxpc3RlbiBwb3J0cw==\"/>\n                    <L7p:VariableToSet stringValue=\"error.msg\"/>\n                </L7p:SetVariable>\n                <L7p:AuditDetailAssertion>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// WARNING\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Detail stringValue=\"==> Error listing listen ports in ${policy.name}\"/>\n                    <L7p:Level stringValue=\"WARNING\"/>\n                </L7p:AuditDetailAssertion>\n                <L7p:FalseAssertion/>\n                <L7p:assertionComment>\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// Failure - set ${error.msg}\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:assertionComment>\n            </wsp:All>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Caching logic\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:OneOrMore>\n        <L7p:Regex>\n            <L7p:AssertionComment assertionComment=\"included\">\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Add source attribute to /ListenPorts element\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:AssertionComment>\n            <L7p:AutoTarget booleanValue=\"false\"/>\n            <L7p:OtherTargetMessageVariable stringValue=\"listenPorts.sorted\"/>\n            <L7p:Regex stringValue=\"&lt;ListenPorts>\"/>\n            <L7p:Replace booleanValue=\"true\"/>\n            <L7p:Replacement stringValue=\"&lt;ListenPorts source=&quot;${source}&quot;>\"/>\n            <L7p:Target target=\"OTHER\"/>\n        </L7p:Regex>\n        <L7p:AuditDetailAssertion>\n            <L7p:AssertionComment assertionComment=\"included\">\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// FINE\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:AssertionComment>\n            <L7p:Detail stringValue=\"==> Leaving Utility Fragment: ${policy.name}\"/>\n            <L7p:Level stringValue=\"FINE\"/>\n        </L7p:AuditDetailAssertion>\n    </wsp:All>\n</wsp:Policy>\n"
        }
      ]
    },
    {
      "guid": "13743744-1348-481a-9c6b-f8ed3f6a89b6",
      "name": "Utility: List Policies",
      "policyType": "FRAGMENT",
      "checksum": "d079205f30d435989ef2ed3d3c72e2e3f8bf612c",
      "folderPath": "/Gateway Management Utilities/fragments",
      "soap": false,
      "policy": {
        "xml": "<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<wsp:Policy xmlns:L7p=\"http://www.layer7tech.com/ws/policy\" xmlns:wsp=\"http://schemas.xmlsoap.org/ws/2002/12/policy\">\n    <wsp:All wsp:Usage=\"Required\">\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Policy fragment for &quot;Utility: List Policies&quot; encapsulated assertion\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Call Restman and generate a sorted list of policies\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** - Assumes an admin role user has been authenticated\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** - Caches results for ${cacheAge} seconds (default=300). To refresh the cache set ${refresh}=true when calling\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** - Returns a text/xml message variable in ${policies.sorted}\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Set ${folderId} to isolate listing to a single folder, else list all policies\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Inputs:\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - refresh (string)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - folderId (string)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - cacheAge (string)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Outputs:\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - policies.sorted (message)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - error.msg (string)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** v1.0.0 - Jay MacDonald - 20201107 - Initial Version\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n        </L7p:CommentAssertion>\n        <L7p:AuditDetailAssertion>\n            <L7p:AssertionComment assertionComment=\"included\">\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// FINE\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:AssertionComment>\n            <L7p:Detail stringValue=\"==> Entering Utility Fragment: ${policy.name} (refresh=${refresh})\"/>\n            <L7p:Level stringValue=\"FINE\"/>\n        </L7p:AuditDetailAssertion>\n        <wsp:All wsp:Usage=\"Required\">\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** ${policies.sorted} has the following schema:\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** \"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** &lt;Policies source=&quot;cache|system&quot;>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   &lt;Policy id=&quot;string&quot; folderId=&quot;string&quot;>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**     &lt;Name>string&lt;/Name>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**     &lt;GUID>string&lt;/GUID>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**     &lt;Type>string&lt;/Type>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**     &lt;FolderPath>string&lt;/FolderPath>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   &lt;/Policy>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   ...\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** &lt;/Policies>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n            </L7p:CommentAssertion>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Description of ${policies.sorted}\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:All>\n        <wsp:OneOrMore wsp:Usage=\"Required\">\n            <L7p:ComparisonAssertion>\n                <L7p:AssertionComment assertionComment=\"included\">\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// true or false\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:AssertionComment>\n                <L7p:CaseSensitive booleanValue=\"false\"/>\n                <L7p:Expression1 stringValue=\"${cacheAge}\"/>\n                <L7p:Operator operatorNull=\"null\"/>\n                <L7p:Predicates predicates=\"included\">\n                    <L7p:item dataType=\"included\">\n                        <L7p:Type variableDataType=\"int\"/>\n                    </L7p:item>\n                    <L7p:item binary=\"included\">\n                        <L7p:CaseSensitive booleanValue=\"false\"/>\n                        <L7p:Operator operator=\"GT\"/>\n                        <L7p:RightValue stringValue=\"0\"/>\n                    </L7p:item>\n                </L7p:Predicates>\n            </L7p:ComparisonAssertion>\n            <L7p:SetVariable>\n                <L7p:Base64Expression stringValue=\"MzAw\"/>\n                <L7p:DataType variableDataType=\"int\"/>\n                <L7p:VariableToSet stringValue=\"cacheAge\"/>\n            </L7p:SetVariable>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Ensure ${cacheAge} is set, default=300\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:OneOrMore>\n        <wsp:OneOrMore wsp:Usage=\"Required\">\n            <L7p:ComparisonAssertion>\n                <L7p:CaseSensitive booleanValue=\"false\"/>\n                <L7p:Expression1 stringValue=\"${folderId}\"/>\n                <L7p:Expression2 stringValue=\"0\"/>\n                <L7p:Negate booleanValue=\"true\"/>\n                <L7p:Operator operator=\"EMPTY\"/>\n                <L7p:Predicates predicates=\"included\">\n                    <L7p:item binary=\"included\">\n                        <L7p:CaseSensitive booleanValue=\"false\"/>\n                        <L7p:Negated booleanValue=\"true\"/>\n                        <L7p:Operator operator=\"EMPTY\"/>\n                        <L7p:RightValue stringValue=\"0\"/>\n                    </L7p:item>\n                </L7p:Predicates>\n            </L7p:ComparisonAssertion>\n            <L7p:SetVariable>\n                <L7p:AssertionComment assertionComment=\"included\">\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// 0 means report all policies\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:AssertionComment>\n                <L7p:Base64Expression stringValue=\"MA==\"/>\n                <L7p:VariableToSet stringValue=\"folderId\"/>\n            </L7p:SetVariable>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Set default ${folderId}=0 (all)\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:OneOrMore>\n        <wsp:OneOrMore wsp:Usage=\"Required\">\n            <L7p:ComparisonAssertion>\n                <L7p:AssertionComment assertionComment=\"included\">\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// true or false\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:AssertionComment>\n                <L7p:CaseSensitive booleanValue=\"false\"/>\n                <L7p:Expression1 stringValue=\"${refresh}\"/>\n                <L7p:Operator operatorNull=\"null\"/>\n                <L7p:Predicates predicates=\"included\">\n                    <L7p:item dataType=\"included\">\n                        <L7p:Type variableDataType=\"string\"/>\n                    </L7p:item>\n                    <L7p:item regex=\"included\">\n                        <L7p:Pattern stringValue=\"^(true|false)$\"/>\n                    </L7p:item>\n                </L7p:Predicates>\n            </L7p:ComparisonAssertion>\n            <L7p:SetVariable>\n                <L7p:Base64Expression stringValue=\"ZmFsc2U=\"/>\n                <L7p:VariableToSet stringValue=\"refresh\"/>\n            </L7p:SetVariable>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Ensure ${refresh} is set, default=false\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:OneOrMore>\n        <L7p:SetVariable>\n            <L7p:Base64Expression stringValue=\"cG9saWNpZXMuc29ydGVkLSR7Zm9sZGVySWR9\"/>\n            <L7p:VariableToSet stringValue=\"cacheKey\"/>\n        </L7p:SetVariable>\n        <wsp:OneOrMore wsp:Usage=\"Required\">\n            <wsp:All wsp:Usage=\"Required\">\n                <L7p:ComparisonAssertion>\n                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                    <L7p:Expression1 stringValue=\"${refresh}\"/>\n                    <L7p:Operator operatorNull=\"null\"/>\n                    <L7p:Predicates predicates=\"included\">\n                        <L7p:item dataType=\"included\">\n                            <L7p:Type variableDataType=\"string\"/>\n                        </L7p:item>\n                        <L7p:item binary=\"included\">\n                            <L7p:Negated booleanValue=\"true\"/>\n                            <L7p:RightValue stringValue=\"true\"/>\n                        </L7p:item>\n                    </L7p:Predicates>\n                </L7p:ComparisonAssertion>\n                <L7p:CacheLookup>\n                    <L7p:CacheEntryKey stringValue=\"${cacheKey}\"/>\n                    <L7p:CacheId stringValue=\"policyList\"/>\n                    <L7p:ContentTypeOverride stringValue=\"\"/>\n                    <L7p:MaxEntryAgeSeconds stringValue=\"${cacheAge}\"/>\n                    <L7p:OtherTargetMessageVariable stringValue=\"policies.sorted\"/>\n                    <L7p:Target target=\"OTHER\"/>\n                </L7p:CacheLookup>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"Y2FjaGU=\"/>\n                    <L7p:VariableToSet stringValue=\"source\"/>\n                </L7p:SetVariable>\n                <L7p:AuditDetailAssertion>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// FINE\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Detail stringValue=\"==> Found policies.sorted in the cache\"/>\n                    <L7p:Level stringValue=\"FINE\"/>\n                </L7p:AuditDetailAssertion>\n                <L7p:assertionComment>\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// Look in cache unless asked to refresh cache\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:assertionComment>\n            </wsp:All>\n            <wsp:All wsp:Usage=\"Required\">\n                <L7p:Encapsulated>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// Want this for full folder paths when reporting\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:EncapsulatedAssertionConfigGuid stringValue=\"fbb4b1d3-54a5-4ab4-95af-814267236d17\"/>\n                    <L7p:EncapsulatedAssertionConfigName stringValue=\"Utility: List Folders\"/>\n                    <L7p:Parameters mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"cacheAge\"/>\n                            <L7p:value stringValue=\"${cacheAge}\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"refresh\"/>\n                            <L7p:value stringValue=\"${refresh}\"/>\n                        </L7p:entry>\n                    </L7p:Parameters>\n                </L7p:Encapsulated>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"cG9saWNpZXM=\"/>\n                    <L7p:VariableToSet stringValue=\"resource\"/>\n                </L7p:SetVariable>\n                <wsp:OneOrMore wsp:Usage=\"Required\">\n                    <L7p:ComparisonAssertion>\n                        <L7p:CaseSensitive booleanValue=\"false\"/>\n                        <L7p:Expression1 stringValue=\"${folderId}\"/>\n                        <L7p:Expression2 stringValue=\"0\"/>\n                        <L7p:Predicates predicates=\"included\">\n                            <L7p:item binary=\"included\">\n                                <L7p:CaseSensitive booleanValue=\"false\"/>\n                                <L7p:RightValue stringValue=\"0\"/>\n                            </L7p:item>\n                        </L7p:Predicates>\n                    </L7p:ComparisonAssertion>\n                    <L7p:SetVariable>\n                        <L7p:Base64Expression stringValue=\"JHtyZXNvdXJjZX0/cGFyZW50Rm9sZGVyLmlkPSR7Zm9sZGVySWR9\"/>\n                        <L7p:VariableToSet stringValue=\"resource\"/>\n                    </L7p:SetVariable>\n                    <L7p:assertionComment>\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// Append parentFolder.id to ${resource} if set\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:assertionComment>\n                </wsp:OneOrMore>\n                <L7p:Encapsulated>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// GET ${resource}\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:EncapsulatedAssertionConfigGuid stringValue=\"c8a5a0d5-1ae2-4144-b538-5c311efc1560\"/>\n                    <L7p:EncapsulatedAssertionConfigName stringValue=\"Utility: Call Restman\"/>\n                    <L7p:Parameters mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"element\"/>\n                            <L7p:value stringValue=\"Policy\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"message\"/>\n                            <L7p:value stringValue=\"\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"method\"/>\n                            <L7p:value stringValue=\"GET\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"resource\"/>\n                            <L7p:value stringValue=\"${resource}\"/>\n                        </L7p:entry>\n                    </L7p:Parameters>\n                </L7p:Encapsulated>\n                <wsp:OneOrMore wsp:Usage=\"Required\">\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:VariablePrefix stringValue=\"policies\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/l7:List/l7:Item/l7:Resource/l7:Policy\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <L7p:TrueAssertion/>\n                    <L7p:assertionComment>\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// Extract the list of policies, never fail\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:assertionComment>\n                </wsp:OneOrMore>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4NCjxQb2xpY2llcz4=\"/>\n                    <L7p:VariableToSet stringValue=\"policies.sorted\"/>\n                </L7p:SetVariable>\n                <L7p:ForEachLoop L7p:Usage=\"Required\"\n                    loopVariable=\"policies.elements\" variablePrefix=\"policy\">\n                    <L7p:SetVariable>\n                        <L7p:Base64Expression stringValue=\"JHtwb2xpY3kuY3VycmVudH0=\"/>\n                        <L7p:ContentType stringValue=\"text/xml; charset=utf-8\"/>\n                        <L7p:DataType variableDataType=\"message\"/>\n                        <L7p:VariableToSet stringValue=\"policy.xml\"/>\n                    </L7p:SetVariable>\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:VariablePrefix stringValue=\"folderId\"/>\n                        <L7p:XmlMsgSrc stringValue=\"policy.xml\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/l7:Policy/l7:PolicyDetail/@folderId\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"s\"/>\n                                    <L7p:value stringValue=\"http://schemas.xmlsoap.org/soap/envelope/\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <wsp:OneOrMore wsp:Usage=\"Required\">\n                        <L7p:ComparisonAssertion>\n                            <L7p:CaseSensitive booleanValue=\"false\"/>\n                            <L7p:Expression1 stringValue=\"${folderId}\"/>\n                            <L7p:Operator operatorNull=\"null\"/>\n                            <L7p:Predicates predicates=\"included\">\n                                <L7p:item dataType=\"included\">\n                                    <L7p:Type variableDataType=\"int\"/>\n                                </L7p:item>\n                                <L7p:item binary=\"included\">\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:Negated booleanValue=\"true\"/>\n                                    <L7p:RightValue stringValue=\"0\"/>\n                                </L7p:item>\n                                <L7p:item binary=\"included\">\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:Negated booleanValue=\"true\"/>\n                                    <L7p:RightValue stringValue=\"${folderId.result}\"/>\n                                </L7p:item>\n                            </L7p:Predicates>\n                        </L7p:ComparisonAssertion>\n                        <wsp:All wsp:Usage=\"Required\">\n                            <L7p:ResponseXpathAssertion>\n                                <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Get the policy's ID\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:AssertionComment>\n                                <L7p:VariablePrefix stringValue=\"id\"/>\n                                <L7p:XmlMsgSrc stringValue=\"policy.xml\"/>\n                                <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                    <L7p:Expression stringValue=\"/l7:Policy/l7:PolicyDetail/@id\"/>\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"s\"/>\n                                    <L7p:value stringValue=\"http://schemas.xmlsoap.org/soap/envelope/\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                                </L7p:XpathExpression>\n                            </L7p:ResponseXpathAssertion>\n                            <L7p:ResponseXpathAssertion>\n                                <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Get the policy's GUID\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:AssertionComment>\n                                <L7p:VariablePrefix stringValue=\"guid\"/>\n                                <L7p:XmlMsgSrc stringValue=\"policy.xml\"/>\n                                <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                    <L7p:Expression stringValue=\"/l7:Policy/l7:PolicyDetail/@guid\"/>\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"s\"/>\n                                    <L7p:value stringValue=\"http://schemas.xmlsoap.org/soap/envelope/\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                                </L7p:XpathExpression>\n                            </L7p:ResponseXpathAssertion>\n                            <L7p:ResponseXpathAssertion>\n                                <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Get the policy's name\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:AssertionComment>\n                                <L7p:VariablePrefix stringValue=\"name\"/>\n                                <L7p:XmlMsgSrc stringValue=\"policy.xml\"/>\n                                <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                    <L7p:Expression stringValue=\"/l7:Policy/l7:PolicyDetail/l7:Name\"/>\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"s\"/>\n                                    <L7p:value stringValue=\"http://schemas.xmlsoap.org/soap/envelope/\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                                </L7p:XpathExpression>\n                            </L7p:ResponseXpathAssertion>\n                            <L7p:ResponseXpathAssertion>\n                                <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Get the policy's type\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:AssertionComment>\n                                <L7p:VariablePrefix stringValue=\"policyType\"/>\n                                <L7p:XmlMsgSrc stringValue=\"policy.xml\"/>\n                                <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                    <L7p:Expression stringValue=\"/l7:Policy/l7:PolicyDetail/l7:PolicyType\"/>\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"s\"/>\n                                    <L7p:value stringValue=\"http://schemas.xmlsoap.org/soap/envelope/\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                                </L7p:XpathExpression>\n                            </L7p:ResponseXpathAssertion>\n                            <L7p:ResponseXpathAssertion>\n                                <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Get the folder path for the policy\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:AssertionComment>\n                                <L7p:VariablePrefix stringValue=\"folderPath\"/>\n                                <L7p:XmlMsgSrc stringValue=\"folders.sorted\"/>\n                                <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                    <L7p:Expression stringValue=\"/Folders/Folder[@id=$folderId.result]/FolderPath\"/>\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"s\"/>\n                                    <L7p:value stringValue=\"http://schemas.xmlsoap.org/soap/envelope/\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                                </L7p:XpathExpression>\n                            </L7p:ResponseXpathAssertion>\n                            <L7p:SetVariable>\n                                <L7p:Base64Expression stringValue=\"JHtwb2xpY2llcy5zb3J0ZWR9PFBvbGljeSBpZD0iJHtpZC5yZXN1bHR9IiBmb2xkZXJJZD0iJHtmb2xkZXJJZC5yZXN1bHR9Ij48TmFtZT48IVtDREFUQVske25hbWUucmVzdWx0fV1dPjwvTmFtZT48R1VJRD4ke2d1aWQucmVzdWx0fTwvR1VJRD48VHlwZT4ke3BvbGljeVR5cGUucmVzdWx0fTwvVHlwZT48Rm9sZGVyUGF0aD48IVtDREFUQVske2ZvbGRlclBhdGgucmVzdWx0fV1dPjwvRm9sZGVyUGF0aD48L1BvbGljeT4=\"/>\n                                <L7p:VariableToSet stringValue=\"policies.sorted\"/>\n                            </L7p:SetVariable>\n                            <L7p:assertionComment>\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Process it\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:assertionComment>\n                        </wsp:All>\n                        <L7p:assertionComment>\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Only process if ${folderId} = 0 or matches ${folderId.result}\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:assertionComment>\n                    </wsp:OneOrMore>\n                </L7p:ForEachLoop>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"JHtwb2xpY2llcy5zb3J0ZWR9PC9Qb2xpY2llcz4=\"/>\n                    <L7p:ContentType stringValue=\"text/xml; charset=utf-8\"/>\n                    <L7p:DataType variableDataType=\"message\"/>\n                    <L7p:VariableToSet stringValue=\"policies.sorted\"/>\n                </L7p:SetVariable>\n                <L7p:XslTransformation>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// Sort the folders by display path\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Direction intValue=\"-1\"/>\n                    <L7p:OtherTargetMessageVariable stringValue=\"policies.sorted\"/>\n                    <L7p:ResourceInfo staticResourceInfo=\"included\">\n                        <L7p:Document stringValue=\"&lt;xsl:stylesheet version=&quot;1.0&quot; xmlns:l7=&quot;http://ns.l7tech.com/2010/04/gateway-management&quot; xmlns:xsl=&quot;http://www.w3.org/1999/XSL/Transform&quot;>&lt;xsl:template match=&quot;/Policies&quot;>    &lt;xsl:copy>        &lt;xsl:for-each select=&quot;Policy&quot;>            &lt;xsl:sort select=&quot;./FolderPath&quot;/>            &lt;xsl:sort select=&quot;./Name&quot;/>            &lt;xsl:copy-of select=&quot;.&quot;/>        &lt;/xsl:for-each>    &lt;/xsl:copy>&lt;/xsl:template>&lt;/xsl:stylesheet>\"/>\n                    </L7p:ResourceInfo>\n                    <L7p:Target target=\"OTHER\"/>\n                    <L7p:TransformName stringValue=\"\"/>\n                    <L7p:XsltVersion stringValue=\"1.0\"/>\n                </L7p:XslTransformation>\n                <L7p:CacheStorage>\n                    <L7p:CacheEntryKey stringValue=\"${cacheKey}\"/>\n                    <L7p:CacheId stringValue=\"policyList\"/>\n                    <L7p:MaxEntries stringValue=\"20\"/>\n                    <L7p:MaxEntryAgeSeconds stringValue=\"${cacheAge}\"/>\n                    <L7p:MaxEntrySizeBytes stringValue=\"200000\"/>\n                    <L7p:OtherTargetMessageVariable stringValue=\"policies.sorted\"/>\n                    <L7p:StoreSoapFaults booleanValue=\"true\"/>\n                    <L7p:Target target=\"OTHER\"/>\n                </L7p:CacheStorage>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"c3lzdGVt\"/>\n                    <L7p:VariableToSet stringValue=\"source\"/>\n                </L7p:SetVariable>\n                <L7p:AuditDetailAssertion>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// FINE\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Detail stringValue=\"==> Loaded policies.sorted from system and stored to cache\"/>\n                    <L7p:Level stringValue=\"FINE\"/>\n                </L7p:AuditDetailAssertion>\n                <L7p:assertionComment>\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// Retrieve new list and cache\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:assertionComment>\n            </wsp:All>\n            <wsp:All wsp:Usage=\"Required\">\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"RXJyb3Igd2hlbiBsaXN0aW5nIHBvbGljaWVz\"/>\n                    <L7p:VariableToSet stringValue=\"error.msg\"/>\n                </L7p:SetVariable>\n                <L7p:AuditDetailAssertion>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// WARNING\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Detail stringValue=\"==> Error listing policies in ${policy.name}\"/>\n                    <L7p:Level stringValue=\"WARNING\"/>\n                </L7p:AuditDetailAssertion>\n                <L7p:FalseAssertion/>\n                <L7p:assertionComment>\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// Failure - set ${error.msg}\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:assertionComment>\n            </wsp:All>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Caching logic\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:OneOrMore>\n        <L7p:Regex>\n            <L7p:AssertionComment assertionComment=\"included\">\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Add source attribute to /Policies element\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:AssertionComment>\n            <L7p:AutoTarget booleanValue=\"false\"/>\n            <L7p:OtherTargetMessageVariable stringValue=\"policies.sorted\"/>\n            <L7p:Regex stringValue=\"&lt;Policies>\"/>\n            <L7p:Replace booleanValue=\"true\"/>\n            <L7p:Replacement stringValue=\"&lt;Policies source=&quot;${source}&quot;>\"/>\n            <L7p:Target target=\"OTHER\"/>\n        </L7p:Regex>\n        <L7p:AuditDetailAssertion>\n            <L7p:AssertionComment assertionComment=\"included\">\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// FINE\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:AssertionComment>\n            <L7p:Detail stringValue=\"==> Leaving Utility Fragment: ${policy.name}\"/>\n            <L7p:Level stringValue=\"FINE\"/>\n        </L7p:AuditDetailAssertion>\n    </wsp:All>\n</wsp:Policy>\n"
      },
      "policyRevisions": [
        {
          "goid": "bed4baf4ff33b7e528854c3965d9bb50",
          "ordinal": 1,
          "active": true,
          "author": "admin",
          "time": "2025-02-05T14:20:38.543Z",
          "xml": "<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<wsp:Policy xmlns:L7p=\"http://www.layer7tech.com/ws/policy\" xmlns:wsp=\"http://schemas.xmlsoap.org/ws/2002/12/policy\">\n    <wsp:All wsp:Usage=\"Required\">\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Policy fragment for &quot;Utility: List Policies&quot; encapsulated assertion\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Call Restman and generate a sorted list of policies\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** - Assumes an admin role user has been authenticated\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** - Caches results for ${cacheAge} seconds (default=300). To refresh the cache set ${refresh}=true when calling\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** - Returns a text/xml message variable in ${policies.sorted}\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Set ${folderId} to isolate listing to a single folder, else list all policies\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Inputs:\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - refresh (string)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - folderId (string)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - cacheAge (string)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Outputs:\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - policies.sorted (message)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - error.msg (string)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** v1.0.0 - Jay MacDonald - 20201107 - Initial Version\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n        </L7p:CommentAssertion>\n        <L7p:AuditDetailAssertion>\n            <L7p:AssertionComment assertionComment=\"included\">\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// FINE\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:AssertionComment>\n            <L7p:Detail stringValue=\"==> Entering Utility Fragment: ${policy.name} (refresh=${refresh})\"/>\n            <L7p:Level stringValue=\"FINE\"/>\n        </L7p:AuditDetailAssertion>\n        <wsp:All wsp:Usage=\"Required\">\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** ${policies.sorted} has the following schema:\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** \"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** &lt;Policies source=&quot;cache|system&quot;>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   &lt;Policy id=&quot;string&quot; folderId=&quot;string&quot;>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**     &lt;Name>string&lt;/Name>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**     &lt;GUID>string&lt;/GUID>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**     &lt;Type>string&lt;/Type>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**     &lt;FolderPath>string&lt;/FolderPath>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   &lt;/Policy>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   ...\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** &lt;/Policies>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n            </L7p:CommentAssertion>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Description of ${policies.sorted}\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:All>\n        <wsp:OneOrMore wsp:Usage=\"Required\">\n            <L7p:ComparisonAssertion>\n                <L7p:AssertionComment assertionComment=\"included\">\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// true or false\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:AssertionComment>\n                <L7p:CaseSensitive booleanValue=\"false\"/>\n                <L7p:Expression1 stringValue=\"${cacheAge}\"/>\n                <L7p:Operator operatorNull=\"null\"/>\n                <L7p:Predicates predicates=\"included\">\n                    <L7p:item dataType=\"included\">\n                        <L7p:Type variableDataType=\"int\"/>\n                    </L7p:item>\n                    <L7p:item binary=\"included\">\n                        <L7p:CaseSensitive booleanValue=\"false\"/>\n                        <L7p:Operator operator=\"GT\"/>\n                        <L7p:RightValue stringValue=\"0\"/>\n                    </L7p:item>\n                </L7p:Predicates>\n            </L7p:ComparisonAssertion>\n            <L7p:SetVariable>\n                <L7p:Base64Expression stringValue=\"MzAw\"/>\n                <L7p:DataType variableDataType=\"int\"/>\n                <L7p:VariableToSet stringValue=\"cacheAge\"/>\n            </L7p:SetVariable>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Ensure ${cacheAge} is set, default=300\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:OneOrMore>\n        <wsp:OneOrMore wsp:Usage=\"Required\">\n            <L7p:ComparisonAssertion>\n                <L7p:CaseSensitive booleanValue=\"false\"/>\n                <L7p:Expression1 stringValue=\"${folderId}\"/>\n                <L7p:Expression2 stringValue=\"0\"/>\n                <L7p:Negate booleanValue=\"true\"/>\n                <L7p:Operator operator=\"EMPTY\"/>\n                <L7p:Predicates predicates=\"included\">\n                    <L7p:item binary=\"included\">\n                        <L7p:CaseSensitive booleanValue=\"false\"/>\n                        <L7p:Negated booleanValue=\"true\"/>\n                        <L7p:Operator operator=\"EMPTY\"/>\n                        <L7p:RightValue stringValue=\"0\"/>\n                    </L7p:item>\n                </L7p:Predicates>\n            </L7p:ComparisonAssertion>\n            <L7p:SetVariable>\n                <L7p:AssertionComment assertionComment=\"included\">\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// 0 means report all policies\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:AssertionComment>\n                <L7p:Base64Expression stringValue=\"MA==\"/>\n                <L7p:VariableToSet stringValue=\"folderId\"/>\n            </L7p:SetVariable>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Set default ${folderId}=0 (all)\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:OneOrMore>\n        <wsp:OneOrMore wsp:Usage=\"Required\">\n            <L7p:ComparisonAssertion>\n                <L7p:AssertionComment assertionComment=\"included\">\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// true or false\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:AssertionComment>\n                <L7p:CaseSensitive booleanValue=\"false\"/>\n                <L7p:Expression1 stringValue=\"${refresh}\"/>\n                <L7p:Operator operatorNull=\"null\"/>\n                <L7p:Predicates predicates=\"included\">\n                    <L7p:item dataType=\"included\">\n                        <L7p:Type variableDataType=\"string\"/>\n                    </L7p:item>\n                    <L7p:item regex=\"included\">\n                        <L7p:Pattern stringValue=\"^(true|false)$\"/>\n                    </L7p:item>\n                </L7p:Predicates>\n            </L7p:ComparisonAssertion>\n            <L7p:SetVariable>\n                <L7p:Base64Expression stringValue=\"ZmFsc2U=\"/>\n                <L7p:VariableToSet stringValue=\"refresh\"/>\n            </L7p:SetVariable>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Ensure ${refresh} is set, default=false\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:OneOrMore>\n        <L7p:SetVariable>\n            <L7p:Base64Expression stringValue=\"cG9saWNpZXMuc29ydGVkLSR7Zm9sZGVySWR9\"/>\n            <L7p:VariableToSet stringValue=\"cacheKey\"/>\n        </L7p:SetVariable>\n        <wsp:OneOrMore wsp:Usage=\"Required\">\n            <wsp:All wsp:Usage=\"Required\">\n                <L7p:ComparisonAssertion>\n                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                    <L7p:Expression1 stringValue=\"${refresh}\"/>\n                    <L7p:Operator operatorNull=\"null\"/>\n                    <L7p:Predicates predicates=\"included\">\n                        <L7p:item dataType=\"included\">\n                            <L7p:Type variableDataType=\"string\"/>\n                        </L7p:item>\n                        <L7p:item binary=\"included\">\n                            <L7p:Negated booleanValue=\"true\"/>\n                            <L7p:RightValue stringValue=\"true\"/>\n                        </L7p:item>\n                    </L7p:Predicates>\n                </L7p:ComparisonAssertion>\n                <L7p:CacheLookup>\n                    <L7p:CacheEntryKey stringValue=\"${cacheKey}\"/>\n                    <L7p:CacheId stringValue=\"policyList\"/>\n                    <L7p:ContentTypeOverride stringValue=\"\"/>\n                    <L7p:MaxEntryAgeSeconds stringValue=\"${cacheAge}\"/>\n                    <L7p:OtherTargetMessageVariable stringValue=\"policies.sorted\"/>\n                    <L7p:Target target=\"OTHER\"/>\n                </L7p:CacheLookup>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"Y2FjaGU=\"/>\n                    <L7p:VariableToSet stringValue=\"source\"/>\n                </L7p:SetVariable>\n                <L7p:AuditDetailAssertion>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// FINE\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Detail stringValue=\"==> Found policies.sorted in the cache\"/>\n                    <L7p:Level stringValue=\"FINE\"/>\n                </L7p:AuditDetailAssertion>\n                <L7p:assertionComment>\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// Look in cache unless asked to refresh cache\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:assertionComment>\n            </wsp:All>\n            <wsp:All wsp:Usage=\"Required\">\n                <L7p:Encapsulated>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// Want this for full folder paths when reporting\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:EncapsulatedAssertionConfigGuid stringValue=\"fbb4b1d3-54a5-4ab4-95af-814267236d17\"/>\n                    <L7p:EncapsulatedAssertionConfigName stringValue=\"Utility: List Folders\"/>\n                    <L7p:Parameters mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"cacheAge\"/>\n                            <L7p:value stringValue=\"${cacheAge}\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"refresh\"/>\n                            <L7p:value stringValue=\"${refresh}\"/>\n                        </L7p:entry>\n                    </L7p:Parameters>\n                </L7p:Encapsulated>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"cG9saWNpZXM=\"/>\n                    <L7p:VariableToSet stringValue=\"resource\"/>\n                </L7p:SetVariable>\n                <wsp:OneOrMore wsp:Usage=\"Required\">\n                    <L7p:ComparisonAssertion>\n                        <L7p:CaseSensitive booleanValue=\"false\"/>\n                        <L7p:Expression1 stringValue=\"${folderId}\"/>\n                        <L7p:Expression2 stringValue=\"0\"/>\n                        <L7p:Predicates predicates=\"included\">\n                            <L7p:item binary=\"included\">\n                                <L7p:CaseSensitive booleanValue=\"false\"/>\n                                <L7p:RightValue stringValue=\"0\"/>\n                            </L7p:item>\n                        </L7p:Predicates>\n                    </L7p:ComparisonAssertion>\n                    <L7p:SetVariable>\n                        <L7p:Base64Expression stringValue=\"JHtyZXNvdXJjZX0/cGFyZW50Rm9sZGVyLmlkPSR7Zm9sZGVySWR9\"/>\n                        <L7p:VariableToSet stringValue=\"resource\"/>\n                    </L7p:SetVariable>\n                    <L7p:assertionComment>\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// Append parentFolder.id to ${resource} if set\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:assertionComment>\n                </wsp:OneOrMore>\n                <L7p:Encapsulated>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// GET ${resource}\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:EncapsulatedAssertionConfigGuid stringValue=\"c8a5a0d5-1ae2-4144-b538-5c311efc1560\"/>\n                    <L7p:EncapsulatedAssertionConfigName stringValue=\"Utility: Call Restman\"/>\n                    <L7p:Parameters mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"element\"/>\n                            <L7p:value stringValue=\"Policy\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"message\"/>\n                            <L7p:value stringValue=\"\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"method\"/>\n                            <L7p:value stringValue=\"GET\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"resource\"/>\n                            <L7p:value stringValue=\"${resource}\"/>\n                        </L7p:entry>\n                    </L7p:Parameters>\n                </L7p:Encapsulated>\n                <wsp:OneOrMore wsp:Usage=\"Required\">\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:VariablePrefix stringValue=\"policies\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/l7:List/l7:Item/l7:Resource/l7:Policy\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <L7p:TrueAssertion/>\n                    <L7p:assertionComment>\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// Extract the list of policies, never fail\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:assertionComment>\n                </wsp:OneOrMore>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4NCjxQb2xpY2llcz4=\"/>\n                    <L7p:VariableToSet stringValue=\"policies.sorted\"/>\n                </L7p:SetVariable>\n                <L7p:ForEachLoop L7p:Usage=\"Required\"\n                    loopVariable=\"policies.elements\" variablePrefix=\"policy\">\n                    <L7p:SetVariable>\n                        <L7p:Base64Expression stringValue=\"JHtwb2xpY3kuY3VycmVudH0=\"/>\n                        <L7p:ContentType stringValue=\"text/xml; charset=utf-8\"/>\n                        <L7p:DataType variableDataType=\"message\"/>\n                        <L7p:VariableToSet stringValue=\"policy.xml\"/>\n                    </L7p:SetVariable>\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:VariablePrefix stringValue=\"folderId\"/>\n                        <L7p:XmlMsgSrc stringValue=\"policy.xml\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/l7:Policy/l7:PolicyDetail/@folderId\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"s\"/>\n                                    <L7p:value stringValue=\"http://schemas.xmlsoap.org/soap/envelope/\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <wsp:OneOrMore wsp:Usage=\"Required\">\n                        <L7p:ComparisonAssertion>\n                            <L7p:CaseSensitive booleanValue=\"false\"/>\n                            <L7p:Expression1 stringValue=\"${folderId}\"/>\n                            <L7p:Operator operatorNull=\"null\"/>\n                            <L7p:Predicates predicates=\"included\">\n                                <L7p:item dataType=\"included\">\n                                    <L7p:Type variableDataType=\"int\"/>\n                                </L7p:item>\n                                <L7p:item binary=\"included\">\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:Negated booleanValue=\"true\"/>\n                                    <L7p:RightValue stringValue=\"0\"/>\n                                </L7p:item>\n                                <L7p:item binary=\"included\">\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:Negated booleanValue=\"true\"/>\n                                    <L7p:RightValue stringValue=\"${folderId.result}\"/>\n                                </L7p:item>\n                            </L7p:Predicates>\n                        </L7p:ComparisonAssertion>\n                        <wsp:All wsp:Usage=\"Required\">\n                            <L7p:ResponseXpathAssertion>\n                                <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Get the policy's ID\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:AssertionComment>\n                                <L7p:VariablePrefix stringValue=\"id\"/>\n                                <L7p:XmlMsgSrc stringValue=\"policy.xml\"/>\n                                <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                    <L7p:Expression stringValue=\"/l7:Policy/l7:PolicyDetail/@id\"/>\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"s\"/>\n                                    <L7p:value stringValue=\"http://schemas.xmlsoap.org/soap/envelope/\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                                </L7p:XpathExpression>\n                            </L7p:ResponseXpathAssertion>\n                            <L7p:ResponseXpathAssertion>\n                                <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Get the policy's GUID\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:AssertionComment>\n                                <L7p:VariablePrefix stringValue=\"guid\"/>\n                                <L7p:XmlMsgSrc stringValue=\"policy.xml\"/>\n                                <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                    <L7p:Expression stringValue=\"/l7:Policy/l7:PolicyDetail/@guid\"/>\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"s\"/>\n                                    <L7p:value stringValue=\"http://schemas.xmlsoap.org/soap/envelope/\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                                </L7p:XpathExpression>\n                            </L7p:ResponseXpathAssertion>\n                            <L7p:ResponseXpathAssertion>\n                                <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Get the policy's name\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:AssertionComment>\n                                <L7p:VariablePrefix stringValue=\"name\"/>\n                                <L7p:XmlMsgSrc stringValue=\"policy.xml\"/>\n                                <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                    <L7p:Expression stringValue=\"/l7:Policy/l7:PolicyDetail/l7:Name\"/>\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"s\"/>\n                                    <L7p:value stringValue=\"http://schemas.xmlsoap.org/soap/envelope/\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                                </L7p:XpathExpression>\n                            </L7p:ResponseXpathAssertion>\n                            <L7p:ResponseXpathAssertion>\n                                <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Get the policy's type\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:AssertionComment>\n                                <L7p:VariablePrefix stringValue=\"policyType\"/>\n                                <L7p:XmlMsgSrc stringValue=\"policy.xml\"/>\n                                <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                    <L7p:Expression stringValue=\"/l7:Policy/l7:PolicyDetail/l7:PolicyType\"/>\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"s\"/>\n                                    <L7p:value stringValue=\"http://schemas.xmlsoap.org/soap/envelope/\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                                </L7p:XpathExpression>\n                            </L7p:ResponseXpathAssertion>\n                            <L7p:ResponseXpathAssertion>\n                                <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Get the folder path for the policy\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:AssertionComment>\n                                <L7p:VariablePrefix stringValue=\"folderPath\"/>\n                                <L7p:XmlMsgSrc stringValue=\"folders.sorted\"/>\n                                <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                    <L7p:Expression stringValue=\"/Folders/Folder[@id=$folderId.result]/FolderPath\"/>\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"s\"/>\n                                    <L7p:value stringValue=\"http://schemas.xmlsoap.org/soap/envelope/\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                                </L7p:XpathExpression>\n                            </L7p:ResponseXpathAssertion>\n                            <L7p:SetVariable>\n                                <L7p:Base64Expression stringValue=\"JHtwb2xpY2llcy5zb3J0ZWR9PFBvbGljeSBpZD0iJHtpZC5yZXN1bHR9IiBmb2xkZXJJZD0iJHtmb2xkZXJJZC5yZXN1bHR9Ij48TmFtZT48IVtDREFUQVske25hbWUucmVzdWx0fV1dPjwvTmFtZT48R1VJRD4ke2d1aWQucmVzdWx0fTwvR1VJRD48VHlwZT4ke3BvbGljeVR5cGUucmVzdWx0fTwvVHlwZT48Rm9sZGVyUGF0aD48IVtDREFUQVske2ZvbGRlclBhdGgucmVzdWx0fV1dPjwvRm9sZGVyUGF0aD48L1BvbGljeT4=\"/>\n                                <L7p:VariableToSet stringValue=\"policies.sorted\"/>\n                            </L7p:SetVariable>\n                            <L7p:assertionComment>\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Process it\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:assertionComment>\n                        </wsp:All>\n                        <L7p:assertionComment>\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Only process if ${folderId} = 0 or matches ${folderId.result}\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:assertionComment>\n                    </wsp:OneOrMore>\n                </L7p:ForEachLoop>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"JHtwb2xpY2llcy5zb3J0ZWR9PC9Qb2xpY2llcz4=\"/>\n                    <L7p:ContentType stringValue=\"text/xml; charset=utf-8\"/>\n                    <L7p:DataType variableDataType=\"message\"/>\n                    <L7p:VariableToSet stringValue=\"policies.sorted\"/>\n                </L7p:SetVariable>\n                <L7p:XslTransformation>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// Sort the folders by display path\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Direction intValue=\"-1\"/>\n                    <L7p:OtherTargetMessageVariable stringValue=\"policies.sorted\"/>\n                    <L7p:ResourceInfo staticResourceInfo=\"included\">\n                        <L7p:Document stringValue=\"&lt;xsl:stylesheet version=&quot;1.0&quot; xmlns:l7=&quot;http://ns.l7tech.com/2010/04/gateway-management&quot; xmlns:xsl=&quot;http://www.w3.org/1999/XSL/Transform&quot;>&lt;xsl:template match=&quot;/Policies&quot;>    &lt;xsl:copy>        &lt;xsl:for-each select=&quot;Policy&quot;>            &lt;xsl:sort select=&quot;./FolderPath&quot;/>            &lt;xsl:sort select=&quot;./Name&quot;/>            &lt;xsl:copy-of select=&quot;.&quot;/>        &lt;/xsl:for-each>    &lt;/xsl:copy>&lt;/xsl:template>&lt;/xsl:stylesheet>\"/>\n                    </L7p:ResourceInfo>\n                    <L7p:Target target=\"OTHER\"/>\n                    <L7p:TransformName stringValue=\"\"/>\n                    <L7p:XsltVersion stringValue=\"1.0\"/>\n                </L7p:XslTransformation>\n                <L7p:CacheStorage>\n                    <L7p:CacheEntryKey stringValue=\"${cacheKey}\"/>\n                    <L7p:CacheId stringValue=\"policyList\"/>\n                    <L7p:MaxEntries stringValue=\"20\"/>\n                    <L7p:MaxEntryAgeSeconds stringValue=\"${cacheAge}\"/>\n                    <L7p:MaxEntrySizeBytes stringValue=\"200000\"/>\n                    <L7p:OtherTargetMessageVariable stringValue=\"policies.sorted\"/>\n                    <L7p:StoreSoapFaults booleanValue=\"true\"/>\n                    <L7p:Target target=\"OTHER\"/>\n                </L7p:CacheStorage>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"c3lzdGVt\"/>\n                    <L7p:VariableToSet stringValue=\"source\"/>\n                </L7p:SetVariable>\n                <L7p:AuditDetailAssertion>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// FINE\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Detail stringValue=\"==> Loaded policies.sorted from system and stored to cache\"/>\n                    <L7p:Level stringValue=\"FINE\"/>\n                </L7p:AuditDetailAssertion>\n                <L7p:assertionComment>\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// Retrieve new list and cache\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:assertionComment>\n            </wsp:All>\n            <wsp:All wsp:Usage=\"Required\">\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"RXJyb3Igd2hlbiBsaXN0aW5nIHBvbGljaWVz\"/>\n                    <L7p:VariableToSet stringValue=\"error.msg\"/>\n                </L7p:SetVariable>\n                <L7p:AuditDetailAssertion>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// WARNING\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Detail stringValue=\"==> Error listing policies in ${policy.name}\"/>\n                    <L7p:Level stringValue=\"WARNING\"/>\n                </L7p:AuditDetailAssertion>\n                <L7p:FalseAssertion/>\n                <L7p:assertionComment>\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// Failure - set ${error.msg}\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:assertionComment>\n            </wsp:All>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Caching logic\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:OneOrMore>\n        <L7p:Regex>\n            <L7p:AssertionComment assertionComment=\"included\">\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Add source attribute to /Policies element\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:AssertionComment>\n            <L7p:AutoTarget booleanValue=\"false\"/>\n            <L7p:OtherTargetMessageVariable stringValue=\"policies.sorted\"/>\n            <L7p:Regex stringValue=\"&lt;Policies>\"/>\n            <L7p:Replace booleanValue=\"true\"/>\n            <L7p:Replacement stringValue=\"&lt;Policies source=&quot;${source}&quot;>\"/>\n            <L7p:Target target=\"OTHER\"/>\n        </L7p:Regex>\n        <L7p:AuditDetailAssertion>\n            <L7p:AssertionComment assertionComment=\"included\">\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// FINE\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:AssertionComment>\n            <L7p:Detail stringValue=\"==> Leaving Utility Fragment: ${policy.name}\"/>\n            <L7p:Level stringValue=\"FINE\"/>\n        </L7p:AuditDetailAssertion>\n    </wsp:All>\n</wsp:Policy>\n"
        }
      ]
    },
    {
      "guid": "1beb446f-b5b0-41f5-89d1-79e8fe122577",
      "name": "Utility: List Policy Backed Services",
      "policyType": "FRAGMENT",
      "checksum": "33c7ad14382d9d6af61e2378d329aa690024d3c7",
      "folderPath": "/Gateway Management Utilities/fragments",
      "soap": false,
      "policy": {
        "xml": "<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<wsp:Policy xmlns:L7p=\"http://www.layer7tech.com/ws/policy\" xmlns:wsp=\"http://schemas.xmlsoap.org/ws/2002/12/policy\">\n    <wsp:All wsp:Usage=\"Required\">\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Policy fragment for &quot;Utility: List Policy Backed Services&quot; encapsulated assertion\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Call Restman and generate a sorted list of policy backed services\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** - Assumes an admin role user has been authenticated\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** - Caches results for ${cacheAge} seconds (default=300). To refresh the cache set ${refresh}=true when calling\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** - Returns a text/xml message variable in ${policyBackedServices.sorted}\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Inputs:\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - refresh (string)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - cacheAge (string)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Outputs:\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - policyBackedServices.sorted (message)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - error.msg (string)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** v1.0.0 - Jay MacDonald - 20201107 - Initial Version\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n        </L7p:CommentAssertion>\n        <L7p:AuditDetailAssertion>\n            <L7p:AssertionComment assertionComment=\"included\">\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// FINE\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:AssertionComment>\n            <L7p:Detail stringValue=\"==> Entering Utility Fragment: ${policy.name} (refresh=${refresh})\"/>\n            <L7p:Level stringValue=\"FINE\"/>\n        </L7p:AuditDetailAssertion>\n        <wsp:All wsp:Usage=\"Required\">\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** ${policyBackedServices.sorted} has the following schema:\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** \"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** &lt;PolicyBackedServices source=&quot;system|cache&quot;>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   &lt;PolicyBackedService id=&quot;string&quot;>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**     &lt;Name>string&lt;/Name>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**     &lt;InterfaceName>string&lt;/InterfaceName>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**     &lt;PolicyID>string&lt;/PolicyId>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   &lt;/PolicyBackedService>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   ...\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** &lt;/PolicyBackedServices>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n            </L7p:CommentAssertion>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Description of ${policyBackedServices.sorted}\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:All>\n        <wsp:OneOrMore wsp:Usage=\"Required\">\n            <L7p:ComparisonAssertion>\n                <L7p:AssertionComment assertionComment=\"included\">\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// true or false\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:AssertionComment>\n                <L7p:CaseSensitive booleanValue=\"false\"/>\n                <L7p:Expression1 stringValue=\"${cacheAge}\"/>\n                <L7p:Operator operatorNull=\"null\"/>\n                <L7p:Predicates predicates=\"included\">\n                    <L7p:item dataType=\"included\">\n                        <L7p:Type variableDataType=\"int\"/>\n                    </L7p:item>\n                    <L7p:item binary=\"included\">\n                        <L7p:CaseSensitive booleanValue=\"false\"/>\n                        <L7p:Operator operator=\"GT\"/>\n                        <L7p:RightValue stringValue=\"0\"/>\n                    </L7p:item>\n                </L7p:Predicates>\n            </L7p:ComparisonAssertion>\n            <L7p:SetVariable>\n                <L7p:Base64Expression stringValue=\"MzAw\"/>\n                <L7p:DataType variableDataType=\"int\"/>\n                <L7p:VariableToSet stringValue=\"cacheAge\"/>\n            </L7p:SetVariable>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Ensure ${cacheAge} is set, default=300\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:OneOrMore>\n        <wsp:OneOrMore wsp:Usage=\"Required\">\n            <L7p:ComparisonAssertion>\n                <L7p:AssertionComment assertionComment=\"included\">\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// true or false\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:AssertionComment>\n                <L7p:CaseSensitive booleanValue=\"false\"/>\n                <L7p:Expression1 stringValue=\"${refresh}\"/>\n                <L7p:Operator operatorNull=\"null\"/>\n                <L7p:Predicates predicates=\"included\">\n                    <L7p:item dataType=\"included\">\n                        <L7p:Type variableDataType=\"string\"/>\n                    </L7p:item>\n                    <L7p:item regex=\"included\">\n                        <L7p:Pattern stringValue=\"^(true|false)$\"/>\n                    </L7p:item>\n                </L7p:Predicates>\n            </L7p:ComparisonAssertion>\n            <L7p:SetVariable>\n                <L7p:Base64Expression stringValue=\"ZmFsc2U=\"/>\n                <L7p:VariableToSet stringValue=\"refresh\"/>\n            </L7p:SetVariable>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Ensure ${refresh} is set, default=false\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:OneOrMore>\n        <L7p:SetVariable>\n            <L7p:Base64Expression stringValue=\"cG9saWN5QmFja2VkU2VydmljZXMuc29ydGVk\"/>\n            <L7p:VariableToSet stringValue=\"cacheKey\"/>\n        </L7p:SetVariable>\n        <wsp:OneOrMore wsp:Usage=\"Required\">\n            <wsp:All wsp:Usage=\"Required\">\n                <L7p:ComparisonAssertion>\n                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                    <L7p:Expression1 stringValue=\"${refresh}\"/>\n                    <L7p:Operator operatorNull=\"null\"/>\n                    <L7p:Predicates predicates=\"included\">\n                        <L7p:item dataType=\"included\">\n                            <L7p:Type variableDataType=\"string\"/>\n                        </L7p:item>\n                        <L7p:item binary=\"included\">\n                            <L7p:Negated booleanValue=\"true\"/>\n                            <L7p:RightValue stringValue=\"true\"/>\n                        </L7p:item>\n                    </L7p:Predicates>\n                </L7p:ComparisonAssertion>\n                <L7p:CacheLookup>\n                    <L7p:CacheEntryKey stringValue=\"${cacheKey}\"/>\n                    <L7p:CacheId stringValue=\"policyBackedServiceList\"/>\n                    <L7p:ContentTypeOverride stringValue=\"\"/>\n                    <L7p:MaxEntryAgeSeconds stringValue=\"${cacheAge}\"/>\n                    <L7p:OtherTargetMessageVariable stringValue=\"policyBackedServices.sorted\"/>\n                    <L7p:Target target=\"OTHER\"/>\n                </L7p:CacheLookup>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"Y2FjaGU=\"/>\n                    <L7p:VariableToSet stringValue=\"source\"/>\n                </L7p:SetVariable>\n                <L7p:AuditDetailAssertion>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// FINE\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Detail stringValue=\"==> Found policyBackedServices.sorted in the cache\"/>\n                    <L7p:Level stringValue=\"FINE\"/>\n                </L7p:AuditDetailAssertion>\n                <L7p:assertionComment>\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// Look in cache unless asked to refresh cache\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:assertionComment>\n            </wsp:All>\n            <wsp:All wsp:Usage=\"Required\">\n                <L7p:Encapsulated>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// GET policyBackedServices\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:EncapsulatedAssertionConfigGuid stringValue=\"c8a5a0d5-1ae2-4144-b538-5c311efc1560\"/>\n                    <L7p:EncapsulatedAssertionConfigName stringValue=\"Utility: Call Restman\"/>\n                    <L7p:Parameters mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"element\"/>\n                            <L7p:value stringValue=\"PolicyBackedService\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"message\"/>\n                            <L7p:value stringValue=\"\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"method\"/>\n                            <L7p:value stringValue=\"Get\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"resource\"/>\n                            <L7p:value stringValue=\"policyBackedServices\"/>\n                        </L7p:entry>\n                    </L7p:Parameters>\n                </L7p:Encapsulated>\n                <wsp:OneOrMore wsp:Usage=\"Required\">\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:VariablePrefix stringValue=\"policyBackedServices\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/l7:List/l7:Item/l7:Resource/l7:PolicyBackedService\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <L7p:TrueAssertion/>\n                    <L7p:assertionComment>\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// Extract the list of policy backed services, never fail\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:assertionComment>\n                </wsp:OneOrMore>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz48UG9saWN5QmFja2VkU2VydmljZXM+\"/>\n                    <L7p:VariableToSet stringValue=\"policyBackedServices.sorted\"/>\n                </L7p:SetVariable>\n                <L7p:ForEachLoop L7p:Usage=\"Required\"\n                    loopVariable=\"policyBackedServices.elements\" variablePrefix=\"policyBackedService\">\n                    <L7p:SetVariable>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Cast to message type for parsing\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:Base64Expression stringValue=\"JHtwb2xpY3lCYWNrZWRTZXJ2aWNlLmN1cnJlbnR9\"/>\n                        <L7p:ContentType stringValue=\"text/xml; charset=utf-8\"/>\n                        <L7p:DataType variableDataType=\"message\"/>\n                        <L7p:VariableToSet stringValue=\"policyBackedService.xml\"/>\n                    </L7p:SetVariable>\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Retrieve the policy backed service ID\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:VariablePrefix stringValue=\"id\"/>\n                        <L7p:XmlMsgSrc stringValue=\"policyBackedService.xml\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/l7:PolicyBackedService/@id\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// retrieve the policy backed service name\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:VariablePrefix stringValue=\"name\"/>\n                        <L7p:XmlMsgSrc stringValue=\"policyBackedService.xml\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/l7:PolicyBackedService/l7:Name\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// retrieve the policy backed service policyId\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:VariablePrefix stringValue=\"policyId\"/>\n                        <L7p:XmlMsgSrc stringValue=\"policyBackedService.xml\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/l7:PolicyBackedService/l7:PolicyBackedServiceOperations/l7:PolicyBackedServiceOperation/l7:PolicyId\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// retrieve the policy backed service interface name\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:VariablePrefix stringValue=\"interfaceName\"/>\n                        <L7p:XmlMsgSrc stringValue=\"policyBackedService.xml\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/l7:PolicyBackedService/l7:InterfaceName\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <L7p:SetVariable>\n                        <L7p:Base64Expression stringValue=\"JHtwb2xpY3lCYWNrZWRTZXJ2aWNlcy5zb3J0ZWR9PFBvbGljeUJhY2tlZFNlcnZpY2UgaWQ9IiR7aWQucmVzdWx0fSI+PE5hbWU+PCFbQ0RBVEFbJHtuYW1lLnJlc3VsdH1dXT48L05hbWU+PEludGVyZmFjZU5hbWU+JHtpbnRlcmZhY2VOYW1lLnJlc3VsdH08L0ludGVyZmFjZU5hbWU+PFBvbGljeUlkPiR7cG9saWN5SWQucmVzdWx0fTwvUG9saWN5SWQ+PC9Qb2xpY3lCYWNrZWRTZXJ2aWNlPlBvbGljeUJhY2tlZFNlcnZpY2U+\"/>\n                        <L7p:VariableToSet stringValue=\"policyBackedServices.sorted\"/>\n                    </L7p:SetVariable>\n                    <L7p:assertionComment>\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// Build the list of policy backed services\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:assertionComment>\n                </L7p:ForEachLoop>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"JHtwb2xpY3lCYWNrZWRTZXJ2aWNlcy5zb3J0ZWR9PC9Qb2xpY3lCYWNrZWRTZXJ2aWNlcz4=\"/>\n                    <L7p:ContentType stringValue=\"text/xml; charset=utf-8\"/>\n                    <L7p:DataType variableDataType=\"message\"/>\n                    <L7p:VariableToSet stringValue=\"policyBackedServices.sorted\"/>\n                </L7p:SetVariable>\n                <L7p:XslTransformation>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// Sort the policy backed service by name\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Direction intValue=\"-1\"/>\n                    <L7p:OtherTargetMessageVariable stringValue=\"policyBackedServices.sorted\"/>\n                    <L7p:ResourceInfo staticResourceInfo=\"included\">\n                        <L7p:Document stringValue=\"&lt;xsl:stylesheet version=&quot;1.0&quot; xmlns:l7=&quot;http://ns.l7tech.com/2010/04/gateway-management&quot; xmlns:xsl=&quot;http://www.w3.org/1999/XSL/Transform&quot;>&lt;xsl:template match=&quot;/PolicyBackedServices&quot;>    &lt;xsl:copy>        &lt;xsl:for-each select=&quot;PolicyBackedService&quot;>            &lt;xsl:sort select=&quot;./Name&quot;/>            &lt;xsl:copy-of select=&quot;.&quot;/>        &lt;/xsl:for-each>    &lt;/xsl:copy>&lt;/xsl:template>&lt;/xsl:stylesheet>\"/>\n                    </L7p:ResourceInfo>\n                    <L7p:Target target=\"OTHER\"/>\n                    <L7p:TransformName stringValue=\"\"/>\n                    <L7p:XsltVersion stringValue=\"1.0\"/>\n                </L7p:XslTransformation>\n                <L7p:CacheStorage>\n                    <L7p:CacheEntryKey stringValue=\"${cacheKey}\"/>\n                    <L7p:CacheId stringValue=\"policyBackedServiceList\"/>\n                    <L7p:MaxEntries stringValue=\"1\"/>\n                    <L7p:MaxEntryAgeSeconds stringValue=\"${cacheAge}\"/>\n                    <L7p:MaxEntrySizeBytes stringValue=\"200000\"/>\n                    <L7p:OtherTargetMessageVariable stringValue=\"policyBackedServices.sorted\"/>\n                    <L7p:StoreSoapFaults booleanValue=\"true\"/>\n                    <L7p:Target target=\"OTHER\"/>\n                </L7p:CacheStorage>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"c3lzdGVt\"/>\n                    <L7p:VariableToSet stringValue=\"source\"/>\n                </L7p:SetVariable>\n                <L7p:AuditDetailAssertion>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// FINE\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Detail stringValue=\"==> Loaded policyBackedServices.sorted from system and stored to cache\"/>\n                    <L7p:Level stringValue=\"FINE\"/>\n                </L7p:AuditDetailAssertion>\n                <L7p:assertionComment>\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// Retrieve new list and cache\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:assertionComment>\n            </wsp:All>\n            <wsp:All wsp:Usage=\"Required\">\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"RXJyb3Igd2hlbiBsaXN0aW5nIHBvbGljeSBiYWNrZWQgc2VydmljZXM=\"/>\n                    <L7p:VariableToSet stringValue=\"error.msg\"/>\n                </L7p:SetVariable>\n                <L7p:AuditDetailAssertion>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// WARNING\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Detail stringValue=\"==> Error listing policy backed services in ${policy.name}\"/>\n                    <L7p:Level stringValue=\"WARNING\"/>\n                </L7p:AuditDetailAssertion>\n                <L7p:FalseAssertion/>\n                <L7p:assertionComment>\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// Failure - set ${error.msg}\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:assertionComment>\n            </wsp:All>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Caching logic\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:OneOrMore>\n        <L7p:Regex>\n            <L7p:AssertionComment assertionComment=\"included\">\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Add source attribute to /PolicyBackedServices element\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:AssertionComment>\n            <L7p:AutoTarget booleanValue=\"false\"/>\n            <L7p:OtherTargetMessageVariable stringValue=\"policyBackedServices.sorted\"/>\n            <L7p:Regex stringValue=\"&lt;PolicyBackedServices>\"/>\n            <L7p:Replace booleanValue=\"true\"/>\n            <L7p:Replacement stringValue=\"&lt;PolicyBackedServices source=&quot;${source}&quot;>\"/>\n            <L7p:Target target=\"OTHER\"/>\n        </L7p:Regex>\n        <L7p:AuditDetailAssertion>\n            <L7p:AssertionComment assertionComment=\"included\">\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// FINE\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:AssertionComment>\n            <L7p:Detail stringValue=\"==> Leaving Utility Fragment: ${policy.name}\"/>\n            <L7p:Level stringValue=\"FINE\"/>\n        </L7p:AuditDetailAssertion>\n    </wsp:All>\n</wsp:Policy>\n"
      },
      "policyRevisions": [
        {
          "goid": "bed4baf4ff33b7e528854c3965d9bb54",
          "ordinal": 1,
          "active": true,
          "author": "admin",
          "time": "2025-02-05T14:20:38.556Z",
          "xml": "<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<wsp:Policy xmlns:L7p=\"http://www.layer7tech.com/ws/policy\" xmlns:wsp=\"http://schemas.xmlsoap.org/ws/2002/12/policy\">\n    <wsp:All wsp:Usage=\"Required\">\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Policy fragment for &quot;Utility: List Policy Backed Services&quot; encapsulated assertion\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Call Restman and generate a sorted list of policy backed services\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** - Assumes an admin role user has been authenticated\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** - Caches results for ${cacheAge} seconds (default=300). To refresh the cache set ${refresh}=true when calling\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** - Returns a text/xml message variable in ${policyBackedServices.sorted}\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Inputs:\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - refresh (string)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - cacheAge (string)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Outputs:\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - policyBackedServices.sorted (message)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - error.msg (string)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** v1.0.0 - Jay MacDonald - 20201107 - Initial Version\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n        </L7p:CommentAssertion>\n        <L7p:AuditDetailAssertion>\n            <L7p:AssertionComment assertionComment=\"included\">\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// FINE\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:AssertionComment>\n            <L7p:Detail stringValue=\"==> Entering Utility Fragment: ${policy.name} (refresh=${refresh})\"/>\n            <L7p:Level stringValue=\"FINE\"/>\n        </L7p:AuditDetailAssertion>\n        <wsp:All wsp:Usage=\"Required\">\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** ${policyBackedServices.sorted} has the following schema:\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** \"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** &lt;PolicyBackedServices source=&quot;system|cache&quot;>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   &lt;PolicyBackedService id=&quot;string&quot;>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**     &lt;Name>string&lt;/Name>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**     &lt;InterfaceName>string&lt;/InterfaceName>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**     &lt;PolicyID>string&lt;/PolicyId>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   &lt;/PolicyBackedService>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   ...\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** &lt;/PolicyBackedServices>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n            </L7p:CommentAssertion>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Description of ${policyBackedServices.sorted}\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:All>\n        <wsp:OneOrMore wsp:Usage=\"Required\">\n            <L7p:ComparisonAssertion>\n                <L7p:AssertionComment assertionComment=\"included\">\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// true or false\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:AssertionComment>\n                <L7p:CaseSensitive booleanValue=\"false\"/>\n                <L7p:Expression1 stringValue=\"${cacheAge}\"/>\n                <L7p:Operator operatorNull=\"null\"/>\n                <L7p:Predicates predicates=\"included\">\n                    <L7p:item dataType=\"included\">\n                        <L7p:Type variableDataType=\"int\"/>\n                    </L7p:item>\n                    <L7p:item binary=\"included\">\n                        <L7p:CaseSensitive booleanValue=\"false\"/>\n                        <L7p:Operator operator=\"GT\"/>\n                        <L7p:RightValue stringValue=\"0\"/>\n                    </L7p:item>\n                </L7p:Predicates>\n            </L7p:ComparisonAssertion>\n            <L7p:SetVariable>\n                <L7p:Base64Expression stringValue=\"MzAw\"/>\n                <L7p:DataType variableDataType=\"int\"/>\n                <L7p:VariableToSet stringValue=\"cacheAge\"/>\n            </L7p:SetVariable>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Ensure ${cacheAge} is set, default=300\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:OneOrMore>\n        <wsp:OneOrMore wsp:Usage=\"Required\">\n            <L7p:ComparisonAssertion>\n                <L7p:AssertionComment assertionComment=\"included\">\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// true or false\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:AssertionComment>\n                <L7p:CaseSensitive booleanValue=\"false\"/>\n                <L7p:Expression1 stringValue=\"${refresh}\"/>\n                <L7p:Operator operatorNull=\"null\"/>\n                <L7p:Predicates predicates=\"included\">\n                    <L7p:item dataType=\"included\">\n                        <L7p:Type variableDataType=\"string\"/>\n                    </L7p:item>\n                    <L7p:item regex=\"included\">\n                        <L7p:Pattern stringValue=\"^(true|false)$\"/>\n                    </L7p:item>\n                </L7p:Predicates>\n            </L7p:ComparisonAssertion>\n            <L7p:SetVariable>\n                <L7p:Base64Expression stringValue=\"ZmFsc2U=\"/>\n                <L7p:VariableToSet stringValue=\"refresh\"/>\n            </L7p:SetVariable>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Ensure ${refresh} is set, default=false\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:OneOrMore>\n        <L7p:SetVariable>\n            <L7p:Base64Expression stringValue=\"cG9saWN5QmFja2VkU2VydmljZXMuc29ydGVk\"/>\n            <L7p:VariableToSet stringValue=\"cacheKey\"/>\n        </L7p:SetVariable>\n        <wsp:OneOrMore wsp:Usage=\"Required\">\n            <wsp:All wsp:Usage=\"Required\">\n                <L7p:ComparisonAssertion>\n                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                    <L7p:Expression1 stringValue=\"${refresh}\"/>\n                    <L7p:Operator operatorNull=\"null\"/>\n                    <L7p:Predicates predicates=\"included\">\n                        <L7p:item dataType=\"included\">\n                            <L7p:Type variableDataType=\"string\"/>\n                        </L7p:item>\n                        <L7p:item binary=\"included\">\n                            <L7p:Negated booleanValue=\"true\"/>\n                            <L7p:RightValue stringValue=\"true\"/>\n                        </L7p:item>\n                    </L7p:Predicates>\n                </L7p:ComparisonAssertion>\n                <L7p:CacheLookup>\n                    <L7p:CacheEntryKey stringValue=\"${cacheKey}\"/>\n                    <L7p:CacheId stringValue=\"policyBackedServiceList\"/>\n                    <L7p:ContentTypeOverride stringValue=\"\"/>\n                    <L7p:MaxEntryAgeSeconds stringValue=\"${cacheAge}\"/>\n                    <L7p:OtherTargetMessageVariable stringValue=\"policyBackedServices.sorted\"/>\n                    <L7p:Target target=\"OTHER\"/>\n                </L7p:CacheLookup>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"Y2FjaGU=\"/>\n                    <L7p:VariableToSet stringValue=\"source\"/>\n                </L7p:SetVariable>\n                <L7p:AuditDetailAssertion>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// FINE\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Detail stringValue=\"==> Found policyBackedServices.sorted in the cache\"/>\n                    <L7p:Level stringValue=\"FINE\"/>\n                </L7p:AuditDetailAssertion>\n                <L7p:assertionComment>\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// Look in cache unless asked to refresh cache\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:assertionComment>\n            </wsp:All>\n            <wsp:All wsp:Usage=\"Required\">\n                <L7p:Encapsulated>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// GET policyBackedServices\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:EncapsulatedAssertionConfigGuid stringValue=\"c8a5a0d5-1ae2-4144-b538-5c311efc1560\"/>\n                    <L7p:EncapsulatedAssertionConfigName stringValue=\"Utility: Call Restman\"/>\n                    <L7p:Parameters mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"element\"/>\n                            <L7p:value stringValue=\"PolicyBackedService\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"message\"/>\n                            <L7p:value stringValue=\"\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"method\"/>\n                            <L7p:value stringValue=\"Get\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"resource\"/>\n                            <L7p:value stringValue=\"policyBackedServices\"/>\n                        </L7p:entry>\n                    </L7p:Parameters>\n                </L7p:Encapsulated>\n                <wsp:OneOrMore wsp:Usage=\"Required\">\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:VariablePrefix stringValue=\"policyBackedServices\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/l7:List/l7:Item/l7:Resource/l7:PolicyBackedService\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <L7p:TrueAssertion/>\n                    <L7p:assertionComment>\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// Extract the list of policy backed services, never fail\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:assertionComment>\n                </wsp:OneOrMore>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz48UG9saWN5QmFja2VkU2VydmljZXM+\"/>\n                    <L7p:VariableToSet stringValue=\"policyBackedServices.sorted\"/>\n                </L7p:SetVariable>\n                <L7p:ForEachLoop L7p:Usage=\"Required\"\n                    loopVariable=\"policyBackedServices.elements\" variablePrefix=\"policyBackedService\">\n                    <L7p:SetVariable>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Cast to message type for parsing\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:Base64Expression stringValue=\"JHtwb2xpY3lCYWNrZWRTZXJ2aWNlLmN1cnJlbnR9\"/>\n                        <L7p:ContentType stringValue=\"text/xml; charset=utf-8\"/>\n                        <L7p:DataType variableDataType=\"message\"/>\n                        <L7p:VariableToSet stringValue=\"policyBackedService.xml\"/>\n                    </L7p:SetVariable>\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Retrieve the policy backed service ID\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:VariablePrefix stringValue=\"id\"/>\n                        <L7p:XmlMsgSrc stringValue=\"policyBackedService.xml\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/l7:PolicyBackedService/@id\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// retrieve the policy backed service name\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:VariablePrefix stringValue=\"name\"/>\n                        <L7p:XmlMsgSrc stringValue=\"policyBackedService.xml\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/l7:PolicyBackedService/l7:Name\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// retrieve the policy backed service policyId\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:VariablePrefix stringValue=\"policyId\"/>\n                        <L7p:XmlMsgSrc stringValue=\"policyBackedService.xml\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/l7:PolicyBackedService/l7:PolicyBackedServiceOperations/l7:PolicyBackedServiceOperation/l7:PolicyId\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// retrieve the policy backed service interface name\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:VariablePrefix stringValue=\"interfaceName\"/>\n                        <L7p:XmlMsgSrc stringValue=\"policyBackedService.xml\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/l7:PolicyBackedService/l7:InterfaceName\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <L7p:SetVariable>\n                        <L7p:Base64Expression stringValue=\"JHtwb2xpY3lCYWNrZWRTZXJ2aWNlcy5zb3J0ZWR9PFBvbGljeUJhY2tlZFNlcnZpY2UgaWQ9IiR7aWQucmVzdWx0fSI+PE5hbWU+PCFbQ0RBVEFbJHtuYW1lLnJlc3VsdH1dXT48L05hbWU+PEludGVyZmFjZU5hbWU+JHtpbnRlcmZhY2VOYW1lLnJlc3VsdH08L0ludGVyZmFjZU5hbWU+PFBvbGljeUlkPiR7cG9saWN5SWQucmVzdWx0fTwvUG9saWN5SWQ+PC9Qb2xpY3lCYWNrZWRTZXJ2aWNlPlBvbGljeUJhY2tlZFNlcnZpY2U+\"/>\n                        <L7p:VariableToSet stringValue=\"policyBackedServices.sorted\"/>\n                    </L7p:SetVariable>\n                    <L7p:assertionComment>\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// Build the list of policy backed services\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:assertionComment>\n                </L7p:ForEachLoop>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"JHtwb2xpY3lCYWNrZWRTZXJ2aWNlcy5zb3J0ZWR9PC9Qb2xpY3lCYWNrZWRTZXJ2aWNlcz4=\"/>\n                    <L7p:ContentType stringValue=\"text/xml; charset=utf-8\"/>\n                    <L7p:DataType variableDataType=\"message\"/>\n                    <L7p:VariableToSet stringValue=\"policyBackedServices.sorted\"/>\n                </L7p:SetVariable>\n                <L7p:XslTransformation>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// Sort the policy backed service by name\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Direction intValue=\"-1\"/>\n                    <L7p:OtherTargetMessageVariable stringValue=\"policyBackedServices.sorted\"/>\n                    <L7p:ResourceInfo staticResourceInfo=\"included\">\n                        <L7p:Document stringValue=\"&lt;xsl:stylesheet version=&quot;1.0&quot; xmlns:l7=&quot;http://ns.l7tech.com/2010/04/gateway-management&quot; xmlns:xsl=&quot;http://www.w3.org/1999/XSL/Transform&quot;>&lt;xsl:template match=&quot;/PolicyBackedServices&quot;>    &lt;xsl:copy>        &lt;xsl:for-each select=&quot;PolicyBackedService&quot;>            &lt;xsl:sort select=&quot;./Name&quot;/>            &lt;xsl:copy-of select=&quot;.&quot;/>        &lt;/xsl:for-each>    &lt;/xsl:copy>&lt;/xsl:template>&lt;/xsl:stylesheet>\"/>\n                    </L7p:ResourceInfo>\n                    <L7p:Target target=\"OTHER\"/>\n                    <L7p:TransformName stringValue=\"\"/>\n                    <L7p:XsltVersion stringValue=\"1.0\"/>\n                </L7p:XslTransformation>\n                <L7p:CacheStorage>\n                    <L7p:CacheEntryKey stringValue=\"${cacheKey}\"/>\n                    <L7p:CacheId stringValue=\"policyBackedServiceList\"/>\n                    <L7p:MaxEntries stringValue=\"1\"/>\n                    <L7p:MaxEntryAgeSeconds stringValue=\"${cacheAge}\"/>\n                    <L7p:MaxEntrySizeBytes stringValue=\"200000\"/>\n                    <L7p:OtherTargetMessageVariable stringValue=\"policyBackedServices.sorted\"/>\n                    <L7p:StoreSoapFaults booleanValue=\"true\"/>\n                    <L7p:Target target=\"OTHER\"/>\n                </L7p:CacheStorage>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"c3lzdGVt\"/>\n                    <L7p:VariableToSet stringValue=\"source\"/>\n                </L7p:SetVariable>\n                <L7p:AuditDetailAssertion>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// FINE\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Detail stringValue=\"==> Loaded policyBackedServices.sorted from system and stored to cache\"/>\n                    <L7p:Level stringValue=\"FINE\"/>\n                </L7p:AuditDetailAssertion>\n                <L7p:assertionComment>\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// Retrieve new list and cache\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:assertionComment>\n            </wsp:All>\n            <wsp:All wsp:Usage=\"Required\">\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"RXJyb3Igd2hlbiBsaXN0aW5nIHBvbGljeSBiYWNrZWQgc2VydmljZXM=\"/>\n                    <L7p:VariableToSet stringValue=\"error.msg\"/>\n                </L7p:SetVariable>\n                <L7p:AuditDetailAssertion>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// WARNING\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Detail stringValue=\"==> Error listing policy backed services in ${policy.name}\"/>\n                    <L7p:Level stringValue=\"WARNING\"/>\n                </L7p:AuditDetailAssertion>\n                <L7p:FalseAssertion/>\n                <L7p:assertionComment>\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// Failure - set ${error.msg}\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:assertionComment>\n            </wsp:All>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Caching logic\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:OneOrMore>\n        <L7p:Regex>\n            <L7p:AssertionComment assertionComment=\"included\">\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Add source attribute to /PolicyBackedServices element\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:AssertionComment>\n            <L7p:AutoTarget booleanValue=\"false\"/>\n            <L7p:OtherTargetMessageVariable stringValue=\"policyBackedServices.sorted\"/>\n            <L7p:Regex stringValue=\"&lt;PolicyBackedServices>\"/>\n            <L7p:Replace booleanValue=\"true\"/>\n            <L7p:Replacement stringValue=\"&lt;PolicyBackedServices source=&quot;${source}&quot;>\"/>\n            <L7p:Target target=\"OTHER\"/>\n        </L7p:Regex>\n        <L7p:AuditDetailAssertion>\n            <L7p:AssertionComment assertionComment=\"included\">\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// FINE\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:AssertionComment>\n            <L7p:Detail stringValue=\"==> Leaving Utility Fragment: ${policy.name}\"/>\n            <L7p:Level stringValue=\"FINE\"/>\n        </L7p:AuditDetailAssertion>\n    </wsp:All>\n</wsp:Policy>\n"
        }
      ]
    },
    {
      "guid": "1f2ab8ee-cf83-49df-b17e-5f78c6a2cf2d",
      "name": "Utility: List Private Keys",
      "policyType": "FRAGMENT",
      "checksum": "62409c65b72382169a5f93fabc09172cabc5753c",
      "folderPath": "/Gateway Management Utilities/fragments",
      "soap": false,
      "policy": {
        "xml": "<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<wsp:Policy xmlns:L7p=\"http://www.layer7tech.com/ws/policy\" xmlns:wsp=\"http://schemas.xmlsoap.org/ws/2002/12/policy\">\n    <wsp:All wsp:Usage=\"Required\">\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Policy fragment for &quot;Utility: List Private Keys&quot; encapsulated assertion\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Call Restman and generate a sorted list of private keys\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** - Assumes an admin role user has been authenticated\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** - Caches results for ${cacheAge} seconds (default=300). To refresh the cache set ${refresh}=true when calling\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** - Returns a text/xml message variable in ${privateKeys.sorted}\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Inputs:\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - refresh (string)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - cacheAge (string)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Outputs:\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - privateKeys.sorted (message)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - error.msg (string)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** v1.0.0 - Jay MacDonald - 20201107 - Initial Version\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n        </L7p:CommentAssertion>\n        <L7p:AuditDetailAssertion>\n            <L7p:AssertionComment assertionComment=\"included\">\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// FINE\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:AssertionComment>\n            <L7p:Detail stringValue=\"==> Entering Utility Fragment: ${policy.name} (refresh=${refresh})\"/>\n            <L7p:Level stringValue=\"FINE\"/>\n        </L7p:AuditDetailAssertion>\n        <wsp:All wsp:Usage=\"Required\">\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** ${privateKeys.sorted} has the following schema:\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** \"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** &lt;PrivateKeys source=&quot;system|cache&quot;>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   &lt;PrivateKey id=&quot;string&quot;>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**     &lt;Alias>string&lt;/Alias>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**     &lt;KeyStore>string&lt;/KeyStore>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**     &lt;Certificates>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**       &lt;Certificate>string&lt;/Certificate>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**           ...\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**     &lt;/Certificates>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   &lt;/PrivateKey>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   ...\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** &lt;/PrivateKeys>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** \"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** Where:\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   Alias = the alias of the private key\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   Keystore = the keystore ID that holds the private key\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   Certificates = all certificates in chain mapped to private key\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n            </L7p:CommentAssertion>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Description of ${privateKeys.sorted}\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:All>\n        <wsp:OneOrMore wsp:Usage=\"Required\">\n            <L7p:ComparisonAssertion>\n                <L7p:AssertionComment assertionComment=\"included\">\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// true or false\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:AssertionComment>\n                <L7p:CaseSensitive booleanValue=\"false\"/>\n                <L7p:Expression1 stringValue=\"${cacheAge}\"/>\n                <L7p:Operator operatorNull=\"null\"/>\n                <L7p:Predicates predicates=\"included\">\n                    <L7p:item dataType=\"included\">\n                        <L7p:Type variableDataType=\"int\"/>\n                    </L7p:item>\n                    <L7p:item binary=\"included\">\n                        <L7p:CaseSensitive booleanValue=\"false\"/>\n                        <L7p:Operator operator=\"GT\"/>\n                        <L7p:RightValue stringValue=\"0\"/>\n                    </L7p:item>\n                </L7p:Predicates>\n            </L7p:ComparisonAssertion>\n            <L7p:SetVariable>\n                <L7p:Base64Expression stringValue=\"MzAw\"/>\n                <L7p:DataType variableDataType=\"int\"/>\n                <L7p:VariableToSet stringValue=\"cacheAge\"/>\n            </L7p:SetVariable>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Ensure ${cacheAge} is set, default=300\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:OneOrMore>\n        <wsp:OneOrMore wsp:Usage=\"Required\">\n            <L7p:ComparisonAssertion>\n                <L7p:AssertionComment assertionComment=\"included\">\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// true or false\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:AssertionComment>\n                <L7p:CaseSensitive booleanValue=\"false\"/>\n                <L7p:Expression1 stringValue=\"${refresh}\"/>\n                <L7p:Operator operatorNull=\"null\"/>\n                <L7p:Predicates predicates=\"included\">\n                    <L7p:item dataType=\"included\">\n                        <L7p:Type variableDataType=\"string\"/>\n                    </L7p:item>\n                    <L7p:item regex=\"included\">\n                        <L7p:Pattern stringValue=\"^(true|false)$\"/>\n                    </L7p:item>\n                </L7p:Predicates>\n            </L7p:ComparisonAssertion>\n            <L7p:SetVariable>\n                <L7p:Base64Expression stringValue=\"ZmFsc2U=\"/>\n                <L7p:VariableToSet stringValue=\"refresh\"/>\n            </L7p:SetVariable>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Ensure ${refresh} is set, default=false\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:OneOrMore>\n        <L7p:SetVariable>\n            <L7p:Base64Expression stringValue=\"cHJpdmF0ZUtleXMuc29ydGVk\"/>\n            <L7p:VariableToSet stringValue=\"cacheKey\"/>\n        </L7p:SetVariable>\n        <wsp:OneOrMore wsp:Usage=\"Required\">\n            <wsp:All wsp:Usage=\"Required\">\n                <L7p:ComparisonAssertion>\n                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                    <L7p:Expression1 stringValue=\"${refresh}\"/>\n                    <L7p:Operator operatorNull=\"null\"/>\n                    <L7p:Predicates predicates=\"included\">\n                        <L7p:item dataType=\"included\">\n                            <L7p:Type variableDataType=\"string\"/>\n                        </L7p:item>\n                        <L7p:item binary=\"included\">\n                            <L7p:Negated booleanValue=\"true\"/>\n                            <L7p:RightValue stringValue=\"true\"/>\n                        </L7p:item>\n                    </L7p:Predicates>\n                </L7p:ComparisonAssertion>\n                <L7p:CacheLookup>\n                    <L7p:CacheEntryKey stringValue=\"${cacheKey}\"/>\n                    <L7p:CacheId stringValue=\"privateKeyList\"/>\n                    <L7p:ContentTypeOverride stringValue=\"\"/>\n                    <L7p:MaxEntryAgeSeconds stringValue=\"${cacheAge}\"/>\n                    <L7p:OtherTargetMessageVariable stringValue=\"privateKeys.sorted\"/>\n                    <L7p:Target target=\"OTHER\"/>\n                </L7p:CacheLookup>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"Y2FjaGU=\"/>\n                    <L7p:VariableToSet stringValue=\"source\"/>\n                </L7p:SetVariable>\n                <L7p:AuditDetailAssertion>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// FINE\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Detail stringValue=\"==> Found privateKeys.sorted in the cache\"/>\n                    <L7p:Level stringValue=\"FINE\"/>\n                </L7p:AuditDetailAssertion>\n                <L7p:assertionComment>\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// Look in cache unless asked to refresh cache\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:assertionComment>\n            </wsp:All>\n            <wsp:All wsp:Usage=\"Required\">\n                <L7p:Encapsulated>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// GET privateKeys\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:EncapsulatedAssertionConfigGuid stringValue=\"c8a5a0d5-1ae2-4144-b538-5c311efc1560\"/>\n                    <L7p:EncapsulatedAssertionConfigName stringValue=\"Utility: Call Restman\"/>\n                    <L7p:Parameters mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"element\"/>\n                            <L7p:value stringValue=\"PrivateKey\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"message\"/>\n                            <L7p:value stringValue=\"\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"method\"/>\n                            <L7p:value stringValue=\"Get\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"resource\"/>\n                            <L7p:value stringValue=\"privateKeys\"/>\n                        </L7p:entry>\n                    </L7p:Parameters>\n                </L7p:Encapsulated>\n                <wsp:OneOrMore wsp:Usage=\"Required\">\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:VariablePrefix stringValue=\"privateKeys\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/l7:List/l7:Item/l7:Resource/l7:PrivateKey\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <L7p:TrueAssertion/>\n                    <L7p:assertionComment>\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// Extract the list of private keys, never fail\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:assertionComment>\n                </wsp:OneOrMore>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz48UHJpdmF0ZUtleXM+\"/>\n                    <L7p:VariableToSet stringValue=\"privateKeys.sorted\"/>\n                </L7p:SetVariable>\n                <L7p:ForEachLoop L7p:Usage=\"Required\"\n                    loopVariable=\"privateKeys.elements\" variablePrefix=\"privateKey\">\n                    <L7p:SetVariable>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Cast to message type for parsing\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:Base64Expression stringValue=\"JHtwcml2YXRlS2V5LmN1cnJlbnR9\"/>\n                        <L7p:ContentType stringValue=\"text/xml; charset=utf-8\"/>\n                        <L7p:DataType variableDataType=\"message\"/>\n                        <L7p:VariableToSet stringValue=\"privateKey.xml\"/>\n                    </L7p:SetVariable>\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Retrieve the private key ID\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:VariablePrefix stringValue=\"id\"/>\n                        <L7p:XmlMsgSrc stringValue=\"privateKey.xml\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/l7:PrivateKey/@id\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// retrieve the private key alias\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:VariablePrefix stringValue=\"alias\"/>\n                        <L7p:XmlMsgSrc stringValue=\"privateKey.xml\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/l7:PrivateKey/@alias\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// retrieve the private key name\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:VariablePrefix stringValue=\"keystoreId\"/>\n                        <L7p:XmlMsgSrc stringValue=\"privateKey.xml\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/l7:PrivateKey/@keystoreId\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// retrieve the certtificates\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:VariablePrefix stringValue=\"certificates\"/>\n                        <L7p:XmlMsgSrc stringValue=\"privateKey.xml\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/l7:PrivateKey/l7:CertificateChain/l7:CertificateData/l7:Encoded\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <L7p:SetVariable>\n                        <L7p:Base64Expression stringValue=\"JHtwcml2YXRlS2V5cy5zb3J0ZWR9PFByaXZhdGVLZXkgaWQ9IiR7aWQucmVzdWx0fSI+PEFsaWFzPjwhW0NEQVRBWyR7YWxpYXMucmVzdWx0fV1dPjwvQWxpYXM+PEtleXN0b3JlPiR7a2V5c3RvcmVJZC5yZXN1bHR9PC9LZXlzdG9yZT48Q2VydGlmaWNhdGVzPg==\"/>\n                        <L7p:VariableToSet stringValue=\"privateKeys.sorted\"/>\n                    </L7p:SetVariable>\n                    <L7p:ForEachLoop L7p:Usage=\"Required\"\n                        loopVariable=\"certificates.results\" variablePrefix=\"certificate\">\n                        <L7p:SetVariable>\n                            <L7p:Base64Expression stringValue=\"JHtwcml2YXRlS2V5cy5zb3J0ZWR9PENlcnRpZmljYXRlPiR7Y2VydGlmaWNhdGUuY3VycmVudH08L0NlcnRpZmljYXRlPg==\"/>\n                            <L7p:VariableToSet stringValue=\"privateKeys.sorted\"/>\n                        </L7p:SetVariable>\n                    </L7p:ForEachLoop>\n                    <L7p:SetVariable>\n                        <L7p:Base64Expression stringValue=\"JHtwcml2YXRlS2V5cy5zb3J0ZWR9PC9DZXJ0aWZpY2F0ZXM+PC9Qcml2YXRlS2V5Pg==\"/>\n                        <L7p:VariableToSet stringValue=\"privateKeys.sorted\"/>\n                    </L7p:SetVariable>\n                    <L7p:assertionComment>\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// Build the list of private keys\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:assertionComment>\n                </L7p:ForEachLoop>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"JHtwcml2YXRlS2V5cy5zb3J0ZWR9PC9Qcml2YXRlS2V5cz4=\"/>\n                    <L7p:ContentType stringValue=\"text/xml; charset=utf-8\"/>\n                    <L7p:DataType variableDataType=\"message\"/>\n                    <L7p:VariableToSet stringValue=\"privateKeys.sorted\"/>\n                </L7p:SetVariable>\n                <L7p:XslTransformation>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// Sort the private keys by alias\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Direction intValue=\"-1\"/>\n                    <L7p:OtherTargetMessageVariable stringValue=\"privateKeys.sorted\"/>\n                    <L7p:ResourceInfo staticResourceInfo=\"included\">\n                        <L7p:Document stringValue=\"&lt;xsl:stylesheet version=&quot;1.0&quot; xmlns:l7=&quot;http://ns.l7tech.com/2010/04/gateway-management&quot; xmlns:xsl=&quot;http://www.w3.org/1999/XSL/Transform&quot;>&lt;xsl:template match=&quot;/PrivateKeys&quot;>    &lt;xsl:copy>        &lt;xsl:for-each select=&quot;PrivateKey&quot;>            &lt;xsl:sort select=&quot;./Alias&quot;/>            &lt;xsl:copy-of select=&quot;.&quot;/>        &lt;/xsl:for-each>    &lt;/xsl:copy>&lt;/xsl:template>&lt;/xsl:stylesheet>\"/>\n                    </L7p:ResourceInfo>\n                    <L7p:Target target=\"OTHER\"/>\n                    <L7p:TransformName stringValue=\"\"/>\n                    <L7p:XsltVersion stringValue=\"1.0\"/>\n                </L7p:XslTransformation>\n                <L7p:CacheStorage>\n                    <L7p:CacheEntryKey stringValue=\"${cacheKey}\"/>\n                    <L7p:CacheId stringValue=\"privateKeyList\"/>\n                    <L7p:MaxEntries stringValue=\"1\"/>\n                    <L7p:MaxEntryAgeSeconds stringValue=\"${cacheAge}\"/>\n                    <L7p:MaxEntrySizeBytes stringValue=\"200000\"/>\n                    <L7p:OtherTargetMessageVariable stringValue=\"privateKeys.sorted\"/>\n                    <L7p:StoreSoapFaults booleanValue=\"true\"/>\n                    <L7p:Target target=\"OTHER\"/>\n                </L7p:CacheStorage>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"c3lzdGVt\"/>\n                    <L7p:VariableToSet stringValue=\"source\"/>\n                </L7p:SetVariable>\n                <L7p:AuditDetailAssertion>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// FINE\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Detail stringValue=\"==> Loaded privateKeys.sorted from system and stored to cache\"/>\n                    <L7p:Level stringValue=\"FINE\"/>\n                </L7p:AuditDetailAssertion>\n                <L7p:assertionComment>\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// Retrieve new list and cache\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:assertionComment>\n            </wsp:All>\n            <wsp:All wsp:Usage=\"Required\">\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"RXJyb3Igd2hlbiBsaXN0aW5nIHByaXZhdGUga2V5cw==\"/>\n                    <L7p:VariableToSet stringValue=\"error.msg\"/>\n                </L7p:SetVariable>\n                <L7p:AuditDetailAssertion>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// WARNING\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Detail stringValue=\"==> Error listing private keys in ${policy.name}\"/>\n                    <L7p:Level stringValue=\"WARNING\"/>\n                </L7p:AuditDetailAssertion>\n                <L7p:FalseAssertion/>\n                <L7p:assertionComment>\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// Failure - set ${error.msg}\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:assertionComment>\n            </wsp:All>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Caching logic\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:OneOrMore>\n        <L7p:Regex>\n            <L7p:AssertionComment assertionComment=\"included\">\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Add source attribute to /PrivateKeys element\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:AssertionComment>\n            <L7p:AutoTarget booleanValue=\"false\"/>\n            <L7p:OtherTargetMessageVariable stringValue=\"privateKeys.sorted\"/>\n            <L7p:Regex stringValue=\"&lt;PrivateKeys>\"/>\n            <L7p:Replace booleanValue=\"true\"/>\n            <L7p:Replacement stringValue=\"&lt;PrivateKeys source=&quot;${source}&quot;>\"/>\n            <L7p:Target target=\"OTHER\"/>\n        </L7p:Regex>\n        <L7p:AuditDetailAssertion>\n            <L7p:AssertionComment assertionComment=\"included\">\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// FINE\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:AssertionComment>\n            <L7p:Detail stringValue=\"==> Leaving Utility Fragment: ${policy.name}\"/>\n            <L7p:Level stringValue=\"FINE\"/>\n        </L7p:AuditDetailAssertion>\n    </wsp:All>\n</wsp:Policy>\n"
      },
      "policyRevisions": [
        {
          "goid": "bed4baf4ff33b7e528854c3965d9bb58",
          "ordinal": 1,
          "active": true,
          "author": "admin",
          "time": "2025-02-05T14:20:38.562Z",
          "xml": "<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<wsp:Policy xmlns:L7p=\"http://www.layer7tech.com/ws/policy\" xmlns:wsp=\"http://schemas.xmlsoap.org/ws/2002/12/policy\">\n    <wsp:All wsp:Usage=\"Required\">\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Policy fragment for &quot;Utility: List Private Keys&quot; encapsulated assertion\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Call Restman and generate a sorted list of private keys\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** - Assumes an admin role user has been authenticated\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** - Caches results for ${cacheAge} seconds (default=300). To refresh the cache set ${refresh}=true when calling\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** - Returns a text/xml message variable in ${privateKeys.sorted}\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Inputs:\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - refresh (string)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - cacheAge (string)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Outputs:\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - privateKeys.sorted (message)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - error.msg (string)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** v1.0.0 - Jay MacDonald - 20201107 - Initial Version\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n        </L7p:CommentAssertion>\n        <L7p:AuditDetailAssertion>\n            <L7p:AssertionComment assertionComment=\"included\">\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// FINE\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:AssertionComment>\n            <L7p:Detail stringValue=\"==> Entering Utility Fragment: ${policy.name} (refresh=${refresh})\"/>\n            <L7p:Level stringValue=\"FINE\"/>\n        </L7p:AuditDetailAssertion>\n        <wsp:All wsp:Usage=\"Required\">\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** ${privateKeys.sorted} has the following schema:\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** \"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** &lt;PrivateKeys source=&quot;system|cache&quot;>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   &lt;PrivateKey id=&quot;string&quot;>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**     &lt;Alias>string&lt;/Alias>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**     &lt;KeyStore>string&lt;/KeyStore>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**     &lt;Certificates>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**       &lt;Certificate>string&lt;/Certificate>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**           ...\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**     &lt;/Certificates>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   &lt;/PrivateKey>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   ...\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** &lt;/PrivateKeys>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** \"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** Where:\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   Alias = the alias of the private key\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   Keystore = the keystore ID that holds the private key\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   Certificates = all certificates in chain mapped to private key\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n            </L7p:CommentAssertion>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Description of ${privateKeys.sorted}\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:All>\n        <wsp:OneOrMore wsp:Usage=\"Required\">\n            <L7p:ComparisonAssertion>\n                <L7p:AssertionComment assertionComment=\"included\">\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// true or false\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:AssertionComment>\n                <L7p:CaseSensitive booleanValue=\"false\"/>\n                <L7p:Expression1 stringValue=\"${cacheAge}\"/>\n                <L7p:Operator operatorNull=\"null\"/>\n                <L7p:Predicates predicates=\"included\">\n                    <L7p:item dataType=\"included\">\n                        <L7p:Type variableDataType=\"int\"/>\n                    </L7p:item>\n                    <L7p:item binary=\"included\">\n                        <L7p:CaseSensitive booleanValue=\"false\"/>\n                        <L7p:Operator operator=\"GT\"/>\n                        <L7p:RightValue stringValue=\"0\"/>\n                    </L7p:item>\n                </L7p:Predicates>\n            </L7p:ComparisonAssertion>\n            <L7p:SetVariable>\n                <L7p:Base64Expression stringValue=\"MzAw\"/>\n                <L7p:DataType variableDataType=\"int\"/>\n                <L7p:VariableToSet stringValue=\"cacheAge\"/>\n            </L7p:SetVariable>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Ensure ${cacheAge} is set, default=300\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:OneOrMore>\n        <wsp:OneOrMore wsp:Usage=\"Required\">\n            <L7p:ComparisonAssertion>\n                <L7p:AssertionComment assertionComment=\"included\">\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// true or false\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:AssertionComment>\n                <L7p:CaseSensitive booleanValue=\"false\"/>\n                <L7p:Expression1 stringValue=\"${refresh}\"/>\n                <L7p:Operator operatorNull=\"null\"/>\n                <L7p:Predicates predicates=\"included\">\n                    <L7p:item dataType=\"included\">\n                        <L7p:Type variableDataType=\"string\"/>\n                    </L7p:item>\n                    <L7p:item regex=\"included\">\n                        <L7p:Pattern stringValue=\"^(true|false)$\"/>\n                    </L7p:item>\n                </L7p:Predicates>\n            </L7p:ComparisonAssertion>\n            <L7p:SetVariable>\n                <L7p:Base64Expression stringValue=\"ZmFsc2U=\"/>\n                <L7p:VariableToSet stringValue=\"refresh\"/>\n            </L7p:SetVariable>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Ensure ${refresh} is set, default=false\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:OneOrMore>\n        <L7p:SetVariable>\n            <L7p:Base64Expression stringValue=\"cHJpdmF0ZUtleXMuc29ydGVk\"/>\n            <L7p:VariableToSet stringValue=\"cacheKey\"/>\n        </L7p:SetVariable>\n        <wsp:OneOrMore wsp:Usage=\"Required\">\n            <wsp:All wsp:Usage=\"Required\">\n                <L7p:ComparisonAssertion>\n                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                    <L7p:Expression1 stringValue=\"${refresh}\"/>\n                    <L7p:Operator operatorNull=\"null\"/>\n                    <L7p:Predicates predicates=\"included\">\n                        <L7p:item dataType=\"included\">\n                            <L7p:Type variableDataType=\"string\"/>\n                        </L7p:item>\n                        <L7p:item binary=\"included\">\n                            <L7p:Negated booleanValue=\"true\"/>\n                            <L7p:RightValue stringValue=\"true\"/>\n                        </L7p:item>\n                    </L7p:Predicates>\n                </L7p:ComparisonAssertion>\n                <L7p:CacheLookup>\n                    <L7p:CacheEntryKey stringValue=\"${cacheKey}\"/>\n                    <L7p:CacheId stringValue=\"privateKeyList\"/>\n                    <L7p:ContentTypeOverride stringValue=\"\"/>\n                    <L7p:MaxEntryAgeSeconds stringValue=\"${cacheAge}\"/>\n                    <L7p:OtherTargetMessageVariable stringValue=\"privateKeys.sorted\"/>\n                    <L7p:Target target=\"OTHER\"/>\n                </L7p:CacheLookup>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"Y2FjaGU=\"/>\n                    <L7p:VariableToSet stringValue=\"source\"/>\n                </L7p:SetVariable>\n                <L7p:AuditDetailAssertion>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// FINE\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Detail stringValue=\"==> Found privateKeys.sorted in the cache\"/>\n                    <L7p:Level stringValue=\"FINE\"/>\n                </L7p:AuditDetailAssertion>\n                <L7p:assertionComment>\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// Look in cache unless asked to refresh cache\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:assertionComment>\n            </wsp:All>\n            <wsp:All wsp:Usage=\"Required\">\n                <L7p:Encapsulated>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// GET privateKeys\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:EncapsulatedAssertionConfigGuid stringValue=\"c8a5a0d5-1ae2-4144-b538-5c311efc1560\"/>\n                    <L7p:EncapsulatedAssertionConfigName stringValue=\"Utility: Call Restman\"/>\n                    <L7p:Parameters mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"element\"/>\n                            <L7p:value stringValue=\"PrivateKey\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"message\"/>\n                            <L7p:value stringValue=\"\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"method\"/>\n                            <L7p:value stringValue=\"Get\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"resource\"/>\n                            <L7p:value stringValue=\"privateKeys\"/>\n                        </L7p:entry>\n                    </L7p:Parameters>\n                </L7p:Encapsulated>\n                <wsp:OneOrMore wsp:Usage=\"Required\">\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:VariablePrefix stringValue=\"privateKeys\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/l7:List/l7:Item/l7:Resource/l7:PrivateKey\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <L7p:TrueAssertion/>\n                    <L7p:assertionComment>\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// Extract the list of private keys, never fail\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:assertionComment>\n                </wsp:OneOrMore>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz48UHJpdmF0ZUtleXM+\"/>\n                    <L7p:VariableToSet stringValue=\"privateKeys.sorted\"/>\n                </L7p:SetVariable>\n                <L7p:ForEachLoop L7p:Usage=\"Required\"\n                    loopVariable=\"privateKeys.elements\" variablePrefix=\"privateKey\">\n                    <L7p:SetVariable>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Cast to message type for parsing\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:Base64Expression stringValue=\"JHtwcml2YXRlS2V5LmN1cnJlbnR9\"/>\n                        <L7p:ContentType stringValue=\"text/xml; charset=utf-8\"/>\n                        <L7p:DataType variableDataType=\"message\"/>\n                        <L7p:VariableToSet stringValue=\"privateKey.xml\"/>\n                    </L7p:SetVariable>\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Retrieve the private key ID\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:VariablePrefix stringValue=\"id\"/>\n                        <L7p:XmlMsgSrc stringValue=\"privateKey.xml\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/l7:PrivateKey/@id\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// retrieve the private key alias\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:VariablePrefix stringValue=\"alias\"/>\n                        <L7p:XmlMsgSrc stringValue=\"privateKey.xml\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/l7:PrivateKey/@alias\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// retrieve the private key name\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:VariablePrefix stringValue=\"keystoreId\"/>\n                        <L7p:XmlMsgSrc stringValue=\"privateKey.xml\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/l7:PrivateKey/@keystoreId\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// retrieve the certtificates\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:VariablePrefix stringValue=\"certificates\"/>\n                        <L7p:XmlMsgSrc stringValue=\"privateKey.xml\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/l7:PrivateKey/l7:CertificateChain/l7:CertificateData/l7:Encoded\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <L7p:SetVariable>\n                        <L7p:Base64Expression stringValue=\"JHtwcml2YXRlS2V5cy5zb3J0ZWR9PFByaXZhdGVLZXkgaWQ9IiR7aWQucmVzdWx0fSI+PEFsaWFzPjwhW0NEQVRBWyR7YWxpYXMucmVzdWx0fV1dPjwvQWxpYXM+PEtleXN0b3JlPiR7a2V5c3RvcmVJZC5yZXN1bHR9PC9LZXlzdG9yZT48Q2VydGlmaWNhdGVzPg==\"/>\n                        <L7p:VariableToSet stringValue=\"privateKeys.sorted\"/>\n                    </L7p:SetVariable>\n                    <L7p:ForEachLoop L7p:Usage=\"Required\"\n                        loopVariable=\"certificates.results\" variablePrefix=\"certificate\">\n                        <L7p:SetVariable>\n                            <L7p:Base64Expression stringValue=\"JHtwcml2YXRlS2V5cy5zb3J0ZWR9PENlcnRpZmljYXRlPiR7Y2VydGlmaWNhdGUuY3VycmVudH08L0NlcnRpZmljYXRlPg==\"/>\n                            <L7p:VariableToSet stringValue=\"privateKeys.sorted\"/>\n                        </L7p:SetVariable>\n                    </L7p:ForEachLoop>\n                    <L7p:SetVariable>\n                        <L7p:Base64Expression stringValue=\"JHtwcml2YXRlS2V5cy5zb3J0ZWR9PC9DZXJ0aWZpY2F0ZXM+PC9Qcml2YXRlS2V5Pg==\"/>\n                        <L7p:VariableToSet stringValue=\"privateKeys.sorted\"/>\n                    </L7p:SetVariable>\n                    <L7p:assertionComment>\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// Build the list of private keys\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:assertionComment>\n                </L7p:ForEachLoop>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"JHtwcml2YXRlS2V5cy5zb3J0ZWR9PC9Qcml2YXRlS2V5cz4=\"/>\n                    <L7p:ContentType stringValue=\"text/xml; charset=utf-8\"/>\n                    <L7p:DataType variableDataType=\"message\"/>\n                    <L7p:VariableToSet stringValue=\"privateKeys.sorted\"/>\n                </L7p:SetVariable>\n                <L7p:XslTransformation>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// Sort the private keys by alias\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Direction intValue=\"-1\"/>\n                    <L7p:OtherTargetMessageVariable stringValue=\"privateKeys.sorted\"/>\n                    <L7p:ResourceInfo staticResourceInfo=\"included\">\n                        <L7p:Document stringValue=\"&lt;xsl:stylesheet version=&quot;1.0&quot; xmlns:l7=&quot;http://ns.l7tech.com/2010/04/gateway-management&quot; xmlns:xsl=&quot;http://www.w3.org/1999/XSL/Transform&quot;>&lt;xsl:template match=&quot;/PrivateKeys&quot;>    &lt;xsl:copy>        &lt;xsl:for-each select=&quot;PrivateKey&quot;>            &lt;xsl:sort select=&quot;./Alias&quot;/>            &lt;xsl:copy-of select=&quot;.&quot;/>        &lt;/xsl:for-each>    &lt;/xsl:copy>&lt;/xsl:template>&lt;/xsl:stylesheet>\"/>\n                    </L7p:ResourceInfo>\n                    <L7p:Target target=\"OTHER\"/>\n                    <L7p:TransformName stringValue=\"\"/>\n                    <L7p:XsltVersion stringValue=\"1.0\"/>\n                </L7p:XslTransformation>\n                <L7p:CacheStorage>\n                    <L7p:CacheEntryKey stringValue=\"${cacheKey}\"/>\n                    <L7p:CacheId stringValue=\"privateKeyList\"/>\n                    <L7p:MaxEntries stringValue=\"1\"/>\n                    <L7p:MaxEntryAgeSeconds stringValue=\"${cacheAge}\"/>\n                    <L7p:MaxEntrySizeBytes stringValue=\"200000\"/>\n                    <L7p:OtherTargetMessageVariable stringValue=\"privateKeys.sorted\"/>\n                    <L7p:StoreSoapFaults booleanValue=\"true\"/>\n                    <L7p:Target target=\"OTHER\"/>\n                </L7p:CacheStorage>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"c3lzdGVt\"/>\n                    <L7p:VariableToSet stringValue=\"source\"/>\n                </L7p:SetVariable>\n                <L7p:AuditDetailAssertion>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// FINE\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Detail stringValue=\"==> Loaded privateKeys.sorted from system and stored to cache\"/>\n                    <L7p:Level stringValue=\"FINE\"/>\n                </L7p:AuditDetailAssertion>\n                <L7p:assertionComment>\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// Retrieve new list and cache\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:assertionComment>\n            </wsp:All>\n            <wsp:All wsp:Usage=\"Required\">\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"RXJyb3Igd2hlbiBsaXN0aW5nIHByaXZhdGUga2V5cw==\"/>\n                    <L7p:VariableToSet stringValue=\"error.msg\"/>\n                </L7p:SetVariable>\n                <L7p:AuditDetailAssertion>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// WARNING\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Detail stringValue=\"==> Error listing private keys in ${policy.name}\"/>\n                    <L7p:Level stringValue=\"WARNING\"/>\n                </L7p:AuditDetailAssertion>\n                <L7p:FalseAssertion/>\n                <L7p:assertionComment>\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// Failure - set ${error.msg}\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:assertionComment>\n            </wsp:All>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Caching logic\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:OneOrMore>\n        <L7p:Regex>\n            <L7p:AssertionComment assertionComment=\"included\">\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Add source attribute to /PrivateKeys element\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:AssertionComment>\n            <L7p:AutoTarget booleanValue=\"false\"/>\n            <L7p:OtherTargetMessageVariable stringValue=\"privateKeys.sorted\"/>\n            <L7p:Regex stringValue=\"&lt;PrivateKeys>\"/>\n            <L7p:Replace booleanValue=\"true\"/>\n            <L7p:Replacement stringValue=\"&lt;PrivateKeys source=&quot;${source}&quot;>\"/>\n            <L7p:Target target=\"OTHER\"/>\n        </L7p:Regex>\n        <L7p:AuditDetailAssertion>\n            <L7p:AssertionComment assertionComment=\"included\">\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// FINE\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:AssertionComment>\n            <L7p:Detail stringValue=\"==> Leaving Utility Fragment: ${policy.name}\"/>\n            <L7p:Level stringValue=\"FINE\"/>\n        </L7p:AuditDetailAssertion>\n    </wsp:All>\n</wsp:Policy>\n"
        }
      ]
    },
    {
      "guid": "3b9346d2-cc38-41ef-aac3-965942d95749",
      "name": "Utility: List Scheduled Tasks",
      "policyType": "FRAGMENT",
      "checksum": "858dfcf7a2f92d1638ce6b086f2f55d96b3ac45e",
      "folderPath": "/Gateway Management Utilities/fragments",
      "soap": false,
      "policy": {
        "xml": "<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<wsp:Policy xmlns:L7p=\"http://www.layer7tech.com/ws/policy\" xmlns:wsp=\"http://schemas.xmlsoap.org/ws/2002/12/policy\">\n    <wsp:All wsp:Usage=\"Required\">\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Policy fragment for &quot;Utility: List Scheduled Taskss&quot; encapsulated assertion\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Call Restman and generate a sorted list of scheduled tasks\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** - Assumes an admin role user has been authenticated\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** - Caches results for ${cacheAge} seconds (default=300). To refresh the cache set ${refresh}=true when calling\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** - Returns a text/xml message variable in ${scheduledTasks.sorted}\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Inputs:\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - refresh (string)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - cacheAge (string)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Outputs:\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - scheduledTasks.sorted (message)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - error.msg (string)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** v1.0.0 - Jay MacDonald - 20201107 - Initial Version\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n        </L7p:CommentAssertion>\n        <L7p:AuditDetailAssertion>\n            <L7p:AssertionComment assertionComment=\"included\">\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// FINE\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:AssertionComment>\n            <L7p:Detail stringValue=\"==> Entering Utility Fragment: ${policy.name} (refresh=${refresh})\"/>\n            <L7p:Level stringValue=\"FINE\"/>\n        </L7p:AuditDetailAssertion>\n        <wsp:All wsp:Usage=\"Required\">\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** ${scheduledTasks.sorted} has the following schema:\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** \"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** &lt;ScheduledTasks source=&quot;system|cache&quot;>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   &lt;ScheduledTask id=&quot;string&quot;>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**     &lt;Name>string&lt;/Name>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**     &lt;PolicyID>string&lt;/PolicyId>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   &lt;/ScheduledTask>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   ...\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** &lt;/ScheduledTasks>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n            </L7p:CommentAssertion>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Description of ${scheduledTasks.sorted}\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:All>\n        <wsp:OneOrMore wsp:Usage=\"Required\">\n            <L7p:ComparisonAssertion>\n                <L7p:AssertionComment assertionComment=\"included\">\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// true or false\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:AssertionComment>\n                <L7p:CaseSensitive booleanValue=\"false\"/>\n                <L7p:Expression1 stringValue=\"${cacheAge}\"/>\n                <L7p:Operator operatorNull=\"null\"/>\n                <L7p:Predicates predicates=\"included\">\n                    <L7p:item dataType=\"included\">\n                        <L7p:Type variableDataType=\"int\"/>\n                    </L7p:item>\n                    <L7p:item binary=\"included\">\n                        <L7p:CaseSensitive booleanValue=\"false\"/>\n                        <L7p:Operator operator=\"GT\"/>\n                        <L7p:RightValue stringValue=\"0\"/>\n                    </L7p:item>\n                </L7p:Predicates>\n            </L7p:ComparisonAssertion>\n            <L7p:SetVariable>\n                <L7p:Base64Expression stringValue=\"MzAw\"/>\n                <L7p:DataType variableDataType=\"int\"/>\n                <L7p:VariableToSet stringValue=\"cacheAge\"/>\n            </L7p:SetVariable>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Ensure ${cacheAge} is set, default=300\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:OneOrMore>\n        <wsp:OneOrMore wsp:Usage=\"Required\">\n            <L7p:ComparisonAssertion>\n                <L7p:AssertionComment assertionComment=\"included\">\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// true or false\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:AssertionComment>\n                <L7p:CaseSensitive booleanValue=\"false\"/>\n                <L7p:Expression1 stringValue=\"${refresh}\"/>\n                <L7p:Operator operatorNull=\"null\"/>\n                <L7p:Predicates predicates=\"included\">\n                    <L7p:item dataType=\"included\">\n                        <L7p:Type variableDataType=\"string\"/>\n                    </L7p:item>\n                    <L7p:item regex=\"included\">\n                        <L7p:Pattern stringValue=\"^(true|false)$\"/>\n                    </L7p:item>\n                </L7p:Predicates>\n            </L7p:ComparisonAssertion>\n            <L7p:SetVariable>\n                <L7p:Base64Expression stringValue=\"ZmFsc2U=\"/>\n                <L7p:VariableToSet stringValue=\"refresh\"/>\n            </L7p:SetVariable>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Ensure ${refresh} is set, default=false\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:OneOrMore>\n        <L7p:SetVariable>\n            <L7p:Base64Expression stringValue=\"c2NoZWR1bGVkVGFza3Muc29ydGVk\"/>\n            <L7p:VariableToSet stringValue=\"cacheKey\"/>\n        </L7p:SetVariable>\n        <wsp:OneOrMore wsp:Usage=\"Required\">\n            <wsp:All wsp:Usage=\"Required\">\n                <L7p:ComparisonAssertion>\n                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                    <L7p:Expression1 stringValue=\"${refresh}\"/>\n                    <L7p:Operator operatorNull=\"null\"/>\n                    <L7p:Predicates predicates=\"included\">\n                        <L7p:item dataType=\"included\">\n                            <L7p:Type variableDataType=\"string\"/>\n                        </L7p:item>\n                        <L7p:item binary=\"included\">\n                            <L7p:Negated booleanValue=\"true\"/>\n                            <L7p:RightValue stringValue=\"true\"/>\n                        </L7p:item>\n                    </L7p:Predicates>\n                </L7p:ComparisonAssertion>\n                <L7p:CacheLookup>\n                    <L7p:CacheEntryKey stringValue=\"${cacheKey}\"/>\n                    <L7p:CacheId stringValue=\"scheduledTaskList\"/>\n                    <L7p:ContentTypeOverride stringValue=\"\"/>\n                    <L7p:MaxEntryAgeSeconds stringValue=\"${cacheAge}\"/>\n                    <L7p:OtherTargetMessageVariable stringValue=\"scheduledTasks.sorted\"/>\n                    <L7p:Target target=\"OTHER\"/>\n                </L7p:CacheLookup>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"Y2FjaGU=\"/>\n                    <L7p:VariableToSet stringValue=\"source\"/>\n                </L7p:SetVariable>\n                <L7p:AuditDetailAssertion>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// FINE\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Detail stringValue=\"==> Found scheduledTasks.sorted in the cache\"/>\n                    <L7p:Level stringValue=\"FINE\"/>\n                </L7p:AuditDetailAssertion>\n                <L7p:assertionComment>\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// Look in cache unless asked to refresh cache\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:assertionComment>\n            </wsp:All>\n            <wsp:All wsp:Usage=\"Required\">\n                <L7p:Encapsulated>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// GET scheduledTasks\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:EncapsulatedAssertionConfigGuid stringValue=\"c8a5a0d5-1ae2-4144-b538-5c311efc1560\"/>\n                    <L7p:EncapsulatedAssertionConfigName stringValue=\"Utility: Call Restman\"/>\n                    <L7p:Parameters mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"element\"/>\n                            <L7p:value stringValue=\"ScheduledTask\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"message\"/>\n                            <L7p:value stringValue=\"\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"method\"/>\n                            <L7p:value stringValue=\"GET\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"resource\"/>\n                            <L7p:value stringValue=\"scheduledTasks\"/>\n                        </L7p:entry>\n                    </L7p:Parameters>\n                </L7p:Encapsulated>\n                <wsp:OneOrMore wsp:Usage=\"Required\">\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:VariablePrefix stringValue=\"scheduledTasks\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/l7:List/l7:Item/l7:Resource/l7:ScheduledTask\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <L7p:TrueAssertion/>\n                    <L7p:assertionComment>\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// Extract the list of scheduled tasks, never fail\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:assertionComment>\n                </wsp:OneOrMore>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz48U2NoZWR1bGVkVGFza3M+\"/>\n                    <L7p:VariableToSet stringValue=\"scheduledTasks.sorted\"/>\n                </L7p:SetVariable>\n                <L7p:ForEachLoop L7p:Usage=\"Required\"\n                    loopVariable=\"scheduledTasks.elements\" variablePrefix=\"scheduledTask\">\n                    <L7p:SetVariable>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Cast to message type for parsing\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:Base64Expression stringValue=\"JHtzY2hlZHVsZWRUYXNrLmN1cnJlbnR9\"/>\n                        <L7p:ContentType stringValue=\"text/xml; charset=utf-8\"/>\n                        <L7p:DataType variableDataType=\"message\"/>\n                        <L7p:VariableToSet stringValue=\"scheduledTask.xml\"/>\n                    </L7p:SetVariable>\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Retrieve the scheduled task ID\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:VariablePrefix stringValue=\"id\"/>\n                        <L7p:XmlMsgSrc stringValue=\"scheduledTask.xml\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/l7:ScheduledTask/@id\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// retrieve the scheduled task name\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:VariablePrefix stringValue=\"name\"/>\n                        <L7p:XmlMsgSrc stringValue=\"scheduledTask.xml\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/l7:ScheduledTask/l7:Name\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// retrieve the scheduled task policy reference Id\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:VariablePrefix stringValue=\"policyId\"/>\n                        <L7p:XmlMsgSrc stringValue=\"scheduledTask.xml\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/l7:ScheduledTask/l7:PolicyReference/@id\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <L7p:SetVariable>\n                        <L7p:Base64Expression stringValue=\"JHtzY2hlZHVsZWRUYXNrcy5zb3J0ZWR9PFNjaGVkdWxlZFRhc2sgaWQ9IiR7aWQucmVzdWx0fSI+PE5hbWU+PCFbQ0RBVEFbJHtuYW1lLnJlc3VsdH1dXT48L05hbWU+PFBvbGljeUlkPiR7cG9saWN5SWQucmVzdWx0fTwvUG9saWN5SWQ+PC9TY2hlZHVsZWRUYXNrPg==\"/>\n                        <L7p:VariableToSet stringValue=\"scheduledTasks.sorted\"/>\n                    </L7p:SetVariable>\n                    <L7p:assertionComment>\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// Build the list of scheduled tasks\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:assertionComment>\n                </L7p:ForEachLoop>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"JHtzY2hlZHVsZWRUYXNrcy5zb3J0ZWR9PC9TY2hlZHVsZWRUYXNrcz4=\"/>\n                    <L7p:ContentType stringValue=\"text/xml; charset=utf-8\"/>\n                    <L7p:DataType variableDataType=\"message\"/>\n                    <L7p:VariableToSet stringValue=\"scheduledTasks.sorted\"/>\n                </L7p:SetVariable>\n                <L7p:XslTransformation>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// Sort the scheduled tasks by name\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Direction intValue=\"-1\"/>\n                    <L7p:OtherTargetMessageVariable stringValue=\"scheduledTasks.sorted\"/>\n                    <L7p:ResourceInfo staticResourceInfo=\"included\">\n                        <L7p:Document stringValue=\"&lt;xsl:stylesheet version=&quot;1.0&quot; xmlns:l7=&quot;http://ns.l7tech.com/2010/04/gateway-management&quot; xmlns:xsl=&quot;http://www.w3.org/1999/XSL/Transform&quot;>&lt;xsl:template match=&quot;/ScheduledTasks&quot;>    &lt;xsl:copy>        &lt;xsl:for-each select=&quot;ScheduledTask&quot;>            &lt;xsl:sort select=&quot;./Name&quot;/>            &lt;xsl:copy-of select=&quot;.&quot;/>        &lt;/xsl:for-each>    &lt;/xsl:copy>&lt;/xsl:template>&lt;/xsl:stylesheet>\"/>\n                    </L7p:ResourceInfo>\n                    <L7p:Target target=\"OTHER\"/>\n                    <L7p:TransformName stringValue=\"\"/>\n                    <L7p:XsltVersion stringValue=\"1.0\"/>\n                </L7p:XslTransformation>\n                <L7p:CacheStorage>\n                    <L7p:CacheEntryKey stringValue=\"${cacheKey}\"/>\n                    <L7p:CacheId stringValue=\"scheduledTaskList\"/>\n                    <L7p:MaxEntries stringValue=\"1\"/>\n                    <L7p:MaxEntryAgeSeconds stringValue=\"${cacheAge}\"/>\n                    <L7p:MaxEntrySizeBytes stringValue=\"200000\"/>\n                    <L7p:OtherTargetMessageVariable stringValue=\"scheduledTasks.sorted\"/>\n                    <L7p:StoreSoapFaults booleanValue=\"true\"/>\n                    <L7p:Target target=\"OTHER\"/>\n                </L7p:CacheStorage>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"c3lzdGVt\"/>\n                    <L7p:VariableToSet stringValue=\"source\"/>\n                </L7p:SetVariable>\n                <L7p:AuditDetailAssertion>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// FINE\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Detail stringValue=\"==> Loaded scheduledTasks.sorted from system and stored to cache\"/>\n                    <L7p:Level stringValue=\"FINE\"/>\n                </L7p:AuditDetailAssertion>\n                <L7p:assertionComment>\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// Retrieve new list and cache\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:assertionComment>\n            </wsp:All>\n            <wsp:All wsp:Usage=\"Required\">\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"RXJyb3Igd2hlbiBsaXN0aW5nIHNjaGVkdWxlZCB0YXNrcw==\"/>\n                    <L7p:VariableToSet stringValue=\"error.msg\"/>\n                </L7p:SetVariable>\n                <L7p:AuditDetailAssertion>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// WARNING\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Detail stringValue=\"==> Error listing scheduled tasks in ${policy.name}\"/>\n                    <L7p:Level stringValue=\"WARNING\"/>\n                </L7p:AuditDetailAssertion>\n                <L7p:FalseAssertion/>\n                <L7p:assertionComment>\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// Failure - set ${error.msg}\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:assertionComment>\n            </wsp:All>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Caching logic\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:OneOrMore>\n        <L7p:Regex>\n            <L7p:AssertionComment assertionComment=\"included\">\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Add source attribute to /ScheduledTasks element\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:AssertionComment>\n            <L7p:AutoTarget booleanValue=\"false\"/>\n            <L7p:OtherTargetMessageVariable stringValue=\"scheduledTasks.sorted\"/>\n            <L7p:Regex stringValue=\"&lt;ScheduledTasks>\"/>\n            <L7p:Replace booleanValue=\"true\"/>\n            <L7p:Replacement stringValue=\"&lt;ScheduledTasks source=&quot;${source}&quot;>\"/>\n            <L7p:Target target=\"OTHER\"/>\n        </L7p:Regex>\n        <L7p:AuditDetailAssertion>\n            <L7p:AssertionComment assertionComment=\"included\">\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// FINE\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:AssertionComment>\n            <L7p:Detail stringValue=\"==> Leaving Utility Fragment: ${policy.name}\"/>\n            <L7p:Level stringValue=\"FINE\"/>\n        </L7p:AuditDetailAssertion>\n    </wsp:All>\n</wsp:Policy>\n"
      },
      "policyRevisions": [
        {
          "goid": "bed4baf4ff33b7e528854c3965d9bb5c",
          "ordinal": 1,
          "active": true,
          "author": "admin",
          "time": "2025-02-05T14:20:38.571Z",
          "xml": "<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<wsp:Policy xmlns:L7p=\"http://www.layer7tech.com/ws/policy\" xmlns:wsp=\"http://schemas.xmlsoap.org/ws/2002/12/policy\">\n    <wsp:All wsp:Usage=\"Required\">\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Policy fragment for &quot;Utility: List Scheduled Taskss&quot; encapsulated assertion\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Call Restman and generate a sorted list of scheduled tasks\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** - Assumes an admin role user has been authenticated\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** - Caches results for ${cacheAge} seconds (default=300). To refresh the cache set ${refresh}=true when calling\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** - Returns a text/xml message variable in ${scheduledTasks.sorted}\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Inputs:\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - refresh (string)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - cacheAge (string)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Outputs:\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - scheduledTasks.sorted (message)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - error.msg (string)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** v1.0.0 - Jay MacDonald - 20201107 - Initial Version\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n        </L7p:CommentAssertion>\n        <L7p:AuditDetailAssertion>\n            <L7p:AssertionComment assertionComment=\"included\">\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// FINE\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:AssertionComment>\n            <L7p:Detail stringValue=\"==> Entering Utility Fragment: ${policy.name} (refresh=${refresh})\"/>\n            <L7p:Level stringValue=\"FINE\"/>\n        </L7p:AuditDetailAssertion>\n        <wsp:All wsp:Usage=\"Required\">\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** ${scheduledTasks.sorted} has the following schema:\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** \"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** &lt;ScheduledTasks source=&quot;system|cache&quot;>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   &lt;ScheduledTask id=&quot;string&quot;>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**     &lt;Name>string&lt;/Name>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**     &lt;PolicyID>string&lt;/PolicyId>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   &lt;/ScheduledTask>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   ...\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** &lt;/ScheduledTasks>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n            </L7p:CommentAssertion>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Description of ${scheduledTasks.sorted}\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:All>\n        <wsp:OneOrMore wsp:Usage=\"Required\">\n            <L7p:ComparisonAssertion>\n                <L7p:AssertionComment assertionComment=\"included\">\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// true or false\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:AssertionComment>\n                <L7p:CaseSensitive booleanValue=\"false\"/>\n                <L7p:Expression1 stringValue=\"${cacheAge}\"/>\n                <L7p:Operator operatorNull=\"null\"/>\n                <L7p:Predicates predicates=\"included\">\n                    <L7p:item dataType=\"included\">\n                        <L7p:Type variableDataType=\"int\"/>\n                    </L7p:item>\n                    <L7p:item binary=\"included\">\n                        <L7p:CaseSensitive booleanValue=\"false\"/>\n                        <L7p:Operator operator=\"GT\"/>\n                        <L7p:RightValue stringValue=\"0\"/>\n                    </L7p:item>\n                </L7p:Predicates>\n            </L7p:ComparisonAssertion>\n            <L7p:SetVariable>\n                <L7p:Base64Expression stringValue=\"MzAw\"/>\n                <L7p:DataType variableDataType=\"int\"/>\n                <L7p:VariableToSet stringValue=\"cacheAge\"/>\n            </L7p:SetVariable>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Ensure ${cacheAge} is set, default=300\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:OneOrMore>\n        <wsp:OneOrMore wsp:Usage=\"Required\">\n            <L7p:ComparisonAssertion>\n                <L7p:AssertionComment assertionComment=\"included\">\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// true or false\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:AssertionComment>\n                <L7p:CaseSensitive booleanValue=\"false\"/>\n                <L7p:Expression1 stringValue=\"${refresh}\"/>\n                <L7p:Operator operatorNull=\"null\"/>\n                <L7p:Predicates predicates=\"included\">\n                    <L7p:item dataType=\"included\">\n                        <L7p:Type variableDataType=\"string\"/>\n                    </L7p:item>\n                    <L7p:item regex=\"included\">\n                        <L7p:Pattern stringValue=\"^(true|false)$\"/>\n                    </L7p:item>\n                </L7p:Predicates>\n            </L7p:ComparisonAssertion>\n            <L7p:SetVariable>\n                <L7p:Base64Expression stringValue=\"ZmFsc2U=\"/>\n                <L7p:VariableToSet stringValue=\"refresh\"/>\n            </L7p:SetVariable>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Ensure ${refresh} is set, default=false\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:OneOrMore>\n        <L7p:SetVariable>\n            <L7p:Base64Expression stringValue=\"c2NoZWR1bGVkVGFza3Muc29ydGVk\"/>\n            <L7p:VariableToSet stringValue=\"cacheKey\"/>\n        </L7p:SetVariable>\n        <wsp:OneOrMore wsp:Usage=\"Required\">\n            <wsp:All wsp:Usage=\"Required\">\n                <L7p:ComparisonAssertion>\n                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                    <L7p:Expression1 stringValue=\"${refresh}\"/>\n                    <L7p:Operator operatorNull=\"null\"/>\n                    <L7p:Predicates predicates=\"included\">\n                        <L7p:item dataType=\"included\">\n                            <L7p:Type variableDataType=\"string\"/>\n                        </L7p:item>\n                        <L7p:item binary=\"included\">\n                            <L7p:Negated booleanValue=\"true\"/>\n                            <L7p:RightValue stringValue=\"true\"/>\n                        </L7p:item>\n                    </L7p:Predicates>\n                </L7p:ComparisonAssertion>\n                <L7p:CacheLookup>\n                    <L7p:CacheEntryKey stringValue=\"${cacheKey}\"/>\n                    <L7p:CacheId stringValue=\"scheduledTaskList\"/>\n                    <L7p:ContentTypeOverride stringValue=\"\"/>\n                    <L7p:MaxEntryAgeSeconds stringValue=\"${cacheAge}\"/>\n                    <L7p:OtherTargetMessageVariable stringValue=\"scheduledTasks.sorted\"/>\n                    <L7p:Target target=\"OTHER\"/>\n                </L7p:CacheLookup>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"Y2FjaGU=\"/>\n                    <L7p:VariableToSet stringValue=\"source\"/>\n                </L7p:SetVariable>\n                <L7p:AuditDetailAssertion>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// FINE\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Detail stringValue=\"==> Found scheduledTasks.sorted in the cache\"/>\n                    <L7p:Level stringValue=\"FINE\"/>\n                </L7p:AuditDetailAssertion>\n                <L7p:assertionComment>\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// Look in cache unless asked to refresh cache\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:assertionComment>\n            </wsp:All>\n            <wsp:All wsp:Usage=\"Required\">\n                <L7p:Encapsulated>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// GET scheduledTasks\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:EncapsulatedAssertionConfigGuid stringValue=\"c8a5a0d5-1ae2-4144-b538-5c311efc1560\"/>\n                    <L7p:EncapsulatedAssertionConfigName stringValue=\"Utility: Call Restman\"/>\n                    <L7p:Parameters mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"element\"/>\n                            <L7p:value stringValue=\"ScheduledTask\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"message\"/>\n                            <L7p:value stringValue=\"\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"method\"/>\n                            <L7p:value stringValue=\"GET\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"resource\"/>\n                            <L7p:value stringValue=\"scheduledTasks\"/>\n                        </L7p:entry>\n                    </L7p:Parameters>\n                </L7p:Encapsulated>\n                <wsp:OneOrMore wsp:Usage=\"Required\">\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:VariablePrefix stringValue=\"scheduledTasks\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/l7:List/l7:Item/l7:Resource/l7:ScheduledTask\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <L7p:TrueAssertion/>\n                    <L7p:assertionComment>\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// Extract the list of scheduled tasks, never fail\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:assertionComment>\n                </wsp:OneOrMore>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz48U2NoZWR1bGVkVGFza3M+\"/>\n                    <L7p:VariableToSet stringValue=\"scheduledTasks.sorted\"/>\n                </L7p:SetVariable>\n                <L7p:ForEachLoop L7p:Usage=\"Required\"\n                    loopVariable=\"scheduledTasks.elements\" variablePrefix=\"scheduledTask\">\n                    <L7p:SetVariable>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Cast to message type for parsing\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:Base64Expression stringValue=\"JHtzY2hlZHVsZWRUYXNrLmN1cnJlbnR9\"/>\n                        <L7p:ContentType stringValue=\"text/xml; charset=utf-8\"/>\n                        <L7p:DataType variableDataType=\"message\"/>\n                        <L7p:VariableToSet stringValue=\"scheduledTask.xml\"/>\n                    </L7p:SetVariable>\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Retrieve the scheduled task ID\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:VariablePrefix stringValue=\"id\"/>\n                        <L7p:XmlMsgSrc stringValue=\"scheduledTask.xml\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/l7:ScheduledTask/@id\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// retrieve the scheduled task name\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:VariablePrefix stringValue=\"name\"/>\n                        <L7p:XmlMsgSrc stringValue=\"scheduledTask.xml\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/l7:ScheduledTask/l7:Name\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// retrieve the scheduled task policy reference Id\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:VariablePrefix stringValue=\"policyId\"/>\n                        <L7p:XmlMsgSrc stringValue=\"scheduledTask.xml\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/l7:ScheduledTask/l7:PolicyReference/@id\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <L7p:SetVariable>\n                        <L7p:Base64Expression stringValue=\"JHtzY2hlZHVsZWRUYXNrcy5zb3J0ZWR9PFNjaGVkdWxlZFRhc2sgaWQ9IiR7aWQucmVzdWx0fSI+PE5hbWU+PCFbQ0RBVEFbJHtuYW1lLnJlc3VsdH1dXT48L05hbWU+PFBvbGljeUlkPiR7cG9saWN5SWQucmVzdWx0fTwvUG9saWN5SWQ+PC9TY2hlZHVsZWRUYXNrPg==\"/>\n                        <L7p:VariableToSet stringValue=\"scheduledTasks.sorted\"/>\n                    </L7p:SetVariable>\n                    <L7p:assertionComment>\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// Build the list of scheduled tasks\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:assertionComment>\n                </L7p:ForEachLoop>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"JHtzY2hlZHVsZWRUYXNrcy5zb3J0ZWR9PC9TY2hlZHVsZWRUYXNrcz4=\"/>\n                    <L7p:ContentType stringValue=\"text/xml; charset=utf-8\"/>\n                    <L7p:DataType variableDataType=\"message\"/>\n                    <L7p:VariableToSet stringValue=\"scheduledTasks.sorted\"/>\n                </L7p:SetVariable>\n                <L7p:XslTransformation>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// Sort the scheduled tasks by name\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Direction intValue=\"-1\"/>\n                    <L7p:OtherTargetMessageVariable stringValue=\"scheduledTasks.sorted\"/>\n                    <L7p:ResourceInfo staticResourceInfo=\"included\">\n                        <L7p:Document stringValue=\"&lt;xsl:stylesheet version=&quot;1.0&quot; xmlns:l7=&quot;http://ns.l7tech.com/2010/04/gateway-management&quot; xmlns:xsl=&quot;http://www.w3.org/1999/XSL/Transform&quot;>&lt;xsl:template match=&quot;/ScheduledTasks&quot;>    &lt;xsl:copy>        &lt;xsl:for-each select=&quot;ScheduledTask&quot;>            &lt;xsl:sort select=&quot;./Name&quot;/>            &lt;xsl:copy-of select=&quot;.&quot;/>        &lt;/xsl:for-each>    &lt;/xsl:copy>&lt;/xsl:template>&lt;/xsl:stylesheet>\"/>\n                    </L7p:ResourceInfo>\n                    <L7p:Target target=\"OTHER\"/>\n                    <L7p:TransformName stringValue=\"\"/>\n                    <L7p:XsltVersion stringValue=\"1.0\"/>\n                </L7p:XslTransformation>\n                <L7p:CacheStorage>\n                    <L7p:CacheEntryKey stringValue=\"${cacheKey}\"/>\n                    <L7p:CacheId stringValue=\"scheduledTaskList\"/>\n                    <L7p:MaxEntries stringValue=\"1\"/>\n                    <L7p:MaxEntryAgeSeconds stringValue=\"${cacheAge}\"/>\n                    <L7p:MaxEntrySizeBytes stringValue=\"200000\"/>\n                    <L7p:OtherTargetMessageVariable stringValue=\"scheduledTasks.sorted\"/>\n                    <L7p:StoreSoapFaults booleanValue=\"true\"/>\n                    <L7p:Target target=\"OTHER\"/>\n                </L7p:CacheStorage>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"c3lzdGVt\"/>\n                    <L7p:VariableToSet stringValue=\"source\"/>\n                </L7p:SetVariable>\n                <L7p:AuditDetailAssertion>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// FINE\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Detail stringValue=\"==> Loaded scheduledTasks.sorted from system and stored to cache\"/>\n                    <L7p:Level stringValue=\"FINE\"/>\n                </L7p:AuditDetailAssertion>\n                <L7p:assertionComment>\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// Retrieve new list and cache\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:assertionComment>\n            </wsp:All>\n            <wsp:All wsp:Usage=\"Required\">\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"RXJyb3Igd2hlbiBsaXN0aW5nIHNjaGVkdWxlZCB0YXNrcw==\"/>\n                    <L7p:VariableToSet stringValue=\"error.msg\"/>\n                </L7p:SetVariable>\n                <L7p:AuditDetailAssertion>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// WARNING\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Detail stringValue=\"==> Error listing scheduled tasks in ${policy.name}\"/>\n                    <L7p:Level stringValue=\"WARNING\"/>\n                </L7p:AuditDetailAssertion>\n                <L7p:FalseAssertion/>\n                <L7p:assertionComment>\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// Failure - set ${error.msg}\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:assertionComment>\n            </wsp:All>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Caching logic\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:OneOrMore>\n        <L7p:Regex>\n            <L7p:AssertionComment assertionComment=\"included\">\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Add source attribute to /ScheduledTasks element\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:AssertionComment>\n            <L7p:AutoTarget booleanValue=\"false\"/>\n            <L7p:OtherTargetMessageVariable stringValue=\"scheduledTasks.sorted\"/>\n            <L7p:Regex stringValue=\"&lt;ScheduledTasks>\"/>\n            <L7p:Replace booleanValue=\"true\"/>\n            <L7p:Replacement stringValue=\"&lt;ScheduledTasks source=&quot;${source}&quot;>\"/>\n            <L7p:Target target=\"OTHER\"/>\n        </L7p:Regex>\n        <L7p:AuditDetailAssertion>\n            <L7p:AssertionComment assertionComment=\"included\">\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// FINE\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:AssertionComment>\n            <L7p:Detail stringValue=\"==> Leaving Utility Fragment: ${policy.name}\"/>\n            <L7p:Level stringValue=\"FINE\"/>\n        </L7p:AuditDetailAssertion>\n    </wsp:All>\n</wsp:Policy>\n"
        }
      ]
    },
    {
      "guid": "18f3eb02-e82b-42a4-843a-276dfb2b0bfe",
      "name": "Utility: List Secure Passwords",
      "policyType": "FRAGMENT",
      "checksum": "e91a5396a913ab28c6b5a156e1dc33688fa3520d",
      "folderPath": "/Gateway Management Utilities/fragments",
      "soap": false,
      "policy": {
        "xml": "<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<wsp:Policy xmlns:L7p=\"http://www.layer7tech.com/ws/policy\" xmlns:wsp=\"http://schemas.xmlsoap.org/ws/2002/12/policy\">\n    <wsp:All wsp:Usage=\"Required\">\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Policy fragment for &quot;Utility: List Secure Passwords&quot; encapsulated assertion\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Call Restman and generate a sorted list of secure passwords\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** - Assumes an admin role user has been authenticated\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** - Caches results for ${cacheAge} seconds (default=300). To refresh the cache set ${refresh}=true when calling\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** - Returns a text/xml message variable in ${securePasswords.sorted}\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Inputs:\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - refresh (string)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - cacheAge (string)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Outputs:\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - securePasswords.sorted (message)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - error.msg (string)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** v1.0.0 - Jay MacDonald - 20201107 - Initial Version\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n        </L7p:CommentAssertion>\n        <L7p:AuditDetailAssertion>\n            <L7p:AssertionComment assertionComment=\"included\">\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// FINE\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:AssertionComment>\n            <L7p:Detail stringValue=\"==> Entering Utility Fragment: ${policy.name} (refresh=${refresh})\"/>\n            <L7p:Level stringValue=\"FINE\"/>\n        </L7p:AuditDetailAssertion>\n        <wsp:All wsp:Usage=\"Required\">\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** ${securePasswords.sorted} has the following schema:\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** \"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** &lt;SecurePasswords source=&quot;system|cache&quot;>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   &lt;SecurePassword id=&quot;string&quot;>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**     &lt;Name>string&lt;/Name>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**     &lt;Type>string&lt;/Type>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**     &lt;Description>string&lt;/Description>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**     &lt;UsageFromVariable>boolean&lt;/UsageFromVariable>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   &lt;/SecurePassword>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   ...\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** &lt;/SecurePasswords>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** \"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** Where:\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   Name = the name of the secure password\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   Type = the type of secure password\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   Description = the description field\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   UsageFromPassword = true or false\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n            </L7p:CommentAssertion>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Description of ${securePasswords.sorted}\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:All>\n        <wsp:OneOrMore wsp:Usage=\"Required\">\n            <L7p:ComparisonAssertion>\n                <L7p:AssertionComment assertionComment=\"included\">\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// true or false\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:AssertionComment>\n                <L7p:CaseSensitive booleanValue=\"false\"/>\n                <L7p:Expression1 stringValue=\"${cacheAge}\"/>\n                <L7p:Operator operatorNull=\"null\"/>\n                <L7p:Predicates predicates=\"included\">\n                    <L7p:item dataType=\"included\">\n                        <L7p:Type variableDataType=\"int\"/>\n                    </L7p:item>\n                    <L7p:item binary=\"included\">\n                        <L7p:CaseSensitive booleanValue=\"false\"/>\n                        <L7p:Operator operator=\"GT\"/>\n                        <L7p:RightValue stringValue=\"0\"/>\n                    </L7p:item>\n                </L7p:Predicates>\n            </L7p:ComparisonAssertion>\n            <L7p:SetVariable>\n                <L7p:Base64Expression stringValue=\"MzAw\"/>\n                <L7p:DataType variableDataType=\"int\"/>\n                <L7p:VariableToSet stringValue=\"cacheAge\"/>\n            </L7p:SetVariable>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Ensure ${cacheAge} is set, default=300\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:OneOrMore>\n        <wsp:OneOrMore wsp:Usage=\"Required\">\n            <L7p:ComparisonAssertion>\n                <L7p:AssertionComment assertionComment=\"included\">\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// true or false\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:AssertionComment>\n                <L7p:CaseSensitive booleanValue=\"false\"/>\n                <L7p:Expression1 stringValue=\"${refresh}\"/>\n                <L7p:Operator operatorNull=\"null\"/>\n                <L7p:Predicates predicates=\"included\">\n                    <L7p:item dataType=\"included\">\n                        <L7p:Type variableDataType=\"string\"/>\n                    </L7p:item>\n                    <L7p:item regex=\"included\">\n                        <L7p:Pattern stringValue=\"^(true|false)$\"/>\n                    </L7p:item>\n                </L7p:Predicates>\n            </L7p:ComparisonAssertion>\n            <L7p:SetVariable>\n                <L7p:Base64Expression stringValue=\"ZmFsc2U=\"/>\n                <L7p:VariableToSet stringValue=\"refresh\"/>\n            </L7p:SetVariable>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Ensure ${refresh} is set, default=false\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:OneOrMore>\n        <L7p:SetVariable>\n            <L7p:Base64Expression stringValue=\"c2VjdXJlUGFzc3dvcmRzLnNvcnRlZA==\"/>\n            <L7p:VariableToSet stringValue=\"cacheKey\"/>\n        </L7p:SetVariable>\n        <wsp:OneOrMore wsp:Usage=\"Required\">\n            <wsp:All wsp:Usage=\"Required\">\n                <L7p:ComparisonAssertion>\n                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                    <L7p:Expression1 stringValue=\"${refresh}\"/>\n                    <L7p:Operator operatorNull=\"null\"/>\n                    <L7p:Predicates predicates=\"included\">\n                        <L7p:item dataType=\"included\">\n                            <L7p:Type variableDataType=\"string\"/>\n                        </L7p:item>\n                        <L7p:item binary=\"included\">\n                            <L7p:Negated booleanValue=\"true\"/>\n                            <L7p:RightValue stringValue=\"true\"/>\n                        </L7p:item>\n                    </L7p:Predicates>\n                </L7p:ComparisonAssertion>\n                <L7p:CacheLookup>\n                    <L7p:CacheEntryKey stringValue=\"${cacheKey}\"/>\n                    <L7p:CacheId stringValue=\"securePasswordList\"/>\n                    <L7p:ContentTypeOverride stringValue=\"\"/>\n                    <L7p:MaxEntryAgeSeconds stringValue=\"${cacheAge}\"/>\n                    <L7p:OtherTargetMessageVariable stringValue=\"securePasswords.sorted\"/>\n                    <L7p:Target target=\"OTHER\"/>\n                </L7p:CacheLookup>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"Y2FjaGU=\"/>\n                    <L7p:VariableToSet stringValue=\"source\"/>\n                </L7p:SetVariable>\n                <L7p:AuditDetailAssertion>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// FINE\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Detail stringValue=\"==> Found securePasswords.sorted in the cache\"/>\n                    <L7p:Level stringValue=\"FINE\"/>\n                </L7p:AuditDetailAssertion>\n                <L7p:assertionComment>\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// Look in cache unless asked to refresh cache\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:assertionComment>\n            </wsp:All>\n            <wsp:All wsp:Usage=\"Required\">\n                <L7p:Encapsulated>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// GET passwords\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:EncapsulatedAssertionConfigGuid stringValue=\"c8a5a0d5-1ae2-4144-b538-5c311efc1560\"/>\n                    <L7p:EncapsulatedAssertionConfigName stringValue=\"Utility: Call Restman\"/>\n                    <L7p:Parameters mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"element\"/>\n                            <L7p:value stringValue=\"StoredPassword\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"message\"/>\n                            <L7p:value stringValue=\"\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"method\"/>\n                            <L7p:value stringValue=\"GET\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"resource\"/>\n                            <L7p:value stringValue=\"passwords\"/>\n                        </L7p:entry>\n                    </L7p:Parameters>\n                </L7p:Encapsulated>\n                <wsp:OneOrMore wsp:Usage=\"Required\">\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:VariablePrefix stringValue=\"securePasswords\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/l7:List/l7:Item/l7:Resource/l7:StoredPassword\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <L7p:TrueAssertion/>\n                    <L7p:assertionComment>\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// Extract the list of secure passwords, never fail\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:assertionComment>\n                </wsp:OneOrMore>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz48U2VjdXJlUGFzc3dvcmRzPg==\"/>\n                    <L7p:VariableToSet stringValue=\"securePasswords.sorted\"/>\n                </L7p:SetVariable>\n                <L7p:ForEachLoop L7p:Usage=\"Required\"\n                    loopVariable=\"securePasswords.elements\" variablePrefix=\"securePassword\">\n                    <L7p:SetVariable>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Cast to message type for parsing\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:Base64Expression stringValue=\"JHtzZWN1cmVQYXNzd29yZC5jdXJyZW50fQ==\"/>\n                        <L7p:ContentType stringValue=\"text/xml; charset=utf-8\"/>\n                        <L7p:DataType variableDataType=\"message\"/>\n                        <L7p:VariableToSet stringValue=\"securePassword.xml\"/>\n                    </L7p:SetVariable>\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Retrieve the secure password ID\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:VariablePrefix stringValue=\"id\"/>\n                        <L7p:XmlMsgSrc stringValue=\"securePassword.xml\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/l7:StoredPassword/@id\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// retrieve the secure password name\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:VariablePrefix stringValue=\"name\"/>\n                        <L7p:XmlMsgSrc stringValue=\"securePassword.xml\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/l7:StoredPassword/l7:Name\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// retrieve the secure password type\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:VariablePrefix stringValue=\"type\"/>\n                        <L7p:XmlMsgSrc stringValue=\"securePassword.xml\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/l7:StoredPassword/l7:Properties/l7:Property[@key=&quot;type&quot;]/l7:StringValue\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Retrieve the secure password description\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:VariablePrefix stringValue=\"description\"/>\n                        <L7p:XmlMsgSrc stringValue=\"securePassword.xml\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/l7:StoredPassword/l7:Properties/l7:Property[@key=&quot;description&quot;]/l7:StringValue\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Retrieve the usage from variable state\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:VariablePrefix stringValue=\"usageFromVariable\"/>\n                        <L7p:XmlMsgSrc stringValue=\"securePassword.xml\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/l7:StoredPassword/l7:Properties/l7:Property[@key=&quot;usageFromVariable&quot;]/l7:BooleanValue\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <L7p:SetVariable>\n                        <L7p:Base64Expression stringValue=\"JHtzZWN1cmVQYXNzd29yZHMuc29ydGVkfTxTZWN1cmVQYXNzd29yZCBpZD0iJHtpZC5yZXN1bHR9Ij48TmFtZT48IVtDREFUQVske25hbWUucmVzdWx0fV1dPjwvTmFtZT48VHlwZT4ke3R5cGUucmVzdWx0fTwvVHlwZT48RGVzY3JpcHRpb24+PCFbQ0RBVEFbJHtkZXNjcmlwdGlvbi5yZXN1bHR9XV0+PC9EZXNjcmlwdGlvbj48VXNhZ2VGcm9tVmFyaWFibGU+JHt1c2FnZUZyb21WYXJpYWJsZS5yZXN1bHR9PC9Vc2FnZUZyb21WYXJpYWJsZT48L1NlY3VyZVBhc3N3b3JkPg==\"/>\n                        <L7p:VariableToSet stringValue=\"securePasswords.sorted\"/>\n                    </L7p:SetVariable>\n                    <L7p:assertionComment>\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// Build the list of secure passwords\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:assertionComment>\n                </L7p:ForEachLoop>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"JHtzZWN1cmVQYXNzd29yZHMuc29ydGVkfTwvU2VjdXJlUGFzc3dvcmRzPg==\"/>\n                    <L7p:ContentType stringValue=\"text/xml; charset=utf-8\"/>\n                    <L7p:DataType variableDataType=\"message\"/>\n                    <L7p:VariableToSet stringValue=\"securePasswords.sorted\"/>\n                </L7p:SetVariable>\n                <L7p:XslTransformation>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// Sort the secure passwords by name\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Direction intValue=\"-1\"/>\n                    <L7p:OtherTargetMessageVariable stringValue=\"securePasswords.sorted\"/>\n                    <L7p:ResourceInfo staticResourceInfo=\"included\">\n                        <L7p:Document stringValue=\"&lt;xsl:stylesheet version=&quot;1.0&quot; xmlns:l7=&quot;http://ns.l7tech.com/2010/04/gateway-management&quot; xmlns:xsl=&quot;http://www.w3.org/1999/XSL/Transform&quot;>&lt;xsl:template match=&quot;/SecurePasswords&quot;>    &lt;xsl:copy>        &lt;xsl:for-each select=&quot;SecurePassword&quot;>            &lt;xsl:sort select=&quot;./Name&quot;/>            &lt;xsl:copy-of select=&quot;.&quot;/>        &lt;/xsl:for-each>    &lt;/xsl:copy>&lt;/xsl:template>&lt;/xsl:stylesheet>\"/>\n                    </L7p:ResourceInfo>\n                    <L7p:Target target=\"OTHER\"/>\n                    <L7p:TransformName stringValue=\"\"/>\n                    <L7p:XsltVersion stringValue=\"1.0\"/>\n                </L7p:XslTransformation>\n                <L7p:CacheStorage>\n                    <L7p:CacheEntryKey stringValue=\"${cacheKey}\"/>\n                    <L7p:CacheId stringValue=\"securePasswordList\"/>\n                    <L7p:MaxEntries stringValue=\"1\"/>\n                    <L7p:MaxEntryAgeSeconds stringValue=\"${cacheAge}\"/>\n                    <L7p:MaxEntrySizeBytes stringValue=\"200000\"/>\n                    <L7p:OtherTargetMessageVariable stringValue=\"securePasswords.sorted\"/>\n                    <L7p:StoreSoapFaults booleanValue=\"true\"/>\n                    <L7p:Target target=\"OTHER\"/>\n                </L7p:CacheStorage>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"c3lzdGVt\"/>\n                    <L7p:VariableToSet stringValue=\"source\"/>\n                </L7p:SetVariable>\n                <L7p:AuditDetailAssertion>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// FINE\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Detail stringValue=\"==> Loaded securePasswords.sorted from system and stored to cache\"/>\n                    <L7p:Level stringValue=\"FINE\"/>\n                </L7p:AuditDetailAssertion>\n                <L7p:assertionComment>\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// Retrieve new list and cache\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:assertionComment>\n            </wsp:All>\n            <wsp:All wsp:Usage=\"Required\">\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"RXJyb3Igd2hlbiBsaXN0aW5nIHNlY3VyZSBwYXNzd29yZHM=\"/>\n                    <L7p:VariableToSet stringValue=\"error.msg\"/>\n                </L7p:SetVariable>\n                <L7p:AuditDetailAssertion>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// WARNING\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Detail stringValue=\"==> Error listing secure passwords in ${policy.name}\"/>\n                    <L7p:Level stringValue=\"WARNING\"/>\n                </L7p:AuditDetailAssertion>\n                <L7p:FalseAssertion/>\n                <L7p:assertionComment>\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// Failure - set ${error.msg}\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:assertionComment>\n            </wsp:All>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Caching logic\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:OneOrMore>\n        <L7p:Regex>\n            <L7p:AssertionComment assertionComment=\"included\">\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Add source attribute to /SecurePasswords element\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:AssertionComment>\n            <L7p:AutoTarget booleanValue=\"false\"/>\n            <L7p:OtherTargetMessageVariable stringValue=\"securePasswords.sorted\"/>\n            <L7p:Regex stringValue=\"&lt;SecurePasswords>\"/>\n            <L7p:Replace booleanValue=\"true\"/>\n            <L7p:Replacement stringValue=\"&lt;SecurePasswords source=&quot;${source}&quot;>\"/>\n            <L7p:Target target=\"OTHER\"/>\n        </L7p:Regex>\n        <L7p:AuditDetailAssertion>\n            <L7p:AssertionComment assertionComment=\"included\">\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// FINE\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:AssertionComment>\n            <L7p:Detail stringValue=\"==> Leaving Utility Fragment: ${policy.name}\"/>\n            <L7p:Level stringValue=\"FINE\"/>\n        </L7p:AuditDetailAssertion>\n    </wsp:All>\n</wsp:Policy>\n"
      },
      "policyRevisions": [
        {
          "goid": "bed4baf4ff33b7e528854c3965d9bb60",
          "ordinal": 1,
          "active": true,
          "author": "admin",
          "time": "2025-02-05T14:20:38.617Z",
          "xml": "<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<wsp:Policy xmlns:L7p=\"http://www.layer7tech.com/ws/policy\" xmlns:wsp=\"http://schemas.xmlsoap.org/ws/2002/12/policy\">\n    <wsp:All wsp:Usage=\"Required\">\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Policy fragment for &quot;Utility: List Secure Passwords&quot; encapsulated assertion\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Call Restman and generate a sorted list of secure passwords\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** - Assumes an admin role user has been authenticated\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** - Caches results for ${cacheAge} seconds (default=300). To refresh the cache set ${refresh}=true when calling\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** - Returns a text/xml message variable in ${securePasswords.sorted}\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Inputs:\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - refresh (string)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - cacheAge (string)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Outputs:\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - securePasswords.sorted (message)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - error.msg (string)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** v1.0.0 - Jay MacDonald - 20201107 - Initial Version\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n        </L7p:CommentAssertion>\n        <L7p:AuditDetailAssertion>\n            <L7p:AssertionComment assertionComment=\"included\">\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// FINE\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:AssertionComment>\n            <L7p:Detail stringValue=\"==> Entering Utility Fragment: ${policy.name} (refresh=${refresh})\"/>\n            <L7p:Level stringValue=\"FINE\"/>\n        </L7p:AuditDetailAssertion>\n        <wsp:All wsp:Usage=\"Required\">\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** ${securePasswords.sorted} has the following schema:\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** \"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** &lt;SecurePasswords source=&quot;system|cache&quot;>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   &lt;SecurePassword id=&quot;string&quot;>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**     &lt;Name>string&lt;/Name>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**     &lt;Type>string&lt;/Type>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**     &lt;Description>string&lt;/Description>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**     &lt;UsageFromVariable>boolean&lt;/UsageFromVariable>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   &lt;/SecurePassword>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   ...\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** &lt;/SecurePasswords>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** \"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** Where:\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   Name = the name of the secure password\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   Type = the type of secure password\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   Description = the description field\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   UsageFromPassword = true or false\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n            </L7p:CommentAssertion>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Description of ${securePasswords.sorted}\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:All>\n        <wsp:OneOrMore wsp:Usage=\"Required\">\n            <L7p:ComparisonAssertion>\n                <L7p:AssertionComment assertionComment=\"included\">\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// true or false\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:AssertionComment>\n                <L7p:CaseSensitive booleanValue=\"false\"/>\n                <L7p:Expression1 stringValue=\"${cacheAge}\"/>\n                <L7p:Operator operatorNull=\"null\"/>\n                <L7p:Predicates predicates=\"included\">\n                    <L7p:item dataType=\"included\">\n                        <L7p:Type variableDataType=\"int\"/>\n                    </L7p:item>\n                    <L7p:item binary=\"included\">\n                        <L7p:CaseSensitive booleanValue=\"false\"/>\n                        <L7p:Operator operator=\"GT\"/>\n                        <L7p:RightValue stringValue=\"0\"/>\n                    </L7p:item>\n                </L7p:Predicates>\n            </L7p:ComparisonAssertion>\n            <L7p:SetVariable>\n                <L7p:Base64Expression stringValue=\"MzAw\"/>\n                <L7p:DataType variableDataType=\"int\"/>\n                <L7p:VariableToSet stringValue=\"cacheAge\"/>\n            </L7p:SetVariable>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Ensure ${cacheAge} is set, default=300\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:OneOrMore>\n        <wsp:OneOrMore wsp:Usage=\"Required\">\n            <L7p:ComparisonAssertion>\n                <L7p:AssertionComment assertionComment=\"included\">\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// true or false\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:AssertionComment>\n                <L7p:CaseSensitive booleanValue=\"false\"/>\n                <L7p:Expression1 stringValue=\"${refresh}\"/>\n                <L7p:Operator operatorNull=\"null\"/>\n                <L7p:Predicates predicates=\"included\">\n                    <L7p:item dataType=\"included\">\n                        <L7p:Type variableDataType=\"string\"/>\n                    </L7p:item>\n                    <L7p:item regex=\"included\">\n                        <L7p:Pattern stringValue=\"^(true|false)$\"/>\n                    </L7p:item>\n                </L7p:Predicates>\n            </L7p:ComparisonAssertion>\n            <L7p:SetVariable>\n                <L7p:Base64Expression stringValue=\"ZmFsc2U=\"/>\n                <L7p:VariableToSet stringValue=\"refresh\"/>\n            </L7p:SetVariable>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Ensure ${refresh} is set, default=false\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:OneOrMore>\n        <L7p:SetVariable>\n            <L7p:Base64Expression stringValue=\"c2VjdXJlUGFzc3dvcmRzLnNvcnRlZA==\"/>\n            <L7p:VariableToSet stringValue=\"cacheKey\"/>\n        </L7p:SetVariable>\n        <wsp:OneOrMore wsp:Usage=\"Required\">\n            <wsp:All wsp:Usage=\"Required\">\n                <L7p:ComparisonAssertion>\n                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                    <L7p:Expression1 stringValue=\"${refresh}\"/>\n                    <L7p:Operator operatorNull=\"null\"/>\n                    <L7p:Predicates predicates=\"included\">\n                        <L7p:item dataType=\"included\">\n                            <L7p:Type variableDataType=\"string\"/>\n                        </L7p:item>\n                        <L7p:item binary=\"included\">\n                            <L7p:Negated booleanValue=\"true\"/>\n                            <L7p:RightValue stringValue=\"true\"/>\n                        </L7p:item>\n                    </L7p:Predicates>\n                </L7p:ComparisonAssertion>\n                <L7p:CacheLookup>\n                    <L7p:CacheEntryKey stringValue=\"${cacheKey}\"/>\n                    <L7p:CacheId stringValue=\"securePasswordList\"/>\n                    <L7p:ContentTypeOverride stringValue=\"\"/>\n                    <L7p:MaxEntryAgeSeconds stringValue=\"${cacheAge}\"/>\n                    <L7p:OtherTargetMessageVariable stringValue=\"securePasswords.sorted\"/>\n                    <L7p:Target target=\"OTHER\"/>\n                </L7p:CacheLookup>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"Y2FjaGU=\"/>\n                    <L7p:VariableToSet stringValue=\"source\"/>\n                </L7p:SetVariable>\n                <L7p:AuditDetailAssertion>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// FINE\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Detail stringValue=\"==> Found securePasswords.sorted in the cache\"/>\n                    <L7p:Level stringValue=\"FINE\"/>\n                </L7p:AuditDetailAssertion>\n                <L7p:assertionComment>\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// Look in cache unless asked to refresh cache\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:assertionComment>\n            </wsp:All>\n            <wsp:All wsp:Usage=\"Required\">\n                <L7p:Encapsulated>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// GET passwords\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:EncapsulatedAssertionConfigGuid stringValue=\"c8a5a0d5-1ae2-4144-b538-5c311efc1560\"/>\n                    <L7p:EncapsulatedAssertionConfigName stringValue=\"Utility: Call Restman\"/>\n                    <L7p:Parameters mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"element\"/>\n                            <L7p:value stringValue=\"StoredPassword\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"message\"/>\n                            <L7p:value stringValue=\"\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"method\"/>\n                            <L7p:value stringValue=\"GET\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"resource\"/>\n                            <L7p:value stringValue=\"passwords\"/>\n                        </L7p:entry>\n                    </L7p:Parameters>\n                </L7p:Encapsulated>\n                <wsp:OneOrMore wsp:Usage=\"Required\">\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:VariablePrefix stringValue=\"securePasswords\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/l7:List/l7:Item/l7:Resource/l7:StoredPassword\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <L7p:TrueAssertion/>\n                    <L7p:assertionComment>\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// Extract the list of secure passwords, never fail\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:assertionComment>\n                </wsp:OneOrMore>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz48U2VjdXJlUGFzc3dvcmRzPg==\"/>\n                    <L7p:VariableToSet stringValue=\"securePasswords.sorted\"/>\n                </L7p:SetVariable>\n                <L7p:ForEachLoop L7p:Usage=\"Required\"\n                    loopVariable=\"securePasswords.elements\" variablePrefix=\"securePassword\">\n                    <L7p:SetVariable>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Cast to message type for parsing\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:Base64Expression stringValue=\"JHtzZWN1cmVQYXNzd29yZC5jdXJyZW50fQ==\"/>\n                        <L7p:ContentType stringValue=\"text/xml; charset=utf-8\"/>\n                        <L7p:DataType variableDataType=\"message\"/>\n                        <L7p:VariableToSet stringValue=\"securePassword.xml\"/>\n                    </L7p:SetVariable>\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Retrieve the secure password ID\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:VariablePrefix stringValue=\"id\"/>\n                        <L7p:XmlMsgSrc stringValue=\"securePassword.xml\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/l7:StoredPassword/@id\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// retrieve the secure password name\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:VariablePrefix stringValue=\"name\"/>\n                        <L7p:XmlMsgSrc stringValue=\"securePassword.xml\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/l7:StoredPassword/l7:Name\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// retrieve the secure password type\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:VariablePrefix stringValue=\"type\"/>\n                        <L7p:XmlMsgSrc stringValue=\"securePassword.xml\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/l7:StoredPassword/l7:Properties/l7:Property[@key=&quot;type&quot;]/l7:StringValue\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Retrieve the secure password description\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:VariablePrefix stringValue=\"description\"/>\n                        <L7p:XmlMsgSrc stringValue=\"securePassword.xml\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/l7:StoredPassword/l7:Properties/l7:Property[@key=&quot;description&quot;]/l7:StringValue\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Retrieve the usage from variable state\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:VariablePrefix stringValue=\"usageFromVariable\"/>\n                        <L7p:XmlMsgSrc stringValue=\"securePassword.xml\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/l7:StoredPassword/l7:Properties/l7:Property[@key=&quot;usageFromVariable&quot;]/l7:BooleanValue\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <L7p:SetVariable>\n                        <L7p:Base64Expression stringValue=\"JHtzZWN1cmVQYXNzd29yZHMuc29ydGVkfTxTZWN1cmVQYXNzd29yZCBpZD0iJHtpZC5yZXN1bHR9Ij48TmFtZT48IVtDREFUQVske25hbWUucmVzdWx0fV1dPjwvTmFtZT48VHlwZT4ke3R5cGUucmVzdWx0fTwvVHlwZT48RGVzY3JpcHRpb24+PCFbQ0RBVEFbJHtkZXNjcmlwdGlvbi5yZXN1bHR9XV0+PC9EZXNjcmlwdGlvbj48VXNhZ2VGcm9tVmFyaWFibGU+JHt1c2FnZUZyb21WYXJpYWJsZS5yZXN1bHR9PC9Vc2FnZUZyb21WYXJpYWJsZT48L1NlY3VyZVBhc3N3b3JkPg==\"/>\n                        <L7p:VariableToSet stringValue=\"securePasswords.sorted\"/>\n                    </L7p:SetVariable>\n                    <L7p:assertionComment>\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// Build the list of secure passwords\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:assertionComment>\n                </L7p:ForEachLoop>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"JHtzZWN1cmVQYXNzd29yZHMuc29ydGVkfTwvU2VjdXJlUGFzc3dvcmRzPg==\"/>\n                    <L7p:ContentType stringValue=\"text/xml; charset=utf-8\"/>\n                    <L7p:DataType variableDataType=\"message\"/>\n                    <L7p:VariableToSet stringValue=\"securePasswords.sorted\"/>\n                </L7p:SetVariable>\n                <L7p:XslTransformation>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// Sort the secure passwords by name\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Direction intValue=\"-1\"/>\n                    <L7p:OtherTargetMessageVariable stringValue=\"securePasswords.sorted\"/>\n                    <L7p:ResourceInfo staticResourceInfo=\"included\">\n                        <L7p:Document stringValue=\"&lt;xsl:stylesheet version=&quot;1.0&quot; xmlns:l7=&quot;http://ns.l7tech.com/2010/04/gateway-management&quot; xmlns:xsl=&quot;http://www.w3.org/1999/XSL/Transform&quot;>&lt;xsl:template match=&quot;/SecurePasswords&quot;>    &lt;xsl:copy>        &lt;xsl:for-each select=&quot;SecurePassword&quot;>            &lt;xsl:sort select=&quot;./Name&quot;/>            &lt;xsl:copy-of select=&quot;.&quot;/>        &lt;/xsl:for-each>    &lt;/xsl:copy>&lt;/xsl:template>&lt;/xsl:stylesheet>\"/>\n                    </L7p:ResourceInfo>\n                    <L7p:Target target=\"OTHER\"/>\n                    <L7p:TransformName stringValue=\"\"/>\n                    <L7p:XsltVersion stringValue=\"1.0\"/>\n                </L7p:XslTransformation>\n                <L7p:CacheStorage>\n                    <L7p:CacheEntryKey stringValue=\"${cacheKey}\"/>\n                    <L7p:CacheId stringValue=\"securePasswordList\"/>\n                    <L7p:MaxEntries stringValue=\"1\"/>\n                    <L7p:MaxEntryAgeSeconds stringValue=\"${cacheAge}\"/>\n                    <L7p:MaxEntrySizeBytes stringValue=\"200000\"/>\n                    <L7p:OtherTargetMessageVariable stringValue=\"securePasswords.sorted\"/>\n                    <L7p:StoreSoapFaults booleanValue=\"true\"/>\n                    <L7p:Target target=\"OTHER\"/>\n                </L7p:CacheStorage>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"c3lzdGVt\"/>\n                    <L7p:VariableToSet stringValue=\"source\"/>\n                </L7p:SetVariable>\n                <L7p:AuditDetailAssertion>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// FINE\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Detail stringValue=\"==> Loaded securePasswords.sorted from system and stored to cache\"/>\n                    <L7p:Level stringValue=\"FINE\"/>\n                </L7p:AuditDetailAssertion>\n                <L7p:assertionComment>\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// Retrieve new list and cache\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:assertionComment>\n            </wsp:All>\n            <wsp:All wsp:Usage=\"Required\">\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"RXJyb3Igd2hlbiBsaXN0aW5nIHNlY3VyZSBwYXNzd29yZHM=\"/>\n                    <L7p:VariableToSet stringValue=\"error.msg\"/>\n                </L7p:SetVariable>\n                <L7p:AuditDetailAssertion>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// WARNING\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Detail stringValue=\"==> Error listing secure passwords in ${policy.name}\"/>\n                    <L7p:Level stringValue=\"WARNING\"/>\n                </L7p:AuditDetailAssertion>\n                <L7p:FalseAssertion/>\n                <L7p:assertionComment>\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// Failure - set ${error.msg}\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:assertionComment>\n            </wsp:All>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Caching logic\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:OneOrMore>\n        <L7p:Regex>\n            <L7p:AssertionComment assertionComment=\"included\">\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Add source attribute to /SecurePasswords element\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:AssertionComment>\n            <L7p:AutoTarget booleanValue=\"false\"/>\n            <L7p:OtherTargetMessageVariable stringValue=\"securePasswords.sorted\"/>\n            <L7p:Regex stringValue=\"&lt;SecurePasswords>\"/>\n            <L7p:Replace booleanValue=\"true\"/>\n            <L7p:Replacement stringValue=\"&lt;SecurePasswords source=&quot;${source}&quot;>\"/>\n            <L7p:Target target=\"OTHER\"/>\n        </L7p:Regex>\n        <L7p:AuditDetailAssertion>\n            <L7p:AssertionComment assertionComment=\"included\">\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// FINE\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:AssertionComment>\n            <L7p:Detail stringValue=\"==> Leaving Utility Fragment: ${policy.name}\"/>\n            <L7p:Level stringValue=\"FINE\"/>\n        </L7p:AuditDetailAssertion>\n    </wsp:All>\n</wsp:Policy>\n"
        }
      ]
    },
    {
      "guid": "485cd1ad-9ef9-4705-9424-d463f2bb39d4",
      "name": "Utility: List Services",
      "policyType": "FRAGMENT",
      "checksum": "82e68f5526a0bb417577cbbd989799f0402e8fdf",
      "folderPath": "/Gateway Management Utilities/fragments",
      "soap": false,
      "policy": {
        "xml": "<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<wsp:Policy xmlns:L7p=\"http://www.layer7tech.com/ws/policy\" xmlns:wsp=\"http://schemas.xmlsoap.org/ws/2002/12/policy\">\n    <wsp:All wsp:Usage=\"Required\">\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Policy fragment for &quot;Utility: List Services&quot; encapsulated assertion\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Call Restman and generate a sorted list of services\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** - Assumes an admin role user has been authenticated\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** - Caches results for ${cacheAge} seconds (default=300). To refresh the cache set ${refresh}=true when calling\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** - Returns a text/xml message variable in ${services.sorted}\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Set ${folderId} to isolate listing to a single folder, else list all services\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Inputs:\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - folderId (string)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - refresh (string)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - cacheAge (string)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Outputs:\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - services.sorted (message)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - error.msg (string)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** v1.0.0 - Jay MacDonald - 20201107 - Initial Version\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n        </L7p:CommentAssertion>\n        <L7p:AuditDetailAssertion>\n            <L7p:AssertionComment assertionComment=\"included\">\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// FINE\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:AssertionComment>\n            <L7p:Detail stringValue=\"==> Entering Utility Fragment: ${policy.name} (refresh=${refresh})\"/>\n            <L7p:Level stringValue=\"FINE\"/>\n        </L7p:AuditDetailAssertion>\n        <wsp:All wsp:Usage=\"Required\">\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** ${services.sorted} has the following schema:\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** \"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** &lt;Services source=&quot;cache|system&quot;>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   &lt;Service id=&quot;string&quot; folderId=&quot;string&quot;>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**     &lt;Name>string&lt;/Name>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**     &lt;ServiceState>string&lt;/ServiceState>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**     &lt;ServicePath>string&lt;/ServicePath>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**     &lt;FolderPath>string&lt;/FolderPath>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**     &lt;FullPath>string&lt;/FullPath>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   &lt;/Service>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   ...\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** &lt;/Services>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n            </L7p:CommentAssertion>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Description of ${services.sorted}\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:All>\n        <wsp:OneOrMore wsp:Usage=\"Required\">\n            <L7p:ComparisonAssertion>\n                <L7p:AssertionComment assertionComment=\"included\">\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// true or false\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:AssertionComment>\n                <L7p:CaseSensitive booleanValue=\"false\"/>\n                <L7p:Expression1 stringValue=\"${cacheAge}\"/>\n                <L7p:Operator operatorNull=\"null\"/>\n                <L7p:Predicates predicates=\"included\">\n                    <L7p:item dataType=\"included\">\n                        <L7p:Type variableDataType=\"int\"/>\n                    </L7p:item>\n                    <L7p:item binary=\"included\">\n                        <L7p:CaseSensitive booleanValue=\"false\"/>\n                        <L7p:Operator operator=\"GT\"/>\n                        <L7p:RightValue stringValue=\"0\"/>\n                    </L7p:item>\n                </L7p:Predicates>\n            </L7p:ComparisonAssertion>\n            <L7p:SetVariable>\n                <L7p:Base64Expression stringValue=\"MzAw\"/>\n                <L7p:DataType variableDataType=\"int\"/>\n                <L7p:VariableToSet stringValue=\"cacheAge\"/>\n            </L7p:SetVariable>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Ensure ${cacheAge} is set, default=300\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:OneOrMore>\n        <wsp:OneOrMore wsp:Usage=\"Required\">\n            <L7p:ComparisonAssertion>\n                <L7p:CaseSensitive booleanValue=\"false\"/>\n                <L7p:Expression1 stringValue=\"${folderId}\"/>\n                <L7p:Expression2 stringValue=\"0\"/>\n                <L7p:Negate booleanValue=\"true\"/>\n                <L7p:Operator operator=\"EMPTY\"/>\n                <L7p:Predicates predicates=\"included\">\n                    <L7p:item binary=\"included\">\n                        <L7p:CaseSensitive booleanValue=\"false\"/>\n                        <L7p:Negated booleanValue=\"true\"/>\n                        <L7p:Operator operator=\"EMPTY\"/>\n                        <L7p:RightValue stringValue=\"0\"/>\n                    </L7p:item>\n                </L7p:Predicates>\n            </L7p:ComparisonAssertion>\n            <L7p:SetVariable>\n                <L7p:AssertionComment assertionComment=\"included\">\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// 0 means report all services\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:AssertionComment>\n                <L7p:Base64Expression stringValue=\"MA==\"/>\n                <L7p:VariableToSet stringValue=\"folderId\"/>\n            </L7p:SetVariable>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Set default ${folderId}=0 (all)\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:OneOrMore>\n        <wsp:OneOrMore wsp:Usage=\"Required\">\n            <L7p:ComparisonAssertion>\n                <L7p:AssertionComment assertionComment=\"included\">\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// true or false\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:AssertionComment>\n                <L7p:CaseSensitive booleanValue=\"false\"/>\n                <L7p:Expression1 stringValue=\"${refresh}\"/>\n                <L7p:Operator operatorNull=\"null\"/>\n                <L7p:Predicates predicates=\"included\">\n                    <L7p:item dataType=\"included\">\n                        <L7p:Type variableDataType=\"string\"/>\n                    </L7p:item>\n                    <L7p:item regex=\"included\">\n                        <L7p:Pattern stringValue=\"^(true|false)$\"/>\n                    </L7p:item>\n                </L7p:Predicates>\n            </L7p:ComparisonAssertion>\n            <L7p:SetVariable>\n                <L7p:Base64Expression stringValue=\"ZmFsc2U=\"/>\n                <L7p:VariableToSet stringValue=\"refresh\"/>\n            </L7p:SetVariable>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Ensure ${refresh} is set, default=false\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:OneOrMore>\n        <L7p:SetVariable>\n            <L7p:Base64Expression stringValue=\"c2VydmljZXMuc29ydGVkLSR7Zm9sZGVySWR9\"/>\n            <L7p:VariableToSet stringValue=\"cacheKey\"/>\n        </L7p:SetVariable>\n        <wsp:OneOrMore wsp:Usage=\"Required\">\n            <wsp:All wsp:Usage=\"Required\">\n                <L7p:ComparisonAssertion>\n                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                    <L7p:Expression1 stringValue=\"${refresh}\"/>\n                    <L7p:Operator operatorNull=\"null\"/>\n                    <L7p:Predicates predicates=\"included\">\n                        <L7p:item dataType=\"included\">\n                            <L7p:Type variableDataType=\"string\"/>\n                        </L7p:item>\n                        <L7p:item binary=\"included\">\n                            <L7p:Negated booleanValue=\"true\"/>\n                            <L7p:RightValue stringValue=\"true\"/>\n                        </L7p:item>\n                    </L7p:Predicates>\n                </L7p:ComparisonAssertion>\n                <L7p:CacheLookup>\n                    <L7p:CacheEntryKey stringValue=\"${cacheKey}\"/>\n                    <L7p:CacheId stringValue=\"serviceList\"/>\n                    <L7p:ContentTypeOverride stringValue=\"\"/>\n                    <L7p:MaxEntryAgeSeconds stringValue=\"${cacheAge}\"/>\n                    <L7p:OtherTargetMessageVariable stringValue=\"services.sorted\"/>\n                    <L7p:Target target=\"OTHER\"/>\n                </L7p:CacheLookup>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"Y2FjaGU=\"/>\n                    <L7p:VariableToSet stringValue=\"source\"/>\n                </L7p:SetVariable>\n                <L7p:AuditDetailAssertion>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// FINE\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Detail stringValue=\"==> Found services.sorted in the cache\"/>\n                    <L7p:Level stringValue=\"FINE\"/>\n                </L7p:AuditDetailAssertion>\n                <L7p:assertionComment>\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// Look in cache unless asked to refresh cache\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:assertionComment>\n            </wsp:All>\n            <wsp:All wsp:Usage=\"Required\">\n                <L7p:Encapsulated>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// Want this for full folder paths when reporting\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:EncapsulatedAssertionConfigGuid stringValue=\"fbb4b1d3-54a5-4ab4-95af-814267236d17\"/>\n                    <L7p:EncapsulatedAssertionConfigName stringValue=\"Utility: List Folders\"/>\n                    <L7p:Parameters mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"cacheAge\"/>\n                            <L7p:value stringValue=\"${cacheAge}\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"refresh\"/>\n                            <L7p:value stringValue=\"${refresh}\"/>\n                        </L7p:entry>\n                    </L7p:Parameters>\n                </L7p:Encapsulated>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"c2VydmljZXM=\"/>\n                    <L7p:VariableToSet stringValue=\"resource\"/>\n                </L7p:SetVariable>\n                <wsp:OneOrMore wsp:Usage=\"Required\">\n                    <L7p:ComparisonAssertion>\n                        <L7p:CaseSensitive booleanValue=\"false\"/>\n                        <L7p:Expression1 stringValue=\"${folderId}\"/>\n                        <L7p:Expression2 stringValue=\"0\"/>\n                        <L7p:Predicates predicates=\"included\">\n                            <L7p:item binary=\"included\">\n                                <L7p:CaseSensitive booleanValue=\"false\"/>\n                                <L7p:RightValue stringValue=\"0\"/>\n                            </L7p:item>\n                        </L7p:Predicates>\n                    </L7p:ComparisonAssertion>\n                    <L7p:SetVariable>\n                        <L7p:Base64Expression stringValue=\"JHtyZXNvdXJjZX0/cGFyZW50Rm9sZGVyLmlkPSR7Zm9sZGVySWR9\"/>\n                        <L7p:VariableToSet stringValue=\"resource\"/>\n                    </L7p:SetVariable>\n                    <L7p:assertionComment>\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// Append parentFolder.id to ${resource} if set\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:assertionComment>\n                </wsp:OneOrMore>\n                <L7p:Encapsulated>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// GET ${resource}\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:EncapsulatedAssertionConfigGuid stringValue=\"c8a5a0d5-1ae2-4144-b538-5c311efc1560\"/>\n                    <L7p:EncapsulatedAssertionConfigName stringValue=\"Utility: Call Restman\"/>\n                    <L7p:Parameters mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"element\"/>\n                            <L7p:value stringValue=\"Service\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"message\"/>\n                            <L7p:value stringValue=\"\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"method\"/>\n                            <L7p:value stringValue=\"GET\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"resource\"/>\n                            <L7p:value stringValue=\"${resource}\"/>\n                        </L7p:entry>\n                    </L7p:Parameters>\n                </L7p:Encapsulated>\n                <wsp:OneOrMore wsp:Usage=\"Required\">\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:VariablePrefix stringValue=\"services\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/l7:List/l7:Item/l7:Resource/l7:Service\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <L7p:TrueAssertion/>\n                    <L7p:assertionComment>\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// Extract the list of services, never fail\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:assertionComment>\n                </wsp:OneOrMore>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz48U2VydmljZXM+\"/>\n                    <L7p:VariableToSet stringValue=\"services.sorted\"/>\n                </L7p:SetVariable>\n                <L7p:ForEachLoop L7p:Usage=\"Required\"\n                    loopVariable=\"services.elements\" variablePrefix=\"service\">\n                    <L7p:SetVariable>\n                        <L7p:Base64Expression stringValue=\"JHtzZXJ2aWNlLmN1cnJlbnR9\"/>\n                        <L7p:ContentType stringValue=\"text/xml; charset=utf-8\"/>\n                        <L7p:DataType variableDataType=\"message\"/>\n                        <L7p:VariableToSet stringValue=\"service.xml\"/>\n                    </L7p:SetVariable>\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:VariablePrefix stringValue=\"folderId\"/>\n                        <L7p:XmlMsgSrc stringValue=\"service.xml\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/l7:Service/l7:ServiceDetail/@folderId\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"s\"/>\n                                    <L7p:value stringValue=\"http://schemas.xmlsoap.org/soap/envelope/\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <wsp:OneOrMore wsp:Usage=\"Required\">\n                        <L7p:ComparisonAssertion>\n                            <L7p:CaseSensitive booleanValue=\"false\"/>\n                            <L7p:Expression1 stringValue=\"${folderId}\"/>\n                            <L7p:Operator operatorNull=\"null\"/>\n                            <L7p:Predicates predicates=\"included\">\n                                <L7p:item dataType=\"included\">\n                                    <L7p:Type variableDataType=\"int\"/>\n                                </L7p:item>\n                                <L7p:item binary=\"included\">\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:Negated booleanValue=\"true\"/>\n                                    <L7p:RightValue stringValue=\"0\"/>\n                                </L7p:item>\n                                <L7p:item binary=\"included\">\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:Negated booleanValue=\"true\"/>\n                                    <L7p:RightValue stringValue=\"${folderId.result}\"/>\n                                </L7p:item>\n                            </L7p:Predicates>\n                        </L7p:ComparisonAssertion>\n                        <wsp:All wsp:Usage=\"Required\">\n                            <L7p:ResponseXpathAssertion>\n                                <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Get the service's ID\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:AssertionComment>\n                                <L7p:VariablePrefix stringValue=\"id\"/>\n                                <L7p:XmlMsgSrc stringValue=\"service.xml\"/>\n                                <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                    <L7p:Expression stringValue=\"/l7:Service/l7:ServiceDetail/@id\"/>\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"s\"/>\n                                    <L7p:value stringValue=\"http://schemas.xmlsoap.org/soap/envelope/\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                                </L7p:XpathExpression>\n                            </L7p:ResponseXpathAssertion>\n                            <L7p:ResponseXpathAssertion>\n                                <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Get the service's name\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:AssertionComment>\n                                <L7p:VariablePrefix stringValue=\"name\"/>\n                                <L7p:XmlMsgSrc stringValue=\"service.xml\"/>\n                                <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                    <L7p:Expression stringValue=\"/l7:Service/l7:ServiceDetail/l7:Name\"/>\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"s\"/>\n                                    <L7p:value stringValue=\"http://schemas.xmlsoap.org/soap/envelope/\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                                </L7p:XpathExpression>\n                            </L7p:ResponseXpathAssertion>\n                            <wsp:OneOrMore wsp:Usage=\"Required\">\n                                <wsp:All wsp:Usage=\"Required\">\n                                    <L7p:ResponseXpathAssertion>\n                                    <L7p:VariablePrefix stringValue=\"\"/>\n                                    <L7p:XmlMsgSrc stringValue=\"service.xml\"/>\n                                    <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                    <L7p:Expression stringValue=\"/l7:Service/l7:ServiceDetail[l7:Enabled='true']\"/>\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"s\"/>\n                                    <L7p:value stringValue=\"http://schemas.xmlsoap.org/soap/envelope/\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                                    </L7p:XpathExpression>\n                                    </L7p:ResponseXpathAssertion>\n                                    <L7p:SetVariable>\n                                    <L7p:Base64Expression stringValue=\"RW5hYmxlZA==\"/>\n                                    <L7p:VariableToSet stringValue=\"serviceState\"/>\n                                    </L7p:SetVariable>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Test if true\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                </wsp:All>\n                                <L7p:SetVariable>\n                                    <L7p:Base64Expression stringValue=\"RGlzYWJsZWQ=\"/>\n                                    <L7p:VariableToSet stringValue=\"serviceState\"/>\n                                </L7p:SetVariable>\n                                <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Set ${serviceState} from value of Enabled element\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:assertionComment>\n                            </wsp:OneOrMore>\n                            <wsp:OneOrMore wsp:Usage=\"Required\">\n                                <wsp:All wsp:Usage=\"Required\">\n                                    <L7p:ResponseXpathAssertion>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Get the service's path\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:VariablePrefix stringValue=\"servicePath\"/>\n                                    <L7p:XmlMsgSrc stringValue=\"service.xml\"/>\n                                    <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                    <L7p:Expression stringValue=\"/l7:Service/l7:ServiceDetail/l7:ServiceMappings/l7:HttpMapping/l7:UrlPattern\"/>\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"s\"/>\n                                    <L7p:value stringValue=\"http://schemas.xmlsoap.org/soap/envelope/\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                                    </L7p:XpathExpression>\n                                    </L7p:ResponseXpathAssertion>\n                                    <L7p:SetVariable>\n                                    <L7p:Base64Expression stringValue=\"JHtzZXJ2aWNlUGF0aC5yZXN1bHR9\"/>\n                                    <L7p:VariableToSet stringValue=\"servicePath\"/>\n                                    </L7p:SetVariable>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// UrlPattern is defined\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                </wsp:All>\n                                <wsp:All wsp:Usage=\"Required\">\n                                    <L7p:ResponseXpathAssertion>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Get the service's path\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:VariablePrefix stringValue=\"\"/>\n                                    <L7p:XmlMsgSrc stringValue=\"service.xml\"/>\n                                    <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                    <L7p:Expression stringValue=\"/l7:Service/l7:ServiceDetail/l7:ServiceMappings/l7:HttpMapping\"/>\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"s\"/>\n                                    <L7p:value stringValue=\"http://schemas.xmlsoap.org/soap/envelope/\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                                    </L7p:XpathExpression>\n                                    </L7p:ResponseXpathAssertion>\n                                    <L7p:SetVariable>\n                                    <L7p:Base64Expression stringValue=\"L3NzZy9zb2Fw\"/>\n                                    <L7p:VariableToSet stringValue=\"servicePath\"/>\n                                    </L7p:SetVariable>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// No UrlPattern, check that HttpMapping is set and set to /ssg/soap\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                </wsp:All>\n                                <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Get path. If no UrlPattern is defined then it is at /ssg/soap\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:assertionComment>\n                            </wsp:OneOrMore>\n                            <L7p:ResponseXpathAssertion>\n                                <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Get the folder path for the policy\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:AssertionComment>\n                                <L7p:VariablePrefix stringValue=\"folderPath\"/>\n                                <L7p:XmlMsgSrc stringValue=\"folders.sorted\"/>\n                                <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                    <L7p:Expression stringValue=\"/Folders/Folder[@id=$folderId.result]/FolderPath\"/>\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"s\"/>\n                                    <L7p:value stringValue=\"http://schemas.xmlsoap.org/soap/envelope/\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                                </L7p:XpathExpression>\n                            </L7p:ResponseXpathAssertion>\n                            <L7p:SetVariable>\n                                <L7p:Base64Expression stringValue=\"JHtzZXJ2aWNlcy5zb3J0ZWR9PFNlcnZpY2UgaWQ9IiR7aWQucmVzdWx0fSIgZm9sZGVySWQ9IiR7Zm9sZGVySWQucmVzdWx0fSI+PE5hbWU+PCFbQ0RBVEFbJHtuYW1lLnJlc3VsdH1dXT48L05hbWU+PFNlcnZpY2VTdGF0ZT4ke3NlcnZpY2VTdGF0ZX08L1NlcnZpY2VTdGF0ZT48U2VydmljZVBhdGg+JHtzZXJ2aWNlUGF0aC5yZXN1bHR9PC9TZXJ2aWNlUGF0aD48Rm9sZGVyUGF0aD48IVtDREFUQVske2ZvbGRlclBhdGgucmVzdWx0fV1dPjwvRm9sZGVyUGF0aD48RnVsbFBhdGg+PCFbQ0RBVEFbJHtmb2xkZXJQYXRoLnJlc3VsdH0ke25hbWUucmVzdWx0fV1dPjwvRnVsbFBhdGg+PC9TZXJ2aWNlPg==\"/>\n                                <L7p:VariableToSet stringValue=\"services.sorted\"/>\n                            </L7p:SetVariable>\n                            <L7p:assertionComment>\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Process it\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:assertionComment>\n                        </wsp:All>\n                        <L7p:assertionComment>\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Only process if ${folderId} = 0 or matches ${folderId.result}\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:assertionComment>\n                    </wsp:OneOrMore>\n                </L7p:ForEachLoop>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"JHtzZXJ2aWNlcy5zb3J0ZWR9PC9TZXJ2aWNlcz4=\"/>\n                    <L7p:ContentType stringValue=\"text/xml; charset=utf-8\"/>\n                    <L7p:DataType variableDataType=\"message\"/>\n                    <L7p:VariableToSet stringValue=\"services.sorted\"/>\n                </L7p:SetVariable>\n                <L7p:XslTransformation>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// Sort the folders by display path\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Direction intValue=\"-1\"/>\n                    <L7p:OtherTargetMessageVariable stringValue=\"services.sorted\"/>\n                    <L7p:ResourceInfo staticResourceInfo=\"included\">\n                        <L7p:Document stringValue=\"&lt;xsl:stylesheet version=&quot;1.0&quot; xmlns:l7=&quot;http://ns.l7tech.com/2010/04/gateway-management&quot; xmlns:xsl=&quot;http://www.w3.org/1999/XSL/Transform&quot;>&lt;xsl:template match=&quot;/Services&quot;>    &lt;xsl:copy>        &lt;xsl:for-each select=&quot;Service&quot;>            &lt;xsl:sort select=&quot;./FolderPath&quot;/>            &lt;xsl:sort select=&quot;./Name&quot;/>            &lt;xsl:copy-of select=&quot;.&quot;/>        &lt;/xsl:for-each>    &lt;/xsl:copy>&lt;/xsl:template>&lt;/xsl:stylesheet>\"/>\n                    </L7p:ResourceInfo>\n                    <L7p:Target target=\"OTHER\"/>\n                    <L7p:TransformName stringValue=\"\"/>\n                    <L7p:XsltVersion stringValue=\"1.0\"/>\n                </L7p:XslTransformation>\n                <L7p:CacheStorage>\n                    <L7p:CacheEntryKey stringValue=\"${cacheKey}\"/>\n                    <L7p:CacheId stringValue=\"serviceList\"/>\n                    <L7p:MaxEntryAgeSeconds stringValue=\"${cacheAge}\"/>\n                    <L7p:MaxEntrySizeBytes stringValue=\"100000\"/>\n                    <L7p:OtherTargetMessageVariable stringValue=\"services.sorted\"/>\n                    <L7p:StoreSoapFaults booleanValue=\"true\"/>\n                    <L7p:Target target=\"OTHER\"/>\n                </L7p:CacheStorage>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"c3lzdGVt\"/>\n                    <L7p:VariableToSet stringValue=\"source\"/>\n                </L7p:SetVariable>\n                <L7p:AuditDetailAssertion>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// FINE\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Detail stringValue=\"==> Loaded services.sorted from system and stored to cache\"/>\n                    <L7p:Level stringValue=\"FINE\"/>\n                </L7p:AuditDetailAssertion>\n                <L7p:assertionComment>\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// Retrieve new list and cache\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:assertionComment>\n            </wsp:All>\n            <wsp:All wsp:Usage=\"Required\">\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"RXJyb3Igd2hlbiBsaXN0aW5nIHNlcnZpY2Vz\"/>\n                    <L7p:VariableToSet stringValue=\"error.msg\"/>\n                </L7p:SetVariable>\n                <L7p:AuditDetailAssertion>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// WARNING\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Detail stringValue=\"==> Error listing services in ${policy.name}\"/>\n                    <L7p:Level stringValue=\"WARNING\"/>\n                </L7p:AuditDetailAssertion>\n                <L7p:FalseAssertion/>\n                <L7p:assertionComment>\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// Failure - set ${error.msg}\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:assertionComment>\n            </wsp:All>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Caching logic\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:OneOrMore>\n        <L7p:Regex>\n            <L7p:AssertionComment assertionComment=\"included\">\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Add source attribute to /Services element\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:AssertionComment>\n            <L7p:AutoTarget booleanValue=\"false\"/>\n            <L7p:OtherTargetMessageVariable stringValue=\"services.sorted\"/>\n            <L7p:Regex stringValue=\"&lt;Services>\"/>\n            <L7p:Replace booleanValue=\"true\"/>\n            <L7p:Replacement stringValue=\"&lt;Services source=&quot;${source}&quot;>\"/>\n            <L7p:Target target=\"OTHER\"/>\n        </L7p:Regex>\n        <L7p:AuditDetailAssertion>\n            <L7p:AssertionComment assertionComment=\"included\">\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// FINE\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:AssertionComment>\n            <L7p:Detail stringValue=\"==> Leaving Utility Fragment: ${policy.name}\"/>\n            <L7p:Level stringValue=\"FINE\"/>\n        </L7p:AuditDetailAssertion>\n    </wsp:All>\n</wsp:Policy>\n"
      },
      "policyRevisions": [
        {
          "goid": "bed4baf4ff33b7e528854c3965d9bb64",
          "ordinal": 1,
          "active": true,
          "author": "admin",
          "time": "2025-02-05T14:20:38.627Z",
          "xml": "<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<wsp:Policy xmlns:L7p=\"http://www.layer7tech.com/ws/policy\" xmlns:wsp=\"http://schemas.xmlsoap.org/ws/2002/12/policy\">\n    <wsp:All wsp:Usage=\"Required\">\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Policy fragment for &quot;Utility: List Services&quot; encapsulated assertion\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Call Restman and generate a sorted list of services\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** - Assumes an admin role user has been authenticated\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** - Caches results for ${cacheAge} seconds (default=300). To refresh the cache set ${refresh}=true when calling\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** - Returns a text/xml message variable in ${services.sorted}\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Set ${folderId} to isolate listing to a single folder, else list all services\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Inputs:\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - folderId (string)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - refresh (string)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - cacheAge (string)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Outputs:\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - services.sorted (message)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - error.msg (string)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** v1.0.0 - Jay MacDonald - 20201107 - Initial Version\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n        </L7p:CommentAssertion>\n        <L7p:AuditDetailAssertion>\n            <L7p:AssertionComment assertionComment=\"included\">\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// FINE\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:AssertionComment>\n            <L7p:Detail stringValue=\"==> Entering Utility Fragment: ${policy.name} (refresh=${refresh})\"/>\n            <L7p:Level stringValue=\"FINE\"/>\n        </L7p:AuditDetailAssertion>\n        <wsp:All wsp:Usage=\"Required\">\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** ${services.sorted} has the following schema:\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** \"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** &lt;Services source=&quot;cache|system&quot;>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   &lt;Service id=&quot;string&quot; folderId=&quot;string&quot;>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**     &lt;Name>string&lt;/Name>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**     &lt;ServiceState>string&lt;/ServiceState>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**     &lt;ServicePath>string&lt;/ServicePath>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**     &lt;FolderPath>string&lt;/FolderPath>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**     &lt;FullPath>string&lt;/FullPath>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   &lt;/Service>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   ...\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** &lt;/Services>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n            </L7p:CommentAssertion>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Description of ${services.sorted}\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:All>\n        <wsp:OneOrMore wsp:Usage=\"Required\">\n            <L7p:ComparisonAssertion>\n                <L7p:AssertionComment assertionComment=\"included\">\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// true or false\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:AssertionComment>\n                <L7p:CaseSensitive booleanValue=\"false\"/>\n                <L7p:Expression1 stringValue=\"${cacheAge}\"/>\n                <L7p:Operator operatorNull=\"null\"/>\n                <L7p:Predicates predicates=\"included\">\n                    <L7p:item dataType=\"included\">\n                        <L7p:Type variableDataType=\"int\"/>\n                    </L7p:item>\n                    <L7p:item binary=\"included\">\n                        <L7p:CaseSensitive booleanValue=\"false\"/>\n                        <L7p:Operator operator=\"GT\"/>\n                        <L7p:RightValue stringValue=\"0\"/>\n                    </L7p:item>\n                </L7p:Predicates>\n            </L7p:ComparisonAssertion>\n            <L7p:SetVariable>\n                <L7p:Base64Expression stringValue=\"MzAw\"/>\n                <L7p:DataType variableDataType=\"int\"/>\n                <L7p:VariableToSet stringValue=\"cacheAge\"/>\n            </L7p:SetVariable>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Ensure ${cacheAge} is set, default=300\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:OneOrMore>\n        <wsp:OneOrMore wsp:Usage=\"Required\">\n            <L7p:ComparisonAssertion>\n                <L7p:CaseSensitive booleanValue=\"false\"/>\n                <L7p:Expression1 stringValue=\"${folderId}\"/>\n                <L7p:Expression2 stringValue=\"0\"/>\n                <L7p:Negate booleanValue=\"true\"/>\n                <L7p:Operator operator=\"EMPTY\"/>\n                <L7p:Predicates predicates=\"included\">\n                    <L7p:item binary=\"included\">\n                        <L7p:CaseSensitive booleanValue=\"false\"/>\n                        <L7p:Negated booleanValue=\"true\"/>\n                        <L7p:Operator operator=\"EMPTY\"/>\n                        <L7p:RightValue stringValue=\"0\"/>\n                    </L7p:item>\n                </L7p:Predicates>\n            </L7p:ComparisonAssertion>\n            <L7p:SetVariable>\n                <L7p:AssertionComment assertionComment=\"included\">\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// 0 means report all services\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:AssertionComment>\n                <L7p:Base64Expression stringValue=\"MA==\"/>\n                <L7p:VariableToSet stringValue=\"folderId\"/>\n            </L7p:SetVariable>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Set default ${folderId}=0 (all)\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:OneOrMore>\n        <wsp:OneOrMore wsp:Usage=\"Required\">\n            <L7p:ComparisonAssertion>\n                <L7p:AssertionComment assertionComment=\"included\">\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// true or false\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:AssertionComment>\n                <L7p:CaseSensitive booleanValue=\"false\"/>\n                <L7p:Expression1 stringValue=\"${refresh}\"/>\n                <L7p:Operator operatorNull=\"null\"/>\n                <L7p:Predicates predicates=\"included\">\n                    <L7p:item dataType=\"included\">\n                        <L7p:Type variableDataType=\"string\"/>\n                    </L7p:item>\n                    <L7p:item regex=\"included\">\n                        <L7p:Pattern stringValue=\"^(true|false)$\"/>\n                    </L7p:item>\n                </L7p:Predicates>\n            </L7p:ComparisonAssertion>\n            <L7p:SetVariable>\n                <L7p:Base64Expression stringValue=\"ZmFsc2U=\"/>\n                <L7p:VariableToSet stringValue=\"refresh\"/>\n            </L7p:SetVariable>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Ensure ${refresh} is set, default=false\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:OneOrMore>\n        <L7p:SetVariable>\n            <L7p:Base64Expression stringValue=\"c2VydmljZXMuc29ydGVkLSR7Zm9sZGVySWR9\"/>\n            <L7p:VariableToSet stringValue=\"cacheKey\"/>\n        </L7p:SetVariable>\n        <wsp:OneOrMore wsp:Usage=\"Required\">\n            <wsp:All wsp:Usage=\"Required\">\n                <L7p:ComparisonAssertion>\n                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                    <L7p:Expression1 stringValue=\"${refresh}\"/>\n                    <L7p:Operator operatorNull=\"null\"/>\n                    <L7p:Predicates predicates=\"included\">\n                        <L7p:item dataType=\"included\">\n                            <L7p:Type variableDataType=\"string\"/>\n                        </L7p:item>\n                        <L7p:item binary=\"included\">\n                            <L7p:Negated booleanValue=\"true\"/>\n                            <L7p:RightValue stringValue=\"true\"/>\n                        </L7p:item>\n                    </L7p:Predicates>\n                </L7p:ComparisonAssertion>\n                <L7p:CacheLookup>\n                    <L7p:CacheEntryKey stringValue=\"${cacheKey}\"/>\n                    <L7p:CacheId stringValue=\"serviceList\"/>\n                    <L7p:ContentTypeOverride stringValue=\"\"/>\n                    <L7p:MaxEntryAgeSeconds stringValue=\"${cacheAge}\"/>\n                    <L7p:OtherTargetMessageVariable stringValue=\"services.sorted\"/>\n                    <L7p:Target target=\"OTHER\"/>\n                </L7p:CacheLookup>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"Y2FjaGU=\"/>\n                    <L7p:VariableToSet stringValue=\"source\"/>\n                </L7p:SetVariable>\n                <L7p:AuditDetailAssertion>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// FINE\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Detail stringValue=\"==> Found services.sorted in the cache\"/>\n                    <L7p:Level stringValue=\"FINE\"/>\n                </L7p:AuditDetailAssertion>\n                <L7p:assertionComment>\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// Look in cache unless asked to refresh cache\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:assertionComment>\n            </wsp:All>\n            <wsp:All wsp:Usage=\"Required\">\n                <L7p:Encapsulated>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// Want this for full folder paths when reporting\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:EncapsulatedAssertionConfigGuid stringValue=\"fbb4b1d3-54a5-4ab4-95af-814267236d17\"/>\n                    <L7p:EncapsulatedAssertionConfigName stringValue=\"Utility: List Folders\"/>\n                    <L7p:Parameters mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"cacheAge\"/>\n                            <L7p:value stringValue=\"${cacheAge}\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"refresh\"/>\n                            <L7p:value stringValue=\"${refresh}\"/>\n                        </L7p:entry>\n                    </L7p:Parameters>\n                </L7p:Encapsulated>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"c2VydmljZXM=\"/>\n                    <L7p:VariableToSet stringValue=\"resource\"/>\n                </L7p:SetVariable>\n                <wsp:OneOrMore wsp:Usage=\"Required\">\n                    <L7p:ComparisonAssertion>\n                        <L7p:CaseSensitive booleanValue=\"false\"/>\n                        <L7p:Expression1 stringValue=\"${folderId}\"/>\n                        <L7p:Expression2 stringValue=\"0\"/>\n                        <L7p:Predicates predicates=\"included\">\n                            <L7p:item binary=\"included\">\n                                <L7p:CaseSensitive booleanValue=\"false\"/>\n                                <L7p:RightValue stringValue=\"0\"/>\n                            </L7p:item>\n                        </L7p:Predicates>\n                    </L7p:ComparisonAssertion>\n                    <L7p:SetVariable>\n                        <L7p:Base64Expression stringValue=\"JHtyZXNvdXJjZX0/cGFyZW50Rm9sZGVyLmlkPSR7Zm9sZGVySWR9\"/>\n                        <L7p:VariableToSet stringValue=\"resource\"/>\n                    </L7p:SetVariable>\n                    <L7p:assertionComment>\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// Append parentFolder.id to ${resource} if set\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:assertionComment>\n                </wsp:OneOrMore>\n                <L7p:Encapsulated>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// GET ${resource}\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:EncapsulatedAssertionConfigGuid stringValue=\"c8a5a0d5-1ae2-4144-b538-5c311efc1560\"/>\n                    <L7p:EncapsulatedAssertionConfigName stringValue=\"Utility: Call Restman\"/>\n                    <L7p:Parameters mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"element\"/>\n                            <L7p:value stringValue=\"Service\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"message\"/>\n                            <L7p:value stringValue=\"\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"method\"/>\n                            <L7p:value stringValue=\"GET\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"resource\"/>\n                            <L7p:value stringValue=\"${resource}\"/>\n                        </L7p:entry>\n                    </L7p:Parameters>\n                </L7p:Encapsulated>\n                <wsp:OneOrMore wsp:Usage=\"Required\">\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:VariablePrefix stringValue=\"services\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/l7:List/l7:Item/l7:Resource/l7:Service\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <L7p:TrueAssertion/>\n                    <L7p:assertionComment>\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// Extract the list of services, never fail\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:assertionComment>\n                </wsp:OneOrMore>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz48U2VydmljZXM+\"/>\n                    <L7p:VariableToSet stringValue=\"services.sorted\"/>\n                </L7p:SetVariable>\n                <L7p:ForEachLoop L7p:Usage=\"Required\"\n                    loopVariable=\"services.elements\" variablePrefix=\"service\">\n                    <L7p:SetVariable>\n                        <L7p:Base64Expression stringValue=\"JHtzZXJ2aWNlLmN1cnJlbnR9\"/>\n                        <L7p:ContentType stringValue=\"text/xml; charset=utf-8\"/>\n                        <L7p:DataType variableDataType=\"message\"/>\n                        <L7p:VariableToSet stringValue=\"service.xml\"/>\n                    </L7p:SetVariable>\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:VariablePrefix stringValue=\"folderId\"/>\n                        <L7p:XmlMsgSrc stringValue=\"service.xml\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/l7:Service/l7:ServiceDetail/@folderId\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"s\"/>\n                                    <L7p:value stringValue=\"http://schemas.xmlsoap.org/soap/envelope/\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <wsp:OneOrMore wsp:Usage=\"Required\">\n                        <L7p:ComparisonAssertion>\n                            <L7p:CaseSensitive booleanValue=\"false\"/>\n                            <L7p:Expression1 stringValue=\"${folderId}\"/>\n                            <L7p:Operator operatorNull=\"null\"/>\n                            <L7p:Predicates predicates=\"included\">\n                                <L7p:item dataType=\"included\">\n                                    <L7p:Type variableDataType=\"int\"/>\n                                </L7p:item>\n                                <L7p:item binary=\"included\">\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:Negated booleanValue=\"true\"/>\n                                    <L7p:RightValue stringValue=\"0\"/>\n                                </L7p:item>\n                                <L7p:item binary=\"included\">\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:Negated booleanValue=\"true\"/>\n                                    <L7p:RightValue stringValue=\"${folderId.result}\"/>\n                                </L7p:item>\n                            </L7p:Predicates>\n                        </L7p:ComparisonAssertion>\n                        <wsp:All wsp:Usage=\"Required\">\n                            <L7p:ResponseXpathAssertion>\n                                <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Get the service's ID\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:AssertionComment>\n                                <L7p:VariablePrefix stringValue=\"id\"/>\n                                <L7p:XmlMsgSrc stringValue=\"service.xml\"/>\n                                <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                    <L7p:Expression stringValue=\"/l7:Service/l7:ServiceDetail/@id\"/>\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"s\"/>\n                                    <L7p:value stringValue=\"http://schemas.xmlsoap.org/soap/envelope/\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                                </L7p:XpathExpression>\n                            </L7p:ResponseXpathAssertion>\n                            <L7p:ResponseXpathAssertion>\n                                <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Get the service's name\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:AssertionComment>\n                                <L7p:VariablePrefix stringValue=\"name\"/>\n                                <L7p:XmlMsgSrc stringValue=\"service.xml\"/>\n                                <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                    <L7p:Expression stringValue=\"/l7:Service/l7:ServiceDetail/l7:Name\"/>\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"s\"/>\n                                    <L7p:value stringValue=\"http://schemas.xmlsoap.org/soap/envelope/\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                                </L7p:XpathExpression>\n                            </L7p:ResponseXpathAssertion>\n                            <wsp:OneOrMore wsp:Usage=\"Required\">\n                                <wsp:All wsp:Usage=\"Required\">\n                                    <L7p:ResponseXpathAssertion>\n                                    <L7p:VariablePrefix stringValue=\"\"/>\n                                    <L7p:XmlMsgSrc stringValue=\"service.xml\"/>\n                                    <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                    <L7p:Expression stringValue=\"/l7:Service/l7:ServiceDetail[l7:Enabled='true']\"/>\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"s\"/>\n                                    <L7p:value stringValue=\"http://schemas.xmlsoap.org/soap/envelope/\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                                    </L7p:XpathExpression>\n                                    </L7p:ResponseXpathAssertion>\n                                    <L7p:SetVariable>\n                                    <L7p:Base64Expression stringValue=\"RW5hYmxlZA==\"/>\n                                    <L7p:VariableToSet stringValue=\"serviceState\"/>\n                                    </L7p:SetVariable>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Test if true\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                </wsp:All>\n                                <L7p:SetVariable>\n                                    <L7p:Base64Expression stringValue=\"RGlzYWJsZWQ=\"/>\n                                    <L7p:VariableToSet stringValue=\"serviceState\"/>\n                                </L7p:SetVariable>\n                                <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Set ${serviceState} from value of Enabled element\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:assertionComment>\n                            </wsp:OneOrMore>\n                            <wsp:OneOrMore wsp:Usage=\"Required\">\n                                <wsp:All wsp:Usage=\"Required\">\n                                    <L7p:ResponseXpathAssertion>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Get the service's path\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:VariablePrefix stringValue=\"servicePath\"/>\n                                    <L7p:XmlMsgSrc stringValue=\"service.xml\"/>\n                                    <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                    <L7p:Expression stringValue=\"/l7:Service/l7:ServiceDetail/l7:ServiceMappings/l7:HttpMapping/l7:UrlPattern\"/>\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"s\"/>\n                                    <L7p:value stringValue=\"http://schemas.xmlsoap.org/soap/envelope/\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                                    </L7p:XpathExpression>\n                                    </L7p:ResponseXpathAssertion>\n                                    <L7p:SetVariable>\n                                    <L7p:Base64Expression stringValue=\"JHtzZXJ2aWNlUGF0aC5yZXN1bHR9\"/>\n                                    <L7p:VariableToSet stringValue=\"servicePath\"/>\n                                    </L7p:SetVariable>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// UrlPattern is defined\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                </wsp:All>\n                                <wsp:All wsp:Usage=\"Required\">\n                                    <L7p:ResponseXpathAssertion>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Get the service's path\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:VariablePrefix stringValue=\"\"/>\n                                    <L7p:XmlMsgSrc stringValue=\"service.xml\"/>\n                                    <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                    <L7p:Expression stringValue=\"/l7:Service/l7:ServiceDetail/l7:ServiceMappings/l7:HttpMapping\"/>\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"s\"/>\n                                    <L7p:value stringValue=\"http://schemas.xmlsoap.org/soap/envelope/\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                                    </L7p:XpathExpression>\n                                    </L7p:ResponseXpathAssertion>\n                                    <L7p:SetVariable>\n                                    <L7p:Base64Expression stringValue=\"L3NzZy9zb2Fw\"/>\n                                    <L7p:VariableToSet stringValue=\"servicePath\"/>\n                                    </L7p:SetVariable>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// No UrlPattern, check that HttpMapping is set and set to /ssg/soap\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                </wsp:All>\n                                <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Get path. If no UrlPattern is defined then it is at /ssg/soap\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:assertionComment>\n                            </wsp:OneOrMore>\n                            <L7p:ResponseXpathAssertion>\n                                <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Get the folder path for the policy\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:AssertionComment>\n                                <L7p:VariablePrefix stringValue=\"folderPath\"/>\n                                <L7p:XmlMsgSrc stringValue=\"folders.sorted\"/>\n                                <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                    <L7p:Expression stringValue=\"/Folders/Folder[@id=$folderId.result]/FolderPath\"/>\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"s\"/>\n                                    <L7p:value stringValue=\"http://schemas.xmlsoap.org/soap/envelope/\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                                </L7p:XpathExpression>\n                            </L7p:ResponseXpathAssertion>\n                            <L7p:SetVariable>\n                                <L7p:Base64Expression stringValue=\"JHtzZXJ2aWNlcy5zb3J0ZWR9PFNlcnZpY2UgaWQ9IiR7aWQucmVzdWx0fSIgZm9sZGVySWQ9IiR7Zm9sZGVySWQucmVzdWx0fSI+PE5hbWU+PCFbQ0RBVEFbJHtuYW1lLnJlc3VsdH1dXT48L05hbWU+PFNlcnZpY2VTdGF0ZT4ke3NlcnZpY2VTdGF0ZX08L1NlcnZpY2VTdGF0ZT48U2VydmljZVBhdGg+JHtzZXJ2aWNlUGF0aC5yZXN1bHR9PC9TZXJ2aWNlUGF0aD48Rm9sZGVyUGF0aD48IVtDREFUQVske2ZvbGRlclBhdGgucmVzdWx0fV1dPjwvRm9sZGVyUGF0aD48RnVsbFBhdGg+PCFbQ0RBVEFbJHtmb2xkZXJQYXRoLnJlc3VsdH0ke25hbWUucmVzdWx0fV1dPjwvRnVsbFBhdGg+PC9TZXJ2aWNlPg==\"/>\n                                <L7p:VariableToSet stringValue=\"services.sorted\"/>\n                            </L7p:SetVariable>\n                            <L7p:assertionComment>\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Process it\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:assertionComment>\n                        </wsp:All>\n                        <L7p:assertionComment>\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Only process if ${folderId} = 0 or matches ${folderId.result}\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:assertionComment>\n                    </wsp:OneOrMore>\n                </L7p:ForEachLoop>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"JHtzZXJ2aWNlcy5zb3J0ZWR9PC9TZXJ2aWNlcz4=\"/>\n                    <L7p:ContentType stringValue=\"text/xml; charset=utf-8\"/>\n                    <L7p:DataType variableDataType=\"message\"/>\n                    <L7p:VariableToSet stringValue=\"services.sorted\"/>\n                </L7p:SetVariable>\n                <L7p:XslTransformation>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// Sort the folders by display path\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Direction intValue=\"-1\"/>\n                    <L7p:OtherTargetMessageVariable stringValue=\"services.sorted\"/>\n                    <L7p:ResourceInfo staticResourceInfo=\"included\">\n                        <L7p:Document stringValue=\"&lt;xsl:stylesheet version=&quot;1.0&quot; xmlns:l7=&quot;http://ns.l7tech.com/2010/04/gateway-management&quot; xmlns:xsl=&quot;http://www.w3.org/1999/XSL/Transform&quot;>&lt;xsl:template match=&quot;/Services&quot;>    &lt;xsl:copy>        &lt;xsl:for-each select=&quot;Service&quot;>            &lt;xsl:sort select=&quot;./FolderPath&quot;/>            &lt;xsl:sort select=&quot;./Name&quot;/>            &lt;xsl:copy-of select=&quot;.&quot;/>        &lt;/xsl:for-each>    &lt;/xsl:copy>&lt;/xsl:template>&lt;/xsl:stylesheet>\"/>\n                    </L7p:ResourceInfo>\n                    <L7p:Target target=\"OTHER\"/>\n                    <L7p:TransformName stringValue=\"\"/>\n                    <L7p:XsltVersion stringValue=\"1.0\"/>\n                </L7p:XslTransformation>\n                <L7p:CacheStorage>\n                    <L7p:CacheEntryKey stringValue=\"${cacheKey}\"/>\n                    <L7p:CacheId stringValue=\"serviceList\"/>\n                    <L7p:MaxEntryAgeSeconds stringValue=\"${cacheAge}\"/>\n                    <L7p:MaxEntrySizeBytes stringValue=\"100000\"/>\n                    <L7p:OtherTargetMessageVariable stringValue=\"services.sorted\"/>\n                    <L7p:StoreSoapFaults booleanValue=\"true\"/>\n                    <L7p:Target target=\"OTHER\"/>\n                </L7p:CacheStorage>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"c3lzdGVt\"/>\n                    <L7p:VariableToSet stringValue=\"source\"/>\n                </L7p:SetVariable>\n                <L7p:AuditDetailAssertion>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// FINE\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Detail stringValue=\"==> Loaded services.sorted from system and stored to cache\"/>\n                    <L7p:Level stringValue=\"FINE\"/>\n                </L7p:AuditDetailAssertion>\n                <L7p:assertionComment>\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// Retrieve new list and cache\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:assertionComment>\n            </wsp:All>\n            <wsp:All wsp:Usage=\"Required\">\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"RXJyb3Igd2hlbiBsaXN0aW5nIHNlcnZpY2Vz\"/>\n                    <L7p:VariableToSet stringValue=\"error.msg\"/>\n                </L7p:SetVariable>\n                <L7p:AuditDetailAssertion>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// WARNING\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Detail stringValue=\"==> Error listing services in ${policy.name}\"/>\n                    <L7p:Level stringValue=\"WARNING\"/>\n                </L7p:AuditDetailAssertion>\n                <L7p:FalseAssertion/>\n                <L7p:assertionComment>\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// Failure - set ${error.msg}\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:assertionComment>\n            </wsp:All>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Caching logic\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:OneOrMore>\n        <L7p:Regex>\n            <L7p:AssertionComment assertionComment=\"included\">\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Add source attribute to /Services element\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:AssertionComment>\n            <L7p:AutoTarget booleanValue=\"false\"/>\n            <L7p:OtherTargetMessageVariable stringValue=\"services.sorted\"/>\n            <L7p:Regex stringValue=\"&lt;Services>\"/>\n            <L7p:Replace booleanValue=\"true\"/>\n            <L7p:Replacement stringValue=\"&lt;Services source=&quot;${source}&quot;>\"/>\n            <L7p:Target target=\"OTHER\"/>\n        </L7p:Regex>\n        <L7p:AuditDetailAssertion>\n            <L7p:AssertionComment assertionComment=\"included\">\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// FINE\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:AssertionComment>\n            <L7p:Detail stringValue=\"==> Leaving Utility Fragment: ${policy.name}\"/>\n            <L7p:Level stringValue=\"FINE\"/>\n        </L7p:AuditDetailAssertion>\n    </wsp:All>\n</wsp:Policy>\n"
        }
      ]
    },
    {
      "guid": "4551eaad-90f5-467f-ba1d-c134ab0d3096",
      "name": "Utility: List SiteMinder Configurations",
      "policyType": "FRAGMENT",
      "checksum": "996de86aec439a62beb07446424d4ff9bf1bf815",
      "folderPath": "/Gateway Management Utilities/fragments",
      "soap": false,
      "policy": {
        "xml": "<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<wsp:Policy xmlns:L7p=\"http://www.layer7tech.com/ws/policy\" xmlns:wsp=\"http://schemas.xmlsoap.org/ws/2002/12/policy\">\n    <wsp:All wsp:Usage=\"Required\">\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Policy fragment for &quot;Utility: List SiteMinder Configurations&quot; encapsulated assertion\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Call Restman and generate a sorted list of SiteMinder configurations\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** - Assumes an admin role user has been authenticated\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** - Caches results for ${cacheAge} seconds (default=300). To refresh the cache set ${refresh}=true when calling\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** - Returns a text/xml message variable in ${siteminderConfigurations.sorted}\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Inputs:\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - refresh (string)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - cacheAge (string)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Outputs:\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - siteminderConfigurations.sorted (message)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - error.msg (string)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** v1.0.0 - Jay MacDonald - 20201107 - Initial Version\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n        </L7p:CommentAssertion>\n        <L7p:AuditDetailAssertion>\n            <L7p:AssertionComment assertionComment=\"included\">\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// FINE\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:AssertionComment>\n            <L7p:Detail stringValue=\"==> Entering Utility Fragment: ${policy.name} (refresh=${refresh})\"/>\n            <L7p:Level stringValue=\"FINE\"/>\n        </L7p:AuditDetailAssertion>\n        <wsp:All wsp:Usage=\"Required\">\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** ${siteminderConfigurations.sorted} has the following schema:\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** \"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** &lt;SiteMinderConfigurations source=&quot;system|cache&quot;>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   &lt;SiteMinderConfiguration id=&quot;string&quot;>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**     &lt;Name>string&lt;/Name>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**     &lt;Address>string&lt;/Address>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**     &lt;Hostname>string&lt;/Hostname>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**     &lt;Enabled>boolean&lt;/Enabled>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   &lt;/SiteMinderConfiguration>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   ...\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** &lt;/SiteMinderConfigurations>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n            </L7p:CommentAssertion>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Description of ${siteminderConfigurations.sorted}\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:All>\n        <wsp:OneOrMore wsp:Usage=\"Required\">\n            <L7p:ComparisonAssertion>\n                <L7p:AssertionComment assertionComment=\"included\">\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// true or false\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:AssertionComment>\n                <L7p:CaseSensitive booleanValue=\"false\"/>\n                <L7p:Expression1 stringValue=\"${cacheAge}\"/>\n                <L7p:Operator operatorNull=\"null\"/>\n                <L7p:Predicates predicates=\"included\">\n                    <L7p:item dataType=\"included\">\n                        <L7p:Type variableDataType=\"int\"/>\n                    </L7p:item>\n                    <L7p:item binary=\"included\">\n                        <L7p:CaseSensitive booleanValue=\"false\"/>\n                        <L7p:Operator operator=\"GT\"/>\n                        <L7p:RightValue stringValue=\"0\"/>\n                    </L7p:item>\n                </L7p:Predicates>\n            </L7p:ComparisonAssertion>\n            <L7p:SetVariable>\n                <L7p:Base64Expression stringValue=\"MzAw\"/>\n                <L7p:DataType variableDataType=\"int\"/>\n                <L7p:VariableToSet stringValue=\"cacheAge\"/>\n            </L7p:SetVariable>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Ensure ${cacheAge} is set, default=300\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:OneOrMore>\n        <wsp:OneOrMore wsp:Usage=\"Required\">\n            <L7p:ComparisonAssertion>\n                <L7p:AssertionComment assertionComment=\"included\">\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// true or false\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:AssertionComment>\n                <L7p:CaseSensitive booleanValue=\"false\"/>\n                <L7p:Expression1 stringValue=\"${refresh}\"/>\n                <L7p:Operator operatorNull=\"null\"/>\n                <L7p:Predicates predicates=\"included\">\n                    <L7p:item dataType=\"included\">\n                        <L7p:Type variableDataType=\"string\"/>\n                    </L7p:item>\n                    <L7p:item regex=\"included\">\n                        <L7p:Pattern stringValue=\"^(true|false)$\"/>\n                    </L7p:item>\n                </L7p:Predicates>\n            </L7p:ComparisonAssertion>\n            <L7p:SetVariable>\n                <L7p:Base64Expression stringValue=\"ZmFsc2U=\"/>\n                <L7p:VariableToSet stringValue=\"refresh\"/>\n            </L7p:SetVariable>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Ensure ${refresh} is set, default=false\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:OneOrMore>\n        <L7p:SetVariable>\n            <L7p:Base64Expression stringValue=\"c2l0ZW1pbmRlckNvbmZpZ3VyYXRpb25zLnNvcnRlZA==\"/>\n            <L7p:VariableToSet stringValue=\"cacheKey\"/>\n        </L7p:SetVariable>\n        <wsp:OneOrMore wsp:Usage=\"Required\">\n            <wsp:All wsp:Usage=\"Required\">\n                <L7p:ComparisonAssertion>\n                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                    <L7p:Expression1 stringValue=\"${refresh}\"/>\n                    <L7p:Operator operatorNull=\"null\"/>\n                    <L7p:Predicates predicates=\"included\">\n                        <L7p:item dataType=\"included\">\n                            <L7p:Type variableDataType=\"string\"/>\n                        </L7p:item>\n                        <L7p:item binary=\"included\">\n                            <L7p:Negated booleanValue=\"true\"/>\n                            <L7p:RightValue stringValue=\"true\"/>\n                        </L7p:item>\n                    </L7p:Predicates>\n                </L7p:ComparisonAssertion>\n                <L7p:CacheLookup>\n                    <L7p:CacheEntryKey stringValue=\"${cacheKey}\"/>\n                    <L7p:CacheId stringValue=\"siteMinderConfigurationList\"/>\n                    <L7p:ContentTypeOverride stringValue=\"\"/>\n                    <L7p:MaxEntryAgeSeconds stringValue=\"${cacheAge}\"/>\n                    <L7p:OtherTargetMessageVariable stringValue=\"siteminderConfigurations.sorted\"/>\n                    <L7p:Target target=\"OTHER\"/>\n                </L7p:CacheLookup>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"Y2FjaGU=\"/>\n                    <L7p:VariableToSet stringValue=\"source\"/>\n                </L7p:SetVariable>\n                <L7p:AuditDetailAssertion>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// FINE\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Detail stringValue=\"==> Found siteminderConfigurations.sorted in the cache\"/>\n                    <L7p:Level stringValue=\"FINE\"/>\n                </L7p:AuditDetailAssertion>\n                <L7p:assertionComment>\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// Look in cache unless asked to refresh cache\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:assertionComment>\n            </wsp:All>\n            <wsp:All wsp:Usage=\"Required\">\n                <L7p:Encapsulated>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// GET siteMinderConfigurations\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:EncapsulatedAssertionConfigGuid stringValue=\"c8a5a0d5-1ae2-4144-b538-5c311efc1560\"/>\n                    <L7p:EncapsulatedAssertionConfigName stringValue=\"Utility: Call Restman\"/>\n                    <L7p:Parameters mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"element\"/>\n                            <L7p:value stringValue=\"SiteMinderConfiguration\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"message\"/>\n                            <L7p:value stringValue=\"\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"method\"/>\n                            <L7p:value stringValue=\"GET\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"resource\"/>\n                            <L7p:value stringValue=\"siteMinderConfigurations\"/>\n                        </L7p:entry>\n                    </L7p:Parameters>\n                </L7p:Encapsulated>\n                <wsp:OneOrMore wsp:Usage=\"Required\">\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:VariablePrefix stringValue=\"siteminderConfigurations\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/l7:List/l7:Item/l7:Resource/l7:SiteMinderConfiguration\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <L7p:TrueAssertion/>\n                    <L7p:assertionComment>\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// Extract the list of SiteMinder configurations, never fail\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:assertionComment>\n                </wsp:OneOrMore>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz48U2l0ZU1pbmRlckNvbmZpZ3VyYXRpb25zPg==\"/>\n                    <L7p:VariableToSet stringValue=\"siteminderConfigurations.sorted\"/>\n                </L7p:SetVariable>\n                <L7p:ForEachLoop L7p:Usage=\"Required\"\n                    loopVariable=\"siteminderConfigurations.elements\" variablePrefix=\"siteminderConfiguration\">\n                    <L7p:SetVariable>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Cast to message type for parsing\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:Base64Expression stringValue=\"JHtzaXRlbWluZGVyQ29uZmlndXJhdGlvbi5jdXJyZW50fQ==\"/>\n                        <L7p:ContentType stringValue=\"text/xml; charset=utf-8\"/>\n                        <L7p:DataType variableDataType=\"message\"/>\n                        <L7p:VariableToSet stringValue=\"siteminderConfiguration.xml\"/>\n                    </L7p:SetVariable>\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Retrieve the SiteMinder configuration ID\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:VariablePrefix stringValue=\"id\"/>\n                        <L7p:XmlMsgSrc stringValue=\"siteminderConfiguration.xml\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/l7:SiteMinderConfiguration/@id\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// retrieve the SiteMinder configuration name\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:VariablePrefix stringValue=\"name\"/>\n                        <L7p:XmlMsgSrc stringValue=\"siteminderConfiguration.xml\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/l7:SiteMinderConfiguration/l7:Name\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// retrieve the SiteMinder configuration address\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:VariablePrefix stringValue=\"address\"/>\n                        <L7p:XmlMsgSrc stringValue=\"siteminderConfiguration.xml\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/l7:SiteMinderConfiguration/l7:Address\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// retrieve the SiteMinder hostname\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:VariablePrefix stringValue=\"hostName\"/>\n                        <L7p:XmlMsgSrc stringValue=\"siteminderConfiguration.xml\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/l7:SiteMinderConfiguration/l7:Hostname\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// retrieve the SiteMinder configuration enabled state\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:VariablePrefix stringValue=\"enabled\"/>\n                        <L7p:XmlMsgSrc stringValue=\"siteminderConfiguration.xml\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/l7:SiteMinderConfiguration/l7:Enabled\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <L7p:SetVariable>\n                        <L7p:Base64Expression stringValue=\"JHtzaXRlbWluZGVyQ29uZmlndXJhdGlvbnMuc29ydGVkfTxTaXRlTWluZGVyQ29uZmlndXJhdGlvbiBpZD0iJHtpZC5yZXN1bHR9Ij48TmFtZT48IVtDREFUQVske25hbWUucmVzdWx0fV1dPjwvTmFtZT48QWRkcmVzcz48IVtDREFUQVske2FkZHJlc3MucmVzdWx0fV1dPjwvQWRkcmVzcz48SG9zdG5hbWU+PCFbQ0RBVEFbJHtob3N0bmFtZS5yZXN1bHR9XV0+PC9Ib3N0bmFtZT48RW5hYmxlZD4ke2VuYWJsZWQucmVzdWx0fTwvRW5hYmxlZD48L1NpdGVNaW5kZXJDb25maWd1cmF0aW9uPg==\"/>\n                        <L7p:VariableToSet stringValue=\"siteminderConfigurations.sorted\"/>\n                    </L7p:SetVariable>\n                    <L7p:assertionComment>\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// Build the list of SiteMinder configurations\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:assertionComment>\n                </L7p:ForEachLoop>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"JHtzaXRlbWluZGVyQ29uZmlndXJhdGlvbnMuc29ydGVkfTwvU2l0ZU1pbmRlckNvbmZpZ3VyYXRpb25zPg==\"/>\n                    <L7p:ContentType stringValue=\"text/xml; charset=utf-8\"/>\n                    <L7p:DataType variableDataType=\"message\"/>\n                    <L7p:VariableToSet stringValue=\"siteminderConfigurations.sorted\"/>\n                </L7p:SetVariable>\n                <L7p:XslTransformation>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// Sort the SiteMinder configurations by name\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Direction intValue=\"-1\"/>\n                    <L7p:OtherTargetMessageVariable stringValue=\"siteminderConfigurations.sorted\"/>\n                    <L7p:ResourceInfo staticResourceInfo=\"included\">\n                        <L7p:Document stringValue=\"&lt;xsl:stylesheet version=&quot;1.0&quot; xmlns:l7=&quot;http://ns.l7tech.com/2010/04/gateway-management&quot; xmlns:xsl=&quot;http://www.w3.org/1999/XSL/Transform&quot;>&lt;xsl:template match=&quot;/SiteMinderConfigurations&quot;>    &lt;xsl:copy>        &lt;xsl:for-each select=&quot;SiteMinderConfiguration&quot;>            &lt;xsl:sort select=&quot;./Name&quot;/>            &lt;xsl:copy-of select=&quot;.&quot;/>        &lt;/xsl:for-each>    &lt;/xsl:copy>&lt;/xsl:template>&lt;/xsl:stylesheet>\"/>\n                    </L7p:ResourceInfo>\n                    <L7p:Target target=\"OTHER\"/>\n                    <L7p:TransformName stringValue=\"\"/>\n                    <L7p:XsltVersion stringValue=\"1.0\"/>\n                </L7p:XslTransformation>\n                <L7p:CacheStorage>\n                    <L7p:CacheEntryKey stringValue=\"${cacheKey}\"/>\n                    <L7p:CacheId stringValue=\"siteMinderConfigurationList\"/>\n                    <L7p:MaxEntries stringValue=\"1\"/>\n                    <L7p:MaxEntryAgeSeconds stringValue=\"${cacheAge}\"/>\n                    <L7p:MaxEntrySizeBytes stringValue=\"200000\"/>\n                    <L7p:OtherTargetMessageVariable stringValue=\"siteminderConfigurations.sorted\"/>\n                    <L7p:StoreSoapFaults booleanValue=\"true\"/>\n                    <L7p:Target target=\"OTHER\"/>\n                </L7p:CacheStorage>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"c3lzdGVt\"/>\n                    <L7p:VariableToSet stringValue=\"source\"/>\n                </L7p:SetVariable>\n                <L7p:AuditDetailAssertion>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// FINE\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Detail stringValue=\"==> Loaded siteminderConfigurations.sorted from system and stored to cache\"/>\n                    <L7p:Level stringValue=\"FINE\"/>\n                </L7p:AuditDetailAssertion>\n                <L7p:assertionComment>\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// Retrieve new list and cache\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:assertionComment>\n            </wsp:All>\n            <wsp:All wsp:Usage=\"Required\">\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"RXJyb3Igd2hlbiBsaXN0aW5nIFNpdGVNaW5kZXIgY29uZmlndXJhdGlvbnM=\"/>\n                    <L7p:VariableToSet stringValue=\"error.msg\"/>\n                </L7p:SetVariable>\n                <L7p:AuditDetailAssertion>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// WARNING\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Detail stringValue=\"==> Error listing SiteMinder configurations in ${policy.name}\"/>\n                    <L7p:Level stringValue=\"WARNING\"/>\n                </L7p:AuditDetailAssertion>\n                <L7p:FalseAssertion/>\n                <L7p:assertionComment>\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// Failure - set ${error.msg}\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:assertionComment>\n            </wsp:All>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Caching logic\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:OneOrMore>\n        <L7p:Regex>\n            <L7p:AssertionComment assertionComment=\"included\">\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Add source attribute to /SiteMinderConfigurations element\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:AssertionComment>\n            <L7p:AutoTarget booleanValue=\"false\"/>\n            <L7p:OtherTargetMessageVariable stringValue=\"siteminderConfigurations.sorted\"/>\n            <L7p:Regex stringValue=\"&lt;SiteMinderConfigurations>\"/>\n            <L7p:Replace booleanValue=\"true\"/>\n            <L7p:Replacement stringValue=\"&lt;SiteMinderConfigurations source=&quot;${source}&quot;>\"/>\n            <L7p:Target target=\"OTHER\"/>\n        </L7p:Regex>\n        <L7p:AuditDetailAssertion>\n            <L7p:AssertionComment assertionComment=\"included\">\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// FINE\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:AssertionComment>\n            <L7p:Detail stringValue=\"==> Leaving Utility Fragment: ${policy.name}\"/>\n            <L7p:Level stringValue=\"FINE\"/>\n        </L7p:AuditDetailAssertion>\n    </wsp:All>\n</wsp:Policy>\n"
      },
      "policyRevisions": [
        {
          "goid": "bed4baf4ff33b7e528854c3965d9bb68",
          "ordinal": 1,
          "active": true,
          "author": "admin",
          "time": "2025-02-05T14:20:38.641Z",
          "xml": "<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<wsp:Policy xmlns:L7p=\"http://www.layer7tech.com/ws/policy\" xmlns:wsp=\"http://schemas.xmlsoap.org/ws/2002/12/policy\">\n    <wsp:All wsp:Usage=\"Required\">\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Policy fragment for &quot;Utility: List SiteMinder Configurations&quot; encapsulated assertion\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Call Restman and generate a sorted list of SiteMinder configurations\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** - Assumes an admin role user has been authenticated\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** - Caches results for ${cacheAge} seconds (default=300). To refresh the cache set ${refresh}=true when calling\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** - Returns a text/xml message variable in ${siteminderConfigurations.sorted}\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Inputs:\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - refresh (string)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - cacheAge (string)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Outputs:\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - siteminderConfigurations.sorted (message)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - error.msg (string)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** v1.0.0 - Jay MacDonald - 20201107 - Initial Version\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n        </L7p:CommentAssertion>\n        <L7p:AuditDetailAssertion>\n            <L7p:AssertionComment assertionComment=\"included\">\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// FINE\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:AssertionComment>\n            <L7p:Detail stringValue=\"==> Entering Utility Fragment: ${policy.name} (refresh=${refresh})\"/>\n            <L7p:Level stringValue=\"FINE\"/>\n        </L7p:AuditDetailAssertion>\n        <wsp:All wsp:Usage=\"Required\">\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** ${siteminderConfigurations.sorted} has the following schema:\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** \"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** &lt;SiteMinderConfigurations source=&quot;system|cache&quot;>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   &lt;SiteMinderConfiguration id=&quot;string&quot;>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**     &lt;Name>string&lt;/Name>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**     &lt;Address>string&lt;/Address>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**     &lt;Hostname>string&lt;/Hostname>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**     &lt;Enabled>boolean&lt;/Enabled>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   &lt;/SiteMinderConfiguration>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   ...\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** &lt;/SiteMinderConfigurations>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n            </L7p:CommentAssertion>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Description of ${siteminderConfigurations.sorted}\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:All>\n        <wsp:OneOrMore wsp:Usage=\"Required\">\n            <L7p:ComparisonAssertion>\n                <L7p:AssertionComment assertionComment=\"included\">\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// true or false\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:AssertionComment>\n                <L7p:CaseSensitive booleanValue=\"false\"/>\n                <L7p:Expression1 stringValue=\"${cacheAge}\"/>\n                <L7p:Operator operatorNull=\"null\"/>\n                <L7p:Predicates predicates=\"included\">\n                    <L7p:item dataType=\"included\">\n                        <L7p:Type variableDataType=\"int\"/>\n                    </L7p:item>\n                    <L7p:item binary=\"included\">\n                        <L7p:CaseSensitive booleanValue=\"false\"/>\n                        <L7p:Operator operator=\"GT\"/>\n                        <L7p:RightValue stringValue=\"0\"/>\n                    </L7p:item>\n                </L7p:Predicates>\n            </L7p:ComparisonAssertion>\n            <L7p:SetVariable>\n                <L7p:Base64Expression stringValue=\"MzAw\"/>\n                <L7p:DataType variableDataType=\"int\"/>\n                <L7p:VariableToSet stringValue=\"cacheAge\"/>\n            </L7p:SetVariable>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Ensure ${cacheAge} is set, default=300\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:OneOrMore>\n        <wsp:OneOrMore wsp:Usage=\"Required\">\n            <L7p:ComparisonAssertion>\n                <L7p:AssertionComment assertionComment=\"included\">\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// true or false\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:AssertionComment>\n                <L7p:CaseSensitive booleanValue=\"false\"/>\n                <L7p:Expression1 stringValue=\"${refresh}\"/>\n                <L7p:Operator operatorNull=\"null\"/>\n                <L7p:Predicates predicates=\"included\">\n                    <L7p:item dataType=\"included\">\n                        <L7p:Type variableDataType=\"string\"/>\n                    </L7p:item>\n                    <L7p:item regex=\"included\">\n                        <L7p:Pattern stringValue=\"^(true|false)$\"/>\n                    </L7p:item>\n                </L7p:Predicates>\n            </L7p:ComparisonAssertion>\n            <L7p:SetVariable>\n                <L7p:Base64Expression stringValue=\"ZmFsc2U=\"/>\n                <L7p:VariableToSet stringValue=\"refresh\"/>\n            </L7p:SetVariable>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Ensure ${refresh} is set, default=false\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:OneOrMore>\n        <L7p:SetVariable>\n            <L7p:Base64Expression stringValue=\"c2l0ZW1pbmRlckNvbmZpZ3VyYXRpb25zLnNvcnRlZA==\"/>\n            <L7p:VariableToSet stringValue=\"cacheKey\"/>\n        </L7p:SetVariable>\n        <wsp:OneOrMore wsp:Usage=\"Required\">\n            <wsp:All wsp:Usage=\"Required\">\n                <L7p:ComparisonAssertion>\n                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                    <L7p:Expression1 stringValue=\"${refresh}\"/>\n                    <L7p:Operator operatorNull=\"null\"/>\n                    <L7p:Predicates predicates=\"included\">\n                        <L7p:item dataType=\"included\">\n                            <L7p:Type variableDataType=\"string\"/>\n                        </L7p:item>\n                        <L7p:item binary=\"included\">\n                            <L7p:Negated booleanValue=\"true\"/>\n                            <L7p:RightValue stringValue=\"true\"/>\n                        </L7p:item>\n                    </L7p:Predicates>\n                </L7p:ComparisonAssertion>\n                <L7p:CacheLookup>\n                    <L7p:CacheEntryKey stringValue=\"${cacheKey}\"/>\n                    <L7p:CacheId stringValue=\"siteMinderConfigurationList\"/>\n                    <L7p:ContentTypeOverride stringValue=\"\"/>\n                    <L7p:MaxEntryAgeSeconds stringValue=\"${cacheAge}\"/>\n                    <L7p:OtherTargetMessageVariable stringValue=\"siteminderConfigurations.sorted\"/>\n                    <L7p:Target target=\"OTHER\"/>\n                </L7p:CacheLookup>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"Y2FjaGU=\"/>\n                    <L7p:VariableToSet stringValue=\"source\"/>\n                </L7p:SetVariable>\n                <L7p:AuditDetailAssertion>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// FINE\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Detail stringValue=\"==> Found siteminderConfigurations.sorted in the cache\"/>\n                    <L7p:Level stringValue=\"FINE\"/>\n                </L7p:AuditDetailAssertion>\n                <L7p:assertionComment>\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// Look in cache unless asked to refresh cache\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:assertionComment>\n            </wsp:All>\n            <wsp:All wsp:Usage=\"Required\">\n                <L7p:Encapsulated>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// GET siteMinderConfigurations\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:EncapsulatedAssertionConfigGuid stringValue=\"c8a5a0d5-1ae2-4144-b538-5c311efc1560\"/>\n                    <L7p:EncapsulatedAssertionConfigName stringValue=\"Utility: Call Restman\"/>\n                    <L7p:Parameters mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"element\"/>\n                            <L7p:value stringValue=\"SiteMinderConfiguration\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"message\"/>\n                            <L7p:value stringValue=\"\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"method\"/>\n                            <L7p:value stringValue=\"GET\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"resource\"/>\n                            <L7p:value stringValue=\"siteMinderConfigurations\"/>\n                        </L7p:entry>\n                    </L7p:Parameters>\n                </L7p:Encapsulated>\n                <wsp:OneOrMore wsp:Usage=\"Required\">\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:VariablePrefix stringValue=\"siteminderConfigurations\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/l7:List/l7:Item/l7:Resource/l7:SiteMinderConfiguration\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <L7p:TrueAssertion/>\n                    <L7p:assertionComment>\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// Extract the list of SiteMinder configurations, never fail\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:assertionComment>\n                </wsp:OneOrMore>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz48U2l0ZU1pbmRlckNvbmZpZ3VyYXRpb25zPg==\"/>\n                    <L7p:VariableToSet stringValue=\"siteminderConfigurations.sorted\"/>\n                </L7p:SetVariable>\n                <L7p:ForEachLoop L7p:Usage=\"Required\"\n                    loopVariable=\"siteminderConfigurations.elements\" variablePrefix=\"siteminderConfiguration\">\n                    <L7p:SetVariable>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Cast to message type for parsing\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:Base64Expression stringValue=\"JHtzaXRlbWluZGVyQ29uZmlndXJhdGlvbi5jdXJyZW50fQ==\"/>\n                        <L7p:ContentType stringValue=\"text/xml; charset=utf-8\"/>\n                        <L7p:DataType variableDataType=\"message\"/>\n                        <L7p:VariableToSet stringValue=\"siteminderConfiguration.xml\"/>\n                    </L7p:SetVariable>\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Retrieve the SiteMinder configuration ID\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:VariablePrefix stringValue=\"id\"/>\n                        <L7p:XmlMsgSrc stringValue=\"siteminderConfiguration.xml\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/l7:SiteMinderConfiguration/@id\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// retrieve the SiteMinder configuration name\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:VariablePrefix stringValue=\"name\"/>\n                        <L7p:XmlMsgSrc stringValue=\"siteminderConfiguration.xml\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/l7:SiteMinderConfiguration/l7:Name\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// retrieve the SiteMinder configuration address\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:VariablePrefix stringValue=\"address\"/>\n                        <L7p:XmlMsgSrc stringValue=\"siteminderConfiguration.xml\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/l7:SiteMinderConfiguration/l7:Address\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// retrieve the SiteMinder hostname\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:VariablePrefix stringValue=\"hostName\"/>\n                        <L7p:XmlMsgSrc stringValue=\"siteminderConfiguration.xml\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/l7:SiteMinderConfiguration/l7:Hostname\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// retrieve the SiteMinder configuration enabled state\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:VariablePrefix stringValue=\"enabled\"/>\n                        <L7p:XmlMsgSrc stringValue=\"siteminderConfiguration.xml\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/l7:SiteMinderConfiguration/l7:Enabled\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <L7p:SetVariable>\n                        <L7p:Base64Expression stringValue=\"JHtzaXRlbWluZGVyQ29uZmlndXJhdGlvbnMuc29ydGVkfTxTaXRlTWluZGVyQ29uZmlndXJhdGlvbiBpZD0iJHtpZC5yZXN1bHR9Ij48TmFtZT48IVtDREFUQVske25hbWUucmVzdWx0fV1dPjwvTmFtZT48QWRkcmVzcz48IVtDREFUQVske2FkZHJlc3MucmVzdWx0fV1dPjwvQWRkcmVzcz48SG9zdG5hbWU+PCFbQ0RBVEFbJHtob3N0bmFtZS5yZXN1bHR9XV0+PC9Ib3N0bmFtZT48RW5hYmxlZD4ke2VuYWJsZWQucmVzdWx0fTwvRW5hYmxlZD48L1NpdGVNaW5kZXJDb25maWd1cmF0aW9uPg==\"/>\n                        <L7p:VariableToSet stringValue=\"siteminderConfigurations.sorted\"/>\n                    </L7p:SetVariable>\n                    <L7p:assertionComment>\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// Build the list of SiteMinder configurations\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:assertionComment>\n                </L7p:ForEachLoop>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"JHtzaXRlbWluZGVyQ29uZmlndXJhdGlvbnMuc29ydGVkfTwvU2l0ZU1pbmRlckNvbmZpZ3VyYXRpb25zPg==\"/>\n                    <L7p:ContentType stringValue=\"text/xml; charset=utf-8\"/>\n                    <L7p:DataType variableDataType=\"message\"/>\n                    <L7p:VariableToSet stringValue=\"siteminderConfigurations.sorted\"/>\n                </L7p:SetVariable>\n                <L7p:XslTransformation>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// Sort the SiteMinder configurations by name\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Direction intValue=\"-1\"/>\n                    <L7p:OtherTargetMessageVariable stringValue=\"siteminderConfigurations.sorted\"/>\n                    <L7p:ResourceInfo staticResourceInfo=\"included\">\n                        <L7p:Document stringValue=\"&lt;xsl:stylesheet version=&quot;1.0&quot; xmlns:l7=&quot;http://ns.l7tech.com/2010/04/gateway-management&quot; xmlns:xsl=&quot;http://www.w3.org/1999/XSL/Transform&quot;>&lt;xsl:template match=&quot;/SiteMinderConfigurations&quot;>    &lt;xsl:copy>        &lt;xsl:for-each select=&quot;SiteMinderConfiguration&quot;>            &lt;xsl:sort select=&quot;./Name&quot;/>            &lt;xsl:copy-of select=&quot;.&quot;/>        &lt;/xsl:for-each>    &lt;/xsl:copy>&lt;/xsl:template>&lt;/xsl:stylesheet>\"/>\n                    </L7p:ResourceInfo>\n                    <L7p:Target target=\"OTHER\"/>\n                    <L7p:TransformName stringValue=\"\"/>\n                    <L7p:XsltVersion stringValue=\"1.0\"/>\n                </L7p:XslTransformation>\n                <L7p:CacheStorage>\n                    <L7p:CacheEntryKey stringValue=\"${cacheKey}\"/>\n                    <L7p:CacheId stringValue=\"siteMinderConfigurationList\"/>\n                    <L7p:MaxEntries stringValue=\"1\"/>\n                    <L7p:MaxEntryAgeSeconds stringValue=\"${cacheAge}\"/>\n                    <L7p:MaxEntrySizeBytes stringValue=\"200000\"/>\n                    <L7p:OtherTargetMessageVariable stringValue=\"siteminderConfigurations.sorted\"/>\n                    <L7p:StoreSoapFaults booleanValue=\"true\"/>\n                    <L7p:Target target=\"OTHER\"/>\n                </L7p:CacheStorage>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"c3lzdGVt\"/>\n                    <L7p:VariableToSet stringValue=\"source\"/>\n                </L7p:SetVariable>\n                <L7p:AuditDetailAssertion>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// FINE\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Detail stringValue=\"==> Loaded siteminderConfigurations.sorted from system and stored to cache\"/>\n                    <L7p:Level stringValue=\"FINE\"/>\n                </L7p:AuditDetailAssertion>\n                <L7p:assertionComment>\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// Retrieve new list and cache\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:assertionComment>\n            </wsp:All>\n            <wsp:All wsp:Usage=\"Required\">\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"RXJyb3Igd2hlbiBsaXN0aW5nIFNpdGVNaW5kZXIgY29uZmlndXJhdGlvbnM=\"/>\n                    <L7p:VariableToSet stringValue=\"error.msg\"/>\n                </L7p:SetVariable>\n                <L7p:AuditDetailAssertion>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// WARNING\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Detail stringValue=\"==> Error listing SiteMinder configurations in ${policy.name}\"/>\n                    <L7p:Level stringValue=\"WARNING\"/>\n                </L7p:AuditDetailAssertion>\n                <L7p:FalseAssertion/>\n                <L7p:assertionComment>\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// Failure - set ${error.msg}\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:assertionComment>\n            </wsp:All>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Caching logic\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:OneOrMore>\n        <L7p:Regex>\n            <L7p:AssertionComment assertionComment=\"included\">\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Add source attribute to /SiteMinderConfigurations element\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:AssertionComment>\n            <L7p:AutoTarget booleanValue=\"false\"/>\n            <L7p:OtherTargetMessageVariable stringValue=\"siteminderConfigurations.sorted\"/>\n            <L7p:Regex stringValue=\"&lt;SiteMinderConfigurations>\"/>\n            <L7p:Replace booleanValue=\"true\"/>\n            <L7p:Replacement stringValue=\"&lt;SiteMinderConfigurations source=&quot;${source}&quot;>\"/>\n            <L7p:Target target=\"OTHER\"/>\n        </L7p:Regex>\n        <L7p:AuditDetailAssertion>\n            <L7p:AssertionComment assertionComment=\"included\">\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// FINE\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:AssertionComment>\n            <L7p:Detail stringValue=\"==> Leaving Utility Fragment: ${policy.name}\"/>\n            <L7p:Level stringValue=\"FINE\"/>\n        </L7p:AuditDetailAssertion>\n    </wsp:All>\n</wsp:Policy>\n"
        }
      ]
    },
    {
      "guid": "339953eb-58b5-451e-a733-c4e01ed39dee",
      "name": "Utility: List Trusted Certificates",
      "policyType": "FRAGMENT",
      "checksum": "ed9f61ba5d4ee5a33ab39950d0516dfbfb3c1f61",
      "folderPath": "/Gateway Management Utilities/fragments",
      "soap": false,
      "policy": {
        "xml": "<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<wsp:Policy xmlns:L7p=\"http://www.layer7tech.com/ws/policy\" xmlns:wsp=\"http://schemas.xmlsoap.org/ws/2002/12/policy\">\n    <wsp:All wsp:Usage=\"Required\">\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Policy fragment for &quot;Utility: List Trusted Certificates&quot; encapsulated assertion\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Call Restman and generate a sorted list of trusted certificates\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** - Assumes an admin role user has been authenticated\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** - Caches results for ${cacheAge} seconds (default=300). To refresh the cache set ${refresh}=true when calling\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** - Returns a text/xml message variable in ${trustedCertificates.sorted}\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Inputs:\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - refresh (string)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - cacheAge (string)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Outputs:\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - trustedCertificates.sorted (message)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - error.msg (string)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** v1.0.0 - Jay MacDonald - 20201107 - Initial Version\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n        </L7p:CommentAssertion>\n        <L7p:AuditDetailAssertion>\n            <L7p:AssertionComment assertionComment=\"included\">\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// FINE\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:AssertionComment>\n            <L7p:Detail stringValue=\"==> Entering Utility Fragment: ${policy.name} (refresh=${refresh})\"/>\n            <L7p:Level stringValue=\"FINE\"/>\n        </L7p:AuditDetailAssertion>\n        <wsp:All wsp:Usage=\"Required\">\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** ${trustedCertificates.sorted} has the following schema:\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** \"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** &lt;TrustedCertificates source=&quot;system|cache&quot;>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   &lt;TrustedCertificate id=&quot;string&quot;>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**     &lt;Name>string&lt;/Name>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**     &lt;Subject>string&lt;/Subject>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**     &lt;Issuer>string&lt;/Issuer>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**     &lt;SerialNumber>string&lt;/SerialNumber>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**     &lt;Expires>string&lt;/Expires>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   &lt;/TrustedCertificate>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   ...\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** &lt;/TrustedCertificates>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** \"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** Where:\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   Name = the name of the trusted certificate\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   Subject = the subject of the trusted certificate\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   Issuer = the issuer of the trusted certificate\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   SerialNumber = the serial number of the trusted certificate\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   Expires = the NotAfter time of the trusted certificate\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   Certificate = the base64 encoded trusted certificate\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n            </L7p:CommentAssertion>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Description of ${trustedCertificates.sorted}\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:All>\n        <wsp:OneOrMore wsp:Usage=\"Required\">\n            <L7p:ComparisonAssertion>\n                <L7p:AssertionComment assertionComment=\"included\">\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// true or false\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:AssertionComment>\n                <L7p:CaseSensitive booleanValue=\"false\"/>\n                <L7p:Expression1 stringValue=\"${cacheAge}\"/>\n                <L7p:Operator operatorNull=\"null\"/>\n                <L7p:Predicates predicates=\"included\">\n                    <L7p:item dataType=\"included\">\n                        <L7p:Type variableDataType=\"int\"/>\n                    </L7p:item>\n                    <L7p:item binary=\"included\">\n                        <L7p:CaseSensitive booleanValue=\"false\"/>\n                        <L7p:Operator operator=\"GT\"/>\n                        <L7p:RightValue stringValue=\"0\"/>\n                    </L7p:item>\n                </L7p:Predicates>\n            </L7p:ComparisonAssertion>\n            <L7p:SetVariable>\n                <L7p:Base64Expression stringValue=\"MzAw\"/>\n                <L7p:DataType variableDataType=\"int\"/>\n                <L7p:VariableToSet stringValue=\"cacheAge\"/>\n            </L7p:SetVariable>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Ensure ${cacheAge} is set, default=300\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:OneOrMore>\n        <wsp:OneOrMore wsp:Usage=\"Required\">\n            <L7p:ComparisonAssertion>\n                <L7p:AssertionComment assertionComment=\"included\">\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// true or false\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:AssertionComment>\n                <L7p:CaseSensitive booleanValue=\"false\"/>\n                <L7p:Expression1 stringValue=\"${refresh}\"/>\n                <L7p:Operator operatorNull=\"null\"/>\n                <L7p:Predicates predicates=\"included\">\n                    <L7p:item dataType=\"included\">\n                        <L7p:Type variableDataType=\"string\"/>\n                    </L7p:item>\n                    <L7p:item regex=\"included\">\n                        <L7p:Pattern stringValue=\"^(true|false)$\"/>\n                    </L7p:item>\n                </L7p:Predicates>\n            </L7p:ComparisonAssertion>\n            <L7p:SetVariable>\n                <L7p:Base64Expression stringValue=\"ZmFsc2U=\"/>\n                <L7p:VariableToSet stringValue=\"refresh\"/>\n            </L7p:SetVariable>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Ensure ${refresh} is set, default=false\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:OneOrMore>\n        <L7p:SetVariable>\n            <L7p:Base64Expression stringValue=\"dHJ1c3RlZENlcnRpZmljYXRlcy5zb3J0ZWQ=\"/>\n            <L7p:VariableToSet stringValue=\"cacheKey\"/>\n        </L7p:SetVariable>\n        <wsp:OneOrMore wsp:Usage=\"Required\">\n            <wsp:All wsp:Usage=\"Required\">\n                <L7p:ComparisonAssertion>\n                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                    <L7p:Expression1 stringValue=\"${refresh}\"/>\n                    <L7p:Operator operatorNull=\"null\"/>\n                    <L7p:Predicates predicates=\"included\">\n                        <L7p:item dataType=\"included\">\n                            <L7p:Type variableDataType=\"string\"/>\n                        </L7p:item>\n                        <L7p:item binary=\"included\">\n                            <L7p:Negated booleanValue=\"true\"/>\n                            <L7p:RightValue stringValue=\"true\"/>\n                        </L7p:item>\n                    </L7p:Predicates>\n                </L7p:ComparisonAssertion>\n                <L7p:CacheLookup>\n                    <L7p:CacheEntryKey stringValue=\"${cacheKey}\"/>\n                    <L7p:CacheId stringValue=\"trustedCertificateList\"/>\n                    <L7p:ContentTypeOverride stringValue=\"\"/>\n                    <L7p:MaxEntryAgeSeconds stringValue=\"${cacheAge}\"/>\n                    <L7p:OtherTargetMessageVariable stringValue=\"trustedCertificates.sorted\"/>\n                    <L7p:Target target=\"OTHER\"/>\n                </L7p:CacheLookup>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"Y2FjaGU=\"/>\n                    <L7p:VariableToSet stringValue=\"source\"/>\n                </L7p:SetVariable>\n                <L7p:AuditDetailAssertion>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// FINE\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Detail stringValue=\"==> Found trustedCertificates.sorted in the cache\"/>\n                    <L7p:Level stringValue=\"FINE\"/>\n                </L7p:AuditDetailAssertion>\n                <L7p:assertionComment>\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// Look in cache unless asked to refresh cache\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:assertionComment>\n            </wsp:All>\n            <wsp:All wsp:Usage=\"Required\">\n                <L7p:Encapsulated>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// GET trustedCertificates\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:EncapsulatedAssertionConfigGuid stringValue=\"c8a5a0d5-1ae2-4144-b538-5c311efc1560\"/>\n                    <L7p:EncapsulatedAssertionConfigName stringValue=\"Utility: Call Restman\"/>\n                    <L7p:Parameters mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"element\"/>\n                            <L7p:value stringValue=\"TrustedCertificate\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"message\"/>\n                            <L7p:value stringValue=\"\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"method\"/>\n                            <L7p:value stringValue=\"Get\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"resource\"/>\n                            <L7p:value stringValue=\"trustedCertificates\"/>\n                        </L7p:entry>\n                    </L7p:Parameters>\n                </L7p:Encapsulated>\n                <wsp:OneOrMore wsp:Usage=\"Required\">\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:VariablePrefix stringValue=\"trustedCertificates\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/l7:List/l7:Item/l7:Resource/l7:TrustedCertificate\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <L7p:TrueAssertion/>\n                    <L7p:assertionComment>\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// Extract the list of trusted certificates, never fail\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:assertionComment>\n                </wsp:OneOrMore>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz48VHJ1c3RlZENlcnRpZmljYXRlcz4=\"/>\n                    <L7p:VariableToSet stringValue=\"trustedCertificates.sorted\"/>\n                </L7p:SetVariable>\n                <L7p:ForEachLoop L7p:Usage=\"Required\"\n                    loopVariable=\"trustedCertificates.elements\" variablePrefix=\"trustedCertificate\">\n                    <L7p:SetVariable>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Cast to message type for parsing\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:Base64Expression stringValue=\"JHt0cnVzdGVkQ2VydGlmaWNhdGUuY3VycmVudH0=\"/>\n                        <L7p:ContentType stringValue=\"text/xml; charset=utf-8\"/>\n                        <L7p:DataType variableDataType=\"message\"/>\n                        <L7p:VariableToSet stringValue=\"trustedCertificate.xml\"/>\n                    </L7p:SetVariable>\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Retrieve the trusted certificate ID\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:VariablePrefix stringValue=\"id\"/>\n                        <L7p:XmlMsgSrc stringValue=\"trustedCertificate.xml\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/l7:TrustedCertificate/@id\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// retrieve the trusted certificate name\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:VariablePrefix stringValue=\"name\"/>\n                        <L7p:XmlMsgSrc stringValue=\"trustedCertificate.xml\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/l7:TrustedCertificate/l7:Name\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Retrieve the trusted certificate serial number\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:VariablePrefix stringValue=\"pem\"/>\n                        <L7p:XmlMsgSrc stringValue=\"trustedCertificate.xml\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/l7:TrustedCertificate/l7:CertificateData/l7:Encoded\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <L7p:EncodeDecode>\n                        <L7p:CharacterEncoding stringValueNull=\"null\"/>\n                        <L7p:SourceVariableName stringValue=\"pem.result\"/>\n                        <L7p:TargetDataType variableDataType=\"cert\"/>\n                        <L7p:TargetVariableName stringValue=\"certificate\"/>\n                        <L7p:TransformType transformType=\"BASE64_DECODE\"/>\n                    </L7p:EncodeDecode>\n                    <L7p:SetVariable>\n                        <L7p:Base64Expression stringValue=\"JHt0cnVzdGVkQ2VydGlmaWNhdGVzLnNvcnRlZH08VHJ1c3RlZENlcnRpZmljYXRlIGlkPSIke2lkLnJlc3VsdH0iPjxOYW1lPjwhW0NEQVRBWyR7bmFtZS5yZXN1bHR9XV0+PC9OYW1lPjxTdWJqZWN0PjwhW0NEQVRBWyR7Y2VydGlmaWNhdGUuc3ViamVjdH1dXT48L1N1YmplY3Q+PElzc3Vlcj48IVtDREFUQVske2NlcnRpZmljYXRlLmlzc3Vlcn1dXT48L0lzc3Vlcj48U2VyaWFsTnVtYmVyPiR7Y2VydGlmaWNhdGUuc2VyaWFsfTwvU2VyaWFsTnVtYmVyPjxFeHBpcmVzPiR7Y2VydGlmaWNhdGUubm90QWZ0ZXJ9PC9FeHBpcmVzPjxDZXJ0aWZpY2F0ZT4ke3BlbS5yZXN1bHR9PC9DZXJ0aWZpY2F0ZT48L1RydXN0ZWRDZXJ0aWZpY2F0ZT4=\"/>\n                        <L7p:VariableToSet stringValue=\"trustedCertificates.sorted\"/>\n                    </L7p:SetVariable>\n                    <L7p:assertionComment>\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// Build the list of trusted certificates\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:assertionComment>\n                </L7p:ForEachLoop>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"JHt0cnVzdGVkQ2VydGlmaWNhdGVzLnNvcnRlZH08L1RydXN0ZWRDZXJ0aWZpY2F0ZXM+\"/>\n                    <L7p:ContentType stringValue=\"text/xml; charset=utf-8\"/>\n                    <L7p:DataType variableDataType=\"message\"/>\n                    <L7p:VariableToSet stringValue=\"trustedCertificates.sorted\"/>\n                </L7p:SetVariable>\n                <L7p:XslTransformation>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// Sort the trusted certificates by name\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Direction intValue=\"-1\"/>\n                    <L7p:OtherTargetMessageVariable stringValue=\"trustedCertificates.sorted\"/>\n                    <L7p:ResourceInfo staticResourceInfo=\"included\">\n                        <L7p:Document stringValue=\"&lt;xsl:stylesheet version=&quot;1.0&quot; xmlns:l7=&quot;http://ns.l7tech.com/2010/04/gateway-management&quot; xmlns:xsl=&quot;http://www.w3.org/1999/XSL/Transform&quot;>&lt;xsl:template match=&quot;/TrustedCertificates&quot;>    &lt;xsl:copy>        &lt;xsl:for-each select=&quot;TrustedCertificate&quot;>            &lt;xsl:sort select=&quot;./Name&quot;/>            &lt;xsl:copy-of select=&quot;.&quot;/>        &lt;/xsl:for-each>    &lt;/xsl:copy>&lt;/xsl:template>&lt;/xsl:stylesheet>\"/>\n                    </L7p:ResourceInfo>\n                    <L7p:Target target=\"OTHER\"/>\n                    <L7p:TransformName stringValue=\"\"/>\n                    <L7p:XsltVersion stringValue=\"1.0\"/>\n                </L7p:XslTransformation>\n                <L7p:CacheStorage>\n                    <L7p:CacheEntryKey stringValue=\"${cacheKey}\"/>\n                    <L7p:CacheId stringValue=\"trustedCertificateList\"/>\n                    <L7p:MaxEntries stringValue=\"1\"/>\n                    <L7p:MaxEntryAgeSeconds stringValue=\"${cacheAge}\"/>\n                    <L7p:MaxEntrySizeBytes stringValue=\"200000\"/>\n                    <L7p:OtherTargetMessageVariable stringValue=\"trustedCertificates.sorted\"/>\n                    <L7p:StoreSoapFaults booleanValue=\"true\"/>\n                    <L7p:Target target=\"OTHER\"/>\n                </L7p:CacheStorage>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"c3lzdGVt\"/>\n                    <L7p:VariableToSet stringValue=\"source\"/>\n                </L7p:SetVariable>\n                <L7p:AuditDetailAssertion>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// FINE\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Detail stringValue=\"==> Loaded trustedCertificates.sorted from system and stored to cache\"/>\n                    <L7p:Level stringValue=\"FINE\"/>\n                </L7p:AuditDetailAssertion>\n                <L7p:assertionComment>\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// Retrieve new list and cache\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:assertionComment>\n            </wsp:All>\n            <wsp:All wsp:Usage=\"Required\">\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"RXJyb3Igd2hlbiBsaXN0aW5nIHRydXN0ZWQgY2VydGlmaWNhdGVz\"/>\n                    <L7p:VariableToSet stringValue=\"error.msg\"/>\n                </L7p:SetVariable>\n                <L7p:AuditDetailAssertion>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// WARNING\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Detail stringValue=\"==> Error listing trusted certificates in ${policy.name}\"/>\n                    <L7p:Level stringValue=\"WARNING\"/>\n                </L7p:AuditDetailAssertion>\n                <L7p:FalseAssertion/>\n                <L7p:assertionComment>\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// Failure - set ${error.msg}\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:assertionComment>\n            </wsp:All>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Caching logic\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:OneOrMore>\n        <L7p:Regex>\n            <L7p:AssertionComment assertionComment=\"included\">\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Add source attribute to /TrustedCertificates element\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:AssertionComment>\n            <L7p:AutoTarget booleanValue=\"false\"/>\n            <L7p:OtherTargetMessageVariable stringValue=\"trustedCertificates.sorted\"/>\n            <L7p:Regex stringValue=\"&lt;TrustedCertificates>\"/>\n            <L7p:Replace booleanValue=\"true\"/>\n            <L7p:Replacement stringValue=\"&lt;TrustedCertificates source=&quot;${source}&quot;>\"/>\n            <L7p:Target target=\"OTHER\"/>\n        </L7p:Regex>\n        <L7p:AuditDetailAssertion>\n            <L7p:AssertionComment assertionComment=\"included\">\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// FINE\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:AssertionComment>\n            <L7p:Detail stringValue=\"==> Leaving Utility Fragment: ${policy.name}\"/>\n            <L7p:Level stringValue=\"FINE\"/>\n        </L7p:AuditDetailAssertion>\n    </wsp:All>\n</wsp:Policy>\n"
      },
      "policyRevisions": [
        {
          "goid": "bed4baf4ff33b7e528854c3965d9bb6c",
          "ordinal": 1,
          "active": true,
          "author": "admin",
          "time": "2025-02-05T14:20:38.651Z",
          "xml": "<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<wsp:Policy xmlns:L7p=\"http://www.layer7tech.com/ws/policy\" xmlns:wsp=\"http://schemas.xmlsoap.org/ws/2002/12/policy\">\n    <wsp:All wsp:Usage=\"Required\">\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Policy fragment for &quot;Utility: List Trusted Certificates&quot; encapsulated assertion\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Call Restman and generate a sorted list of trusted certificates\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** - Assumes an admin role user has been authenticated\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** - Caches results for ${cacheAge} seconds (default=300). To refresh the cache set ${refresh}=true when calling\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** - Returns a text/xml message variable in ${trustedCertificates.sorted}\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Inputs:\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - refresh (string)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - cacheAge (string)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Outputs:\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - trustedCertificates.sorted (message)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - error.msg (string)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** v1.0.0 - Jay MacDonald - 20201107 - Initial Version\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n        </L7p:CommentAssertion>\n        <L7p:AuditDetailAssertion>\n            <L7p:AssertionComment assertionComment=\"included\">\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// FINE\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:AssertionComment>\n            <L7p:Detail stringValue=\"==> Entering Utility Fragment: ${policy.name} (refresh=${refresh})\"/>\n            <L7p:Level stringValue=\"FINE\"/>\n        </L7p:AuditDetailAssertion>\n        <wsp:All wsp:Usage=\"Required\">\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** ${trustedCertificates.sorted} has the following schema:\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** \"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** &lt;TrustedCertificates source=&quot;system|cache&quot;>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   &lt;TrustedCertificate id=&quot;string&quot;>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**     &lt;Name>string&lt;/Name>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**     &lt;Subject>string&lt;/Subject>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**     &lt;Issuer>string&lt;/Issuer>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**     &lt;SerialNumber>string&lt;/SerialNumber>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**     &lt;Expires>string&lt;/Expires>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   &lt;/TrustedCertificate>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   ...\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** &lt;/TrustedCertificates>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** \"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** Where:\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   Name = the name of the trusted certificate\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   Subject = the subject of the trusted certificate\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   Issuer = the issuer of the trusted certificate\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   SerialNumber = the serial number of the trusted certificate\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   Expires = the NotAfter time of the trusted certificate\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   Certificate = the base64 encoded trusted certificate\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n            </L7p:CommentAssertion>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Description of ${trustedCertificates.sorted}\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:All>\n        <wsp:OneOrMore wsp:Usage=\"Required\">\n            <L7p:ComparisonAssertion>\n                <L7p:AssertionComment assertionComment=\"included\">\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// true or false\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:AssertionComment>\n                <L7p:CaseSensitive booleanValue=\"false\"/>\n                <L7p:Expression1 stringValue=\"${cacheAge}\"/>\n                <L7p:Operator operatorNull=\"null\"/>\n                <L7p:Predicates predicates=\"included\">\n                    <L7p:item dataType=\"included\">\n                        <L7p:Type variableDataType=\"int\"/>\n                    </L7p:item>\n                    <L7p:item binary=\"included\">\n                        <L7p:CaseSensitive booleanValue=\"false\"/>\n                        <L7p:Operator operator=\"GT\"/>\n                        <L7p:RightValue stringValue=\"0\"/>\n                    </L7p:item>\n                </L7p:Predicates>\n            </L7p:ComparisonAssertion>\n            <L7p:SetVariable>\n                <L7p:Base64Expression stringValue=\"MzAw\"/>\n                <L7p:DataType variableDataType=\"int\"/>\n                <L7p:VariableToSet stringValue=\"cacheAge\"/>\n            </L7p:SetVariable>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Ensure ${cacheAge} is set, default=300\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:OneOrMore>\n        <wsp:OneOrMore wsp:Usage=\"Required\">\n            <L7p:ComparisonAssertion>\n                <L7p:AssertionComment assertionComment=\"included\">\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// true or false\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:AssertionComment>\n                <L7p:CaseSensitive booleanValue=\"false\"/>\n                <L7p:Expression1 stringValue=\"${refresh}\"/>\n                <L7p:Operator operatorNull=\"null\"/>\n                <L7p:Predicates predicates=\"included\">\n                    <L7p:item dataType=\"included\">\n                        <L7p:Type variableDataType=\"string\"/>\n                    </L7p:item>\n                    <L7p:item regex=\"included\">\n                        <L7p:Pattern stringValue=\"^(true|false)$\"/>\n                    </L7p:item>\n                </L7p:Predicates>\n            </L7p:ComparisonAssertion>\n            <L7p:SetVariable>\n                <L7p:Base64Expression stringValue=\"ZmFsc2U=\"/>\n                <L7p:VariableToSet stringValue=\"refresh\"/>\n            </L7p:SetVariable>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Ensure ${refresh} is set, default=false\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:OneOrMore>\n        <L7p:SetVariable>\n            <L7p:Base64Expression stringValue=\"dHJ1c3RlZENlcnRpZmljYXRlcy5zb3J0ZWQ=\"/>\n            <L7p:VariableToSet stringValue=\"cacheKey\"/>\n        </L7p:SetVariable>\n        <wsp:OneOrMore wsp:Usage=\"Required\">\n            <wsp:All wsp:Usage=\"Required\">\n                <L7p:ComparisonAssertion>\n                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                    <L7p:Expression1 stringValue=\"${refresh}\"/>\n                    <L7p:Operator operatorNull=\"null\"/>\n                    <L7p:Predicates predicates=\"included\">\n                        <L7p:item dataType=\"included\">\n                            <L7p:Type variableDataType=\"string\"/>\n                        </L7p:item>\n                        <L7p:item binary=\"included\">\n                            <L7p:Negated booleanValue=\"true\"/>\n                            <L7p:RightValue stringValue=\"true\"/>\n                        </L7p:item>\n                    </L7p:Predicates>\n                </L7p:ComparisonAssertion>\n                <L7p:CacheLookup>\n                    <L7p:CacheEntryKey stringValue=\"${cacheKey}\"/>\n                    <L7p:CacheId stringValue=\"trustedCertificateList\"/>\n                    <L7p:ContentTypeOverride stringValue=\"\"/>\n                    <L7p:MaxEntryAgeSeconds stringValue=\"${cacheAge}\"/>\n                    <L7p:OtherTargetMessageVariable stringValue=\"trustedCertificates.sorted\"/>\n                    <L7p:Target target=\"OTHER\"/>\n                </L7p:CacheLookup>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"Y2FjaGU=\"/>\n                    <L7p:VariableToSet stringValue=\"source\"/>\n                </L7p:SetVariable>\n                <L7p:AuditDetailAssertion>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// FINE\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Detail stringValue=\"==> Found trustedCertificates.sorted in the cache\"/>\n                    <L7p:Level stringValue=\"FINE\"/>\n                </L7p:AuditDetailAssertion>\n                <L7p:assertionComment>\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// Look in cache unless asked to refresh cache\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:assertionComment>\n            </wsp:All>\n            <wsp:All wsp:Usage=\"Required\">\n                <L7p:Encapsulated>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// GET trustedCertificates\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:EncapsulatedAssertionConfigGuid stringValue=\"c8a5a0d5-1ae2-4144-b538-5c311efc1560\"/>\n                    <L7p:EncapsulatedAssertionConfigName stringValue=\"Utility: Call Restman\"/>\n                    <L7p:Parameters mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"element\"/>\n                            <L7p:value stringValue=\"TrustedCertificate\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"message\"/>\n                            <L7p:value stringValue=\"\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"method\"/>\n                            <L7p:value stringValue=\"Get\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"resource\"/>\n                            <L7p:value stringValue=\"trustedCertificates\"/>\n                        </L7p:entry>\n                    </L7p:Parameters>\n                </L7p:Encapsulated>\n                <wsp:OneOrMore wsp:Usage=\"Required\">\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:VariablePrefix stringValue=\"trustedCertificates\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/l7:List/l7:Item/l7:Resource/l7:TrustedCertificate\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <L7p:TrueAssertion/>\n                    <L7p:assertionComment>\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// Extract the list of trusted certificates, never fail\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:assertionComment>\n                </wsp:OneOrMore>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz48VHJ1c3RlZENlcnRpZmljYXRlcz4=\"/>\n                    <L7p:VariableToSet stringValue=\"trustedCertificates.sorted\"/>\n                </L7p:SetVariable>\n                <L7p:ForEachLoop L7p:Usage=\"Required\"\n                    loopVariable=\"trustedCertificates.elements\" variablePrefix=\"trustedCertificate\">\n                    <L7p:SetVariable>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Cast to message type for parsing\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:Base64Expression stringValue=\"JHt0cnVzdGVkQ2VydGlmaWNhdGUuY3VycmVudH0=\"/>\n                        <L7p:ContentType stringValue=\"text/xml; charset=utf-8\"/>\n                        <L7p:DataType variableDataType=\"message\"/>\n                        <L7p:VariableToSet stringValue=\"trustedCertificate.xml\"/>\n                    </L7p:SetVariable>\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Retrieve the trusted certificate ID\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:VariablePrefix stringValue=\"id\"/>\n                        <L7p:XmlMsgSrc stringValue=\"trustedCertificate.xml\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/l7:TrustedCertificate/@id\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// retrieve the trusted certificate name\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:VariablePrefix stringValue=\"name\"/>\n                        <L7p:XmlMsgSrc stringValue=\"trustedCertificate.xml\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/l7:TrustedCertificate/l7:Name\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Retrieve the trusted certificate serial number\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:VariablePrefix stringValue=\"pem\"/>\n                        <L7p:XmlMsgSrc stringValue=\"trustedCertificate.xml\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/l7:TrustedCertificate/l7:CertificateData/l7:Encoded\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <L7p:EncodeDecode>\n                        <L7p:CharacterEncoding stringValueNull=\"null\"/>\n                        <L7p:SourceVariableName stringValue=\"pem.result\"/>\n                        <L7p:TargetDataType variableDataType=\"cert\"/>\n                        <L7p:TargetVariableName stringValue=\"certificate\"/>\n                        <L7p:TransformType transformType=\"BASE64_DECODE\"/>\n                    </L7p:EncodeDecode>\n                    <L7p:SetVariable>\n                        <L7p:Base64Expression stringValue=\"JHt0cnVzdGVkQ2VydGlmaWNhdGVzLnNvcnRlZH08VHJ1c3RlZENlcnRpZmljYXRlIGlkPSIke2lkLnJlc3VsdH0iPjxOYW1lPjwhW0NEQVRBWyR7bmFtZS5yZXN1bHR9XV0+PC9OYW1lPjxTdWJqZWN0PjwhW0NEQVRBWyR7Y2VydGlmaWNhdGUuc3ViamVjdH1dXT48L1N1YmplY3Q+PElzc3Vlcj48IVtDREFUQVske2NlcnRpZmljYXRlLmlzc3Vlcn1dXT48L0lzc3Vlcj48U2VyaWFsTnVtYmVyPiR7Y2VydGlmaWNhdGUuc2VyaWFsfTwvU2VyaWFsTnVtYmVyPjxFeHBpcmVzPiR7Y2VydGlmaWNhdGUubm90QWZ0ZXJ9PC9FeHBpcmVzPjxDZXJ0aWZpY2F0ZT4ke3BlbS5yZXN1bHR9PC9DZXJ0aWZpY2F0ZT48L1RydXN0ZWRDZXJ0aWZpY2F0ZT4=\"/>\n                        <L7p:VariableToSet stringValue=\"trustedCertificates.sorted\"/>\n                    </L7p:SetVariable>\n                    <L7p:assertionComment>\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// Build the list of trusted certificates\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:assertionComment>\n                </L7p:ForEachLoop>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"JHt0cnVzdGVkQ2VydGlmaWNhdGVzLnNvcnRlZH08L1RydXN0ZWRDZXJ0aWZpY2F0ZXM+\"/>\n                    <L7p:ContentType stringValue=\"text/xml; charset=utf-8\"/>\n                    <L7p:DataType variableDataType=\"message\"/>\n                    <L7p:VariableToSet stringValue=\"trustedCertificates.sorted\"/>\n                </L7p:SetVariable>\n                <L7p:XslTransformation>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// Sort the trusted certificates by name\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Direction intValue=\"-1\"/>\n                    <L7p:OtherTargetMessageVariable stringValue=\"trustedCertificates.sorted\"/>\n                    <L7p:ResourceInfo staticResourceInfo=\"included\">\n                        <L7p:Document stringValue=\"&lt;xsl:stylesheet version=&quot;1.0&quot; xmlns:l7=&quot;http://ns.l7tech.com/2010/04/gateway-management&quot; xmlns:xsl=&quot;http://www.w3.org/1999/XSL/Transform&quot;>&lt;xsl:template match=&quot;/TrustedCertificates&quot;>    &lt;xsl:copy>        &lt;xsl:for-each select=&quot;TrustedCertificate&quot;>            &lt;xsl:sort select=&quot;./Name&quot;/>            &lt;xsl:copy-of select=&quot;.&quot;/>        &lt;/xsl:for-each>    &lt;/xsl:copy>&lt;/xsl:template>&lt;/xsl:stylesheet>\"/>\n                    </L7p:ResourceInfo>\n                    <L7p:Target target=\"OTHER\"/>\n                    <L7p:TransformName stringValue=\"\"/>\n                    <L7p:XsltVersion stringValue=\"1.0\"/>\n                </L7p:XslTransformation>\n                <L7p:CacheStorage>\n                    <L7p:CacheEntryKey stringValue=\"${cacheKey}\"/>\n                    <L7p:CacheId stringValue=\"trustedCertificateList\"/>\n                    <L7p:MaxEntries stringValue=\"1\"/>\n                    <L7p:MaxEntryAgeSeconds stringValue=\"${cacheAge}\"/>\n                    <L7p:MaxEntrySizeBytes stringValue=\"200000\"/>\n                    <L7p:OtherTargetMessageVariable stringValue=\"trustedCertificates.sorted\"/>\n                    <L7p:StoreSoapFaults booleanValue=\"true\"/>\n                    <L7p:Target target=\"OTHER\"/>\n                </L7p:CacheStorage>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"c3lzdGVt\"/>\n                    <L7p:VariableToSet stringValue=\"source\"/>\n                </L7p:SetVariable>\n                <L7p:AuditDetailAssertion>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// FINE\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Detail stringValue=\"==> Loaded trustedCertificates.sorted from system and stored to cache\"/>\n                    <L7p:Level stringValue=\"FINE\"/>\n                </L7p:AuditDetailAssertion>\n                <L7p:assertionComment>\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// Retrieve new list and cache\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:assertionComment>\n            </wsp:All>\n            <wsp:All wsp:Usage=\"Required\">\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"RXJyb3Igd2hlbiBsaXN0aW5nIHRydXN0ZWQgY2VydGlmaWNhdGVz\"/>\n                    <L7p:VariableToSet stringValue=\"error.msg\"/>\n                </L7p:SetVariable>\n                <L7p:AuditDetailAssertion>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// WARNING\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Detail stringValue=\"==> Error listing trusted certificates in ${policy.name}\"/>\n                    <L7p:Level stringValue=\"WARNING\"/>\n                </L7p:AuditDetailAssertion>\n                <L7p:FalseAssertion/>\n                <L7p:assertionComment>\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// Failure - set ${error.msg}\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:assertionComment>\n            </wsp:All>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Caching logic\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:OneOrMore>\n        <L7p:Regex>\n            <L7p:AssertionComment assertionComment=\"included\">\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Add source attribute to /TrustedCertificates element\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:AssertionComment>\n            <L7p:AutoTarget booleanValue=\"false\"/>\n            <L7p:OtherTargetMessageVariable stringValue=\"trustedCertificates.sorted\"/>\n            <L7p:Regex stringValue=\"&lt;TrustedCertificates>\"/>\n            <L7p:Replace booleanValue=\"true\"/>\n            <L7p:Replacement stringValue=\"&lt;TrustedCertificates source=&quot;${source}&quot;>\"/>\n            <L7p:Target target=\"OTHER\"/>\n        </L7p:Regex>\n        <L7p:AuditDetailAssertion>\n            <L7p:AssertionComment assertionComment=\"included\">\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// FINE\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:AssertionComment>\n            <L7p:Detail stringValue=\"==> Leaving Utility Fragment: ${policy.name}\"/>\n            <L7p:Level stringValue=\"FINE\"/>\n        </L7p:AuditDetailAssertion>\n    </wsp:All>\n</wsp:Policy>\n"
        }
      ]
    },
    {
      "guid": "57909023-fab7-453a-80dd-1c3354e7f942",
      "name": "Utility: List Users",
      "policyType": "FRAGMENT",
      "checksum": "a8b531fcdf25ae5b9ffefb359b8319c5444b08fc",
      "folderPath": "/Gateway Management Utilities/fragments",
      "soap": false,
      "policy": {
        "xml": "<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<wsp:Policy xmlns:L7p=\"http://www.layer7tech.com/ws/policy\" xmlns:wsp=\"http://schemas.xmlsoap.org/ws/2002/12/policy\">\n    <wsp:All wsp:Usage=\"Required\">\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Policy fragment for &quot;Utility: List Users&quot; encapsulated assertion\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Call Restman and generate a sorted list of users from all but LDAP and Policy Backed identity providers\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** - Assumes an admin role user has been authenticated\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** - Caches results for ${cacheAge} seconds (default=300). To refresh the cache set ${refresh}=true when calling\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** - Returns a text/xml message variable in ${users.sorted}\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Inputs:\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - identityProviderIds (string)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - refresh (string)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - cacheAge (string)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Outputs:\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - users.sorted (message)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - error.msg (string)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** v1.0.0 - Jay MacDonald - 20201107 - Initial Version\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n        </L7p:CommentAssertion>\n        <L7p:AuditDetailAssertion>\n            <L7p:AssertionComment assertionComment=\"included\">\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// FINE\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:AssertionComment>\n            <L7p:Detail stringValue=\"==> Entering Utility Fragment: ${policy.name} (refresh=${refresh})\"/>\n            <L7p:Level stringValue=\"FINE\"/>\n        </L7p:AuditDetailAssertion>\n        <wsp:All wsp:Usage=\"Required\">\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** ${users.sorted} has the following schema:\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** \"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** &lt;Users source=&quot;system|cache&quot;>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   &lt;User id=&quot;string&quot; providerId=&quot;string&quot; providerType=&quot;string&quot; providerName=&quot;string&quot;>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**     &lt;Name>string&lt;/Name>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**     &lt;Login>string&lt;/Login>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**     &lt;FirstName>string&lt;/FirstName>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**     &lt;LastName>string&lt;/LastName>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**     &lt;Email>string&lt;/Email>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**     &lt;SubjectDn>string&lt;/SubjectDn>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**     &lt;Enabled>boolean&lt;/Enabled>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   &lt;/User>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   ...\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** &lt;/Users>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n            </L7p:CommentAssertion>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Description of ${users.sorted}\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:All>\n        <wsp:OneOrMore wsp:Usage=\"Required\">\n            <L7p:ComparisonAssertion>\n                <L7p:AssertionComment assertionComment=\"included\">\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// true or false\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:AssertionComment>\n                <L7p:CaseSensitive booleanValue=\"false\"/>\n                <L7p:Expression1 stringValue=\"${cacheAge}\"/>\n                <L7p:Operator operatorNull=\"null\"/>\n                <L7p:Predicates predicates=\"included\">\n                    <L7p:item dataType=\"included\">\n                        <L7p:Type variableDataType=\"int\"/>\n                    </L7p:item>\n                    <L7p:item binary=\"included\">\n                        <L7p:CaseSensitive booleanValue=\"false\"/>\n                        <L7p:Operator operator=\"GT\"/>\n                        <L7p:RightValue stringValue=\"0\"/>\n                    </L7p:item>\n                </L7p:Predicates>\n            </L7p:ComparisonAssertion>\n            <L7p:SetVariable>\n                <L7p:Base64Expression stringValue=\"MzAw\"/>\n                <L7p:DataType variableDataType=\"int\"/>\n                <L7p:VariableToSet stringValue=\"cacheAge\"/>\n            </L7p:SetVariable>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Ensure ${cacheAge} is set, default=300\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:OneOrMore>\n        <wsp:OneOrMore wsp:Usage=\"Required\">\n            <L7p:ComparisonAssertion>\n                <L7p:AssertionComment assertionComment=\"included\">\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// true or false\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:AssertionComment>\n                <L7p:CaseSensitive booleanValue=\"false\"/>\n                <L7p:Expression1 stringValue=\"${refresh}\"/>\n                <L7p:Operator operatorNull=\"null\"/>\n                <L7p:Predicates predicates=\"included\">\n                    <L7p:item dataType=\"included\">\n                        <L7p:Type variableDataType=\"string\"/>\n                    </L7p:item>\n                    <L7p:item regex=\"included\">\n                        <L7p:Pattern stringValue=\"^(true|false)$\"/>\n                    </L7p:item>\n                </L7p:Predicates>\n            </L7p:ComparisonAssertion>\n            <L7p:SetVariable>\n                <L7p:Base64Expression stringValue=\"ZmFsc2U=\"/>\n                <L7p:VariableToSet stringValue=\"refresh\"/>\n            </L7p:SetVariable>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Ensure ${refresh} is set, default=false\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:OneOrMore>\n        <L7p:SetVariable>\n            <L7p:Base64Expression stringValue=\"dXNlcnMuc29ydGVk\"/>\n            <L7p:VariableToSet stringValue=\"cacheKey\"/>\n        </L7p:SetVariable>\n        <wsp:OneOrMore wsp:Usage=\"Required\">\n            <wsp:All wsp:Usage=\"Required\">\n                <L7p:ComparisonAssertion>\n                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                    <L7p:Expression1 stringValue=\"${refresh}\"/>\n                    <L7p:Operator operatorNull=\"null\"/>\n                    <L7p:Predicates predicates=\"included\">\n                        <L7p:item dataType=\"included\">\n                            <L7p:Type variableDataType=\"string\"/>\n                        </L7p:item>\n                        <L7p:item binary=\"included\">\n                            <L7p:Negated booleanValue=\"true\"/>\n                            <L7p:RightValue stringValue=\"true\"/>\n                        </L7p:item>\n                    </L7p:Predicates>\n                </L7p:ComparisonAssertion>\n                <L7p:CacheLookup>\n                    <L7p:CacheEntryKey stringValue=\"${cacheKey}\"/>\n                    <L7p:CacheId stringValue=\"userList\"/>\n                    <L7p:ContentTypeOverride stringValue=\"\"/>\n                    <L7p:MaxEntryAgeSeconds stringValue=\"${cacheAge}\"/>\n                    <L7p:OtherTargetMessageVariable stringValue=\"users.sorted\"/>\n                    <L7p:Target target=\"OTHER\"/>\n                </L7p:CacheLookup>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"Y2FjaGU=\"/>\n                    <L7p:VariableToSet stringValue=\"source\"/>\n                </L7p:SetVariable>\n                <L7p:AuditDetailAssertion>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// FINE\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Detail stringValue=\"==> Found users.sorted in the cache\"/>\n                    <L7p:Level stringValue=\"FINE\"/>\n                </L7p:AuditDetailAssertion>\n                <L7p:assertionComment>\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// Look in cache unless asked to refresh cache\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:assertionComment>\n            </wsp:All>\n            <wsp:All wsp:Usage=\"Required\">\n                <L7p:Encapsulated>\n                    <L7p:EncapsulatedAssertionConfigGuid stringValue=\"1ab6158d-33ce-4fa6-a7d8-2b8dc8e31faf\"/>\n                    <L7p:EncapsulatedAssertionConfigName stringValue=\"Utility: List Identity Providers\"/>\n                    <L7p:Parameters mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"cacheAge\"/>\n                            <L7p:value stringValue=\"${cacheAge}\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"refresh\"/>\n                            <L7p:value stringValue=\"${refresh}\"/>\n                        </L7p:entry>\n                    </L7p:Parameters>\n                </L7p:Encapsulated>\n                <wsp:OneOrMore wsp:Usage=\"Required\">\n                    <wsp:All wsp:Usage=\"Required\">\n                        <L7p:ComparisonAssertion>\n                            <L7p:CaseSensitive booleanValue=\"false\"/>\n                            <L7p:Expression1 stringValue=\"${identityProviderIds}\"/>\n                            <L7p:Expression2 stringValue=\"\"/>\n                            <L7p:Negate booleanValue=\"true\"/>\n                            <L7p:Operator operator=\"EMPTY\"/>\n                            <L7p:Predicates predicates=\"included\">\n                                <L7p:item binary=\"included\">\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:Negated booleanValue=\"true\"/>\n                                    <L7p:Operator operator=\"EMPTY\"/>\n                                    <L7p:RightValue stringValue=\"\"/>\n                                </L7p:item>\n                            </L7p:Predicates>\n                        </L7p:ComparisonAssertion>\n                        <L7p:Split>\n                            <L7p:InputVariable stringValue=\"identityProviderIds\"/>\n                            <L7p:OutputVariable stringValue=\"identityProviderIds.results\"/>\n                        </L7p:Split>\n                        <L7p:assertionComment>\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// identity provider ids is set so split into ${identityProviderIds.results}\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:assertionComment>\n                    </wsp:All>\n                    <wsp:All wsp:Usage=\"Required\">\n                        <L7p:ResponseXpathAssertion>\n                            <L7p:VariablePrefix stringValue=\"identityProviderIds\"/>\n                            <L7p:XmlMsgSrc stringValue=\"identityProviders.sorted\"/>\n                            <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                <L7p:Expression stringValue=\"/IdentityProviders/IdentityProvider[Type='Internal' or Type='Federated']/@id\"/>\n                                <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"s\"/>\n                                    <L7p:value stringValue=\"http://schemas.xmlsoap.org/soap/envelope/\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                    </L7p:entry>\n                                </L7p:Namespaces>\n                                <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                            </L7p:XpathExpression>\n                        </L7p:ResponseXpathAssertion>\n                        <L7p:assertionComment>\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// No identity provider ids set, so get list of them\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:assertionComment>\n                    </wsp:All>\n                    <L7p:assertionComment>\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// If identityProviderId is not set, find list of all of them\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:assertionComment>\n                </wsp:OneOrMore>\n                <L7p:AuditDetailAssertion>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// FINE\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Detail stringValue=\"==> identityProviderIds.results ${identityProviderIds.results}\"/>\n                    <L7p:Level stringValue=\"FINE\"/>\n                </L7p:AuditDetailAssertion>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz48VXNlcnM+\"/>\n                    <L7p:VariableToSet stringValue=\"users.sorted\"/>\n                </L7p:SetVariable>\n                <L7p:ForEachLoop L7p:Usage=\"Required\"\n                    loopVariable=\"identityProviderIds.results\" variablePrefix=\"identityProviderId\">\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Retrieve the type of the identity provider\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:VariablePrefix stringValue=\"providerType\"/>\n                        <L7p:XmlMsgSrc stringValue=\"identityProviders.sorted\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/IdentityProviders/IdentityProvider[@id=$identityProviderId.current]/Type\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Retrieve the type of the identity provider\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:VariablePrefix stringValue=\"providerName\"/>\n                        <L7p:XmlMsgSrc stringValue=\"identityProviders.sorted\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/IdentityProviders/IdentityProvider[@id=$identityProviderId.current]/Name\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <L7p:Encapsulated>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// GET users\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:EncapsulatedAssertionConfigGuid stringValue=\"c8a5a0d5-1ae2-4144-b538-5c311efc1560\"/>\n                        <L7p:EncapsulatedAssertionConfigName stringValue=\"Utility: Call Restman\"/>\n                        <L7p:Parameters mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"element\"/>\n                                <L7p:value stringValue=\"User\"/>\n                            </L7p:entry>\n                            <L7p:entry>\n                                <L7p:key stringValue=\"message\"/>\n                                <L7p:value stringValue=\"\"/>\n                            </L7p:entry>\n                            <L7p:entry>\n                                <L7p:key stringValue=\"method\"/>\n                                <L7p:value stringValue=\"GET\"/>\n                            </L7p:entry>\n                            <L7p:entry>\n                                <L7p:key stringValue=\"resource\"/>\n                                <L7p:value stringValue=\"identityProviders/${identityProviderId.current}/users\"/>\n                            </L7p:entry>\n                        </L7p:Parameters>\n                    </L7p:Encapsulated>\n                    <wsp:OneOrMore wsp:Usage=\"Required\">\n                        <L7p:ResponseXpathAssertion>\n                            <L7p:VariablePrefix stringValue=\"users\"/>\n                            <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                <L7p:Expression stringValue=\"/l7:List/l7:Item/l7:Resource/l7:User\"/>\n                                <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                    </L7p:entry>\n                                </L7p:Namespaces>\n                                <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                            </L7p:XpathExpression>\n                        </L7p:ResponseXpathAssertion>\n                        <L7p:TrueAssertion/>\n                        <L7p:assertionComment>\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Extract the list of users, never fail\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:assertionComment>\n                    </wsp:OneOrMore>\n                    <L7p:ForEachLoop L7p:Usage=\"Required\"\n                        loopVariable=\"users.elements\" variablePrefix=\"user\">\n                        <L7p:SetVariable>\n                            <L7p:AssertionComment assertionComment=\"included\">\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Cast to message type for parsing\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:AssertionComment>\n                            <L7p:Base64Expression stringValue=\"JHt1c2VyLmN1cnJlbnR9\"/>\n                            <L7p:ContentType stringValue=\"text/xml; charset=utf-8\"/>\n                            <L7p:DataType variableDataType=\"message\"/>\n                            <L7p:VariableToSet stringValue=\"user.xml\"/>\n                        </L7p:SetVariable>\n                        <L7p:ResponseXpathAssertion>\n                            <L7p:AssertionComment assertionComment=\"included\">\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Retrieve the user ID\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:AssertionComment>\n                            <L7p:VariablePrefix stringValue=\"id\"/>\n                            <L7p:XmlMsgSrc stringValue=\"user.xml\"/>\n                            <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                <L7p:Expression stringValue=\"/l7:User/@id\"/>\n                                <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                    </L7p:entry>\n                                </L7p:Namespaces>\n                                <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                            </L7p:XpathExpression>\n                        </L7p:ResponseXpathAssertion>\n                        <L7p:ResponseXpathAssertion>\n                            <L7p:AssertionComment assertionComment=\"included\">\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Retrieve the user's provider ID\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:AssertionComment>\n                            <L7p:VariablePrefix stringValue=\"providerId\"/>\n                            <L7p:XmlMsgSrc stringValue=\"user.xml\"/>\n                            <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                <L7p:Expression stringValue=\"/l7:User/@providerId\"/>\n                                <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                    </L7p:entry>\n                                </L7p:Namespaces>\n                                <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                            </L7p:XpathExpression>\n                        </L7p:ResponseXpathAssertion>\n                        <L7p:ResponseXpathAssertion>\n                            <L7p:AssertionComment assertionComment=\"included\">\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Retrieve the user name\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:AssertionComment>\n                            <L7p:VariablePrefix stringValue=\"name\"/>\n                            <L7p:XmlMsgSrc stringValue=\"user.xml\"/>\n                            <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                <L7p:Expression stringValue=\"/l7:User/l7:Properties/l7:Property[@key='name']/l7:StringValue\"/>\n                                <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                    </L7p:entry>\n                                </L7p:Namespaces>\n                                <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                            </L7p:XpathExpression>\n                        </L7p:ResponseXpathAssertion>\n                        <L7p:ResponseXpathAssertion>\n                            <L7p:AssertionComment assertionComment=\"included\">\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Retrieve the user login\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:AssertionComment>\n                            <L7p:VariablePrefix stringValue=\"login\"/>\n                            <L7p:XmlMsgSrc stringValue=\"user.xml\"/>\n                            <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                <L7p:Expression stringValue=\"/l7:User/l7:Login\"/>\n                                <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                    </L7p:entry>\n                                </L7p:Namespaces>\n                                <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                            </L7p:XpathExpression>\n                        </L7p:ResponseXpathAssertion>\n                        <wsp:OneOrMore wsp:Usage=\"Required\">\n                            <L7p:ResponseXpathAssertion>\n                                <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Retrieve the user's first name\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:AssertionComment>\n                                <L7p:VariablePrefix stringValue=\"firstName\"/>\n                                <L7p:XmlMsgSrc stringValue=\"user.xml\"/>\n                                <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                    <L7p:Expression stringValue=\"/l7:User/l7:FirstName\"/>\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                                </L7p:XpathExpression>\n                            </L7p:ResponseXpathAssertion>\n                            <L7p:SetVariable>\n                                <L7p:Base64Expression stringValue=\"\"/>\n                                <L7p:VariableToSet stringValue=\"firstName.result\"/>\n                            </L7p:SetVariable>\n                            <L7p:assertionComment>\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// FirstName may not be present\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:assertionComment>\n                        </wsp:OneOrMore>\n                        <wsp:OneOrMore wsp:Usage=\"Required\">\n                            <L7p:ResponseXpathAssertion>\n                                <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Retrieve the user's last name\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:AssertionComment>\n                                <L7p:VariablePrefix stringValue=\"lastName\"/>\n                                <L7p:XmlMsgSrc stringValue=\"user.xml\"/>\n                                <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                    <L7p:Expression stringValue=\"/l7:User/l7:LastName\"/>\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                                </L7p:XpathExpression>\n                            </L7p:ResponseXpathAssertion>\n                            <L7p:SetVariable>\n                                <L7p:Base64Expression stringValue=\"\"/>\n                                <L7p:VariableToSet stringValue=\"lastName.result\"/>\n                            </L7p:SetVariable>\n                            <L7p:assertionComment>\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// LastName may not be present\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:assertionComment>\n                        </wsp:OneOrMore>\n                        <L7p:ResponseXpathAssertion>\n                            <L7p:AssertionComment assertionComment=\"included\">\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// retrieve the user's email\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:AssertionComment>\n                            <L7p:VariablePrefix stringValue=\"email\"/>\n                            <L7p:XmlMsgSrc stringValue=\"user.xml\"/>\n                            <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                <L7p:Expression stringValue=\"/l7:User/l7:Email\"/>\n                                <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                    </L7p:entry>\n                                </L7p:Namespaces>\n                                <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                            </L7p:XpathExpression>\n                        </L7p:ResponseXpathAssertion>\n                        <wsp:OneOrMore wsp:Usage=\"Required\">\n                            <L7p:ResponseXpathAssertion>\n                                <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Retrieve the user's subject DN\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:AssertionComment>\n                                <L7p:VariablePrefix stringValue=\"subjectDn\"/>\n                                <L7p:XmlMsgSrc stringValue=\"user.xml\"/>\n                                <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                    <L7p:Expression stringValue=\"/l7:User/l7:SubjectDn\"/>\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                                </L7p:XpathExpression>\n                            </L7p:ResponseXpathAssertion>\n                            <L7p:SetVariable>\n                                <L7p:Base64Expression stringValue=\"\"/>\n                                <L7p:VariableToSet stringValue=\"subjectDn.result\"/>\n                            </L7p:SetVariable>\n                            <L7p:assertionComment>\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// SubjectDn may not be present\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:assertionComment>\n                        </wsp:OneOrMore>\n                        <wsp:OneOrMore wsp:Usage=\"Required\">\n                            <L7p:ResponseXpathAssertion>\n                                <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Retrieve the user enabled state\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:AssertionComment>\n                                <L7p:VariablePrefix stringValue=\"enabled\"/>\n                                <L7p:XmlMsgSrc stringValue=\"user.xml\"/>\n                                <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                    <L7p:Expression stringValue=\"/l7:User/l7:Properties/l7:Property[@key='enabled']/l7:BooleanValue\"/>\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                                </L7p:XpathExpression>\n                            </L7p:ResponseXpathAssertion>\n                            <L7p:SetVariable>\n                                <L7p:Base64Expression stringValue=\"dHJ1ZQ==\"/>\n                                <L7p:VariableToSet stringValue=\"enabled.result\"/>\n                            </L7p:SetVariable>\n                            <L7p:assertionComment>\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Enabled is only valid for IIP\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:assertionComment>\n                        </wsp:OneOrMore>\n                        <L7p:SetVariable>\n                            <L7p:Base64Expression stringValue=\"JHt1c2Vycy5zb3J0ZWR9PFVzZXIgaWQ9IiR7aWQucmVzdWx0fSIgcHJvdmlkZXJJZD0iJHtwcm92aWRlcklkLnJlc3VsdH0iIHByb3ZpZGVyVHlwZT0iJHtwcm92aWRlclR5cGUucmVzdWx0fSIgcHJvdmlkZXJOYW1lPSIke3Byb3ZpZGVyTmFtZS5yZXN1bHR9Ij48TmFtZT48IVtDREFUQVske25hbWUucmVzdWx0fV1dPjwvTmFtZT48TG9naW4+PCFbQ0RBVEFbJHtsb2dpbi5yZXN1bHR9XV0+PC9Mb2dpbj48Rmlyc3ROYW1lPjwhW0NEQVRBWyR7Zmlyc3ROYW1lLnJlc3VsdH1dXT48L0ZpcnN0TmFtZT48TGFzdE5hbWU+PCFbQ0RBVEFbJHtsYXN0TmFtZS5yZXN1bHR9XV0+PC9MYXN0TmFtZT48RW1haWw+PCFbQ0RBVEFbJHtlbWFpbC5yZXN1bHR9XV0+PC9FbWFpbD48U3ViamVjdERuPjwhW0NEQVRBWyR7c3ViamVjdERuLnJlc3VsdH1dXT48L1N1YmplY3REbj48RW5hYmxlZD4ke2VuYWJsZWQucmVzdWx0fTwvRW5hYmxlZD48L1VzZXI+\"/>\n                            <L7p:VariableToSet stringValue=\"users.sorted\"/>\n                        </L7p:SetVariable>\n                        <L7p:assertionComment>\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Build the list of users\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:assertionComment>\n                    </L7p:ForEachLoop>\n                </L7p:ForEachLoop>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"JHt1c2Vycy5zb3J0ZWR9PC9Vc2Vycz4=\"/>\n                    <L7p:ContentType stringValue=\"text/xml; charset=utf-8\"/>\n                    <L7p:DataType variableDataType=\"message\"/>\n                    <L7p:VariableToSet stringValue=\"users.sorted\"/>\n                </L7p:SetVariable>\n                <L7p:XslTransformation>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// Sort the users by identity provider and user name\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Direction intValue=\"-1\"/>\n                    <L7p:OtherTargetMessageVariable stringValue=\"users.sorted\"/>\n                    <L7p:ResourceInfo staticResourceInfo=\"included\">\n                        <L7p:Document stringValue=\"&lt;xsl:stylesheet version=&quot;1.0&quot; xmlns:l7=&quot;http://ns.l7tech.com/2010/04/gateway-management&quot; xmlns:xsl=&quot;http://www.w3.org/1999/XSL/Transform&quot;>&lt;xsl:template match=&quot;/Users&quot;>    &lt;xsl:copy>        &lt;xsl:for-each select=&quot;User&quot;>            &lt;xsl:sort select=&quot;./@providerName&quot;/>            &lt;xsl:sort select=&quot;./Name&quot;/>            &lt;xsl:copy-of select=&quot;.&quot;/>        &lt;/xsl:for-each>    &lt;/xsl:copy>&lt;/xsl:template>&lt;/xsl:stylesheet>\"/>\n                    </L7p:ResourceInfo>\n                    <L7p:Target target=\"OTHER\"/>\n                    <L7p:TransformName stringValue=\"\"/>\n                    <L7p:XsltVersion stringValue=\"1.0\"/>\n                </L7p:XslTransformation>\n                <L7p:CacheStorage>\n                    <L7p:CacheEntryKey stringValue=\"${cacheKey}\"/>\n                    <L7p:CacheId stringValue=\"userList\"/>\n                    <L7p:MaxEntries stringValue=\"1\"/>\n                    <L7p:MaxEntryAgeSeconds stringValue=\"${cacheAge}\"/>\n                    <L7p:MaxEntrySizeBytes stringValue=\"200000\"/>\n                    <L7p:OtherTargetMessageVariable stringValue=\"users.sorted\"/>\n                    <L7p:StoreSoapFaults booleanValue=\"true\"/>\n                    <L7p:Target target=\"OTHER\"/>\n                </L7p:CacheStorage>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"c3lzdGVt\"/>\n                    <L7p:VariableToSet stringValue=\"source\"/>\n                </L7p:SetVariable>\n                <L7p:AuditDetailAssertion>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// FINE\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Detail stringValue=\"==> Loaded users.sorted from system and stored to cache\"/>\n                    <L7p:Level stringValue=\"FINE\"/>\n                </L7p:AuditDetailAssertion>\n                <L7p:assertionComment>\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// Retrieve new list and cache\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:assertionComment>\n            </wsp:All>\n            <wsp:All wsp:Usage=\"Required\">\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"RXJyb3Igd2hlbiBsaXN0aW5nIHVzZXJz\"/>\n                    <L7p:VariableToSet stringValue=\"error.msg\"/>\n                </L7p:SetVariable>\n                <L7p:AuditDetailAssertion>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// WARNING\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Detail stringValue=\"==> Error listing users in ${policy.name}\"/>\n                    <L7p:Level stringValue=\"WARNING\"/>\n                </L7p:AuditDetailAssertion>\n                <L7p:FalseAssertion/>\n                <L7p:assertionComment>\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// Failure - set ${error.msg}\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:assertionComment>\n            </wsp:All>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Caching logic\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:OneOrMore>\n        <L7p:Regex>\n            <L7p:AssertionComment assertionComment=\"included\">\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Add source attribute to /Users element\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:AssertionComment>\n            <L7p:AutoTarget booleanValue=\"false\"/>\n            <L7p:OtherTargetMessageVariable stringValue=\"users.sorted\"/>\n            <L7p:Regex stringValue=\"&lt;Users>\"/>\n            <L7p:Replace booleanValue=\"true\"/>\n            <L7p:Replacement stringValue=\"&lt;Users source=&quot;${source}&quot;>\"/>\n            <L7p:Target target=\"OTHER\"/>\n        </L7p:Regex>\n        <L7p:AuditDetailAssertion>\n            <L7p:AssertionComment assertionComment=\"included\">\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// FINE\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:AssertionComment>\n            <L7p:Detail stringValue=\"==> Leaving Utility Fragment: ${policy.name}\"/>\n            <L7p:Level stringValue=\"FINE\"/>\n        </L7p:AuditDetailAssertion>\n    </wsp:All>\n</wsp:Policy>\n"
      },
      "policyRevisions": [
        {
          "goid": "bed4baf4ff33b7e528854c3965d9bb70",
          "ordinal": 1,
          "active": true,
          "author": "admin",
          "time": "2025-02-05T14:20:38.661Z",
          "xml": "<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<wsp:Policy xmlns:L7p=\"http://www.layer7tech.com/ws/policy\" xmlns:wsp=\"http://schemas.xmlsoap.org/ws/2002/12/policy\">\n    <wsp:All wsp:Usage=\"Required\">\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Policy fragment for &quot;Utility: List Users&quot; encapsulated assertion\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Call Restman and generate a sorted list of users from all but LDAP and Policy Backed identity providers\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** - Assumes an admin role user has been authenticated\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** - Caches results for ${cacheAge} seconds (default=300). To refresh the cache set ${refresh}=true when calling\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** - Returns a text/xml message variable in ${users.sorted}\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Inputs:\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - identityProviderIds (string)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - refresh (string)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - cacheAge (string)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Outputs:\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - users.sorted (message)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**   - error.msg (string)\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** v1.0.0 - Jay MacDonald - 20201107 - Initial Version\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n        </L7p:CommentAssertion>\n        <L7p:AuditDetailAssertion>\n            <L7p:AssertionComment assertionComment=\"included\">\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// FINE\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:AssertionComment>\n            <L7p:Detail stringValue=\"==> Entering Utility Fragment: ${policy.name} (refresh=${refresh})\"/>\n            <L7p:Level stringValue=\"FINE\"/>\n        </L7p:AuditDetailAssertion>\n        <wsp:All wsp:Usage=\"Required\">\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** ${users.sorted} has the following schema:\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** \"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** &lt;Users source=&quot;system|cache&quot;>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   &lt;User id=&quot;string&quot; providerId=&quot;string&quot; providerType=&quot;string&quot; providerName=&quot;string&quot;>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**     &lt;Name>string&lt;/Name>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**     &lt;Login>string&lt;/Login>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**     &lt;FirstName>string&lt;/FirstName>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**     &lt;LastName>string&lt;/LastName>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**     &lt;Email>string&lt;/Email>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**     &lt;SubjectDn>string&lt;/SubjectDn>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**     &lt;Enabled>boolean&lt;/Enabled>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   &lt;/User>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"**   ...\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"** &lt;/Users>\"/>\n            </L7p:CommentAssertion>\n            <L7p:CommentAssertion>\n                <L7p:Comment stringValue=\"*****************************************************************************************************\"/>\n            </L7p:CommentAssertion>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Description of ${users.sorted}\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:All>\n        <wsp:OneOrMore wsp:Usage=\"Required\">\n            <L7p:ComparisonAssertion>\n                <L7p:AssertionComment assertionComment=\"included\">\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// true or false\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:AssertionComment>\n                <L7p:CaseSensitive booleanValue=\"false\"/>\n                <L7p:Expression1 stringValue=\"${cacheAge}\"/>\n                <L7p:Operator operatorNull=\"null\"/>\n                <L7p:Predicates predicates=\"included\">\n                    <L7p:item dataType=\"included\">\n                        <L7p:Type variableDataType=\"int\"/>\n                    </L7p:item>\n                    <L7p:item binary=\"included\">\n                        <L7p:CaseSensitive booleanValue=\"false\"/>\n                        <L7p:Operator operator=\"GT\"/>\n                        <L7p:RightValue stringValue=\"0\"/>\n                    </L7p:item>\n                </L7p:Predicates>\n            </L7p:ComparisonAssertion>\n            <L7p:SetVariable>\n                <L7p:Base64Expression stringValue=\"MzAw\"/>\n                <L7p:DataType variableDataType=\"int\"/>\n                <L7p:VariableToSet stringValue=\"cacheAge\"/>\n            </L7p:SetVariable>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Ensure ${cacheAge} is set, default=300\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:OneOrMore>\n        <wsp:OneOrMore wsp:Usage=\"Required\">\n            <L7p:ComparisonAssertion>\n                <L7p:AssertionComment assertionComment=\"included\">\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// true or false\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:AssertionComment>\n                <L7p:CaseSensitive booleanValue=\"false\"/>\n                <L7p:Expression1 stringValue=\"${refresh}\"/>\n                <L7p:Operator operatorNull=\"null\"/>\n                <L7p:Predicates predicates=\"included\">\n                    <L7p:item dataType=\"included\">\n                        <L7p:Type variableDataType=\"string\"/>\n                    </L7p:item>\n                    <L7p:item regex=\"included\">\n                        <L7p:Pattern stringValue=\"^(true|false)$\"/>\n                    </L7p:item>\n                </L7p:Predicates>\n            </L7p:ComparisonAssertion>\n            <L7p:SetVariable>\n                <L7p:Base64Expression stringValue=\"ZmFsc2U=\"/>\n                <L7p:VariableToSet stringValue=\"refresh\"/>\n            </L7p:SetVariable>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Ensure ${refresh} is set, default=false\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:OneOrMore>\n        <L7p:SetVariable>\n            <L7p:Base64Expression stringValue=\"dXNlcnMuc29ydGVk\"/>\n            <L7p:VariableToSet stringValue=\"cacheKey\"/>\n        </L7p:SetVariable>\n        <wsp:OneOrMore wsp:Usage=\"Required\">\n            <wsp:All wsp:Usage=\"Required\">\n                <L7p:ComparisonAssertion>\n                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                    <L7p:Expression1 stringValue=\"${refresh}\"/>\n                    <L7p:Operator operatorNull=\"null\"/>\n                    <L7p:Predicates predicates=\"included\">\n                        <L7p:item dataType=\"included\">\n                            <L7p:Type variableDataType=\"string\"/>\n                        </L7p:item>\n                        <L7p:item binary=\"included\">\n                            <L7p:Negated booleanValue=\"true\"/>\n                            <L7p:RightValue stringValue=\"true\"/>\n                        </L7p:item>\n                    </L7p:Predicates>\n                </L7p:ComparisonAssertion>\n                <L7p:CacheLookup>\n                    <L7p:CacheEntryKey stringValue=\"${cacheKey}\"/>\n                    <L7p:CacheId stringValue=\"userList\"/>\n                    <L7p:ContentTypeOverride stringValue=\"\"/>\n                    <L7p:MaxEntryAgeSeconds stringValue=\"${cacheAge}\"/>\n                    <L7p:OtherTargetMessageVariable stringValue=\"users.sorted\"/>\n                    <L7p:Target target=\"OTHER\"/>\n                </L7p:CacheLookup>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"Y2FjaGU=\"/>\n                    <L7p:VariableToSet stringValue=\"source\"/>\n                </L7p:SetVariable>\n                <L7p:AuditDetailAssertion>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// FINE\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Detail stringValue=\"==> Found users.sorted in the cache\"/>\n                    <L7p:Level stringValue=\"FINE\"/>\n                </L7p:AuditDetailAssertion>\n                <L7p:assertionComment>\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// Look in cache unless asked to refresh cache\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:assertionComment>\n            </wsp:All>\n            <wsp:All wsp:Usage=\"Required\">\n                <L7p:Encapsulated>\n                    <L7p:EncapsulatedAssertionConfigGuid stringValue=\"1ab6158d-33ce-4fa6-a7d8-2b8dc8e31faf\"/>\n                    <L7p:EncapsulatedAssertionConfigName stringValue=\"Utility: List Identity Providers\"/>\n                    <L7p:Parameters mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"cacheAge\"/>\n                            <L7p:value stringValue=\"${cacheAge}\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"refresh\"/>\n                            <L7p:value stringValue=\"${refresh}\"/>\n                        </L7p:entry>\n                    </L7p:Parameters>\n                </L7p:Encapsulated>\n                <wsp:OneOrMore wsp:Usage=\"Required\">\n                    <wsp:All wsp:Usage=\"Required\">\n                        <L7p:ComparisonAssertion>\n                            <L7p:CaseSensitive booleanValue=\"false\"/>\n                            <L7p:Expression1 stringValue=\"${identityProviderIds}\"/>\n                            <L7p:Expression2 stringValue=\"\"/>\n                            <L7p:Negate booleanValue=\"true\"/>\n                            <L7p:Operator operator=\"EMPTY\"/>\n                            <L7p:Predicates predicates=\"included\">\n                                <L7p:item binary=\"included\">\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:Negated booleanValue=\"true\"/>\n                                    <L7p:Operator operator=\"EMPTY\"/>\n                                    <L7p:RightValue stringValue=\"\"/>\n                                </L7p:item>\n                            </L7p:Predicates>\n                        </L7p:ComparisonAssertion>\n                        <L7p:Split>\n                            <L7p:InputVariable stringValue=\"identityProviderIds\"/>\n                            <L7p:OutputVariable stringValue=\"identityProviderIds.results\"/>\n                        </L7p:Split>\n                        <L7p:assertionComment>\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// identity provider ids is set so split into ${identityProviderIds.results}\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:assertionComment>\n                    </wsp:All>\n                    <wsp:All wsp:Usage=\"Required\">\n                        <L7p:ResponseXpathAssertion>\n                            <L7p:VariablePrefix stringValue=\"identityProviderIds\"/>\n                            <L7p:XmlMsgSrc stringValue=\"identityProviders.sorted\"/>\n                            <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                <L7p:Expression stringValue=\"/IdentityProviders/IdentityProvider[Type='Internal' or Type='Federated']/@id\"/>\n                                <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"s\"/>\n                                    <L7p:value stringValue=\"http://schemas.xmlsoap.org/soap/envelope/\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                    </L7p:entry>\n                                </L7p:Namespaces>\n                                <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                            </L7p:XpathExpression>\n                        </L7p:ResponseXpathAssertion>\n                        <L7p:assertionComment>\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// No identity provider ids set, so get list of them\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:assertionComment>\n                    </wsp:All>\n                    <L7p:assertionComment>\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// If identityProviderId is not set, find list of all of them\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:assertionComment>\n                </wsp:OneOrMore>\n                <L7p:AuditDetailAssertion>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// FINE\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Detail stringValue=\"==> identityProviderIds.results ${identityProviderIds.results}\"/>\n                    <L7p:Level stringValue=\"FINE\"/>\n                </L7p:AuditDetailAssertion>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz48VXNlcnM+\"/>\n                    <L7p:VariableToSet stringValue=\"users.sorted\"/>\n                </L7p:SetVariable>\n                <L7p:ForEachLoop L7p:Usage=\"Required\"\n                    loopVariable=\"identityProviderIds.results\" variablePrefix=\"identityProviderId\">\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Retrieve the type of the identity provider\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:VariablePrefix stringValue=\"providerType\"/>\n                        <L7p:XmlMsgSrc stringValue=\"identityProviders.sorted\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/IdentityProviders/IdentityProvider[@id=$identityProviderId.current]/Type\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <L7p:ResponseXpathAssertion>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Retrieve the type of the identity provider\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:VariablePrefix stringValue=\"providerName\"/>\n                        <L7p:XmlMsgSrc stringValue=\"identityProviders.sorted\"/>\n                        <L7p:XpathExpression xpathExpressionValue=\"included\">\n                            <L7p:Expression stringValue=\"/IdentityProviders/IdentityProvider[@id=$identityProviderId.current]/Name\"/>\n                            <L7p:Namespaces mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                </L7p:entry>\n                            </L7p:Namespaces>\n                            <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                        </L7p:XpathExpression>\n                    </L7p:ResponseXpathAssertion>\n                    <L7p:Encapsulated>\n                        <L7p:AssertionComment assertionComment=\"included\">\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// GET users\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:AssertionComment>\n                        <L7p:EncapsulatedAssertionConfigGuid stringValue=\"c8a5a0d5-1ae2-4144-b538-5c311efc1560\"/>\n                        <L7p:EncapsulatedAssertionConfigName stringValue=\"Utility: Call Restman\"/>\n                        <L7p:Parameters mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"element\"/>\n                                <L7p:value stringValue=\"User\"/>\n                            </L7p:entry>\n                            <L7p:entry>\n                                <L7p:key stringValue=\"message\"/>\n                                <L7p:value stringValue=\"\"/>\n                            </L7p:entry>\n                            <L7p:entry>\n                                <L7p:key stringValue=\"method\"/>\n                                <L7p:value stringValue=\"GET\"/>\n                            </L7p:entry>\n                            <L7p:entry>\n                                <L7p:key stringValue=\"resource\"/>\n                                <L7p:value stringValue=\"identityProviders/${identityProviderId.current}/users\"/>\n                            </L7p:entry>\n                        </L7p:Parameters>\n                    </L7p:Encapsulated>\n                    <wsp:OneOrMore wsp:Usage=\"Required\">\n                        <L7p:ResponseXpathAssertion>\n                            <L7p:VariablePrefix stringValue=\"users\"/>\n                            <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                <L7p:Expression stringValue=\"/l7:List/l7:Item/l7:Resource/l7:User\"/>\n                                <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                    </L7p:entry>\n                                </L7p:Namespaces>\n                                <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                            </L7p:XpathExpression>\n                        </L7p:ResponseXpathAssertion>\n                        <L7p:TrueAssertion/>\n                        <L7p:assertionComment>\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Extract the list of users, never fail\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:assertionComment>\n                    </wsp:OneOrMore>\n                    <L7p:ForEachLoop L7p:Usage=\"Required\"\n                        loopVariable=\"users.elements\" variablePrefix=\"user\">\n                        <L7p:SetVariable>\n                            <L7p:AssertionComment assertionComment=\"included\">\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Cast to message type for parsing\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:AssertionComment>\n                            <L7p:Base64Expression stringValue=\"JHt1c2VyLmN1cnJlbnR9\"/>\n                            <L7p:ContentType stringValue=\"text/xml; charset=utf-8\"/>\n                            <L7p:DataType variableDataType=\"message\"/>\n                            <L7p:VariableToSet stringValue=\"user.xml\"/>\n                        </L7p:SetVariable>\n                        <L7p:ResponseXpathAssertion>\n                            <L7p:AssertionComment assertionComment=\"included\">\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Retrieve the user ID\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:AssertionComment>\n                            <L7p:VariablePrefix stringValue=\"id\"/>\n                            <L7p:XmlMsgSrc stringValue=\"user.xml\"/>\n                            <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                <L7p:Expression stringValue=\"/l7:User/@id\"/>\n                                <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                    </L7p:entry>\n                                </L7p:Namespaces>\n                                <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                            </L7p:XpathExpression>\n                        </L7p:ResponseXpathAssertion>\n                        <L7p:ResponseXpathAssertion>\n                            <L7p:AssertionComment assertionComment=\"included\">\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Retrieve the user's provider ID\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:AssertionComment>\n                            <L7p:VariablePrefix stringValue=\"providerId\"/>\n                            <L7p:XmlMsgSrc stringValue=\"user.xml\"/>\n                            <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                <L7p:Expression stringValue=\"/l7:User/@providerId\"/>\n                                <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                    </L7p:entry>\n                                </L7p:Namespaces>\n                                <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                            </L7p:XpathExpression>\n                        </L7p:ResponseXpathAssertion>\n                        <L7p:ResponseXpathAssertion>\n                            <L7p:AssertionComment assertionComment=\"included\">\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Retrieve the user name\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:AssertionComment>\n                            <L7p:VariablePrefix stringValue=\"name\"/>\n                            <L7p:XmlMsgSrc stringValue=\"user.xml\"/>\n                            <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                <L7p:Expression stringValue=\"/l7:User/l7:Properties/l7:Property[@key='name']/l7:StringValue\"/>\n                                <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                    </L7p:entry>\n                                </L7p:Namespaces>\n                                <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                            </L7p:XpathExpression>\n                        </L7p:ResponseXpathAssertion>\n                        <L7p:ResponseXpathAssertion>\n                            <L7p:AssertionComment assertionComment=\"included\">\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Retrieve the user login\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:AssertionComment>\n                            <L7p:VariablePrefix stringValue=\"login\"/>\n                            <L7p:XmlMsgSrc stringValue=\"user.xml\"/>\n                            <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                <L7p:Expression stringValue=\"/l7:User/l7:Login\"/>\n                                <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                    </L7p:entry>\n                                </L7p:Namespaces>\n                                <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                            </L7p:XpathExpression>\n                        </L7p:ResponseXpathAssertion>\n                        <wsp:OneOrMore wsp:Usage=\"Required\">\n                            <L7p:ResponseXpathAssertion>\n                                <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Retrieve the user's first name\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:AssertionComment>\n                                <L7p:VariablePrefix stringValue=\"firstName\"/>\n                                <L7p:XmlMsgSrc stringValue=\"user.xml\"/>\n                                <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                    <L7p:Expression stringValue=\"/l7:User/l7:FirstName\"/>\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                                </L7p:XpathExpression>\n                            </L7p:ResponseXpathAssertion>\n                            <L7p:SetVariable>\n                                <L7p:Base64Expression stringValue=\"\"/>\n                                <L7p:VariableToSet stringValue=\"firstName.result\"/>\n                            </L7p:SetVariable>\n                            <L7p:assertionComment>\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// FirstName may not be present\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:assertionComment>\n                        </wsp:OneOrMore>\n                        <wsp:OneOrMore wsp:Usage=\"Required\">\n                            <L7p:ResponseXpathAssertion>\n                                <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Retrieve the user's last name\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:AssertionComment>\n                                <L7p:VariablePrefix stringValue=\"lastName\"/>\n                                <L7p:XmlMsgSrc stringValue=\"user.xml\"/>\n                                <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                    <L7p:Expression stringValue=\"/l7:User/l7:LastName\"/>\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                                </L7p:XpathExpression>\n                            </L7p:ResponseXpathAssertion>\n                            <L7p:SetVariable>\n                                <L7p:Base64Expression stringValue=\"\"/>\n                                <L7p:VariableToSet stringValue=\"lastName.result\"/>\n                            </L7p:SetVariable>\n                            <L7p:assertionComment>\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// LastName may not be present\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:assertionComment>\n                        </wsp:OneOrMore>\n                        <L7p:ResponseXpathAssertion>\n                            <L7p:AssertionComment assertionComment=\"included\">\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// retrieve the user's email\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:AssertionComment>\n                            <L7p:VariablePrefix stringValue=\"email\"/>\n                            <L7p:XmlMsgSrc stringValue=\"user.xml\"/>\n                            <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                <L7p:Expression stringValue=\"/l7:User/l7:Email\"/>\n                                <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                    </L7p:entry>\n                                </L7p:Namespaces>\n                                <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                            </L7p:XpathExpression>\n                        </L7p:ResponseXpathAssertion>\n                        <wsp:OneOrMore wsp:Usage=\"Required\">\n                            <L7p:ResponseXpathAssertion>\n                                <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Retrieve the user's subject DN\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:AssertionComment>\n                                <L7p:VariablePrefix stringValue=\"subjectDn\"/>\n                                <L7p:XmlMsgSrc stringValue=\"user.xml\"/>\n                                <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                    <L7p:Expression stringValue=\"/l7:User/l7:SubjectDn\"/>\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                                </L7p:XpathExpression>\n                            </L7p:ResponseXpathAssertion>\n                            <L7p:SetVariable>\n                                <L7p:Base64Expression stringValue=\"\"/>\n                                <L7p:VariableToSet stringValue=\"subjectDn.result\"/>\n                            </L7p:SetVariable>\n                            <L7p:assertionComment>\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// SubjectDn may not be present\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:assertionComment>\n                        </wsp:OneOrMore>\n                        <wsp:OneOrMore wsp:Usage=\"Required\">\n                            <L7p:ResponseXpathAssertion>\n                                <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Retrieve the user enabled state\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:AssertionComment>\n                                <L7p:VariablePrefix stringValue=\"enabled\"/>\n                                <L7p:XmlMsgSrc stringValue=\"user.xml\"/>\n                                <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                    <L7p:Expression stringValue=\"/l7:User/l7:Properties/l7:Property[@key='enabled']/l7:BooleanValue\"/>\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                                </L7p:XpathExpression>\n                            </L7p:ResponseXpathAssertion>\n                            <L7p:SetVariable>\n                                <L7p:Base64Expression stringValue=\"dHJ1ZQ==\"/>\n                                <L7p:VariableToSet stringValue=\"enabled.result\"/>\n                            </L7p:SetVariable>\n                            <L7p:assertionComment>\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Enabled is only valid for IIP\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:assertionComment>\n                        </wsp:OneOrMore>\n                        <L7p:SetVariable>\n                            <L7p:Base64Expression stringValue=\"JHt1c2Vycy5zb3J0ZWR9PFVzZXIgaWQ9IiR7aWQucmVzdWx0fSIgcHJvdmlkZXJJZD0iJHtwcm92aWRlcklkLnJlc3VsdH0iIHByb3ZpZGVyVHlwZT0iJHtwcm92aWRlclR5cGUucmVzdWx0fSIgcHJvdmlkZXJOYW1lPSIke3Byb3ZpZGVyTmFtZS5yZXN1bHR9Ij48TmFtZT48IVtDREFUQVske25hbWUucmVzdWx0fV1dPjwvTmFtZT48TG9naW4+PCFbQ0RBVEFbJHtsb2dpbi5yZXN1bHR9XV0+PC9Mb2dpbj48Rmlyc3ROYW1lPjwhW0NEQVRBWyR7Zmlyc3ROYW1lLnJlc3VsdH1dXT48L0ZpcnN0TmFtZT48TGFzdE5hbWU+PCFbQ0RBVEFbJHtsYXN0TmFtZS5yZXN1bHR9XV0+PC9MYXN0TmFtZT48RW1haWw+PCFbQ0RBVEFbJHtlbWFpbC5yZXN1bHR9XV0+PC9FbWFpbD48U3ViamVjdERuPjwhW0NEQVRBWyR7c3ViamVjdERuLnJlc3VsdH1dXT48L1N1YmplY3REbj48RW5hYmxlZD4ke2VuYWJsZWQucmVzdWx0fTwvRW5hYmxlZD48L1VzZXI+\"/>\n                            <L7p:VariableToSet stringValue=\"users.sorted\"/>\n                        </L7p:SetVariable>\n                        <L7p:assertionComment>\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Build the list of users\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:assertionComment>\n                    </L7p:ForEachLoop>\n                </L7p:ForEachLoop>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"JHt1c2Vycy5zb3J0ZWR9PC9Vc2Vycz4=\"/>\n                    <L7p:ContentType stringValue=\"text/xml; charset=utf-8\"/>\n                    <L7p:DataType variableDataType=\"message\"/>\n                    <L7p:VariableToSet stringValue=\"users.sorted\"/>\n                </L7p:SetVariable>\n                <L7p:XslTransformation>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// Sort the users by identity provider and user name\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Direction intValue=\"-1\"/>\n                    <L7p:OtherTargetMessageVariable stringValue=\"users.sorted\"/>\n                    <L7p:ResourceInfo staticResourceInfo=\"included\">\n                        <L7p:Document stringValue=\"&lt;xsl:stylesheet version=&quot;1.0&quot; xmlns:l7=&quot;http://ns.l7tech.com/2010/04/gateway-management&quot; xmlns:xsl=&quot;http://www.w3.org/1999/XSL/Transform&quot;>&lt;xsl:template match=&quot;/Users&quot;>    &lt;xsl:copy>        &lt;xsl:for-each select=&quot;User&quot;>            &lt;xsl:sort select=&quot;./@providerName&quot;/>            &lt;xsl:sort select=&quot;./Name&quot;/>            &lt;xsl:copy-of select=&quot;.&quot;/>        &lt;/xsl:for-each>    &lt;/xsl:copy>&lt;/xsl:template>&lt;/xsl:stylesheet>\"/>\n                    </L7p:ResourceInfo>\n                    <L7p:Target target=\"OTHER\"/>\n                    <L7p:TransformName stringValue=\"\"/>\n                    <L7p:XsltVersion stringValue=\"1.0\"/>\n                </L7p:XslTransformation>\n                <L7p:CacheStorage>\n                    <L7p:CacheEntryKey stringValue=\"${cacheKey}\"/>\n                    <L7p:CacheId stringValue=\"userList\"/>\n                    <L7p:MaxEntries stringValue=\"1\"/>\n                    <L7p:MaxEntryAgeSeconds stringValue=\"${cacheAge}\"/>\n                    <L7p:MaxEntrySizeBytes stringValue=\"200000\"/>\n                    <L7p:OtherTargetMessageVariable stringValue=\"users.sorted\"/>\n                    <L7p:StoreSoapFaults booleanValue=\"true\"/>\n                    <L7p:Target target=\"OTHER\"/>\n                </L7p:CacheStorage>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"c3lzdGVt\"/>\n                    <L7p:VariableToSet stringValue=\"source\"/>\n                </L7p:SetVariable>\n                <L7p:AuditDetailAssertion>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// FINE\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Detail stringValue=\"==> Loaded users.sorted from system and stored to cache\"/>\n                    <L7p:Level stringValue=\"FINE\"/>\n                </L7p:AuditDetailAssertion>\n                <L7p:assertionComment>\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// Retrieve new list and cache\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:assertionComment>\n            </wsp:All>\n            <wsp:All wsp:Usage=\"Required\">\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"RXJyb3Igd2hlbiBsaXN0aW5nIHVzZXJz\"/>\n                    <L7p:VariableToSet stringValue=\"error.msg\"/>\n                </L7p:SetVariable>\n                <L7p:AuditDetailAssertion>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// WARNING\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Detail stringValue=\"==> Error listing users in ${policy.name}\"/>\n                    <L7p:Level stringValue=\"WARNING\"/>\n                </L7p:AuditDetailAssertion>\n                <L7p:FalseAssertion/>\n                <L7p:assertionComment>\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// Failure - set ${error.msg}\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:assertionComment>\n            </wsp:All>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Caching logic\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:OneOrMore>\n        <L7p:Regex>\n            <L7p:AssertionComment assertionComment=\"included\">\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Add source attribute to /Users element\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:AssertionComment>\n            <L7p:AutoTarget booleanValue=\"false\"/>\n            <L7p:OtherTargetMessageVariable stringValue=\"users.sorted\"/>\n            <L7p:Regex stringValue=\"&lt;Users>\"/>\n            <L7p:Replace booleanValue=\"true\"/>\n            <L7p:Replacement stringValue=\"&lt;Users source=&quot;${source}&quot;>\"/>\n            <L7p:Target target=\"OTHER\"/>\n        </L7p:Regex>\n        <L7p:AuditDetailAssertion>\n            <L7p:AssertionComment assertionComment=\"included\">\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// FINE\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:AssertionComment>\n            <L7p:Detail stringValue=\"==> Leaving Utility Fragment: ${policy.name}\"/>\n            <L7p:Level stringValue=\"FINE\"/>\n        </L7p:AuditDetailAssertion>\n    </wsp:All>\n</wsp:Policy>\n"
        }
      ]
    }
  ],
  "services": [
    {
      "guid": "b5c187f8-4bac-4fa2-b663-9240ed6a7291",
      "name": "API Gateway Dependency Analyzer",
      "resolutionPath": "/apigw/dependencyAnalyzer",
      "serviceType": "WEB_API",
      "checksum": "655c272ce4ac7ed7c640eeba55ba27ea2f3a869e",
      "enabled": true,
      "folderPath": "/Gateway Management Utilities",
      "methodsAllowed": [
        "GET",
        "POST",
        "PUT",
        "DELETE"
      ],
      "tracingEnabled": false,
      "wssProcessingEnabled": false,
      "laxResolution": false,
      "properties": [
        {
          "name": "latencyMetrics.settings",
          "value": "false|INTERVAL|15000"
        },
        {
          "name": "latencyMetrics.subservices",
          "value": ""
        },
        {
          "name": "latencyMetrics.captureClientAndFolder",
          "value": "true|false"
        }
      ],
      "policy": {
        "xml": "<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<wsp:Policy xmlns:L7p=\"http://www.layer7tech.com/ws/policy\" xmlns:wsp=\"http://schemas.xmlsoap.org/ws/2002/12/policy\">\n    <wsp:All wsp:Usage=\"Required\">\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**************************************************************************************************************\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Web interface to determine what depends on something\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** WARNING: Most dependencies have been accounted for, but some are probably still missing.\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** Caches results for two hours. Check the &quot;Refresh cache&quot; box on the form to pull fresh data from Gateway\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** \"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"** v1.0.0 - Jay MacDonald - 20201107 - Initial Version\"/>\n        </L7p:CommentAssertion>\n        <L7p:CommentAssertion>\n            <L7p:Comment stringValue=\"**************************************************************************************************************\"/>\n        </L7p:CommentAssertion>\n        <L7p:AuditAssertion/>\n        <L7p:Encapsulated>\n            <L7p:EncapsulatedAssertionConfigGuid stringValue=\"4bd10104-a43c-4ecf-ae4d-b95e312cad4b\"/>\n            <L7p:EncapsulatedAssertionConfigName stringValue=\"Utility: Form and Session Authentication\"/>\n            <L7p:Parameters mapValue=\"included\">\n                <L7p:entry>\n                    <L7p:key stringValue=\"sessionTTL\"/>\n                    <L7p:value stringValue=\"1800\"/>\n                </L7p:entry>\n                <L7p:entry>\n                    <L7p:key stringValue=\"verifyAdmin\"/>\n                    <L7p:value stringValue=\"true\"/>\n                </L7p:entry>\n            </L7p:Parameters>\n        </L7p:Encapsulated>\n        <wsp:All wsp:Usage=\"Required\">\n            <wsp:All wsp:Usage=\"Required\">\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"VW5rbm93biBlcnJvciBmb3VuZA==\"/>\n                    <L7p:VariableToSet stringValue=\"error.message\"/>\n                </L7p:SetVariable>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"NTAw\"/>\n                    <L7p:VariableToSet stringValue=\"error.status\"/>\n                </L7p:SetVariable>\n                <L7p:CustomizeErrorResponse>\n                    <L7p:Content stringValue=\"&lt;html>&lt;head>  &lt;title>Error: ${error.message}&lt;/title>&lt;/head>&lt;body>  &lt;h1>Error&lt;/h1>  &lt;p>${error.message}&lt;/p>  &lt;hr/>&lt;/body>&lt;/html>\"/>\n                    <L7p:ContentType stringValue=\"text/html; charset=UTF-8\"/>\n                    <L7p:ExtraHeaders nameValuePairArray=\"included\"/>\n                    <L7p:HttpStatus stringValue=\"${error.status}\"/>\n                </L7p:CustomizeErrorResponse>\n                <L7p:assertionComment>\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// Configure error response\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:assertionComment>\n            </wsp:All>\n            <L7p:SetVariable>\n                <L7p:AssertionComment assertionComment=\"included\">\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// List of object types we recognize\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:AssertionComment>\n                <L7p:Base64Expression stringValue=\"Q2Fzc2FuZHJhIENvbm5lY3Rpb24sQ2x1c3RlciBQcm9wZXJ0eSxFbmNhcHN1bGF0ZWQgQXNzZXJ0aW9uLEdyb3VwLElkZW50aXR5IFByb3ZpZGVyLEpEQkMgQ29ubmVjdGlvbixKTVMgRGVzdGluYXRpb24sUG9saWN5LFByaXZhdGUgS2V5LFNlY3VyZSBQYXNzd29yZCxTZXJ2aWNlLFNpdGVNaW5kZXIgQ29uZmlndXJhdGlvbixUcnVzdGVkIENlcnRpZmljYXRlLFVzZXI=\"/>\n                <L7p:VariableToSet stringValue=\"objectTypes\"/>\n            </L7p:SetVariable>\n            <L7p:SetVariable>\n                <L7p:AssertionComment assertionComment=\"included\">\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// Set the default object type in case it was not passed as a parameter\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:AssertionComment>\n                <L7p:Base64Expression stringValue=\"UG9saWN5\"/>\n                <L7p:VariableToSet stringValue=\"objectType.default\"/>\n            </L7p:SetVariable>\n            <L7p:SetVariable>\n                <L7p:AssertionComment assertionComment=\"included\">\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// 2 hours\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:AssertionComment>\n                <L7p:Base64Expression stringValue=\"NzIwMA==\"/>\n                <L7p:VariableToSet stringValue=\"cacheAge\"/>\n            </L7p:SetVariable>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Configuration\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:All>\n        <wsp:OneOrMore wsp:Usage=\"Required\">\n            <wsp:All wsp:Usage=\"Required\">\n                <L7p:ComparisonAssertion>\n                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                    <L7p:Expression1 stringValue=\"${loggedIn}\"/>\n                    <L7p:Operator operatorNull=\"null\"/>\n                    <L7p:Predicates predicates=\"included\">\n                        <L7p:item dataType=\"included\">\n                            <L7p:Type variableDataType=\"boolean\"/>\n                        </L7p:item>\n                        <L7p:item binary=\"included\">\n                            <L7p:CaseSensitive booleanValue=\"false\"/>\n                            <L7p:RightValue stringValue=\"true\"/>\n                        </L7p:item>\n                    </L7p:Predicates>\n                </L7p:ComparisonAssertion>\n                <L7p:AuditDetailAssertion>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// INFO\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:Detail stringValue=\"==> User authenticated: ${username}\"/>\n                </L7p:AuditDetailAssertion>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"JHtyZXF1ZXN0Lmh0dHAucGFyYW1ldGVycy5vYmplY3RUeXBlfQ==\"/>\n                    <L7p:VariableToSet stringValue=\"objectType\"/>\n                </L7p:SetVariable>\n                <wsp:OneOrMore wsp:Usage=\"Required\">\n                    <L7p:ComparisonAssertion>\n                        <L7p:CaseSensitive booleanValue=\"false\"/>\n                        <L7p:Expression1 stringValue=\"${objectType}\"/>\n                        <L7p:Expression2 stringValue=\"\"/>\n                        <L7p:Negate booleanValue=\"true\"/>\n                        <L7p:Operator operator=\"EMPTY\"/>\n                        <L7p:Predicates predicates=\"included\">\n                            <L7p:item binary=\"included\">\n                                <L7p:CaseSensitive booleanValue=\"false\"/>\n                                <L7p:Negated booleanValue=\"true\"/>\n                                <L7p:Operator operator=\"EMPTY\"/>\n                                <L7p:RightValue stringValue=\"\"/>\n                            </L7p:item>\n                        </L7p:Predicates>\n                    </L7p:ComparisonAssertion>\n                    <L7p:SetVariable>\n                        <L7p:Base64Expression stringValue=\"JHtvYmplY3RUeXBlLmRlZmF1bHR9\"/>\n                        <L7p:VariableToSet stringValue=\"objectType\"/>\n                    </L7p:SetVariable>\n                    <L7p:assertionComment>\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// Default objectType is ${objectType.default}\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:assertionComment>\n                </wsp:OneOrMore>\n                <wsp:All wsp:Usage=\"Required\">\n                    <L7p:Split>\n                        <L7p:InputVariable stringValue=\"objectTypes\"/>\n                        <L7p:OutputVariable stringValue=\"objectTypes\"/>\n                    </L7p:Split>\n                    <wsp:OneOrMore wsp:Usage=\"Required\">\n                        <L7p:ComparisonAssertion>\n                            <L7p:Expression1 stringValue=\"${objectTypes}\"/>\n                            <L7p:Expression2 stringValue=\"${objectType}\"/>\n                            <L7p:MultivaluedComparison multivaluedComparison=\"ANY\"/>\n                            <L7p:Predicates predicates=\"included\">\n                                <L7p:item binary=\"included\">\n                                    <L7p:RightValue stringValue=\"${objectType}\"/>\n                                </L7p:item>\n                            </L7p:Predicates>\n                        </L7p:ComparisonAssertion>\n                        <wsp:All wsp:Usage=\"Required\">\n                            <L7p:SetVariable>\n                                <L7p:Base64Expression stringValue=\"VW5rbm93biBvYmplY3QgdHlwZTogJHtvYmplY3RUeXBlfTwvcD4NCg0KPHA+PGEgaHJlZj0iJHtyZXF1ZXN0LnVybC5wYXRofSI+Q29udGludWU8L2E+\"/>\n                                <L7p:VariableToSet stringValue=\"error.message\"/>\n                            </L7p:SetVariable>\n                            <L7p:SetVariable>\n                                <L7p:Base64Expression stringValue=\"NDAw\"/>\n                                <L7p:VariableToSet stringValue=\"error.status\"/>\n                            </L7p:SetVariable>\n                            <L7p:FalseAssertion/>\n                            <L7p:assertionComment>\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Fail\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:assertionComment>\n                        </wsp:All>\n                        <L7p:assertionComment>\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Verify the submitted objectType is legitimate\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:assertionComment>\n                    </wsp:OneOrMore>\n                    <L7p:SetVariable>\n                        <L7p:Base64Expression stringValue=\"PHNlbGVjdCBuYW1lPSJvYmplY3RUeXBlIiBvbmNoYW5nZT0ndGhpcy5mb3JtLnN1Ym1pdCgpJz4=\"/>\n                        <L7p:VariableToSet stringValue=\"objectType.select\"/>\n                    </L7p:SetVariable>\n                    <L7p:ForEachLoop L7p:Usage=\"Required\"\n                        loopVariable=\"objectTypes\" variablePrefix=\"objectType\">\n                        <wsp:OneOrMore wsp:Usage=\"Required\">\n                            <wsp:All wsp:Usage=\"Required\">\n                                <L7p:ComparisonAssertion>\n                                    <L7p:Expression1 stringValue=\"${objectType}\"/>\n                                    <L7p:Expression2 stringValue=\"${objectType.current}\"/>\n                                    <L7p:Predicates predicates=\"included\">\n                                    <L7p:item binary=\"included\">\n                                    <L7p:RightValue stringValue=\"${objectType.current}\"/>\n                                    </L7p:item>\n                                    </L7p:Predicates>\n                                </L7p:ComparisonAssertion>\n                                <L7p:SetVariable>\n                                    <L7p:Base64Expression stringValue=\"JHtvYmplY3RUeXBlLnNlbGVjdH08b3B0aW9uIHNlbGVjdGVkPiR7b2JqZWN0VHlwZS5jdXJyZW50fTwvb3B0aW9uPg==\"/>\n                                    <L7p:VariableToSet stringValue=\"objectType.select\"/>\n                                </L7p:SetVariable>\n                                <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// This is the selected one\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:assertionComment>\n                            </wsp:All>\n                            <L7p:SetVariable>\n                                <L7p:Base64Expression stringValue=\"JHtvYmplY3RUeXBlLnNlbGVjdH08b3B0aW9uPiR7b2JqZWN0VHlwZS5jdXJyZW50fTwvb3B0aW9uPg==\"/>\n                                <L7p:VariableToSet stringValue=\"objectType.select\"/>\n                            </L7p:SetVariable>\n                            <L7p:assertionComment>\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Append each objectType, setting selected when it is the current one\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:assertionComment>\n                        </wsp:OneOrMore>\n                    </L7p:ForEachLoop>\n                    <L7p:SetVariable>\n                        <L7p:Base64Expression stringValue=\"JHtvYmplY3RUeXBlLnNlbGVjdH08L3NlbGVjdD4=\"/>\n                        <L7p:VariableToSet stringValue=\"objectType.select\"/>\n                    </L7p:SetVariable>\n                    <L7p:assertionComment>\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// Build ${objectType.select} HTML element\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:assertionComment>\n                </wsp:All>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"JHtyZXF1ZXN0Lmh0dHAucGFyYW1ldGVyLmlkfQ==\"/>\n                    <L7p:VariableToSet stringValue=\"id\"/>\n                </L7p:SetVariable>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"\"/>\n                    <L7p:VariableToSet stringValue=\"htmlContent\"/>\n                </L7p:SetVariable>\n                <L7p:SetVariable>\n                    <L7p:Base64Expression stringValue=\"\"/>\n                    <L7p:VariableToSet stringValue=\"dependers.html\"/>\n                </L7p:SetVariable>\n                <L7p:Encapsulated>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// Retrieve all of the plicy XML for searching references\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:EncapsulatedAssertionConfigGuid stringValue=\"420909da-0e72-4996-a6ed-cf3c21b8bc59\"/>\n                    <L7p:EncapsulatedAssertionConfigName stringValue=\"Utility: Get All Policy XML\"/>\n                    <L7p:Parameters mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"cacheAge\"/>\n                            <L7p:value stringValue=\"${cacheAge}\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"refresh\"/>\n                            <L7p:value stringValue=\"${request.http.parameter.refresh}\"/>\n                        </L7p:entry>\n                    </L7p:Parameters>\n                </L7p:Encapsulated>\n                <L7p:Encapsulated>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// Need this to get folderpath, etc\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:EncapsulatedAssertionConfigGuid stringValue=\"da84740e-cee3-47d8-b6f7-0a9eb1fd9638\"/>\n                    <L7p:EncapsulatedAssertionConfigName stringValue=\"Utility: List Policies\"/>\n                    <L7p:Parameters mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"cacheAge\"/>\n                            <L7p:value stringValue=\"${cacheAge}\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"folderId\"/>\n                            <L7p:value stringValue=\"\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"policyList.refresh\"/>\n                            <L7p:value stringValue=\"${refresh}\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"refresh\"/>\n                            <L7p:value stringValue=\"${request.http.parameter.refresh}\"/>\n                        </L7p:entry>\n                    </L7p:Parameters>\n                </L7p:Encapsulated>\n                <L7p:Encapsulated>\n                    <L7p:AssertionComment assertionComment=\"included\">\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// Need this to get folderpath, etc\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:AssertionComment>\n                    <L7p:EncapsulatedAssertionConfigGuid stringValue=\"6fcf3e6c-eac9-4b2b-ac49-aa5fb2ff801f\"/>\n                    <L7p:EncapsulatedAssertionConfigName stringValue=\"Utility: List Services\"/>\n                    <L7p:Parameters mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"cacheAge\"/>\n                            <L7p:value stringValue=\"${cacheAge}\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"folderId\"/>\n                            <L7p:value stringValue=\"\"/>\n                        </L7p:entry>\n                        <L7p:entry>\n                            <L7p:key stringValue=\"refresh\"/>\n                            <L7p:value stringValue=\"${request.http.parameter.refresh}\"/>\n                        </L7p:entry>\n                    </L7p:Parameters>\n                </L7p:Encapsulated>\n                <wsp:OneOrMore wsp:Usage=\"Required\">\n                    <wsp:All wsp:Usage=\"Required\">\n                        <L7p:ComparisonAssertion>\n                            <L7p:CaseSensitive booleanValue=\"false\"/>\n                            <L7p:Expression1 stringValue=\"${objectType}\"/>\n                            <L7p:Expression2 stringValue=\"Cassandra Connection\"/>\n                            <L7p:Predicates predicates=\"included\">\n                                <L7p:item binary=\"included\">\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:RightValue stringValue=\"Cassandra Connection\"/>\n                                </L7p:item>\n                            </L7p:Predicates>\n                        </L7p:ComparisonAssertion>\n                        <L7p:AuditDetailAssertion>\n                            <L7p:AssertionComment assertionComment=\"included\">\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// FINE\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:AssertionComment>\n                            <L7p:Detail stringValue=\"======> Listing ${objectType} objects\"/>\n                            <L7p:Level stringValue=\"FINE\"/>\n                        </L7p:AuditDetailAssertion>\n                        <L7p:Encapsulated>\n                            <L7p:AssertionComment assertionComment=\"included\">\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Get list of objectTypes to display and search for references\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:AssertionComment>\n                            <L7p:EncapsulatedAssertionConfigGuid stringValue=\"b55454b6-3095-4e4d-92dc-3f10a6594fba\"/>\n                            <L7p:EncapsulatedAssertionConfigName stringValue=\"Utility: List Cassandra Connections\"/>\n                            <L7p:Parameters mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"cacheAge\"/>\n                                    <L7p:value stringValue=\"${cacheAge}\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"refresh\"/>\n                                    <L7p:value stringValue=\"${request.http.parameter.refresh}\"/>\n                                </L7p:entry>\n                            </L7p:Parameters>\n                        </L7p:Encapsulated>\n                        <L7p:ResponseXpathAssertion>\n                            <L7p:AssertionComment assertionComment=\"included\">\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Get list of ids\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:AssertionComment>\n                            <L7p:VariablePrefix stringValue=\"ids\"/>\n                            <L7p:XmlMsgSrc stringValue=\"cassandraConnections.sorted\"/>\n                            <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                <L7p:Expression stringValue=\"/CassandraConnections/CassandraConnection/@id\"/>\n                                <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"s\"/>\n                                    <L7p:value stringValue=\"http://schemas.xmlsoap.org/soap/envelope/\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                    </L7p:entry>\n                                </L7p:Namespaces>\n                                <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                            </L7p:XpathExpression>\n                        </L7p:ResponseXpathAssertion>\n                        <L7p:ForEachLoop L7p:Usage=\"Required\"\n                            loopVariable=\"ids.results\" variablePrefix=\"id\">\n                            <L7p:ResponseXpathAssertion>\n                                <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Get name of the object for display\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:AssertionComment>\n                                <L7p:VariablePrefix stringValue=\"name\"/>\n                                <L7p:XmlMsgSrc stringValue=\"cassandraConnections.sorted\"/>\n                                <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                    <L7p:Expression stringValue=\"/CassandraConnections/CassandraConnection[@id=$id.current]/Name\"/>\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"s\"/>\n                                    <L7p:value stringValue=\"http://schemas.xmlsoap.org/soap/envelope/\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                                </L7p:XpathExpression>\n                            </L7p:ResponseXpathAssertion>\n                            <L7p:AuditDetailAssertion>\n                                <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// FINE\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:AssertionComment>\n                                <L7p:Detail stringValue=\"=====> Processing ${objectType}: ${name.result} (${id.current})\"/>\n                                <L7p:Level stringValue=\"FINE\"/>\n                            </L7p:AuditDetailAssertion>\n                            <L7p:Encapsulated>\n                                <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// name.result\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:AssertionComment>\n                                <L7p:EncapsulatedAssertionConfigGuid stringValue=\"f6b19229-a705-4c48-bc78-3975564a1a9a\"/>\n                                <L7p:EncapsulatedAssertionConfigName stringValue=\"Utility: Escape HTML String\"/>\n                                <L7p:Parameters mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"escapedString\"/>\n                                    <L7p:value stringValue=\"${name.result}\"/>\n                                    </L7p:entry>\n                                </L7p:Parameters>\n                            </L7p:Encapsulated>\n                            <L7p:SetVariable>\n                                <L7p:Base64Expression stringValue=\"JHtodG1sQ29udGVudH0NCjxhIGlkPSIke2lkLmN1cnJlbnR9Ii8+PGEgaHJlZj0iJHtyZXF1ZXN0LnVybC5wYXRofT9vYmplY3RUeXBlPSR7b2JqZWN0VHlwZX0maWQ9JHtpZC5jdXJyZW50fSMke2lkLmN1cnJlbnR9IiBvbkNsaWNrPSJzZXRSZWZyZXNoKHRoaXMpIj4ke2VzY2FwZWRTdHJpbmd9PC9hPjxici8+\"/>\n                                <L7p:VariableToSet stringValue=\"htmlContent\"/>\n                            </L7p:SetVariable>\n                            <wsp:OneOrMore wsp:Usage=\"Required\">\n                                <L7p:ComparisonAssertion>\n                                    <L7p:Expression1 stringValue=\"${id}\"/>\n                                    <L7p:Expression2 stringValue=\"${id.current}\"/>\n                                    <L7p:Negate booleanValue=\"true\"/>\n                                    <L7p:Predicates predicates=\"included\">\n                                    <L7p:item binary=\"included\">\n                                    <L7p:Negated booleanValue=\"true\"/>\n                                    <L7p:RightValue stringValue=\"${id.current}\"/>\n                                    </L7p:item>\n                                    </L7p:Predicates>\n                                </L7p:ComparisonAssertion>\n                                <wsp:All wsp:Usage=\"Required\">\n                                    <L7p:AuditDetailAssertion>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// FINE\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:Detail stringValue=\"====> ID matched, processing for dependencies\"/>\n                                    <L7p:Level stringValue=\"FINE\"/>\n                                    </L7p:AuditDetailAssertion>\n                                    <L7p:SetVariable>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// The final identifier string we'll use\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:Base64Expression stringValue=\"JHtuYW1lLnJlc3VsdH0=\"/>\n                                    <L7p:VariableToSet stringValue=\"referenceString\"/>\n                                    </L7p:SetVariable>\n                                    <L7p:AuditDetailAssertion>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// FINE\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:Detail stringValue=\"===> Searching objects for references to ${referenceString}\"/>\n                                    <L7p:Level stringValue=\"FINE\"/>\n                                    </L7p:AuditDetailAssertion>\n                                    <wsp:OneOrMore wsp:Usage=\"Required\">\n                                    <wsp:All wsp:Usage=\"Required\">\n                                    <L7p:AuditDetailAssertion>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// FINE\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:Detail stringValue=\"==> Searching policy XML\"/>\n                                    <L7p:Level stringValue=\"FINE\"/>\n                                    </L7p:AuditDetailAssertion>\n                                    <L7p:ResponseXpathAssertion>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Extract all policy objects that contain a CassandraQuery element\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:VariablePrefix stringValue=\"policies\"/>\n                                    <L7p:XmlMsgSrc stringValue=\"allPolicyXML\"/>\n                                    <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                    <L7p:Expression stringValue=\"/AllPolicyXML/PolicyXML[contains(.,'&lt;L7p:CassandraQuery>')]\"/>\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                                    </L7p:XpathExpression>\n                                    </L7p:ResponseXpathAssertion>\n                                    <L7p:ForEachLoop\n                                    L7p:Usage=\"Required\"\n                                    loopVariable=\"policies.elements\" variablePrefix=\"policy\">\n                                    <L7p:SetVariable>\n\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"// Cast to message type for XPath\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n\n                                    <L7p:Base64Expression stringValue=\"JHtwb2xpY3kuY3VycmVudH0=\"/>\n                                    <L7p:ContentType stringValue=\"text/xml; charset=utf-8\"/>\n                                    <L7p:DataType variableDataType=\"message\"/>\n                                    <L7p:VariableToSet stringValue=\"policyObject.xml\"/>\n                                    </L7p:SetVariable>\n                                    <L7p:ResponseXpathAssertion>\n\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"// Extract the policy XML from the policy object\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:VariablePrefix stringValue=\"policy.xml\"/>\n                                    <L7p:XmlMsgSrc stringValue=\"policyObject.xml\"/>\n                                    <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                    <L7p:Expression stringValue=\"/PolicyXML/text()\"/>\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"s\"/>\n\n                                    <L7p:value stringValue=\"http://schemas.xmlsoap.org/soap/envelope/\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                                    </L7p:XpathExpression>\n                                    </L7p:ResponseXpathAssertion>\n                                    <L7p:SetVariable>\n\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"// Cast to message type for XPath\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n\n                                    <L7p:Base64Expression stringValue=\"JHtwb2xpY3kueG1sLnJlc3VsdH0=\"/>\n                                    <L7p:ContentType stringValue=\"text/xml; charset=utf-8\"/>\n                                    <L7p:DataType variableDataType=\"message\"/>\n                                    <L7p:VariableToSet stringValue=\"policy.xml\"/>\n                                    </L7p:SetVariable>\n                                    <wsp:OneOrMore wsp:Usage=\"Required\">\n                                    <wsp:All wsp:Usage=\"Required\">\n                                    <L7p:ResponseXpathAssertion>\n\n                                    <L7p:AssertionComment assertionComment=\"included\">\n\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"// Check if the policy XML has a reference to this cassandra connection\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n\n                                    <L7p:VariablePrefix stringValue=\"\"/>\n\n                                    <L7p:XmlMsgSrc stringValue=\"policy.xml\"/>\n\n                                    <L7p:XpathExpression xpathExpressionValue=\"included\">\n\n                                    <L7p:Expression stringValue=\"//L7p:CassandraQuery/L7p:ConnectionName[@stringValue=$referenceString]\"/>\n\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"L7p\"/>\n\n                                    <L7p:value stringValue=\"http://www.layer7tech.com/ws/policy\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"wsp\"/>\n\n                                    <L7p:value stringValue=\"http://schemas.xmlsoap.org/ws/2002/12/policy\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                                    </L7p:XpathExpression>\n                                    </L7p:ResponseXpathAssertion>\n                                    <L7p:Include>\n\n                                    <L7p:PolicyGuid stringValue=\"8f33b165-bc16-4959-a524-aba67aff3cdf\"/>\n                                    </L7p:Include>\n                                    <L7p:SetVariable>\n\n                                    <L7p:Base64Expression stringValue=\"JHtzb3VyY2VUeXBlLnJlc3VsdH06ICR7Zm9sZGVyUGF0aC5yZXN1bHR9JHtuYW1lLnJlc3VsdH0=\"/>\n\n                                    <L7p:VariableToSet stringValue=\"depender\"/>\n                                    </L7p:SetVariable>\n                                    <L7p:ManipulateMultiValuedVariable>\n\n                                    <L7p:SourceVariableName stringValue=\"depender\"/>\n\n                                    <L7p:TargetVariableName stringValue=\"dependers.list\"/>\n                                    </L7p:ManipulateMultiValuedVariable>\n                                    <L7p:assertionComment>\n\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"// Search policy XML for CassandraQuery element matching our reference\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:All>\n                                    <L7p:TrueAssertion/>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"// Search policy XML for CassandraQuery element matching our reference, never fail\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:OneOrMore>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Cycle through each policy that has an &lt;L7p:CassandraQuery> element and check if it is our cassandra connection\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </L7p:ForEachLoop>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Search for references in policy XML\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:All>\n                                    <L7p:TrueAssertion/>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Search for references in policy XML, never fail\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:OneOrMore>\n                                    <wsp:OneOrMore wsp:Usage=\"Required\">\n                                    <wsp:All wsp:Usage=\"Required\">\n                                    <L7p:ComparisonAssertion>\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:Expression1 stringValue=\"${dependers.list.length}\"/>\n                                    <L7p:Expression2 stringValue=\"1\"/>\n                                    <L7p:Operator operator=\"GE\"/>\n                                    <L7p:Predicates predicates=\"included\">\n                                    <L7p:item binary=\"included\">\n\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:Operator operator=\"GE\"/>\n                                    <L7p:RightValue stringValue=\"1\"/>\n                                    </L7p:item>\n                                    </L7p:Predicates>\n                                    </L7p:ComparisonAssertion>\n                                    <L7p:ForEachLoop\n                                    L7p:Usage=\"Required\"\n                                    loopVariable=\"dependers.list\" variablePrefix=\"depender\">\n                                    <L7p:SetVariable>\n\n                                    <L7p:Base64Expression stringValue=\"JHtkZXBlbmRlcnMuaHRtbH0NCiAgPGxpPiR7ZGVwZW5kZXIuY3VycmVudH08L2xpPg==\"/>\n                                    <L7p:VariableToSet stringValue=\"dependers.html\"/>\n                                    </L7p:SetVariable>\n                                    </L7p:ForEachLoop>\n                                    <L7p:SetVariable>\n                                    <L7p:Base64Expression stringValue=\"JHtodG1sQ29udGVudH0NCg0KPHA+VGhlIGZvbGxvd2luZyBvYmplY3RzIHJlZmVyZW5jZSB0aGlzIGNhc3NhbmRyYSBjb25uZWN0aW9uOjwvcD4NCjx1bD4ke2RlcGVuZGVycy5odG1sfTwvdWw+\"/>\n                                    <L7p:VariableToSet stringValue=\"htmlContent\"/>\n                                    </L7p:SetVariable>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// ${dependers.list} has content\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:All>\n                                    <L7p:SetVariable>\n                                    <L7p:Base64Expression stringValue=\"JHtodG1sQ29udGVudH0NCjxwPk5vdGhpbmcgd2FzIGZvdW5kIHRoYXQgcmVmZXJlbmNlcyB0aGlzIGNhc3NhbmRyYSBjb25uZWN0aW9uPC9wPg==\"/>\n                                    <L7p:VariableToSet stringValue=\"htmlContent\"/>\n                                    </L7p:SetVariable>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Append ${dependers.html} to ${htmlContent} if ${dependers.list} has any entries\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:OneOrMore>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// ${id} matches so retrieve dependers\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                </wsp:All>\n                                <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Do reverse dependency search if id matches\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:assertionComment>\n                            </wsp:OneOrMore>\n                            <L7p:assertionComment>\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Cycle through each object to add to display and check if search must be run\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:assertionComment>\n                        </L7p:ForEachLoop>\n                        <L7p:assertionComment>\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// ${objectType} == &quot;Cassandra Connection&quot;\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:assertionComment>\n                    </wsp:All>\n                    <wsp:All wsp:Usage=\"Required\">\n                        <L7p:ComparisonAssertion>\n                            <L7p:CaseSensitive booleanValue=\"false\"/>\n                            <L7p:Expression1 stringValue=\"${objectType}\"/>\n                            <L7p:Expression2 stringValue=\"Cluster Property\"/>\n                            <L7p:Predicates predicates=\"included\">\n                                <L7p:item binary=\"included\">\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:RightValue stringValue=\"Cluster Property\"/>\n                                </L7p:item>\n                            </L7p:Predicates>\n                        </L7p:ComparisonAssertion>\n                        <L7p:AuditDetailAssertion>\n                            <L7p:AssertionComment assertionComment=\"included\">\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// FINE\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:AssertionComment>\n                            <L7p:Detail stringValue=\"======> Listing ${objectType} objects\"/>\n                            <L7p:Level stringValue=\"FINE\"/>\n                        </L7p:AuditDetailAssertion>\n                        <L7p:Encapsulated>\n                            <L7p:AssertionComment assertionComment=\"included\">\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Get list of objectTypes to display and search for references\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:AssertionComment>\n                            <L7p:EncapsulatedAssertionConfigGuid stringValue=\"c8e30576-c290-4bd0-b63d-1eb3df866479\"/>\n                            <L7p:EncapsulatedAssertionConfigName stringValue=\"Utility: List Cluster Properties\"/>\n                            <L7p:Parameters mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"cacheAge\"/>\n                                    <L7p:value stringValue=\"${cacheAge}\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"refresh\"/>\n                                    <L7p:value stringValue=\"${request.http.parameter.refresh}\"/>\n                                </L7p:entry>\n                            </L7p:Parameters>\n                        </L7p:Encapsulated>\n                        <L7p:ResponseXpathAssertion>\n                            <L7p:AssertionComment assertionComment=\"included\">\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Get list of ids\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:AssertionComment>\n                            <L7p:VariablePrefix stringValue=\"ids\"/>\n                            <L7p:XmlMsgSrc stringValue=\"clusterProperties.sorted\"/>\n                            <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                <L7p:Expression stringValue=\"/ClusterProperties/ClusterProperty/@id\"/>\n                                <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"s\"/>\n                                    <L7p:value stringValue=\"http://schemas.xmlsoap.org/soap/envelope/\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                    </L7p:entry>\n                                </L7p:Namespaces>\n                                <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                            </L7p:XpathExpression>\n                        </L7p:ResponseXpathAssertion>\n                        <L7p:ForEachLoop L7p:Usage=\"Required\"\n                            loopVariable=\"ids.results\" variablePrefix=\"id\">\n                            <L7p:ResponseXpathAssertion>\n                                <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Get name of the object for display\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:AssertionComment>\n                                <L7p:VariablePrefix stringValue=\"name\"/>\n                                <L7p:XmlMsgSrc stringValue=\"clusterProperties.sorted\"/>\n                                <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                    <L7p:Expression stringValue=\"/ClusterProperties/ClusterProperty[@id=$id.current]/Name\"/>\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"s\"/>\n                                    <L7p:value stringValue=\"http://schemas.xmlsoap.org/soap/envelope/\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                                </L7p:XpathExpression>\n                            </L7p:ResponseXpathAssertion>\n                            <L7p:AuditDetailAssertion>\n                                <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// FINE\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:AssertionComment>\n                                <L7p:Detail stringValue=\"=====> Processing ${objectType}: ${name.result} (${id.current})\"/>\n                                <L7p:Level stringValue=\"FINE\"/>\n                            </L7p:AuditDetailAssertion>\n                            <L7p:Encapsulated>\n                                <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// name.result\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:AssertionComment>\n                                <L7p:EncapsulatedAssertionConfigGuid stringValue=\"f6b19229-a705-4c48-bc78-3975564a1a9a\"/>\n                                <L7p:EncapsulatedAssertionConfigName stringValue=\"Utility: Escape HTML String\"/>\n                                <L7p:Parameters mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"escapedString\"/>\n                                    <L7p:value stringValue=\"${name.result}\"/>\n                                    </L7p:entry>\n                                </L7p:Parameters>\n                            </L7p:Encapsulated>\n                            <L7p:SetVariable>\n                                <L7p:Base64Expression stringValue=\"JHtodG1sQ29udGVudH0NCjxhIGlkPSIke2lkLmN1cnJlbnR9Ii8+PGEgaHJlZj0iJHtyZXF1ZXN0LnVybC5wYXRofT9vYmplY3RUeXBlPSR7b2JqZWN0VHlwZX0maWQ9JHtpZC5jdXJyZW50fSMke2lkLmN1cnJlbnR9IiBvbkNsaWNrPSJzZXRSZWZyZXNoKHRoaXMpIj4ke2VzY2FwZWRTdHJpbmd9PC9hPjxici8+\"/>\n                                <L7p:VariableToSet stringValue=\"htmlContent\"/>\n                            </L7p:SetVariable>\n                            <wsp:OneOrMore wsp:Usage=\"Required\">\n                                <L7p:ComparisonAssertion>\n                                    <L7p:Expression1 stringValue=\"${id}\"/>\n                                    <L7p:Expression2 stringValue=\"${id.current}\"/>\n                                    <L7p:Negate booleanValue=\"true\"/>\n                                    <L7p:Predicates predicates=\"included\">\n                                    <L7p:item binary=\"included\">\n                                    <L7p:Negated booleanValue=\"true\"/>\n                                    <L7p:RightValue stringValue=\"${id.current}\"/>\n                                    </L7p:item>\n                                    </L7p:Predicates>\n                                </L7p:ComparisonAssertion>\n                                <wsp:All wsp:Usage=\"Required\">\n                                    <L7p:AuditDetailAssertion>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// FINE\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:Detail stringValue=\"====> ID matched, processing for dependencies\"/>\n                                    <L7p:Level stringValue=\"FINE\"/>\n                                    </L7p:AuditDetailAssertion>\n                                    <L7p:SetVariable>\n                                    <L7p:Base64Expression stringValue=\"e2dhdGV3YXkuJHtuYW1lLnJlc3VsdH19\"/>\n                                    <L7p:VariableToSet stringValue=\"referenceString\"/>\n                                    </L7p:SetVariable>\n                                    <L7p:SetVariable>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Prepend $ to the string we will search for\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:Base64Expression stringValue=\"JCR7cmVmZXJlbmNlU3RyaW5nfQ==\"/>\n                                    <L7p:VariableToSet stringValue=\"referenceString\"/>\n                                    </L7p:SetVariable>\n                                    <L7p:AuditDetailAssertion>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// FINE\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:Detail stringValue=\"===> Searching objects for references to ${referenceString}\"/>\n                                    <L7p:Level stringValue=\"FINE\"/>\n                                    </L7p:AuditDetailAssertion>\n                                    <wsp:OneOrMore wsp:Usage=\"Required\">\n                                    <wsp:All wsp:Usage=\"Required\">\n                                    <L7p:AuditDetailAssertion>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// FINE\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:Detail stringValue=\"==> Searching policy XML for non-encoded references\"/>\n                                    <L7p:Level stringValue=\"FINE\"/>\n                                    </L7p:AuditDetailAssertion>\n                                    <L7p:ResponseXpathAssertion>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Check if this policy has a direct reference to the cluster property\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:VariablePrefix stringValue=\"policies\"/>\n                                    <L7p:XmlMsgSrc stringValue=\"allPolicyXML\"/>\n                                    <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                    <L7p:Expression stringValue=\"//AllPolicyXML/PolicyXML[contains(.,$referenceString)]\"/>\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                                    </L7p:XpathExpression>\n                                    </L7p:ResponseXpathAssertion>\n                                    <L7p:ForEachLoop\n                                    L7p:Usage=\"Required\"\n                                    loopVariable=\"policies.elements\" variablePrefix=\"policy\">\n                                    <L7p:SetVariable>\n\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"// Cast to message type for XPath\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n\n                                    <L7p:Base64Expression stringValue=\"JHtwb2xpY3kuY3VycmVudH0=\"/>\n                                    <L7p:ContentType stringValue=\"text/xml; charset=utf-8\"/>\n                                    <L7p:DataType variableDataType=\"message\"/>\n                                    <L7p:VariableToSet stringValue=\"policyObject.xml\"/>\n                                    </L7p:SetVariable>\n                                    <L7p:Include>\n                                    <L7p:PolicyGuid stringValue=\"8f33b165-bc16-4959-a524-aba67aff3cdf\"/>\n                                    </L7p:Include>\n                                    <L7p:SetVariable>\n\n                                    <L7p:Base64Expression stringValue=\"JHtzb3VyY2VUeXBlLnJlc3VsdH06ICR7Zm9sZGVyUGF0aC5yZXN1bHR9JHtuYW1lLnJlc3VsdH0gKGluIGRpcmVjdCByZWZlcmVuY2Up\"/>\n                                    <L7p:VariableToSet stringValue=\"depender\"/>\n                                    </L7p:SetVariable>\n                                    <L7p:ManipulateMultiValuedVariable>\n\n                                    <L7p:SourceVariableName stringValue=\"depender\"/>\n\n                                    <L7p:TargetVariableName stringValue=\"dependers.list\"/>\n                                    </L7p:ManipulateMultiValuedVariable>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Cycle through each policy that matched and append to ${dependers.list}\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </L7p:ForEachLoop>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Search for non-encoded references in policy XML\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:All>\n                                    <L7p:TrueAssertion/>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Search for non-encoded references in policy XML, never fail\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:OneOrMore>\n                                    <wsp:OneOrMore wsp:Usage=\"Required\">\n                                    <wsp:All wsp:Usage=\"Required\">\n                                    <L7p:AuditDetailAssertion>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// FINE\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:Detail stringValue=\"==> Searching policy XML for encoded references\"/>\n                                    <L7p:Level stringValue=\"FINE\"/>\n                                    </L7p:AuditDetailAssertion>\n                                    <L7p:ResponseXpathAssertion>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Extract all policy objects that contain Base64Expression or Base64ResponseBody elements\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:VariablePrefix stringValue=\"policies\"/>\n                                    <L7p:XmlMsgSrc stringValue=\"allPolicyXML\"/>\n                                    <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                    <L7p:Expression stringValue=\"//AllPolicyXML/PolicyXML[(contains(.,'&lt;L7p:Base64Expression ') or contains(.,'&lt;L7p:Base64ResponseBody '))]\"/>\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                                    </L7p:XpathExpression>\n                                    </L7p:ResponseXpathAssertion>\n                                    <L7p:ForEachLoop\n                                    L7p:Usage=\"Required\"\n                                    loopVariable=\"policies.elements\" variablePrefix=\"policy\">\n                                    <L7p:SetVariable>\n\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"// Cast to message type for XPath\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n\n                                    <L7p:Base64Expression stringValue=\"JHtwb2xpY3kuY3VycmVudH0=\"/>\n                                    <L7p:ContentType stringValue=\"text/xml; charset=utf-8\"/>\n                                    <L7p:DataType variableDataType=\"message\"/>\n                                    <L7p:VariableToSet stringValue=\"policyObject.xml\"/>\n                                    </L7p:SetVariable>\n                                    <L7p:ResponseXpathAssertion>\n\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"// Extract the policy XML from the policy object\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:VariablePrefix stringValue=\"policy.xml\"/>\n                                    <L7p:XmlMsgSrc stringValue=\"policyObject.xml\"/>\n                                    <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                    <L7p:Expression stringValue=\"/PolicyXML/text()\"/>\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"s\"/>\n\n                                    <L7p:value stringValue=\"http://schemas.xmlsoap.org/soap/envelope/\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                                    </L7p:XpathExpression>\n                                    </L7p:ResponseXpathAssertion>\n                                    <L7p:SetVariable>\n\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"// Cast to message type for XPath\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n\n                                    <L7p:Base64Expression stringValue=\"JHtwb2xpY3kueG1sLnJlc3VsdH0=\"/>\n                                    <L7p:ContentType stringValue=\"text/xml; charset=utf-8\"/>\n                                    <L7p:DataType variableDataType=\"message\"/>\n                                    <L7p:VariableToSet stringValue=\"policy.xml\"/>\n                                    </L7p:SetVariable>\n                                    <wsp:OneOrMore wsp:Usage=\"Required\">\n                                    <wsp:All wsp:Usage=\"Required\">\n                                    <L7p:ResponseXpathAssertion>\n\n                                    <L7p:AssertionComment assertionComment=\"included\">\n\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"// Extract all of the (Base64Expression | Base64ResponseBody)/@stringValue instances for analysis\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n\n                                    <L7p:VariablePrefix stringValue=\"stringValue\"/>\n\n                                    <L7p:XmlMsgSrc stringValue=\"policy.xml\"/>\n\n                                    <L7p:XpathExpression xpathExpressionValue=\"included\">\n\n                                    <L7p:Expression stringValue=\"(//L7p:Base64Expression | //L7p:Base64ResponseBody)/@stringValue\"/>\n\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"s\"/>\n\n                                    <L7p:value stringValue=\"http://schemas.xmlsoap.org/soap/envelope/\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"L7p\"/>\n\n                                    <L7p:value stringValue=\"http://www.layer7tech.com/ws/policy\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"wsp\"/>\n\n                                    <L7p:value stringValue=\"http://schemas.xmlsoap.org/ws/2002/12/policy\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                                    </L7p:XpathExpression>\n                                    </L7p:ResponseXpathAssertion>\n                                    <L7p:SetVariable>\n\n                                    <L7p:AssertionComment assertionComment=\"included\">\n\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"// Reset in case we broke out of something earlier\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n\n                                    <L7p:Base64Expression stringValue=\"ZmFsc2U=\"/>\n\n                                    <L7p:VariableToSet stringValue=\"stringValue.break\"/>\n                                    </L7p:SetVariable>\n                                    <L7p:ForEachLoop\n                                    L7p:Usage=\"Required\"\n                                    loopVariable=\"stringValue.results\" variablePrefix=\"stringValue\">\n                                    <L7p:EncodeDecode>\n\n                                    <L7p:SourceVariableName stringValue=\"stringValue.current\"/>\n\n                                    <L7p:TargetDataType variableDataType=\"string\"/>\n\n                                    <L7p:TargetVariableName stringValue=\"stringValue.current\"/>\n\n                                    <L7p:TransformType transformType=\"BASE64_DECODE\"/>\n                                    </L7p:EncodeDecode>\n\n                                    <wsp:OneOrMore wsp:Usage=\"Required\">\n                                    <L7p:ComparisonAssertion>\n\n                                    <L7p:Expression1 stringValue=\"${stringValue.current}\"/>\n\n                                    <L7p:Expression2 stringValue=\"${referenceString}\"/>\n\n                                    <L7p:Negate booleanValue=\"true\"/>\n\n                                    <L7p:Operator operator=\"CONTAINS\"/>\n\n                                    <L7p:Predicates predicates=\"included\">\n\n                                    <L7p:item binary=\"included\">\n\n                                    <L7p:Negated booleanValue=\"true\"/>\n\n                                    <L7p:Operator operator=\"CONTAINS\"/>\n\n                                    <L7p:RightValue stringValue=\"${referenceString}\"/>\n                                    </L7p:item>\n                                    </L7p:Predicates>\n                                    </L7p:ComparisonAssertion>\n                                    <wsp:All wsp:Usage=\"Required\">\n                                    <L7p:Include>\n\n                                    <L7p:PolicyGuid stringValue=\"8f33b165-bc16-4959-a524-aba67aff3cdf\"/>\n                                    </L7p:Include>\n                                    <L7p:SetVariable>\n\n                                    <L7p:Base64Expression stringValue=\"JHtzb3VyY2VUeXBlLnJlc3VsdH06ICR7Zm9sZGVyUGF0aC5yZXN1bHR9JHtuYW1lLnJlc3VsdH0gKGluIEJhc2U2NCBlbmNvZGVkIGF0dHJpYnV0ZSk=\"/>\n\n                                    <L7p:VariableToSet stringValue=\"depender\"/>\n                                    </L7p:SetVariable>\n                                    <L7p:ManipulateMultiValuedVariable>\n\n                                    <L7p:SourceVariableName stringValue=\"depender\"/>\n\n                                    <L7p:TargetVariableName stringValue=\"dependers.list\"/>\n                                    </L7p:ManipulateMultiValuedVariable>\n                                    <L7p:SetVariable>\n\n                                    <L7p:AssertionComment assertionComment=\"included\">\n\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"// Don't need any more\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n\n                                    <L7p:Base64Expression stringValue=\"dHJ1ZQ==\"/>\n\n                                    <L7p:VariableToSet stringValue=\"stringValue.break\"/>\n                                    </L7p:SetVariable>\n                                    <L7p:assertionComment>\n\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"// Extract id and append to ${dependers.list}\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:All>\n                                    <L7p:assertionComment>\n\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"// Check if ${stringValue.current} contains ${referenceString}\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:OneOrMore>\n                                    <L7p:assertionComment>\n\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"// Cycle through each base64 string and check for ${referenceString}\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </L7p:ForEachLoop>\n                                    <L7p:assertionComment>\n\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"// Extract Base64Expressions from policy and check for matches\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:All>\n                                    <L7p:TrueAssertion/>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"// Extract Base64Expressions from policy and check for matches, never fail\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:OneOrMore>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Cycle through each policy with Base64 content, extract base64 strings and analyse for ${referenceString}\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </L7p:ForEachLoop>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Search for encoded references in policy XML\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:All>\n                                    <L7p:TrueAssertion/>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Search for encoded references in policy XML, never fail\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:OneOrMore>\n                                    <wsp:OneOrMore wsp:Usage=\"Required\">\n                                    <wsp:All wsp:Usage=\"Required\">\n                                    <L7p:ComparisonAssertion>\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:Expression1 stringValue=\"${dependers.list.length}\"/>\n                                    <L7p:Expression2 stringValue=\"1\"/>\n                                    <L7p:Operator operator=\"GE\"/>\n                                    <L7p:Predicates predicates=\"included\">\n                                    <L7p:item binary=\"included\">\n\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:Operator operator=\"GE\"/>\n                                    <L7p:RightValue stringValue=\"1\"/>\n                                    </L7p:item>\n                                    </L7p:Predicates>\n                                    </L7p:ComparisonAssertion>\n                                    <L7p:ForEachLoop\n                                    L7p:Usage=\"Required\"\n                                    loopVariable=\"dependers.list\" variablePrefix=\"depender\">\n                                    <L7p:SetVariable>\n\n                                    <L7p:Base64Expression stringValue=\"JHtkZXBlbmRlcnMuaHRtbH0NCiAgPGxpPiR7ZGVwZW5kZXIuY3VycmVudH08L2xpPg==\"/>\n                                    <L7p:VariableToSet stringValue=\"dependers.html\"/>\n                                    </L7p:SetVariable>\n                                    </L7p:ForEachLoop>\n                                    <L7p:SetVariable>\n                                    <L7p:Base64Expression stringValue=\"JHtodG1sQ29udGVudH0NCg0KPHA+VGhlIGZvbGxvd2luZyBvYmplY3RzIHJlZmVyZW5jZSB0aGlzIGNsdXN0ZXIgcHJvcGVydHk6PC9wPg0KPHVsPiR7ZGVwZW5kZXJzLmh0bWx9PC91bD4=\"/>\n                                    <L7p:VariableToSet stringValue=\"htmlContent\"/>\n                                    </L7p:SetVariable>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// ${dependers.list} has content\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:All>\n                                    <L7p:SetVariable>\n                                    <L7p:Base64Expression stringValue=\"JHtodG1sQ29udGVudH0NCjxwPk5vdGhpbmcgd2FzIGZvdW5kIHRoYXQgcmVmZXJlbmNlcyB0aGlzIGNsdXN0ZXIgcHJvcGVydHk8L3A+\"/>\n                                    <L7p:VariableToSet stringValue=\"htmlContent\"/>\n                                    </L7p:SetVariable>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Append ${dependers.html} to ${htmlContent} if ${dependers.list} has any entries\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:OneOrMore>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// ${id} matches so retrieve dependers\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                </wsp:All>\n                                <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Do reverse dependency search if id matches\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:assertionComment>\n                            </wsp:OneOrMore>\n                            <L7p:assertionComment>\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Cycle through each object to add to display and check if search must be run\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:assertionComment>\n                        </L7p:ForEachLoop>\n                        <L7p:assertionComment>\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// ${objectType} == &quot;Cluster Property&quot;\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:assertionComment>\n                    </wsp:All>\n                    <wsp:All wsp:Usage=\"Required\">\n                        <L7p:ComparisonAssertion>\n                            <L7p:CaseSensitive booleanValue=\"false\"/>\n                            <L7p:Expression1 stringValue=\"${objectType}\"/>\n                            <L7p:Expression2 stringValue=\"Encapsulated Assertion\"/>\n                            <L7p:Predicates predicates=\"included\">\n                                <L7p:item binary=\"included\">\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:RightValue stringValue=\"Encapsulated Assertion\"/>\n                                </L7p:item>\n                            </L7p:Predicates>\n                        </L7p:ComparisonAssertion>\n                        <L7p:AuditDetailAssertion>\n                            <L7p:AssertionComment assertionComment=\"included\">\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// FINE\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:AssertionComment>\n                            <L7p:Detail stringValue=\"======> Listing ${objectType} objects\"/>\n                            <L7p:Level stringValue=\"FINE\"/>\n                        </L7p:AuditDetailAssertion>\n                        <L7p:Encapsulated>\n                            <L7p:AssertionComment assertionComment=\"included\">\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Get list of objectTypes to display and search for references\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:AssertionComment>\n                            <L7p:EncapsulatedAssertionConfigGuid stringValue=\"8fc67f28-191e-4a4b-808b-299848593b53\"/>\n                            <L7p:EncapsulatedAssertionConfigName stringValue=\"Utility: List Encapsulated Assertions\"/>\n                            <L7p:Parameters mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"cacheAge\"/>\n                                    <L7p:value stringValue=\"${cacheAge}\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"refresh\"/>\n                                    <L7p:value stringValue=\"${request.http.parameter.refresh}\"/>\n                                </L7p:entry>\n                            </L7p:Parameters>\n                        </L7p:Encapsulated>\n                        <L7p:ResponseXpathAssertion>\n                            <L7p:AssertionComment assertionComment=\"included\">\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Extract list of encapsulated assertion ids\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:AssertionComment>\n                            <L7p:VariablePrefix stringValue=\"ids\"/>\n                            <L7p:XmlMsgSrc stringValue=\"encapsulatedAssertions.sorted\"/>\n                            <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                <L7p:Expression stringValue=\"/EncapsulatedAssertions/EncapsulatedAssertion/@id\"/>\n                                <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"s\"/>\n                                    <L7p:value stringValue=\"http://schemas.xmlsoap.org/soap/envelope/\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                    </L7p:entry>\n                                </L7p:Namespaces>\n                                <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                            </L7p:XpathExpression>\n                        </L7p:ResponseXpathAssertion>\n                        <L7p:ForEachLoop L7p:Usage=\"Required\"\n                            loopVariable=\"ids.results\" variablePrefix=\"id\">\n                            <L7p:ResponseXpathAssertion>\n                                <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Get name of the object for display\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:AssertionComment>\n                                <L7p:VariablePrefix stringValue=\"name\"/>\n                                <L7p:XmlMsgSrc stringValue=\"encapsulatedAssertions.sorted\"/>\n                                <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                    <L7p:Expression stringValue=\"/EncapsulatedAssertions/EncapsulatedAssertion[@id=$id.current]/Name\"/>\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"s\"/>\n                                    <L7p:value stringValue=\"http://schemas.xmlsoap.org/soap/envelope/\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                                </L7p:XpathExpression>\n                            </L7p:ResponseXpathAssertion>\n                            <L7p:AuditDetailAssertion>\n                                <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// FINE\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:AssertionComment>\n                                <L7p:Detail stringValue=\"=====> Processing ${objectType}: ${name.result} (${id.current})\"/>\n                                <L7p:Level stringValue=\"FINE\"/>\n                            </L7p:AuditDetailAssertion>\n                            <L7p:Encapsulated>\n                                <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// name.result\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:AssertionComment>\n                                <L7p:EncapsulatedAssertionConfigGuid stringValue=\"f6b19229-a705-4c48-bc78-3975564a1a9a\"/>\n                                <L7p:EncapsulatedAssertionConfigName stringValue=\"Utility: Escape HTML String\"/>\n                                <L7p:Parameters mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"escapedString\"/>\n                                    <L7p:value stringValue=\"${name.result}\"/>\n                                    </L7p:entry>\n                                </L7p:Parameters>\n                            </L7p:Encapsulated>\n                            <L7p:SetVariable>\n                                <L7p:Base64Expression stringValue=\"JHtodG1sQ29udGVudH0NCjxhIGlkPSIke2lkLmN1cnJlbnR9Ii8+PGEgaHJlZj0iJHtyZXF1ZXN0LnVybC5wYXRofT9vYmplY3RUeXBlPSR7b2JqZWN0VHlwZX0maWQ9JHtpZC5jdXJyZW50fSMke2lkLmN1cnJlbnR9IiBvbkNsaWNrPSJzZXRSZWZyZXNoKHRoaXMpIj4ke2VzY2FwZWRTdHJpbmd9PC9hPjxici8+\"/>\n                                <L7p:VariableToSet stringValue=\"htmlContent\"/>\n                            </L7p:SetVariable>\n                            <wsp:OneOrMore wsp:Usage=\"Required\">\n                                <L7p:ComparisonAssertion>\n                                    <L7p:Expression1 stringValue=\"${id}\"/>\n                                    <L7p:Expression2 stringValue=\"${id.current}\"/>\n                                    <L7p:Negate booleanValue=\"true\"/>\n                                    <L7p:Predicates predicates=\"included\">\n                                    <L7p:item binary=\"included\">\n                                    <L7p:Negated booleanValue=\"true\"/>\n                                    <L7p:RightValue stringValue=\"${id.current}\"/>\n                                    </L7p:item>\n                                    </L7p:Predicates>\n                                </L7p:ComparisonAssertion>\n                                <wsp:All wsp:Usage=\"Required\">\n                                    <L7p:AuditDetailAssertion>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// FINE\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:Detail stringValue=\"====> ID matched, processing for dependencies\"/>\n                                    <L7p:Level stringValue=\"FINE\"/>\n                                    </L7p:AuditDetailAssertion>\n                                    <L7p:ResponseXpathAssertion>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Extract GUID for encapsulated assertion\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:VariablePrefix stringValue=\"guid\"/>\n                                    <L7p:XmlMsgSrc stringValue=\"encapsulatedAssertions.sorted\"/>\n                                    <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                    <L7p:Expression stringValue=\"/EncapsulatedAssertions/EncapsulatedAssertion[@id=$id.current]/GUID\"/>\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"s\"/>\n                                    <L7p:value stringValue=\"http://schemas.xmlsoap.org/soap/envelope/\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                                    </L7p:XpathExpression>\n                                    </L7p:ResponseXpathAssertion>\n                                    <L7p:SetVariable>\n                                    <L7p:Base64Expression stringValue=\"RW5jYXBzdWxhdGVkQXNzZXJ0aW9uQ29uZmlnR3VpZCBzdHJpbmdWYWx1ZT0iJHtndWlkLnJlc3VsdH0i\"/>\n                                    <L7p:VariableToSet stringValue=\"referenceString\"/>\n                                    </L7p:SetVariable>\n                                    <L7p:AuditDetailAssertion>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// FINE\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:Detail stringValue=\"===> Searching objects for references to ${referenceString}\"/>\n                                    <L7p:Level stringValue=\"FINE\"/>\n                                    </L7p:AuditDetailAssertion>\n                                    <wsp:OneOrMore wsp:Usage=\"Required\">\n                                    <wsp:All wsp:Usage=\"Required\">\n                                    <L7p:AuditDetailAssertion>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// FINE\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:Detail stringValue=\"==> Searching policy XML\"/>\n                                    <L7p:Level stringValue=\"FINE\"/>\n                                    </L7p:AuditDetailAssertion>\n                                    <L7p:ResponseXpathAssertion>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Extract policiies with reference to this encapsulated assertion\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:VariablePrefix stringValue=\"policies\"/>\n                                    <L7p:XmlMsgSrc stringValue=\"allPolicyXML\"/>\n                                    <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                    <L7p:Expression stringValue=\"//AllPolicyXML/PolicyXML[contains(.,$referenceString)]\"/>\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                                    </L7p:XpathExpression>\n                                    </L7p:ResponseXpathAssertion>\n                                    <L7p:ForEachLoop\n                                    L7p:Usage=\"Required\"\n                                    loopVariable=\"policies.elements\" variablePrefix=\"policy\">\n                                    <L7p:SetVariable>\n\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"// Cast to message type for XPath\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n\n                                    <L7p:Base64Expression stringValue=\"JHtwb2xpY3kuY3VycmVudH0=\"/>\n                                    <L7p:ContentType stringValue=\"text/xml; charset=utf-8\"/>\n                                    <L7p:DataType variableDataType=\"message\"/>\n                                    <L7p:VariableToSet stringValue=\"policyObject.xml\"/>\n                                    </L7p:SetVariable>\n                                    <L7p:Include>\n                                    <L7p:PolicyGuid stringValue=\"8f33b165-bc16-4959-a524-aba67aff3cdf\"/>\n                                    </L7p:Include>\n                                    <L7p:SetVariable>\n\n                                    <L7p:Base64Expression stringValue=\"JHtzb3VyY2VUeXBlLnJlc3VsdH06ICR7Zm9sZGVyUGF0aC5yZXN1bHR9JHtuYW1lLnJlc3VsdH0=\"/>\n                                    <L7p:VariableToSet stringValue=\"depender\"/>\n                                    </L7p:SetVariable>\n                                    <L7p:ManipulateMultiValuedVariable>\n\n                                    <L7p:SourceVariableName stringValue=\"depender\"/>\n\n                                    <L7p:TargetVariableName stringValue=\"dependers.list\"/>\n                                    </L7p:ManipulateMultiValuedVariable>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Cycle through the policies, get folderpath and name and append to ${dependers.list}\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </L7p:ForEachLoop>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Search for references in policy XML\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:All>\n                                    <L7p:TrueAssertion/>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Search for references in policy XML, never fail\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:OneOrMore>\n                                    <wsp:OneOrMore wsp:Usage=\"Required\">\n                                    <wsp:All wsp:Usage=\"Required\">\n                                    <L7p:ComparisonAssertion>\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:Expression1 stringValue=\"${dependers.list.length}\"/>\n                                    <L7p:Expression2 stringValue=\"1\"/>\n                                    <L7p:Operator operator=\"GE\"/>\n                                    <L7p:Predicates predicates=\"included\">\n                                    <L7p:item binary=\"included\">\n\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:Operator operator=\"GE\"/>\n                                    <L7p:RightValue stringValue=\"1\"/>\n                                    </L7p:item>\n                                    </L7p:Predicates>\n                                    </L7p:ComparisonAssertion>\n                                    <L7p:ForEachLoop\n                                    L7p:Usage=\"Required\"\n                                    loopVariable=\"dependers.list\" variablePrefix=\"depender\">\n                                    <L7p:SetVariable>\n\n                                    <L7p:Base64Expression stringValue=\"JHtkZXBlbmRlcnMuaHRtbH0NCiAgPGxpPiR7ZGVwZW5kZXIuY3VycmVudH08L2xpPg==\"/>\n                                    <L7p:VariableToSet stringValue=\"dependers.html\"/>\n                                    </L7p:SetVariable>\n                                    </L7p:ForEachLoop>\n                                    <L7p:SetVariable>\n                                    <L7p:Base64Expression stringValue=\"JHtodG1sQ29udGVudH0NCg0KPHA+VGhlIGZvbGxvd2luZyBvYmplY3RzIHVzZSB0aGlzIGVuY2Fwc3VsYXRlZCBhc3NlcnRpb246PC9wPg0KPHVsPiR7ZGVwZW5kZXJzLmh0bWx9PC91bD4=\"/>\n                                    <L7p:VariableToSet stringValue=\"htmlContent\"/>\n                                    </L7p:SetVariable>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// ${dependers.list} has content\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:All>\n                                    <L7p:SetVariable>\n                                    <L7p:Base64Expression stringValue=\"JHtodG1sQ29udGVudH0NCjxwPk5vdGhpbmcgd2FzIGZvdW5kIHRoYXQgdXNlcyB0aGlzIGVuY2Fwc3VsYXRlZCBhc3NlcnRpb248L3A+\"/>\n                                    <L7p:VariableToSet stringValue=\"htmlContent\"/>\n                                    </L7p:SetVariable>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Append ${dependers.html} to ${htmlContent} if ${dependers.list} has any entries\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:OneOrMore>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// ${id} matches so retrieve dependers\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                </wsp:All>\n                                <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Do reverse dependency search if id matches\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:assertionComment>\n                            </wsp:OneOrMore>\n                            <L7p:assertionComment>\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Cycle through each object to add to display and check if search must be run\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:assertionComment>\n                        </L7p:ForEachLoop>\n                        <L7p:assertionComment>\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// ${objectType} == &quot;Encapsulated Assertion&quot;\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:assertionComment>\n                    </wsp:All>\n                    <wsp:All wsp:Usage=\"Required\">\n                        <L7p:ComparisonAssertion>\n                            <L7p:CaseSensitive booleanValue=\"false\"/>\n                            <L7p:Expression1 stringValue=\"${objectType}\"/>\n                            <L7p:Expression2 stringValue=\"Group\"/>\n                            <L7p:Predicates predicates=\"included\">\n                                <L7p:item binary=\"included\">\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:RightValue stringValue=\"Group\"/>\n                                </L7p:item>\n                            </L7p:Predicates>\n                        </L7p:ComparisonAssertion>\n                        <L7p:AuditDetailAssertion>\n                            <L7p:AssertionComment assertionComment=\"included\">\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// FINE\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:AssertionComment>\n                            <L7p:Detail stringValue=\"======> Listing ${objectType} objects\"/>\n                            <L7p:Level stringValue=\"FINE\"/>\n                        </L7p:AuditDetailAssertion>\n                        <L7p:Encapsulated>\n                            <L7p:AssertionComment assertionComment=\"included\">\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Get list of objectTypes to display and search for references\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:AssertionComment>\n                            <L7p:EncapsulatedAssertionConfigGuid stringValue=\"ead32848-5ace-4468-95fe-50cb9d343d60\"/>\n                            <L7p:EncapsulatedAssertionConfigName stringValue=\"Utility: List Groups\"/>\n                            <L7p:Parameters mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"cacheAge\"/>\n                                    <L7p:value stringValue=\"${cacheAge}\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"identityProviderIds\"/>\n                                    <L7p:value stringValue=\"\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"refresh\"/>\n                                    <L7p:value stringValue=\"${request.http.parameter.refresh}\"/>\n                                </L7p:entry>\n                            </L7p:Parameters>\n                        </L7p:Encapsulated>\n                        <L7p:ResponseXpathAssertion>\n                            <L7p:AssertionComment assertionComment=\"included\">\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Get list of ids\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:AssertionComment>\n                            <L7p:VariablePrefix stringValue=\"ids\"/>\n                            <L7p:XmlMsgSrc stringValue=\"groups.sorted\"/>\n                            <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                <L7p:Expression stringValue=\"/Groups/Group/@id\"/>\n                                <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"s\"/>\n                                    <L7p:value stringValue=\"http://schemas.xmlsoap.org/soap/envelope/\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                    </L7p:entry>\n                                </L7p:Namespaces>\n                                <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                            </L7p:XpathExpression>\n                        </L7p:ResponseXpathAssertion>\n                        <L7p:ForEachLoop L7p:Usage=\"Required\"\n                            loopVariable=\"ids.results\" variablePrefix=\"id\">\n                            <L7p:ResponseXpathAssertion>\n                                <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Get name of the object for display\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:AssertionComment>\n                                <L7p:VariablePrefix stringValue=\"name\"/>\n                                <L7p:XmlMsgSrc stringValue=\"groups.sorted\"/>\n                                <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                    <L7p:Expression stringValue=\"/Groups/Group[@id=$id.current]/Name\"/>\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"s\"/>\n                                    <L7p:value stringValue=\"http://schemas.xmlsoap.org/soap/envelope/\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                                </L7p:XpathExpression>\n                            </L7p:ResponseXpathAssertion>\n                            <L7p:ResponseXpathAssertion>\n                                <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Get providerName of the object for display\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:AssertionComment>\n                                <L7p:VariablePrefix stringValue=\"providerName\"/>\n                                <L7p:XmlMsgSrc stringValue=\"groups.sorted\"/>\n                                <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                    <L7p:Expression stringValue=\"/Groups/Group[@id=$id.current]/@providerName\"/>\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"s\"/>\n                                    <L7p:value stringValue=\"http://schemas.xmlsoap.org/soap/envelope/\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                                </L7p:XpathExpression>\n                            </L7p:ResponseXpathAssertion>\n                            <L7p:AuditDetailAssertion>\n                                <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// FINE\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:AssertionComment>\n                                <L7p:Detail stringValue=\"=====> Processing ${objectType}: ${login.result} (${id.current})\"/>\n                                <L7p:Level stringValue=\"FINE\"/>\n                            </L7p:AuditDetailAssertion>\n                            <L7p:Encapsulated>\n                                <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// ${providerName.result}: ${name.result}\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:AssertionComment>\n                                <L7p:EncapsulatedAssertionConfigGuid stringValue=\"f6b19229-a705-4c48-bc78-3975564a1a9a\"/>\n                                <L7p:EncapsulatedAssertionConfigName stringValue=\"Utility: Escape HTML String\"/>\n                                <L7p:Parameters mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"escapedString\"/>\n                                    <L7p:value stringValue=\"${providerName.result} : ${name.result}\"/>\n                                    </L7p:entry>\n                                </L7p:Parameters>\n                            </L7p:Encapsulated>\n                            <L7p:SetVariable>\n                                <L7p:Base64Expression stringValue=\"JHtodG1sQ29udGVudH0NCjxhIGlkPSIke2lkLmN1cnJlbnR9Ii8+PGEgaHJlZj0iJHtyZXF1ZXN0LnVybC5wYXRofT9vYmplY3RUeXBlPSR7b2JqZWN0VHlwZX0maWQ9JHtpZC5jdXJyZW50fSMke2lkLmN1cnJlbnR9IiBvbkNsaWNrPSJzZXRSZWZyZXNoKHRoaXMpIj4ke2VzY2FwZWRTdHJpbmd9PC9hPjxici8+\"/>\n                                <L7p:VariableToSet stringValue=\"htmlContent\"/>\n                            </L7p:SetVariable>\n                            <wsp:OneOrMore wsp:Usage=\"Required\">\n                                <L7p:ComparisonAssertion>\n                                    <L7p:Expression1 stringValue=\"${id}\"/>\n                                    <L7p:Expression2 stringValue=\"${id.current}\"/>\n                                    <L7p:Negate booleanValue=\"true\"/>\n                                    <L7p:Predicates predicates=\"included\">\n                                    <L7p:item binary=\"included\">\n                                    <L7p:Negated booleanValue=\"true\"/>\n                                    <L7p:RightValue stringValue=\"${id.current}\"/>\n                                    </L7p:item>\n                                    </L7p:Predicates>\n                                </L7p:ComparisonAssertion>\n                                <wsp:All wsp:Usage=\"Required\">\n                                    <L7p:AuditDetailAssertion>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// FINE\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:Detail stringValue=\"====> ID matched, processing for dependencies\"/>\n                                    <L7p:Level stringValue=\"FINE\"/>\n                                    </L7p:AuditDetailAssertion>\n                                    <L7p:ResponseXpathAssertion>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Get providerId of the object for confirmation\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:VariablePrefix stringValue=\"providerId\"/>\n                                    <L7p:XmlMsgSrc stringValue=\"groups.sorted\"/>\n                                    <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                    <L7p:Expression stringValue=\"/Groups/Group[@id=$id.current]/@providerId\"/>\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"s\"/>\n                                    <L7p:value stringValue=\"http://schemas.xmlsoap.org/soap/envelope/\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                                    </L7p:XpathExpression>\n                                    </L7p:ResponseXpathAssertion>\n                                    <L7p:SetVariable>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// The final identifier string we'll use\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:Base64Expression stringValue=\"PEw3cDpHcm91cElkIHN0cmluZ1ZhbHVlPSIke2lkLmN1cnJlbnR9Ii8+\"/>\n                                    <L7p:VariableToSet stringValue=\"referenceString\"/>\n                                    </L7p:SetVariable>\n                                    <L7p:AuditDetailAssertion>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// FINE\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:Detail stringValue=\"===> Searching objects for references to ${referenceString}\"/>\n                                    <L7p:Level stringValue=\"FINE\"/>\n                                    </L7p:AuditDetailAssertion>\n                                    <wsp:OneOrMore wsp:Usage=\"Required\">\n                                    <wsp:All wsp:Usage=\"Required\">\n                                    <L7p:AuditDetailAssertion>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// FINE\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:Detail stringValue=\"==> Searching policy XML\"/>\n                                    <L7p:Level stringValue=\"FINE\"/>\n                                    </L7p:AuditDetailAssertion>\n                                    <L7p:ResponseXpathAssertion>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Extract all policy objects that contain the reference string\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:VariablePrefix stringValue=\"policies\"/>\n                                    <L7p:XmlMsgSrc stringValue=\"allPolicyXML\"/>\n                                    <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                    <L7p:Expression stringValue=\"/AllPolicyXML/PolicyXML[contains(.,$referenceString)]\"/>\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                                    </L7p:XpathExpression>\n                                    </L7p:ResponseXpathAssertion>\n                                    <L7p:ForEachLoop\n                                    L7p:Usage=\"Required\"\n                                    loopVariable=\"policies.elements\" variablePrefix=\"policy\">\n                                    <L7p:SetVariable>\n\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"// Cast to message type for XPath\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n\n                                    <L7p:Base64Expression stringValue=\"JHtwb2xpY3kuY3VycmVudH0=\"/>\n                                    <L7p:ContentType stringValue=\"text/xml; charset=utf-8\"/>\n                                    <L7p:DataType variableDataType=\"message\"/>\n                                    <L7p:VariableToSet stringValue=\"policyObject.xml\"/>\n                                    </L7p:SetVariable>\n                                    <L7p:ResponseXpathAssertion>\n\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"// Extract the policy XML from the policy object\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:VariablePrefix stringValue=\"policy.xml\"/>\n                                    <L7p:XmlMsgSrc stringValue=\"policyObject.xml\"/>\n                                    <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                    <L7p:Expression stringValue=\"/PolicyXML/text()\"/>\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"s\"/>\n\n                                    <L7p:value stringValue=\"http://schemas.xmlsoap.org/soap/envelope/\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                                    </L7p:XpathExpression>\n                                    </L7p:ResponseXpathAssertion>\n                                    <L7p:SetVariable>\n\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"// Cast to message type for XPath\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n\n                                    <L7p:Base64Expression stringValue=\"JHtwb2xpY3kueG1sLnJlc3VsdH0=\"/>\n                                    <L7p:ContentType stringValue=\"text/xml; charset=utf-8\"/>\n                                    <L7p:DataType variableDataType=\"message\"/>\n                                    <L7p:VariableToSet stringValue=\"policy.xml\"/>\n                                    </L7p:SetVariable>\n                                    <wsp:OneOrMore wsp:Usage=\"Required\">\n                                    <wsp:All wsp:Usage=\"Required\">\n                                    <L7p:ResponseXpathAssertion>\n\n                                    <L7p:AssertionComment assertionComment=\"included\">\n\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"// Check if the policy XML has a reference to this group id\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n\n                                    <L7p:VariablePrefix stringValue=\"\"/>\n\n                                    <L7p:XmlMsgSrc stringValue=\"policy.xml\"/>\n\n                                    <L7p:XpathExpression xpathExpressionValue=\"included\">\n\n                                    <L7p:Expression stringValue=\"//L7p:MemberOfGroup/L7p:IdentityProviderOid[@goidValue=$providerId.result]\"/>\n\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"L7p\"/>\n\n                                    <L7p:value stringValue=\"http://www.layer7tech.com/ws/policy\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"wsp\"/>\n\n                                    <L7p:value stringValue=\"http://schemas.xmlsoap.org/ws/2002/12/policy\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                                    </L7p:XpathExpression>\n                                    </L7p:ResponseXpathAssertion>\n                                    <L7p:Include>\n\n                                    <L7p:PolicyGuid stringValue=\"8f33b165-bc16-4959-a524-aba67aff3cdf\"/>\n                                    </L7p:Include>\n                                    <L7p:SetVariable>\n\n                                    <L7p:Base64Expression stringValue=\"JHtzb3VyY2VUeXBlLnJlc3VsdH06ICR7Zm9sZGVyUGF0aC5yZXN1bHR9JHtuYW1lLnJlc3VsdH0=\"/>\n\n                                    <L7p:VariableToSet stringValue=\"depender\"/>\n                                    </L7p:SetVariable>\n                                    <L7p:ManipulateMultiValuedVariable>\n\n                                    <L7p:SourceVariableName stringValue=\"depender\"/>\n\n                                    <L7p:TargetVariableName stringValue=\"dependers.list\"/>\n                                    </L7p:ManipulateMultiValuedVariable>\n                                    <L7p:assertionComment>\n\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"// Search policy XML for IdentityProviderOid element matching our reference\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:All>\n                                    <L7p:TrueAssertion/>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"// Search policy XML for IdentityProviderOid element matching our reference, never fail\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:OneOrMore>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Cycle through each policy that has our reference string and confirm the provider\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </L7p:ForEachLoop>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Search for references in policy XML\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:All>\n                                    <L7p:TrueAssertion/>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Search for references in policy XML, never fail\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:OneOrMore>\n                                    <wsp:OneOrMore wsp:Usage=\"Required\">\n                                    <wsp:All wsp:Usage=\"Required\">\n                                    <L7p:ComparisonAssertion>\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:Expression1 stringValue=\"${dependers.list.length}\"/>\n                                    <L7p:Expression2 stringValue=\"1\"/>\n                                    <L7p:Operator operator=\"GE\"/>\n                                    <L7p:Predicates predicates=\"included\">\n                                    <L7p:item binary=\"included\">\n\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:Operator operator=\"GE\"/>\n                                    <L7p:RightValue stringValue=\"1\"/>\n                                    </L7p:item>\n                                    </L7p:Predicates>\n                                    </L7p:ComparisonAssertion>\n                                    <L7p:ForEachLoop\n                                    L7p:Usage=\"Required\"\n                                    loopVariable=\"dependers.list\" variablePrefix=\"depender\">\n                                    <L7p:SetVariable>\n\n                                    <L7p:Base64Expression stringValue=\"JHtkZXBlbmRlcnMuaHRtbH0NCiAgPGxpPiR7ZGVwZW5kZXIuY3VycmVudH08L2xpPg==\"/>\n                                    <L7p:VariableToSet stringValue=\"dependers.html\"/>\n                                    </L7p:SetVariable>\n                                    </L7p:ForEachLoop>\n                                    <L7p:SetVariable>\n                                    <L7p:Base64Expression stringValue=\"JHtodG1sQ29udGVudH0NCg0KPHA+VGhlIGZvbGxvd2luZyBvYmplY3RzIHJlZmVyZW5jZSB0aGlzIGdyb3VwOjwvcD4NCjx1bD4ke2RlcGVuZGVycy5odG1sfTwvdWw+\"/>\n                                    <L7p:VariableToSet stringValue=\"htmlContent\"/>\n                                    </L7p:SetVariable>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// ${dependers.list} has content\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:All>\n                                    <L7p:SetVariable>\n                                    <L7p:Base64Expression stringValue=\"JHtodG1sQ29udGVudH0NCjxwPk5vdGhpbmcgd2FzIGZvdW5kIHRoYXQgcmVmZXJlbmNlcyB0aGlzIGdyb3VwPC9wPg==\"/>\n                                    <L7p:VariableToSet stringValue=\"htmlContent\"/>\n                                    </L7p:SetVariable>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Append ${dependers.html} to ${htmlContent} if ${dependers.list} has any entries\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:OneOrMore>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// ${id} matches so retrieve dependers\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                </wsp:All>\n                                <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Do reverse dependency search if id matches\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:assertionComment>\n                            </wsp:OneOrMore>\n                            <L7p:assertionComment>\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Cycle through each object to add to display and check if search must be run\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:assertionComment>\n                        </L7p:ForEachLoop>\n                        <L7p:assertionComment>\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// ${objectType} == &quot;Group&quot;\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:assertionComment>\n                    </wsp:All>\n                    <wsp:All wsp:Usage=\"Required\">\n                        <L7p:ComparisonAssertion>\n                            <L7p:CaseSensitive booleanValue=\"false\"/>\n                            <L7p:Expression1 stringValue=\"${objectType}\"/>\n                            <L7p:Expression2 stringValue=\"Identity Provider\"/>\n                            <L7p:Predicates predicates=\"included\">\n                                <L7p:item binary=\"included\">\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:RightValue stringValue=\"Identity Provider\"/>\n                                </L7p:item>\n                            </L7p:Predicates>\n                        </L7p:ComparisonAssertion>\n                        <L7p:AuditDetailAssertion>\n                            <L7p:AssertionComment assertionComment=\"included\">\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// FINE\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:AssertionComment>\n                            <L7p:Detail stringValue=\"======> Listing ${objectType} objects\"/>\n                            <L7p:Level stringValue=\"FINE\"/>\n                        </L7p:AuditDetailAssertion>\n                        <L7p:Encapsulated>\n                            <L7p:AssertionComment assertionComment=\"included\">\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Get list of objectTypes to display and search for references\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:AssertionComment>\n                            <L7p:EncapsulatedAssertionConfigGuid stringValue=\"1ab6158d-33ce-4fa6-a7d8-2b8dc8e31faf\"/>\n                            <L7p:EncapsulatedAssertionConfigName stringValue=\"Utility: List Identity Providers\"/>\n                            <L7p:Parameters mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"cacheAge\"/>\n                                    <L7p:value stringValue=\"${cacheAge}\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"refresh\"/>\n                                    <L7p:value stringValue=\"${request.http.parameter.refresh}\"/>\n                                </L7p:entry>\n                            </L7p:Parameters>\n                        </L7p:Encapsulated>\n                        <L7p:ResponseXpathAssertion>\n                            <L7p:AssertionComment assertionComment=\"included\">\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Get list of ids\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:AssertionComment>\n                            <L7p:VariablePrefix stringValue=\"ids\"/>\n                            <L7p:XmlMsgSrc stringValue=\"identityProviders.sorted\"/>\n                            <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                <L7p:Expression stringValue=\"/IdentityProviders/IdentityProvider/@id\"/>\n                                <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"s\"/>\n                                    <L7p:value stringValue=\"http://schemas.xmlsoap.org/soap/envelope/\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                    </L7p:entry>\n                                </L7p:Namespaces>\n                                <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                            </L7p:XpathExpression>\n                        </L7p:ResponseXpathAssertion>\n                        <L7p:ForEachLoop L7p:Usage=\"Required\"\n                            loopVariable=\"ids.results\" variablePrefix=\"id\">\n                            <L7p:ResponseXpathAssertion>\n                                <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Get name of the object for display\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:AssertionComment>\n                                <L7p:VariablePrefix stringValue=\"name\"/>\n                                <L7p:XmlMsgSrc stringValue=\"identityProviders.sorted\"/>\n                                <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                    <L7p:Expression stringValue=\"/IdentityProviders/IdentityProvider[@id=$id.current]/Name\"/>\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"s\"/>\n                                    <L7p:value stringValue=\"http://schemas.xmlsoap.org/soap/envelope/\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                                </L7p:XpathExpression>\n                            </L7p:ResponseXpathAssertion>\n                            <L7p:ResponseXpathAssertion>\n                                <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Get type of the object for display\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:AssertionComment>\n                                <L7p:VariablePrefix stringValue=\"type\"/>\n                                <L7p:XmlMsgSrc stringValue=\"identityProviders.sorted\"/>\n                                <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                    <L7p:Expression stringValue=\"/IdentityProviders/IdentityProvider[@id=$id.current]/Type\"/>\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"s\"/>\n                                    <L7p:value stringValue=\"http://schemas.xmlsoap.org/soap/envelope/\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                                </L7p:XpathExpression>\n                            </L7p:ResponseXpathAssertion>\n                            <L7p:AuditDetailAssertion>\n                                <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// FINE\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:AssertionComment>\n                                <L7p:Detail stringValue=\"=====> Processing ${objectType}: ${name.result} (${id.current})\"/>\n                                <L7p:Level stringValue=\"FINE\"/>\n                            </L7p:AuditDetailAssertion>\n                            <L7p:Encapsulated>\n                                <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// name.result\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:AssertionComment>\n                                <L7p:EncapsulatedAssertionConfigGuid stringValue=\"f6b19229-a705-4c48-bc78-3975564a1a9a\"/>\n                                <L7p:EncapsulatedAssertionConfigName stringValue=\"Utility: Escape HTML String\"/>\n                                <L7p:Parameters mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"escapedString\"/>\n                                    <L7p:value stringValue=\"${name.result}\"/>\n                                    </L7p:entry>\n                                </L7p:Parameters>\n                            </L7p:Encapsulated>\n                            <L7p:SetVariable>\n                                <L7p:Base64Expression stringValue=\"JHtodG1sQ29udGVudH0NCjxhIGlkPSIke2lkLmN1cnJlbnR9Ii8+PGEgaHJlZj0iJHtyZXF1ZXN0LnVybC5wYXRofT9vYmplY3RUeXBlPSR7b2JqZWN0VHlwZX0maWQ9JHtpZC5jdXJyZW50fSMke2lkLmN1cnJlbnR9IiBvbkNsaWNrPSJzZXRSZWZyZXNoKHRoaXMpIj4ke2VzY2FwZWRTdHJpbmd9PC9hPiAoJHt0eXBlLnJlc3VsdH0pPGJyLz4=\"/>\n                                <L7p:VariableToSet stringValue=\"htmlContent\"/>\n                            </L7p:SetVariable>\n                            <wsp:OneOrMore wsp:Usage=\"Required\">\n                                <L7p:ComparisonAssertion>\n                                    <L7p:Expression1 stringValue=\"${id}\"/>\n                                    <L7p:Expression2 stringValue=\"${id.current}\"/>\n                                    <L7p:Negate booleanValue=\"true\"/>\n                                    <L7p:Predicates predicates=\"included\">\n                                    <L7p:item binary=\"included\">\n                                    <L7p:Negated booleanValue=\"true\"/>\n                                    <L7p:RightValue stringValue=\"${id.current}\"/>\n                                    </L7p:item>\n                                    </L7p:Predicates>\n                                </L7p:ComparisonAssertion>\n                                <wsp:All wsp:Usage=\"Required\">\n                                    <L7p:AuditDetailAssertion>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// FINE\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:Detail stringValue=\"====> ID matched, processing for dependencies\"/>\n                                    <L7p:Level stringValue=\"FINE\"/>\n                                    </L7p:AuditDetailAssertion>\n                                    <L7p:SetVariable>\n                                    <L7p:Base64Expression stringValue=\"PEw3cDpJZGVudGl0eVByb3ZpZGVyT2lkIGdvaWRWYWx1ZT0iJHtpZC5jdXJyZW50fSI=\"/>\n                                    <L7p:VariableToSet stringValue=\"referenceString\"/>\n                                    </L7p:SetVariable>\n                                    <L7p:AuditDetailAssertion>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// FINE\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:Detail stringValue=\"===> Searching objects for references to ${referenceString}\"/>\n                                    <L7p:Level stringValue=\"FINE\"/>\n                                    </L7p:AuditDetailAssertion>\n                                    <wsp:OneOrMore wsp:Usage=\"Required\">\n                                    <wsp:All wsp:Usage=\"Required\">\n                                    <L7p:AuditDetailAssertion>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// FINE\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:Detail stringValue=\"==> Searching policy XML\"/>\n                                    <L7p:Level stringValue=\"FINE\"/>\n                                    </L7p:AuditDetailAssertion>\n                                    <L7p:ResponseXpathAssertion>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Extract all policy objects that contain the IdentityProviderOid element\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:VariablePrefix stringValue=\"policies\"/>\n                                    <L7p:XmlMsgSrc stringValue=\"allPolicyXML\"/>\n                                    <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                    <L7p:Expression stringValue=\"/AllPolicyXML/PolicyXML[contains(.,$referenceString)]\"/>\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                                    </L7p:XpathExpression>\n                                    </L7p:ResponseXpathAssertion>\n                                    <L7p:ForEachLoop\n                                    L7p:Usage=\"Required\"\n                                    loopVariable=\"policies.elements\" variablePrefix=\"policy\">\n                                    <L7p:SetVariable>\n\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"// Cast to message type for XPath\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n\n                                    <L7p:Base64Expression stringValue=\"JHtwb2xpY3kuY3VycmVudH0=\"/>\n                                    <L7p:ContentType stringValue=\"text/xml; charset=utf-8\"/>\n                                    <L7p:DataType variableDataType=\"message\"/>\n                                    <L7p:VariableToSet stringValue=\"policyObject.xml\"/>\n                                    </L7p:SetVariable>\n                                    <L7p:ResponseXpathAssertion>\n\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"// Extract the policy XML from the policy object\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:VariablePrefix stringValue=\"policy.xml\"/>\n                                    <L7p:XmlMsgSrc stringValue=\"policyObject.xml\"/>\n                                    <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                    <L7p:Expression stringValue=\"/PolicyXML/text()\"/>\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"s\"/>\n\n                                    <L7p:value stringValue=\"http://schemas.xmlsoap.org/soap/envelope/\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                                    </L7p:XpathExpression>\n                                    </L7p:ResponseXpathAssertion>\n                                    <L7p:Include>\n                                    <L7p:PolicyGuid stringValue=\"8f33b165-bc16-4959-a524-aba67aff3cdf\"/>\n                                    </L7p:Include>\n                                    <L7p:SetVariable>\n\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"// Cast to message type for XPath\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n\n                                    <L7p:Base64Expression stringValue=\"JHtwb2xpY3kueG1sLnJlc3VsdH0=\"/>\n                                    <L7p:ContentType stringValue=\"text/xml; charset=utf-8\"/>\n                                    <L7p:DataType variableDataType=\"message\"/>\n                                    <L7p:VariableToSet stringValue=\"policy.xml\"/>\n                                    </L7p:SetVariable>\n                                    <L7p:ResponseXpathAssertion>\n\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"// Get the name of the parent elements to display\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:VariablePrefix stringValue=\"assertion\"/>\n                                    <L7p:XmlMsgSrc stringValue=\"policy.xml\"/>\n                                    <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                    <L7p:Expression stringValue=\"//L7p:IdentityProviderOid[@goidValue=$id.current]/../name()\"/>\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"L7p\"/>\n\n                                    <L7p:value stringValue=\"http://www.layer7tech.com/ws/policy\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_2_0\"/>\n                                    </L7p:XpathExpression>\n                                    </L7p:ResponseXpathAssertion>\n                                    <L7p:SetVariable>\n\n                                    <L7p:Base64Expression stringValue=\"JHtzb3VyY2VUeXBlLnJlc3VsdH06ICR7Zm9sZGVyUGF0aC5yZXN1bHR9JHtuYW1lLnJlc3VsdH0gKCR7YXNzZXJ0aW9uLnJlc3VsdHN9KQ==\"/>\n                                    <L7p:VariableToSet stringValue=\"depender\"/>\n                                    </L7p:SetVariable>\n                                    <L7p:ManipulateMultiValuedVariable>\n\n                                    <L7p:SourceVariableName stringValue=\"depender\"/>\n\n                                    <L7p:TargetVariableName stringValue=\"dependers.list\"/>\n                                    </L7p:ManipulateMultiValuedVariable>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Cycle through each to extract parent elements and add to ${dependers.list}\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </L7p:ForEachLoop>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Search for references in policy XML, never fail\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:All>\n                                    <L7p:TrueAssertion/>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Search for references in policy XML, never fail\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:OneOrMore>\n                                    <wsp:OneOrMore wsp:Usage=\"Required\">\n                                    <wsp:All wsp:Usage=\"Required\">\n                                    <L7p:ComparisonAssertion>\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:Expression1 stringValue=\"${dependers.list.length}\"/>\n                                    <L7p:Expression2 stringValue=\"1\"/>\n                                    <L7p:Operator operator=\"GE\"/>\n                                    <L7p:Predicates predicates=\"included\">\n                                    <L7p:item binary=\"included\">\n\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:Operator operator=\"GE\"/>\n                                    <L7p:RightValue stringValue=\"1\"/>\n                                    </L7p:item>\n                                    </L7p:Predicates>\n                                    </L7p:ComparisonAssertion>\n                                    <L7p:ForEachLoop\n                                    L7p:Usage=\"Required\"\n                                    loopVariable=\"dependers.list\" variablePrefix=\"depender\">\n                                    <L7p:SetVariable>\n\n                                    <L7p:Base64Expression stringValue=\"JHtkZXBlbmRlcnMuaHRtbH0NCiAgPGxpPiR7ZGVwZW5kZXIuY3VycmVudH08L2xpPg==\"/>\n                                    <L7p:VariableToSet stringValue=\"dependers.html\"/>\n                                    </L7p:SetVariable>\n                                    </L7p:ForEachLoop>\n                                    <L7p:SetVariable>\n                                    <L7p:Base64Expression stringValue=\"JHtodG1sQ29udGVudH0NCg0KPHA+VGhlIGZvbGxvd2luZyBvYmplY3RzIHJlZmVyZW5jZSB0aGlzIGlkZW50aXR5IHByb3ZpZGVyOjwvcD4NCjx1bD4ke2RlcGVuZGVycy5odG1sfTwvdWw+\"/>\n                                    <L7p:VariableToSet stringValue=\"htmlContent\"/>\n                                    </L7p:SetVariable>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// ${dependers.list} has content\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:All>\n                                    <L7p:SetVariable>\n                                    <L7p:Base64Expression stringValue=\"JHtodG1sQ29udGVudH0NCjxwPk5vdGhpbmcgd2FzIGZvdW5kIHRoYXQgcmVmZXJlbmNlcyB0aGlzIGlkZW50aXR5IHByb3ZpZGVyPC9wPg==\"/>\n                                    <L7p:VariableToSet stringValue=\"htmlContent\"/>\n                                    </L7p:SetVariable>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Append ${dependers.html} to ${htmlContent} if ${dependers.list} has any entries\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:OneOrMore>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// ${id} matches so retrieve dependers\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                </wsp:All>\n                                <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Do reverse dependency search if id matches\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:assertionComment>\n                            </wsp:OneOrMore>\n                            <L7p:assertionComment>\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Cycle through each object to add to display and check if search must be run\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:assertionComment>\n                        </L7p:ForEachLoop>\n                        <L7p:assertionComment>\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// ${objectType} == &quot;Identity Provider&quot;\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:assertionComment>\n                    </wsp:All>\n                    <wsp:All wsp:Usage=\"Required\">\n                        <L7p:ComparisonAssertion>\n                            <L7p:CaseSensitive booleanValue=\"false\"/>\n                            <L7p:Expression1 stringValue=\"${objectType}\"/>\n                            <L7p:Expression2 stringValue=\"JDBC Connection\"/>\n                            <L7p:Predicates predicates=\"included\">\n                                <L7p:item binary=\"included\">\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:RightValue stringValue=\"JDBC Connection\"/>\n                                </L7p:item>\n                            </L7p:Predicates>\n                        </L7p:ComparisonAssertion>\n                        <L7p:AuditDetailAssertion>\n                            <L7p:AssertionComment assertionComment=\"included\">\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// FINE\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:AssertionComment>\n                            <L7p:Detail stringValue=\"======> Listing ${objectType} objects\"/>\n                            <L7p:Level stringValue=\"FINE\"/>\n                        </L7p:AuditDetailAssertion>\n                        <L7p:Encapsulated>\n                            <L7p:AssertionComment assertionComment=\"included\">\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Get list of objectTypes to display and search for references\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:AssertionComment>\n                            <L7p:EncapsulatedAssertionConfigGuid stringValue=\"f8abecfe-11d6-44e4-be07-16e6080a7e5e\"/>\n                            <L7p:EncapsulatedAssertionConfigName stringValue=\"Utility: List JDBC Connections\"/>\n                            <L7p:Parameters mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"cacheAge\"/>\n                                    <L7p:value stringValue=\"${cacheAge}\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"refresh\"/>\n                                    <L7p:value stringValue=\"${request.http.parameter.refresh}\"/>\n                                </L7p:entry>\n                            </L7p:Parameters>\n                        </L7p:Encapsulated>\n                        <L7p:ResponseXpathAssertion>\n                            <L7p:AssertionComment assertionComment=\"included\">\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Get list of ids\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:AssertionComment>\n                            <L7p:VariablePrefix stringValue=\"ids\"/>\n                            <L7p:XmlMsgSrc stringValue=\"jdbcConnections.sorted\"/>\n                            <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                <L7p:Expression stringValue=\"/JDBCConnections/JDBCConnection/@id\"/>\n                                <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"s\"/>\n                                    <L7p:value stringValue=\"http://schemas.xmlsoap.org/soap/envelope/\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                    </L7p:entry>\n                                </L7p:Namespaces>\n                                <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                            </L7p:XpathExpression>\n                        </L7p:ResponseXpathAssertion>\n                        <L7p:ForEachLoop L7p:Usage=\"Required\"\n                            loopVariable=\"ids.results\" variablePrefix=\"id\">\n                            <L7p:ResponseXpathAssertion>\n                                <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Get name of the object for display\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:AssertionComment>\n                                <L7p:VariablePrefix stringValue=\"name\"/>\n                                <L7p:XmlMsgSrc stringValue=\"jdbcConnections.sorted\"/>\n                                <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                    <L7p:Expression stringValue=\"/JDBCConnections/JDBCConnection[@id=$id.current]/Name\"/>\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"s\"/>\n                                    <L7p:value stringValue=\"http://schemas.xmlsoap.org/soap/envelope/\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                                </L7p:XpathExpression>\n                            </L7p:ResponseXpathAssertion>\n                            <L7p:AuditDetailAssertion>\n                                <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// FINE\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:AssertionComment>\n                                <L7p:Detail stringValue=\"=====> Processing ${objectType}: ${name.result} (${id.current})\"/>\n                                <L7p:Level stringValue=\"FINE\"/>\n                            </L7p:AuditDetailAssertion>\n                            <L7p:Encapsulated>\n                                <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// name.result\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:AssertionComment>\n                                <L7p:EncapsulatedAssertionConfigGuid stringValue=\"f6b19229-a705-4c48-bc78-3975564a1a9a\"/>\n                                <L7p:EncapsulatedAssertionConfigName stringValue=\"Utility: Escape HTML String\"/>\n                                <L7p:Parameters mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"escapedString\"/>\n                                    <L7p:value stringValue=\"${name.result}\"/>\n                                    </L7p:entry>\n                                </L7p:Parameters>\n                            </L7p:Encapsulated>\n                            <L7p:SetVariable>\n                                <L7p:Base64Expression stringValue=\"JHtodG1sQ29udGVudH0NCjxhIGlkPSIke2lkLmN1cnJlbnR9Ii8+PGEgaHJlZj0iJHtyZXF1ZXN0LnVybC5wYXRofT9vYmplY3RUeXBlPSR7b2JqZWN0VHlwZX0maWQ9JHtpZC5jdXJyZW50fSMke2lkLmN1cnJlbnR9IiBvbkNsaWNrPSJzZXRSZWZyZXNoKHRoaXMpIj4ke2VzY2FwZWRTdHJpbmd9PC9hPjxici8+\"/>\n                                <L7p:VariableToSet stringValue=\"htmlContent\"/>\n                            </L7p:SetVariable>\n                            <wsp:OneOrMore wsp:Usage=\"Required\">\n                                <L7p:ComparisonAssertion>\n                                    <L7p:Expression1 stringValue=\"${id}\"/>\n                                    <L7p:Expression2 stringValue=\"${id.current}\"/>\n                                    <L7p:Negate booleanValue=\"true\"/>\n                                    <L7p:Predicates predicates=\"included\">\n                                    <L7p:item binary=\"included\">\n                                    <L7p:Negated booleanValue=\"true\"/>\n                                    <L7p:RightValue stringValue=\"${id.current}\"/>\n                                    </L7p:item>\n                                    </L7p:Predicates>\n                                </L7p:ComparisonAssertion>\n                                <wsp:All wsp:Usage=\"Required\">\n                                    <L7p:AuditDetailAssertion>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// FINE\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:Detail stringValue=\"====> ID matched, processing for dependencies\"/>\n                                    <L7p:Level stringValue=\"FINE\"/>\n                                    </L7p:AuditDetailAssertion>\n                                    <L7p:SetVariable>\n                                    <L7p:Base64Expression stringValue=\"JHtuYW1lLnJlc3VsdH0=\"/>\n                                    <L7p:VariableToSet stringValue=\"referenceString\"/>\n                                    </L7p:SetVariable>\n                                    <L7p:AuditDetailAssertion>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// FINE\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:Detail stringValue=\"===> Searching objects for references to ${referenceString}\"/>\n                                    <L7p:Level stringValue=\"FINE\"/>\n                                    </L7p:AuditDetailAssertion>\n                                    <wsp:OneOrMore wsp:Usage=\"Required\">\n                                    <wsp:All wsp:Usage=\"Required\">\n                                    <L7p:AuditDetailAssertion>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// FINE\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:Detail stringValue=\"==> Searching policy XML\"/>\n                                    <L7p:Level stringValue=\"FINE\"/>\n                                    </L7p:AuditDetailAssertion>\n                                    <L7p:ResponseXpathAssertion>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Extract all policy objects that contain the JdbcQuery element\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:VariablePrefix stringValue=\"policies\"/>\n                                    <L7p:XmlMsgSrc stringValue=\"allPolicyXML\"/>\n                                    <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                    <L7p:Expression stringValue=\"/AllPolicyXML/PolicyXML[contains(.,'&lt;L7p:JdbcQuery>')]\"/>\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                                    </L7p:XpathExpression>\n                                    </L7p:ResponseXpathAssertion>\n                                    <L7p:ForEachLoop\n                                    L7p:Usage=\"Required\"\n                                    loopVariable=\"policies.elements\" variablePrefix=\"policy\">\n                                    <L7p:SetVariable>\n\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"// Cast to message type for XPath\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n\n                                    <L7p:Base64Expression stringValue=\"JHtwb2xpY3kuY3VycmVudH0=\"/>\n                                    <L7p:ContentType stringValue=\"text/xml; charset=utf-8\"/>\n                                    <L7p:DataType variableDataType=\"message\"/>\n                                    <L7p:VariableToSet stringValue=\"policyObject.xml\"/>\n                                    </L7p:SetVariable>\n                                    <L7p:ResponseXpathAssertion>\n\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"// Extract the policy XML from the policy object\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:VariablePrefix stringValue=\"policy.xml\"/>\n                                    <L7p:XmlMsgSrc stringValue=\"policyObject.xml\"/>\n                                    <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                    <L7p:Expression stringValue=\"/PolicyXML/text()\"/>\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"s\"/>\n\n                                    <L7p:value stringValue=\"http://schemas.xmlsoap.org/soap/envelope/\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                                    </L7p:XpathExpression>\n                                    </L7p:ResponseXpathAssertion>\n                                    <L7p:SetVariable>\n\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"// Cast to message type for XPath\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n\n                                    <L7p:Base64Expression stringValue=\"JHtwb2xpY3kueG1sLnJlc3VsdH0=\"/>\n                                    <L7p:ContentType stringValue=\"text/xml; charset=utf-8\"/>\n                                    <L7p:DataType variableDataType=\"message\"/>\n                                    <L7p:VariableToSet stringValue=\"policy.xml\"/>\n                                    </L7p:SetVariable>\n                                    <wsp:OneOrMore wsp:Usage=\"Required\">\n                                    <wsp:All wsp:Usage=\"Required\">\n                                    <L7p:ResponseXpathAssertion>\n\n                                    <L7p:AssertionComment assertionComment=\"included\">\n\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"// Check if the policy XML has a reference to this JDBC connection\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n\n                                    <L7p:VariablePrefix stringValue=\"\"/>\n\n                                    <L7p:XmlMsgSrc stringValue=\"policy.xml\"/>\n\n                                    <L7p:XpathExpression xpathExpressionValue=\"included\">\n\n                                    <L7p:Expression stringValue=\"//L7p:JdbcQuery/L7p:ConnectionName[@stringValue=$referenceString]\"/>\n\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"L7p\"/>\n\n                                    <L7p:value stringValue=\"http://www.layer7tech.com/ws/policy\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"wsp\"/>\n\n                                    <L7p:value stringValue=\"http://schemas.xmlsoap.org/ws/2002/12/policy\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                                    </L7p:XpathExpression>\n                                    </L7p:ResponseXpathAssertion>\n                                    <L7p:Include>\n\n                                    <L7p:PolicyGuid stringValue=\"8f33b165-bc16-4959-a524-aba67aff3cdf\"/>\n                                    </L7p:Include>\n                                    <L7p:SetVariable>\n\n                                    <L7p:Base64Expression stringValue=\"JHtzb3VyY2VUeXBlLnJlc3VsdH06ICR7Zm9sZGVyUGF0aC5yZXN1bHR9JHtuYW1lLnJlc3VsdH0=\"/>\n\n                                    <L7p:VariableToSet stringValue=\"depender\"/>\n                                    </L7p:SetVariable>\n                                    <L7p:ManipulateMultiValuedVariable>\n\n                                    <L7p:SourceVariableName stringValue=\"depender\"/>\n\n                                    <L7p:TargetVariableName stringValue=\"dependers.list\"/>\n                                    </L7p:ManipulateMultiValuedVariable>\n                                    <L7p:assertionComment>\n\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"// Search policy XML for JdbcQuery element matching our reference\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:All>\n                                    <L7p:TrueAssertion/>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"// Search policy XML for JdbcQuery element matching our reference, never fail\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:OneOrMore>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Cycle through each policy to see if the JDBC connection is the one we want and append to ${dependers.list}\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </L7p:ForEachLoop>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Search for references in policy XML\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:All>\n                                    <L7p:TrueAssertion/>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Search for references in policy XML, never fail\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:OneOrMore>\n                                    <wsp:OneOrMore wsp:Usage=\"Required\">\n                                    <wsp:All wsp:Usage=\"Required\">\n                                    <L7p:ComparisonAssertion>\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:Expression1 stringValue=\"${dependers.list.length}\"/>\n                                    <L7p:Expression2 stringValue=\"1\"/>\n                                    <L7p:Operator operator=\"GE\"/>\n                                    <L7p:Predicates predicates=\"included\">\n                                    <L7p:item binary=\"included\">\n\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:Operator operator=\"GE\"/>\n                                    <L7p:RightValue stringValue=\"1\"/>\n                                    </L7p:item>\n                                    </L7p:Predicates>\n                                    </L7p:ComparisonAssertion>\n                                    <L7p:ForEachLoop\n                                    L7p:Usage=\"Required\"\n                                    loopVariable=\"dependers.list\" variablePrefix=\"depender\">\n                                    <L7p:SetVariable>\n\n                                    <L7p:Base64Expression stringValue=\"JHtkZXBlbmRlcnMuaHRtbH0NCiAgPGxpPiR7ZGVwZW5kZXIuY3VycmVudH08L2xpPg==\"/>\n                                    <L7p:VariableToSet stringValue=\"dependers.html\"/>\n                                    </L7p:SetVariable>\n                                    </L7p:ForEachLoop>\n                                    <L7p:SetVariable>\n                                    <L7p:Base64Expression stringValue=\"JHtodG1sQ29udGVudH0NCg0KPHA+VGhlIGZvbGxvd2luZyBvYmplY3RzIHJlZmVyZW5jZSB0aGlzIEpEQkMgY29ubmVjdGlvbjo8L3A+DQo8dWw+JHtkZXBlbmRlcnMuaHRtbH08L3VsPg==\"/>\n                                    <L7p:VariableToSet stringValue=\"htmlContent\"/>\n                                    </L7p:SetVariable>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// ${dependers.list} has content\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:All>\n                                    <L7p:SetVariable>\n                                    <L7p:Base64Expression stringValue=\"JHtodG1sQ29udGVudH0NCjxwPk5vdGhpbmcgd2FzIGZvdW5kIHRoYXQgcmVmZXJlbmNlcyB0aGlzIEpEQkMgY29ubmVjdGlvbjwvcD4=\"/>\n                                    <L7p:VariableToSet stringValue=\"htmlContent\"/>\n                                    </L7p:SetVariable>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Append ${dependers.html} to ${htmlContent} if ${dependers.list} has any entries\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:OneOrMore>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// ${id} matches so retrieve dependers\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                </wsp:All>\n                                <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Do reverse dependency search if id matches\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:assertionComment>\n                            </wsp:OneOrMore>\n                            <L7p:assertionComment>\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Cycle through each object to add to display and check if search must be run\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:assertionComment>\n                        </L7p:ForEachLoop>\n                        <L7p:assertionComment>\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// ${objectType} == &quot;JDBC Connection&quot;\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:assertionComment>\n                    </wsp:All>\n                    <wsp:All wsp:Usage=\"Required\">\n                        <L7p:ComparisonAssertion>\n                            <L7p:CaseSensitive booleanValue=\"false\"/>\n                            <L7p:Expression1 stringValue=\"${objectType}\"/>\n                            <L7p:Expression2 stringValue=\"JMS Destination\"/>\n                            <L7p:Predicates predicates=\"included\">\n                                <L7p:item binary=\"included\">\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:RightValue stringValue=\"JMS Destination\"/>\n                                </L7p:item>\n                            </L7p:Predicates>\n                        </L7p:ComparisonAssertion>\n                        <L7p:AuditDetailAssertion>\n                            <L7p:AssertionComment assertionComment=\"included\">\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// FINE\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:AssertionComment>\n                            <L7p:Detail stringValue=\"======> Listing ${objectType} objects\"/>\n                            <L7p:Level stringValue=\"FINE\"/>\n                        </L7p:AuditDetailAssertion>\n                        <L7p:Encapsulated>\n                            <L7p:AssertionComment assertionComment=\"included\">\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Get list of objectTypes to display and search for references\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:AssertionComment>\n                            <L7p:EncapsulatedAssertionConfigGuid stringValue=\"53bc61d8-f0d0-4024-b09c-61fd5c9ef33e\"/>\n                            <L7p:EncapsulatedAssertionConfigName stringValue=\"Utility: List JMS Destinations\"/>\n                            <L7p:Parameters mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"cacheAge\"/>\n                                    <L7p:value stringValue=\"${cacheAge}\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"refresh\"/>\n                                    <L7p:value stringValue=\"${request.http.parameter.refresh}\"/>\n                                </L7p:entry>\n                            </L7p:Parameters>\n                        </L7p:Encapsulated>\n                        <L7p:ResponseXpathAssertion>\n                            <L7p:AssertionComment assertionComment=\"included\">\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Get list of ids\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:AssertionComment>\n                            <L7p:VariablePrefix stringValue=\"ids\"/>\n                            <L7p:XmlMsgSrc stringValue=\"jmsDestinations.sorted\"/>\n                            <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                <L7p:Expression stringValue=\"/JMSDestinations/JMSDestination/@id\"/>\n                                <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"s\"/>\n                                    <L7p:value stringValue=\"http://schemas.xmlsoap.org/soap/envelope/\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                    </L7p:entry>\n                                </L7p:Namespaces>\n                                <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                            </L7p:XpathExpression>\n                        </L7p:ResponseXpathAssertion>\n                        <L7p:ForEachLoop L7p:Usage=\"Required\"\n                            loopVariable=\"ids.results\" variablePrefix=\"id\">\n                            <L7p:ResponseXpathAssertion>\n                                <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Get name of the object for display\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:AssertionComment>\n                                <L7p:VariablePrefix stringValue=\"name\"/>\n                                <L7p:XmlMsgSrc stringValue=\"jmsDestinations.sorted\"/>\n                                <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                    <L7p:Expression stringValue=\"/JMSDestinations/JMSDestination[@id=$id.current]/Name\"/>\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"s\"/>\n                                    <L7p:value stringValue=\"http://schemas.xmlsoap.org/soap/envelope/\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                                </L7p:XpathExpression>\n                            </L7p:ResponseXpathAssertion>\n                            <L7p:ResponseXpathAssertion>\n                                <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Get direction of the object for display\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:AssertionComment>\n                                <L7p:VariablePrefix stringValue=\"direction\"/>\n                                <L7p:XmlMsgSrc stringValue=\"jmsDestinations.sorted\"/>\n                                <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                    <L7p:Expression stringValue=\"/JMSDestinations/JMSDestination[@id=$id.current]/Direction\"/>\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"s\"/>\n                                    <L7p:value stringValue=\"http://schemas.xmlsoap.org/soap/envelope/\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                                </L7p:XpathExpression>\n                            </L7p:ResponseXpathAssertion>\n                            <L7p:AuditDetailAssertion>\n                                <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// FINE\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:AssertionComment>\n                                <L7p:Detail stringValue=\"=====> Processing ${objectType}: ${name.result} (${id.current})\"/>\n                                <L7p:Level stringValue=\"FINE\"/>\n                            </L7p:AuditDetailAssertion>\n                            <L7p:Encapsulated>\n                                <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// name.result\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:AssertionComment>\n                                <L7p:EncapsulatedAssertionConfigGuid stringValue=\"f6b19229-a705-4c48-bc78-3975564a1a9a\"/>\n                                <L7p:EncapsulatedAssertionConfigName stringValue=\"Utility: Escape HTML String\"/>\n                                <L7p:Parameters mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"escapedString\"/>\n                                    <L7p:value stringValue=\"${name.result}\"/>\n                                    </L7p:entry>\n                                </L7p:Parameters>\n                            </L7p:Encapsulated>\n                            <L7p:SetVariable>\n                                <L7p:Base64Expression stringValue=\"JHtodG1sQ29udGVudH0NCjxhIGlkPSIke2lkLmN1cnJlbnR9Ii8+PGEgaHJlZj0iJHtyZXF1ZXN0LnVybC5wYXRofT9vYmplY3RUeXBlPSR7b2JqZWN0VHlwZX0maWQ9JHtpZC5jdXJyZW50fSMke2lkLmN1cnJlbnR9IiBvbkNsaWNrPSJzZXRSZWZyZXNoKHRoaXMpIj4ke2VzY2FwZWRTdHJpbmd9ICgke2RpcmVjdGlvbi5yZXN1bHR9KTwvYT48YnIvPg==\"/>\n                                <L7p:VariableToSet stringValue=\"htmlContent\"/>\n                            </L7p:SetVariable>\n                            <wsp:OneOrMore wsp:Usage=\"Required\">\n                                <L7p:ComparisonAssertion>\n                                    <L7p:Expression1 stringValue=\"${id}\"/>\n                                    <L7p:Expression2 stringValue=\"${id.current}\"/>\n                                    <L7p:Negate booleanValue=\"true\"/>\n                                    <L7p:Predicates predicates=\"included\">\n                                    <L7p:item binary=\"included\">\n                                    <L7p:Negated booleanValue=\"true\"/>\n                                    <L7p:RightValue stringValue=\"${id.current}\"/>\n                                    </L7p:item>\n                                    </L7p:Predicates>\n                                </L7p:ComparisonAssertion>\n                                <wsp:All wsp:Usage=\"Required\">\n                                    <L7p:AuditDetailAssertion>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// FINE\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:Detail stringValue=\"====> ID matched, processing for dependencies\"/>\n                                    <L7p:Level stringValue=\"FINE\"/>\n                                    </L7p:AuditDetailAssertion>\n                                    <L7p:SetVariable>\n                                    <L7p:Base64Expression stringValue=\"JHtpZC5jdXJyZW50fQ==\"/>\n                                    <L7p:VariableToSet stringValue=\"referenceString\"/>\n                                    </L7p:SetVariable>\n                                    <L7p:AuditDetailAssertion>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// FINE\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:Detail stringValue=\"===> Searching objects for references to ${referenceString}\"/>\n                                    <L7p:Level stringValue=\"FINE\"/>\n                                    </L7p:AuditDetailAssertion>\n                                    <wsp:OneOrMore wsp:Usage=\"Required\">\n                                    <wsp:All wsp:Usage=\"Required\">\n                                    <L7p:AuditDetailAssertion>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// FINE\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:Detail stringValue=\"==> Searching policy XML\"/>\n                                    <L7p:Level stringValue=\"FINE\"/>\n                                    </L7p:AuditDetailAssertion>\n                                    <L7p:ResponseXpathAssertion>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Extract all policy objects that contain the JmsRoutingAssertion element\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:VariablePrefix stringValue=\"policies\"/>\n                                    <L7p:XmlMsgSrc stringValue=\"allPolicyXML\"/>\n                                    <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                    <L7p:Expression stringValue=\"/AllPolicyXML/PolicyXML[contains(.,'&lt;L7p:JmsRoutingAssertion>')]\"/>\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                                    </L7p:XpathExpression>\n                                    </L7p:ResponseXpathAssertion>\n                                    <L7p:ForEachLoop\n                                    L7p:Usage=\"Required\"\n                                    loopVariable=\"policies.elements\" variablePrefix=\"policy\">\n                                    <L7p:SetVariable>\n\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"// Cast to message type for XPath\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n\n                                    <L7p:Base64Expression stringValue=\"JHtwb2xpY3kuY3VycmVudH0=\"/>\n                                    <L7p:ContentType stringValue=\"text/xml; charset=utf-8\"/>\n                                    <L7p:DataType variableDataType=\"message\"/>\n                                    <L7p:VariableToSet stringValue=\"policyObject.xml\"/>\n                                    </L7p:SetVariable>\n                                    <L7p:ResponseXpathAssertion>\n\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"// Extract the policy XML from the policy object\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:VariablePrefix stringValue=\"policy.xml\"/>\n                                    <L7p:XmlMsgSrc stringValue=\"policyObject.xml\"/>\n                                    <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                    <L7p:Expression stringValue=\"/PolicyXML/text()\"/>\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"s\"/>\n\n                                    <L7p:value stringValue=\"http://schemas.xmlsoap.org/soap/envelope/\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                                    </L7p:XpathExpression>\n                                    </L7p:ResponseXpathAssertion>\n                                    <L7p:SetVariable>\n\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"// Cast to message type for XPath\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n\n                                    <L7p:Base64Expression stringValue=\"JHtwb2xpY3kueG1sLnJlc3VsdH0=\"/>\n                                    <L7p:ContentType stringValue=\"text/xml; charset=utf-8\"/>\n                                    <L7p:DataType variableDataType=\"message\"/>\n                                    <L7p:VariableToSet stringValue=\"policy.xml\"/>\n                                    </L7p:SetVariable>\n                                    <wsp:OneOrMore wsp:Usage=\"Required\">\n                                    <wsp:All wsp:Usage=\"Required\">\n                                    <L7p:ResponseXpathAssertion>\n\n                                    <L7p:AssertionComment assertionComment=\"included\">\n\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"// Check if the policy XML has a reference to this JMS destination\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n\n                                    <L7p:VariablePrefix stringValue=\"\"/>\n\n                                    <L7p:XmlMsgSrc stringValue=\"policy.xml\"/>\n\n                                    <L7p:XpathExpression xpathExpressionValue=\"included\">\n\n                                    <L7p:Expression stringValue=\"//L7p:JmsRoutingAssertion/L7p:EndpointOid[@goidValue=$referenceString]\"/>\n\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"L7p\"/>\n\n                                    <L7p:value stringValue=\"http://www.layer7tech.com/ws/policy\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"wsp\"/>\n\n                                    <L7p:value stringValue=\"http://schemas.xmlsoap.org/ws/2002/12/policy\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                                    </L7p:XpathExpression>\n                                    </L7p:ResponseXpathAssertion>\n                                    <L7p:Include>\n\n                                    <L7p:PolicyGuid stringValue=\"8f33b165-bc16-4959-a524-aba67aff3cdf\"/>\n                                    </L7p:Include>\n                                    <L7p:SetVariable>\n\n                                    <L7p:Base64Expression stringValue=\"JHtzb3VyY2VUeXBlLnJlc3VsdH06ICR7Zm9sZGVyUGF0aC5yZXN1bHR9JHtuYW1lLnJlc3VsdH0=\"/>\n\n                                    <L7p:VariableToSet stringValue=\"depender\"/>\n                                    </L7p:SetVariable>\n                                    <L7p:ManipulateMultiValuedVariable>\n\n                                    <L7p:SourceVariableName stringValue=\"depender\"/>\n\n                                    <L7p:TargetVariableName stringValue=\"dependers.list\"/>\n                                    </L7p:ManipulateMultiValuedVariable>\n                                    <L7p:assertionComment>\n\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"// Search policy XML for JmsRoutingAssertion element matching our reference\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:All>\n                                    <L7p:TrueAssertion/>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"// Search policy XML for JmsRoutingAssertion element matching our reference, never fail\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:OneOrMore>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Cycle through each policy to see if the JMS assertion is the one we want and append to ${dependers.list}\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </L7p:ForEachLoop>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Search for references in policy XML\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:All>\n                                    <L7p:TrueAssertion/>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Search for references in policy XML, never fail\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:OneOrMore>\n                                    <wsp:OneOrMore wsp:Usage=\"Required\">\n                                    <wsp:All wsp:Usage=\"Required\">\n                                    <L7p:ComparisonAssertion>\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:Expression1 stringValue=\"${dependers.list.length}\"/>\n                                    <L7p:Expression2 stringValue=\"1\"/>\n                                    <L7p:Operator operator=\"GE\"/>\n                                    <L7p:Predicates predicates=\"included\">\n                                    <L7p:item binary=\"included\">\n\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:Operator operator=\"GE\"/>\n                                    <L7p:RightValue stringValue=\"1\"/>\n                                    </L7p:item>\n                                    </L7p:Predicates>\n                                    </L7p:ComparisonAssertion>\n                                    <L7p:ForEachLoop\n                                    L7p:Usage=\"Required\"\n                                    loopVariable=\"dependers.list\" variablePrefix=\"depender\">\n                                    <L7p:SetVariable>\n\n                                    <L7p:Base64Expression stringValue=\"JHtkZXBlbmRlcnMuaHRtbH0NCiAgPGxpPiR7ZGVwZW5kZXIuY3VycmVudH08L2xpPg==\"/>\n                                    <L7p:VariableToSet stringValue=\"dependers.html\"/>\n                                    </L7p:SetVariable>\n                                    </L7p:ForEachLoop>\n                                    <L7p:SetVariable>\n                                    <L7p:Base64Expression stringValue=\"JHtodG1sQ29udGVudH0NCg0KPHA+VGhlIGZvbGxvd2luZyBvYmplY3RzIHJlZmVyZW5jZSB0aGlzIEpNUyBkZXN0aW5hdGlvbjo8L3A+DQo8dWw+JHtkZXBlbmRlcnMuaHRtbH08L3VsPg==\"/>\n                                    <L7p:VariableToSet stringValue=\"htmlContent\"/>\n                                    </L7p:SetVariable>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// ${dependers.list} has content\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:All>\n                                    <L7p:SetVariable>\n                                    <L7p:Base64Expression stringValue=\"JHtodG1sQ29udGVudH0NCjxwPk5vdGhpbmcgd2FzIGZvdW5kIHRoYXQgcmVmZXJlbmNlcyB0aGlzIEpNUyBkZXN0aW5hdGlvbjwvcD4=\"/>\n                                    <L7p:VariableToSet stringValue=\"htmlContent\"/>\n                                    </L7p:SetVariable>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Append ${dependers.html} to ${htmlContent} if ${dependers.list} has any entries\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:OneOrMore>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// ${id} matches so retrieve dependers\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                </wsp:All>\n                                <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Do reverse dependency search if id matches\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:assertionComment>\n                            </wsp:OneOrMore>\n                            <L7p:assertionComment>\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Cycle through each object to add to display and check if search must be run\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:assertionComment>\n                        </L7p:ForEachLoop>\n                        <L7p:assertionComment>\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// ${objectType} == &quot;JMS Destination&quot;\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:assertionComment>\n                    </wsp:All>\n                    <wsp:All wsp:Usage=\"Required\">\n                        <L7p:ComparisonAssertion>\n                            <L7p:CaseSensitive booleanValue=\"false\"/>\n                            <L7p:Expression1 stringValue=\"${objectType}\"/>\n                            <L7p:Expression2 stringValue=\"Policy\"/>\n                            <L7p:Predicates predicates=\"included\">\n                                <L7p:item binary=\"included\">\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:RightValue stringValue=\"Policy\"/>\n                                </L7p:item>\n                            </L7p:Predicates>\n                        </L7p:ComparisonAssertion>\n                        <L7p:AuditDetailAssertion>\n                            <L7p:AssertionComment assertionComment=\"included\">\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// FINE\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:AssertionComment>\n                            <L7p:Detail stringValue=\"======> Listing ${objectType} objects\"/>\n                            <L7p:Level stringValue=\"FINE\"/>\n                        </L7p:AuditDetailAssertion>\n                        <L7p:CommentAssertion>\n                            <L7p:Comment stringValue=\"* Note: ${policies.sorted} was set earlier, so don't call Utility: List Policies it here\"/>\n                        </L7p:CommentAssertion>\n                        <L7p:ResponseXpathAssertion>\n                            <L7p:AssertionComment assertionComment=\"included\">\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Get list of ids\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:AssertionComment>\n                            <L7p:VariablePrefix stringValue=\"ids\"/>\n                            <L7p:XmlMsgSrc stringValue=\"policies.sorted\"/>\n                            <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                <L7p:Expression stringValue=\"/Policies/Policy/@id\"/>\n                                <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"s\"/>\n                                    <L7p:value stringValue=\"http://schemas.xmlsoap.org/soap/envelope/\"/>\n                                    </L7p:entry>\n                                </L7p:Namespaces>\n                                <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                            </L7p:XpathExpression>\n                        </L7p:ResponseXpathAssertion>\n                        <L7p:ForEachLoop L7p:Usage=\"Required\"\n                            loopVariable=\"ids.results\" variablePrefix=\"id\">\n                            <L7p:ResponseXpathAssertion>\n                                <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Get name of the object for display\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:AssertionComment>\n                                <L7p:VariablePrefix stringValue=\"name\"/>\n                                <L7p:XmlMsgSrc stringValue=\"policies.sorted\"/>\n                                <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                    <L7p:Expression stringValue=\"/Policies/Policy[@id=$id.current]/Name\"/>\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"s\"/>\n                                    <L7p:value stringValue=\"http://schemas.xmlsoap.org/soap/envelope/\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                                </L7p:XpathExpression>\n                            </L7p:ResponseXpathAssertion>\n                            <L7p:ResponseXpathAssertion>\n                                <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Get folderPath of the object to display\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:AssertionComment>\n                                <L7p:VariablePrefix stringValue=\"folderPath\"/>\n                                <L7p:XmlMsgSrc stringValue=\"policies.sorted\"/>\n                                <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                    <L7p:Expression stringValue=\"/Policies/Policy[@id=$id.current]/FolderPath\"/>\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"s\"/>\n                                    <L7p:value stringValue=\"http://schemas.xmlsoap.org/soap/envelope/\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                                </L7p:XpathExpression>\n                            </L7p:ResponseXpathAssertion>\n                            <L7p:AuditDetailAssertion>\n                                <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// FINE\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:AssertionComment>\n                                <L7p:Detail stringValue=\"=====> Processing ${objectType}: ${name.result} (${id.current})\"/>\n                                <L7p:Level stringValue=\"FINE\"/>\n                            </L7p:AuditDetailAssertion>\n                            <L7p:Encapsulated>\n                                <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// name.result\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:AssertionComment>\n                                <L7p:EncapsulatedAssertionConfigGuid stringValue=\"f6b19229-a705-4c48-bc78-3975564a1a9a\"/>\n                                <L7p:EncapsulatedAssertionConfigName stringValue=\"Utility: Escape HTML String\"/>\n                                <L7p:Parameters mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"escapedString\"/>\n                                    <L7p:value stringValue=\"${name.result}\"/>\n                                    </L7p:entry>\n                                </L7p:Parameters>\n                            </L7p:Encapsulated>\n                            <L7p:SetVariable>\n                                <L7p:Base64Expression stringValue=\"JHtlc2NhcGVkU3RyaW5nfQ==\"/>\n                                <L7p:VariableToSet stringValue=\"name\"/>\n                            </L7p:SetVariable>\n                            <L7p:Encapsulated>\n                                <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// folderPath.result\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:AssertionComment>\n                                <L7p:EncapsulatedAssertionConfigGuid stringValue=\"f6b19229-a705-4c48-bc78-3975564a1a9a\"/>\n                                <L7p:EncapsulatedAssertionConfigName stringValue=\"Utility: Escape HTML String\"/>\n                                <L7p:Parameters mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"escapedString\"/>\n                                    <L7p:value stringValue=\"${folderPath.result}\"/>\n                                    </L7p:entry>\n                                </L7p:Parameters>\n                            </L7p:Encapsulated>\n                            <L7p:SetVariable>\n                                <L7p:Base64Expression stringValue=\"JHtodG1sQ29udGVudH0NCjxhIGlkPSIke2lkLmN1cnJlbnR9Ii8+PGEgaHJlZj0iJHtyZXF1ZXN0LnVybC5wYXRofT9vYmplY3RUeXBlPSR7b2JqZWN0VHlwZX0maWQ9JHtpZC5jdXJyZW50fSMke2lkLmN1cnJlbnR9IiBvbkNsaWNrPSJzZXRSZWZyZXNoKHRoaXMpIj4ke2VzY2FwZWRTdHJpbmd9JHtuYW1lfTwvYT48YnIvPg==\"/>\n                                <L7p:VariableToSet stringValue=\"htmlContent\"/>\n                            </L7p:SetVariable>\n                            <wsp:OneOrMore wsp:Usage=\"Required\">\n                                <L7p:ComparisonAssertion>\n                                    <L7p:Expression1 stringValue=\"${id}\"/>\n                                    <L7p:Expression2 stringValue=\"${id.current}\"/>\n                                    <L7p:Negate booleanValue=\"true\"/>\n                                    <L7p:Predicates predicates=\"included\">\n                                    <L7p:item binary=\"included\">\n                                    <L7p:Negated booleanValue=\"true\"/>\n                                    <L7p:RightValue stringValue=\"${id.current}\"/>\n                                    </L7p:item>\n                                    </L7p:Predicates>\n                                </L7p:ComparisonAssertion>\n                                <wsp:All wsp:Usage=\"Required\">\n                                    <L7p:AuditDetailAssertion>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// FINE\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:Detail stringValue=\"====> ID matched, processing for dependencies\"/>\n                                    <L7p:Level stringValue=\"FINE\"/>\n                                    </L7p:AuditDetailAssertion>\n                                    <L7p:ResponseXpathAssertion>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Get the GUID for this policy\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:VariablePrefix stringValue=\"guid\"/>\n                                    <L7p:XmlMsgSrc stringValue=\"policies.sorted\"/>\n                                    <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                    <L7p:Expression stringValue=\"/Policies/Policy[@id=$id]/GUID\"/>\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                                    </L7p:XpathExpression>\n                                    </L7p:ResponseXpathAssertion>\n                                    <L7p:SetVariable>\n                                    <L7p:Base64Expression stringValue=\"UG9saWN5R3VpZCBzdHJpbmdWYWx1ZT0iJHtndWlkLnJlc3VsdH0i\"/>\n                                    <L7p:VariableToSet stringValue=\"referenceString\"/>\n                                    </L7p:SetVariable>\n                                    <L7p:AuditDetailAssertion>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// FINE\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:Detail stringValue=\"===> Searching objects for references to ${referenceString}\"/>\n                                    <L7p:Level stringValue=\"FINE\"/>\n                                    </L7p:AuditDetailAssertion>\n                                    <wsp:OneOrMore wsp:Usage=\"Required\">\n                                    <wsp:All wsp:Usage=\"Required\">\n                                    <L7p:AuditDetailAssertion>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// FINE\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:Detail stringValue=\"==> Searching policy XML\"/>\n                                    <L7p:Level stringValue=\"FINE\"/>\n                                    </L7p:AuditDetailAssertion>\n                                    <L7p:ResponseXpathAssertion>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Find policies that include this fragment\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:VariablePrefix stringValue=\"policies\"/>\n                                    <L7p:XmlMsgSrc stringValue=\"allPolicyXML\"/>\n                                    <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                    <L7p:Expression stringValue=\"//AllPolicyXML/PolicyXML[contains(.,$referenceString)]\"/>\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                                    </L7p:XpathExpression>\n                                    </L7p:ResponseXpathAssertion>\n                                    <L7p:ForEachLoop\n                                    L7p:Usage=\"Required\"\n                                    loopVariable=\"policies.elements\" variablePrefix=\"policy\">\n                                    <L7p:SetVariable>\n\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"// Cast to message type for XPath\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n\n                                    <L7p:Base64Expression stringValue=\"JHtwb2xpY3kuY3VycmVudH0=\"/>\n                                    <L7p:ContentType stringValue=\"text/xml; charset=utf-8\"/>\n                                    <L7p:DataType variableDataType=\"message\"/>\n                                    <L7p:VariableToSet stringValue=\"policyObject.xml\"/>\n                                    </L7p:SetVariable>\n                                    <L7p:Include>\n                                    <L7p:PolicyGuid stringValue=\"8f33b165-bc16-4959-a524-aba67aff3cdf\"/>\n                                    </L7p:Include>\n                                    <L7p:SetVariable>\n\n                                    <L7p:Base64Expression stringValue=\"JHtzb3VyY2VUeXBlLnJlc3VsdH06ICR7Zm9sZGVyUGF0aC5yZXN1bHR9JHtuYW1lLnJlc3VsdH0=\"/>\n                                    <L7p:VariableToSet stringValue=\"depender\"/>\n                                    </L7p:SetVariable>\n                                    <L7p:ManipulateMultiValuedVariable>\n\n                                    <L7p:SourceVariableName stringValue=\"depender\"/>\n\n                                    <L7p:TargetVariableName stringValue=\"dependers.list\"/>\n                                    </L7p:ManipulateMultiValuedVariable>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Add each one to ${dependers.list}\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </L7p:ForEachLoop>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Search for references in policy XML\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:All>\n                                    <L7p:TrueAssertion/>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Search for references in policy XML, never fail\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:OneOrMore>\n                                    <wsp:OneOrMore wsp:Usage=\"Required\">\n                                    <wsp:All wsp:Usage=\"Required\">\n                                    <L7p:AuditDetailAssertion>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// FINE\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:Detail stringValue=\"==> Searching encapsulated assertion definitions\"/>\n                                    <L7p:Level stringValue=\"FINE\"/>\n                                    </L7p:AuditDetailAssertion>\n                                    <L7p:Encapsulated>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// GET encapsulatedAssertions\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n\n                                    <L7p:EncapsulatedAssertionConfigGuid stringValue=\"c8a5a0d5-1ae2-4144-b538-5c311efc1560\"/>\n\n                                    <L7p:EncapsulatedAssertionConfigName stringValue=\"Utility: Call Restman\"/>\n                                    <L7p:Parameters mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"element\"/>\n                                    <L7p:value stringValue=\"\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"message\"/>\n                                    <L7p:value stringValue=\"\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"method\"/>\n                                    <L7p:value stringValue=\"GET\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"resource\"/>\n                                    <L7p:value stringValue=\"encapsulatedAssertions\"/>\n                                    </L7p:entry>\n                                    </L7p:Parameters>\n                                    </L7p:Encapsulated>\n                                    <L7p:ResponseXpathAssertion>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Get list of Encapsulate Assertions that link to this policy (max 1)\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:VariablePrefix stringValue=\"dependers\"/>\n                                    <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                    <L7p:Expression stringValue=\"/l7:List/l7:Item/l7:Resource/l7:EncapsulatedAssertion/l7:PolicyReference[@id=$id.current]/../l7:Name\"/>\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                                    </L7p:XpathExpression>\n                                    </L7p:ResponseXpathAssertion>\n                                    <L7p:ForEachLoop\n                                    L7p:Usage=\"Required\"\n                                    loopVariable=\"dependers.results\" variablePrefix=\"depender\">\n                                    <L7p:SetVariable>\n\n                                    <L7p:Base64Expression stringValue=\"RU5DQVBTVUxBVEVEIEFTU0VSVElPTjogJHtkZXBlbmRlci5jdXJyZW50fQ==\"/>\n                                    <L7p:VariableToSet stringValue=\"depender\"/>\n                                    </L7p:SetVariable>\n                                    <L7p:ManipulateMultiValuedVariable>\n\n                                    <L7p:SourceVariableName stringValue=\"depender\"/>\n\n                                    <L7p:TargetVariableName stringValue=\"dependers.list\"/>\n                                    </L7p:ManipulateMultiValuedVariable>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Add each one to ${dependers.list}\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </L7p:ForEachLoop>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Search for references in encpasulated assertion definitions\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:All>\n                                    <L7p:TrueAssertion/>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Search for references in encpasulated assertion definitions, never fail\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:OneOrMore>\n                                    <wsp:OneOrMore wsp:Usage=\"Required\">\n                                    <wsp:All wsp:Usage=\"Required\">\n                                    <L7p:AuditDetailAssertion>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// FINE\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:Detail stringValue=\"==> Searching identity provider definitions\"/>\n                                    <L7p:Level stringValue=\"FINE\"/>\n                                    </L7p:AuditDetailAssertion>\n                                    <L7p:Encapsulated>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// GET identityProviders\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n\n                                    <L7p:EncapsulatedAssertionConfigGuid stringValue=\"c8a5a0d5-1ae2-4144-b538-5c311efc1560\"/>\n\n                                    <L7p:EncapsulatedAssertionConfigName stringValue=\"Utility: Call Restman\"/>\n                                    <L7p:Parameters mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"element\"/>\n                                    <L7p:value stringValue=\"\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"message\"/>\n                                    <L7p:value stringValue=\"\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"method\"/>\n                                    <L7p:value stringValue=\"GET\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"resource\"/>\n                                    <L7p:value stringValue=\"identityProviders\"/>\n                                    </L7p:entry>\n                                    </L7p:Parameters>\n                                    </L7p:Encapsulated>\n                                    <L7p:ResponseXpathAssertion>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Get list of policy backed identity providers that link to this policy\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:VariablePrefix stringValue=\"dependers\"/>\n                                    <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                    <L7p:Expression stringValue=\"/l7:List/l7:Item/l7:Resource/l7:IdentityProvider/l7:Extension/l7:PolicyBackedIdentityProviderDetail[l7:AuthenticationPolicyId=$id.current]/../../@id\"/>\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                                    </L7p:XpathExpression>\n                                    </L7p:ResponseXpathAssertion>\n                                    <L7p:Encapsulated>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Get a sorted list of identity providers\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n\n                                    <L7p:EncapsulatedAssertionConfigGuid stringValue=\"1ab6158d-33ce-4fa6-a7d8-2b8dc8e31faf\"/>\n\n                                    <L7p:EncapsulatedAssertionConfigName stringValue=\"Utility: List Identity Providers\"/>\n                                    <L7p:Parameters mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"cacheAge\"/>\n                                    <L7p:value stringValue=\"${cacheAge}\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"refresh\"/>\n                                    <L7p:value stringValue=\"${request.http.parameter.refresh}\"/>\n                                    </L7p:entry>\n                                    </L7p:Parameters>\n                                    </L7p:Encapsulated>\n                                    <L7p:ForEachLoop\n                                    L7p:Usage=\"Required\"\n                                    loopVariable=\"dependers.results\" variablePrefix=\"depender\">\n                                    <L7p:ResponseXpathAssertion>\n\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"// Get name of the identity provider that references this policy\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:VariablePrefix stringValue=\"name\"/>\n                                    <L7p:XmlMsgSrc stringValue=\"identityProviders.sorted\"/>\n                                    <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                    <L7p:Expression stringValue=\"/IdentityProviders/IdentityProvider[@id=$depender.current]/Name\"/>\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                                    </L7p:XpathExpression>\n                                    </L7p:ResponseXpathAssertion>\n                                    <L7p:ResponseXpathAssertion>\n\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"// Get type of the identity provider that references this policy\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:VariablePrefix stringValue=\"type\"/>\n                                    <L7p:XmlMsgSrc stringValue=\"identityProviders.sorted\"/>\n                                    <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                    <L7p:Expression stringValue=\"/IdentityProviders/IdentityProvider[@id=$depender.current]/Type\"/>\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                                    </L7p:XpathExpression>\n                                    </L7p:ResponseXpathAssertion>\n                                    <L7p:SetVariable>\n\n                                    <L7p:Base64Expression stringValue=\"SURFTlRJVFkgUFJPVklERVI6ICR7bmFtZS5yZXN1bHR9ICgke3R5cGUucmVzdWx0fSk=\"/>\n                                    <L7p:VariableToSet stringValue=\"depender\"/>\n                                    </L7p:SetVariable>\n                                    <L7p:ManipulateMultiValuedVariable>\n\n                                    <L7p:SourceVariableName stringValue=\"depender\"/>\n\n                                    <L7p:TargetVariableName stringValue=\"dependers.list\"/>\n                                    </L7p:ManipulateMultiValuedVariable>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Add each one to ${dependers.list}\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </L7p:ForEachLoop>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Search for references in identity provider definitions\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:All>\n                                    <L7p:TrueAssertion/>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Search for references in identity provider definitions, never fail\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:OneOrMore>\n                                    <wsp:OneOrMore wsp:Usage=\"Required\">\n                                    <wsp:All wsp:Usage=\"Required\">\n                                    <L7p:AuditDetailAssertion>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// FINE\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:Detail stringValue=\"==> Searching policy backed service definitions\"/>\n                                    <L7p:Level stringValue=\"FINE\"/>\n                                    </L7p:AuditDetailAssertion>\n                                    <L7p:Encapsulated>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Get a sorted list of policy backed services\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n\n                                    <L7p:EncapsulatedAssertionConfigGuid stringValue=\"461cb9aa-0d25-4bf0-85d2-7e2d8d895e47\"/>\n\n                                    <L7p:EncapsulatedAssertionConfigName stringValue=\"Utility: List Policy Backed Services\"/>\n                                    <L7p:Parameters mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"cacheAge\"/>\n                                    <L7p:value stringValue=\"${cacheAge}\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"refresh\"/>\n                                    <L7p:value stringValue=\"${request.http.parameter.refresh}\"/>\n                                    </L7p:entry>\n                                    </L7p:Parameters>\n                                    </L7p:Encapsulated>\n                                    <L7p:ResponseXpathAssertion>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Get list of policy backed services that link to this policy\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:VariablePrefix stringValue=\"dependers\"/>\n                                    <L7p:XmlMsgSrc stringValue=\"policyBackedServices.sorted\"/>\n                                    <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                    <L7p:Expression stringValue=\"/PolicyBackedServices/PolicyBackedService[PolicyId=$id.current]/Name\"/>\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                                    </L7p:XpathExpression>\n                                    </L7p:ResponseXpathAssertion>\n                                    <L7p:ForEachLoop\n                                    L7p:Usage=\"Required\"\n                                    loopVariable=\"dependers.results\" variablePrefix=\"depender\">\n                                    <L7p:SetVariable>\n\n                                    <L7p:Base64Expression stringValue=\"UE9MSUNZIEJBQ0tFRCBTRVJWSUNFOiAke25hbWUucmVzdWx0fQ==\"/>\n                                    <L7p:VariableToSet stringValue=\"depender\"/>\n                                    </L7p:SetVariable>\n                                    <L7p:ManipulateMultiValuedVariable>\n\n                                    <L7p:SourceVariableName stringValue=\"depender\"/>\n\n                                    <L7p:TargetVariableName stringValue=\"dependers.list\"/>\n                                    </L7p:ManipulateMultiValuedVariable>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Add each one to ${dependers.list}\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </L7p:ForEachLoop>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Search for references in policy backed service definitions\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:All>\n                                    <L7p:TrueAssertion/>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Search for references in policy backed service definitions, never fail\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:OneOrMore>\n                                    <wsp:OneOrMore wsp:Usage=\"Required\">\n                                    <wsp:All wsp:Usage=\"Required\">\n                                    <L7p:AuditDetailAssertion>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// FINE\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:Detail stringValue=\"==> Searching scheduled task definitions\"/>\n                                    <L7p:Level stringValue=\"FINE\"/>\n                                    </L7p:AuditDetailAssertion>\n                                    <L7p:Encapsulated>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Get a sorted list of scheduled tasks\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n\n                                    <L7p:EncapsulatedAssertionConfigGuid stringValue=\"100c1321-8d9f-45b9-80bd-ca1198081e5b\"/>\n\n                                    <L7p:EncapsulatedAssertionConfigName stringValue=\"Utility: List Scheduled Tasks\"/>\n                                    <L7p:Parameters mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"cacheAge\"/>\n                                    <L7p:value stringValue=\"${cacheAge}\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"refresh\"/>\n                                    <L7p:value stringValue=\"${request.http.parameter.refresh}\"/>\n                                    </L7p:entry>\n                                    </L7p:Parameters>\n                                    </L7p:Encapsulated>\n                                    <L7p:ResponseXpathAssertion>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Get list of schedule tasks that link to this policy\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:VariablePrefix stringValue=\"dependers\"/>\n                                    <L7p:XmlMsgSrc stringValue=\"scheduledTasks.sorted\"/>\n                                    <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                    <L7p:Expression stringValue=\"/ScheduledTasks/ScheduledTask[PolicyId=$id.current]/Name\"/>\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                                    </L7p:XpathExpression>\n                                    </L7p:ResponseXpathAssertion>\n                                    <L7p:ForEachLoop\n                                    L7p:Usage=\"Required\"\n                                    loopVariable=\"dependers.results\" variablePrefix=\"depender\">\n                                    <L7p:SetVariable>\n\n                                    <L7p:Base64Expression stringValue=\"U0NIRURVTEVEIFRBU0s6ICR7bmFtZS5yZXN1bHR9\"/>\n                                    <L7p:VariableToSet stringValue=\"depender\"/>\n                                    </L7p:SetVariable>\n                                    <L7p:ManipulateMultiValuedVariable>\n\n                                    <L7p:SourceVariableName stringValue=\"depender\"/>\n\n                                    <L7p:TargetVariableName stringValue=\"dependers.list\"/>\n                                    </L7p:ManipulateMultiValuedVariable>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Add each one to ${dependers.list}\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </L7p:ForEachLoop>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Search for references in scheduled task definitions\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:All>\n                                    <L7p:TrueAssertion/>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Search for references in scheduled task definitions, never fail\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:OneOrMore>\n                                    <wsp:OneOrMore wsp:Usage=\"Required\">\n                                    <wsp:All wsp:Usage=\"Required\">\n                                    <L7p:ComparisonAssertion>\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:Expression1 stringValue=\"${dependers.list.length}\"/>\n                                    <L7p:Expression2 stringValue=\"1\"/>\n                                    <L7p:Operator operator=\"GE\"/>\n                                    <L7p:Predicates predicates=\"included\">\n                                    <L7p:item binary=\"included\">\n\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:Operator operator=\"GE\"/>\n                                    <L7p:RightValue stringValue=\"1\"/>\n                                    </L7p:item>\n                                    </L7p:Predicates>\n                                    </L7p:ComparisonAssertion>\n                                    <L7p:ForEachLoop\n                                    L7p:Usage=\"Required\"\n                                    loopVariable=\"dependers.list\" variablePrefix=\"depender\">\n                                    <L7p:SetVariable>\n\n                                    <L7p:Base64Expression stringValue=\"JHtkZXBlbmRlcnMuaHRtbH0NCiAgPGxpPiR7ZGVwZW5kZXIuY3VycmVudH08L2xpPg==\"/>\n                                    <L7p:VariableToSet stringValue=\"dependers.html\"/>\n                                    </L7p:SetVariable>\n                                    </L7p:ForEachLoop>\n                                    <L7p:SetVariable>\n                                    <L7p:Base64Expression stringValue=\"JHtodG1sQ29udGVudH0NCg0KPHA+VGhlIGZvbGxvd2luZyBvYmplY3RzIGRlcGVuZCBvbiB0aGlzIHBvbGljeTo8L3A+DQo8dWw+JHtkZXBlbmRlcnMuaHRtbH08L3VsPg==\"/>\n                                    <L7p:VariableToSet stringValue=\"htmlContent\"/>\n                                    </L7p:SetVariable>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// ${dependers.list} has content\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:All>\n                                    <L7p:SetVariable>\n                                    <L7p:Base64Expression stringValue=\"JHtodG1sQ29udGVudH0NCjxwPk5vdGhpbmcgd2FzIGZvdW5kIHRoYXQgZGVwZW5kcyBvbiB0aGlzIHBvbGljeTwvcD4=\"/>\n                                    <L7p:VariableToSet stringValue=\"htmlContent\"/>\n                                    </L7p:SetVariable>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Append ${dependers.html} to ${htmlContent} if ${dependers.list} has any entries\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:OneOrMore>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// ${id} matches so retrieve dependers\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                </wsp:All>\n                                <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Do reverse dependency search if id matches\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:assertionComment>\n                            </wsp:OneOrMore>\n                            <L7p:assertionComment>\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Cycle through each object to add to display and check if search must be run\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:assertionComment>\n                        </L7p:ForEachLoop>\n                        <L7p:assertionComment>\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// ${objectType} == &quot;Policy&quot;\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:assertionComment>\n                    </wsp:All>\n                    <wsp:All wsp:Usage=\"Required\">\n                        <L7p:ComparisonAssertion>\n                            <L7p:CaseSensitive booleanValue=\"false\"/>\n                            <L7p:Expression1 stringValue=\"${objectType}\"/>\n                            <L7p:Expression2 stringValue=\"Private Key\"/>\n                            <L7p:Predicates predicates=\"included\">\n                                <L7p:item binary=\"included\">\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:RightValue stringValue=\"Private Key\"/>\n                                </L7p:item>\n                            </L7p:Predicates>\n                        </L7p:ComparisonAssertion>\n                        <L7p:AuditDetailAssertion>\n                            <L7p:AssertionComment assertionComment=\"included\">\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// FINE\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:AssertionComment>\n                            <L7p:Detail stringValue=\"======> Listing ${objectType} objects\"/>\n                            <L7p:Level stringValue=\"FINE\"/>\n                        </L7p:AuditDetailAssertion>\n                        <L7p:Encapsulated>\n                            <L7p:AssertionComment assertionComment=\"included\">\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Get list of objectTypes to display and search for references\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:AssertionComment>\n                            <L7p:EncapsulatedAssertionConfigGuid stringValue=\"fbdcb4ad-bf2d-44f7-8aef-c8e1553c13ba\"/>\n                            <L7p:EncapsulatedAssertionConfigName stringValue=\"Utility: List Private Keys\"/>\n                            <L7p:Parameters mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"cacheAge\"/>\n                                    <L7p:value stringValue=\"${cacheAge}\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"refresh\"/>\n                                    <L7p:value stringValue=\"${request.http.parameter.refresh}\"/>\n                                </L7p:entry>\n                            </L7p:Parameters>\n                        </L7p:Encapsulated>\n                        <L7p:ResponseXpathAssertion>\n                            <L7p:AssertionComment assertionComment=\"included\">\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Get list of ids\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:AssertionComment>\n                            <L7p:VariablePrefix stringValue=\"ids\"/>\n                            <L7p:XmlMsgSrc stringValue=\"privateKeys.sorted\"/>\n                            <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                <L7p:Expression stringValue=\"/PrivateKeys/PrivateKey/@id\"/>\n                                <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"s\"/>\n                                    <L7p:value stringValue=\"http://schemas.xmlsoap.org/soap/envelope/\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                    </L7p:entry>\n                                </L7p:Namespaces>\n                                <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                            </L7p:XpathExpression>\n                        </L7p:ResponseXpathAssertion>\n                        <L7p:ForEachLoop L7p:Usage=\"Required\"\n                            loopVariable=\"ids.results\" variablePrefix=\"id\">\n                            <L7p:ResponseXpathAssertion>\n                                <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Get alias of the object for display\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:AssertionComment>\n                                <L7p:VariablePrefix stringValue=\"alias\"/>\n                                <L7p:XmlMsgSrc stringValue=\"privateKeys.sorted\"/>\n                                <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                    <L7p:Expression stringValue=\"/PrivateKeys/PrivateKey[@id=$id.current]/Alias\"/>\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"s\"/>\n                                    <L7p:value stringValue=\"http://schemas.xmlsoap.org/soap/envelope/\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                                </L7p:XpathExpression>\n                            </L7p:ResponseXpathAssertion>\n                            <L7p:AuditDetailAssertion>\n                                <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// FINE\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:AssertionComment>\n                                <L7p:Detail stringValue=\"=====> Processing ${objectType}: ${alias.result} (${id.current})\"/>\n                                <L7p:Level stringValue=\"FINE\"/>\n                            </L7p:AuditDetailAssertion>\n                            <L7p:Encapsulated>\n                                <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// alias.result\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:AssertionComment>\n                                <L7p:EncapsulatedAssertionConfigGuid stringValue=\"f6b19229-a705-4c48-bc78-3975564a1a9a\"/>\n                                <L7p:EncapsulatedAssertionConfigName stringValue=\"Utility: Escape HTML String\"/>\n                                <L7p:Parameters mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"escapedString\"/>\n                                    <L7p:value stringValue=\"${alias.result}\"/>\n                                    </L7p:entry>\n                                </L7p:Parameters>\n                            </L7p:Encapsulated>\n                            <L7p:SetVariable>\n                                <L7p:Base64Expression stringValue=\"JHtodG1sQ29udGVudH0NCjxhIGlkPSIke2lkLmN1cnJlbnR9Ii8+PGEgaHJlZj0iJHtyZXF1ZXN0LnVybC5wYXRofT9vYmplY3RUeXBlPSR7b2JqZWN0VHlwZX0maWQ9JHtpZC5jdXJyZW50fSMke2lkLmN1cnJlbnR9IiBvbkNsaWNrPSJzZXRSZWZyZXNoKHRoaXMpIj4ke2VzY2FwZWRTdHJpbmd9PC9hPjxici8+\"/>\n                                <L7p:VariableToSet stringValue=\"htmlContent\"/>\n                            </L7p:SetVariable>\n                            <wsp:OneOrMore wsp:Usage=\"Required\">\n                                <L7p:ComparisonAssertion>\n                                    <L7p:Expression1 stringValue=\"${id}\"/>\n                                    <L7p:Expression2 stringValue=\"${id.current}\"/>\n                                    <L7p:Negate booleanValue=\"true\"/>\n                                    <L7p:Predicates predicates=\"included\">\n                                    <L7p:item binary=\"included\">\n                                    <L7p:Negated booleanValue=\"true\"/>\n                                    <L7p:RightValue stringValue=\"${id.current}\"/>\n                                    </L7p:item>\n                                    </L7p:Predicates>\n                                </L7p:ComparisonAssertion>\n                                <wsp:All wsp:Usage=\"Required\">\n                                    <L7p:AuditDetailAssertion>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// FINE\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:Detail stringValue=\"====> ID matched, processing for dependencies\"/>\n                                    <L7p:Level stringValue=\"FINE\"/>\n                                    </L7p:AuditDetailAssertion>\n                                    <L7p:ResponseXpathAssertion>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Get keystore of the private key for display\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:VariablePrefix stringValue=\"keystore\"/>\n                                    <L7p:XmlMsgSrc stringValue=\"privateKeys.sorted\"/>\n                                    <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                    <L7p:Expression stringValue=\"/PrivateKeys/PrivateKey[@id=$id.current]/Keystore\"/>\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"s\"/>\n                                    <L7p:value stringValue=\"http://schemas.xmlsoap.org/soap/envelope/\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                                    </L7p:XpathExpression>\n                                    </L7p:ResponseXpathAssertion>\n                                    <L7p:AuditDetailAssertion>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// FINE\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:Detail stringValue=\"===> Searching objects for references to ${keystore.result}:${alias.result}\"/>\n                                    <L7p:Level stringValue=\"FINE\"/>\n                                    </L7p:AuditDetailAssertion>\n                                    <wsp:OneOrMore wsp:Usage=\"Required\">\n                                    <wsp:All wsp:Usage=\"Required\">\n                                    <L7p:AuditDetailAssertion>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// FINE\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:Detail stringValue=\"==> Searching policy XML\"/>\n                                    <L7p:Level stringValue=\"FINE\"/>\n                                    </L7p:AuditDetailAssertion>\n                                    <L7p:ResponseXpathAssertion>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Extract all policy objects that contain the KeyAlias element\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:VariablePrefix stringValue=\"policies\"/>\n                                    <L7p:XmlMsgSrc stringValue=\"allPolicyXML\"/>\n                                    <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                    <L7p:Expression stringValue=\"/AllPolicyXML/PolicyXML[contains(.,'&lt;L7p:KeyAlias stringValue=')]\"/>\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                                    </L7p:XpathExpression>\n                                    </L7p:ResponseXpathAssertion>\n                                    <L7p:ForEachLoop\n                                    L7p:Usage=\"Required\"\n                                    loopVariable=\"policies.elements\" variablePrefix=\"policy\">\n                                    <L7p:SetVariable>\n\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"// Cast to message type for XPath\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n\n                                    <L7p:Base64Expression stringValue=\"JHtwb2xpY3kuY3VycmVudH0=\"/>\n                                    <L7p:ContentType stringValue=\"text/xml; charset=utf-8\"/>\n                                    <L7p:DataType variableDataType=\"message\"/>\n                                    <L7p:VariableToSet stringValue=\"policyObject.xml\"/>\n                                    </L7p:SetVariable>\n                                    <L7p:ResponseXpathAssertion>\n\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"// Extract the policy XML from the policy object\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:VariablePrefix stringValue=\"policy.xml\"/>\n                                    <L7p:XmlMsgSrc stringValue=\"policyObject.xml\"/>\n                                    <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                    <L7p:Expression stringValue=\"/PolicyXML/text()\"/>\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"s\"/>\n\n                                    <L7p:value stringValue=\"http://schemas.xmlsoap.org/soap/envelope/\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                                    </L7p:XpathExpression>\n                                    </L7p:ResponseXpathAssertion>\n                                    <L7p:Include>\n                                    <L7p:PolicyGuid stringValue=\"8f33b165-bc16-4959-a524-aba67aff3cdf\"/>\n                                    </L7p:Include>\n                                    <L7p:SetVariable>\n\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"// Cast to message type for XPath\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n\n                                    <L7p:Base64Expression stringValue=\"JHtwb2xpY3kueG1sLnJlc3VsdH0=\"/>\n                                    <L7p:ContentType stringValue=\"text/xml; charset=utf-8\"/>\n                                    <L7p:DataType variableDataType=\"message\"/>\n                                    <L7p:VariableToSet stringValue=\"policy.xml\"/>\n                                    </L7p:SetVariable>\n                                    <wsp:OneOrMore wsp:Usage=\"Required\">\n                                    <wsp:All wsp:Usage=\"Required\">\n                                    <L7p:ResponseXpathAssertion>\n\n                                    <L7p:AssertionComment assertionComment=\"included\">\n\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"// Check if the policy XML has a reference to this private by alias\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n\n                                    <L7p:VariablePrefix stringValue=\"assertion\"/>\n\n                                    <L7p:XmlMsgSrc stringValue=\"policy.xml\"/>\n\n                                    <L7p:XpathExpression xpathExpressionValue=\"included\">\n\n                                    <L7p:Expression stringValue=\"//L7p:KeyAlias[@stringValue=$alias.result]/../L7p:NonDefaultKeystoreId[@goidValue=$keystore.result]/../name()\"/>\n\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"L7p\"/>\n\n                                    <L7p:value stringValue=\"http://www.layer7tech.com/ws/policy\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_2_0\"/>\n                                    </L7p:XpathExpression>\n                                    </L7p:ResponseXpathAssertion>\n                                    <L7p:AuditDetailAssertion>\n\n                                    <L7p:AssertionComment assertionComment=\"included\">\n\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"// FINE\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:Detail stringValue=\"==> Found ${assertion.results} assertion(s) in ${sourceType.result}: ${folderpath.result}${name.result}\"/>\n                                    <L7p:Level stringValue=\"FINE\"/>\n                                    </L7p:AuditDetailAssertion>\n                                    <L7p:Include>\n\n                                    <L7p:PolicyGuid stringValue=\"8f33b165-bc16-4959-a524-aba67aff3cdf\"/>\n                                    </L7p:Include>\n                                    <L7p:SetVariable>\n\n                                    <L7p:Base64Expression stringValue=\"JHtzb3VyY2VUeXBlLnJlc3VsdH06ICR7Zm9sZGVyUGF0aC5yZXN1bHR9JHtuYW1lLnJlc3VsdH0gKCR7YXNzZXJ0aW9uLnJlc3VsdHN9KQ==\"/>\n\n                                    <L7p:VariableToSet stringValue=\"depender\"/>\n                                    </L7p:SetVariable>\n                                    <L7p:ManipulateMultiValuedVariable>\n\n                                    <L7p:SourceVariableName stringValue=\"depender\"/>\n\n                                    <L7p:TargetVariableName stringValue=\"dependers.list\"/>\n                                    </L7p:ManipulateMultiValuedVariable>\n                                    <L7p:assertionComment>\n\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"// Search policy XML for TrustedCertificateName element matching ${name.result}\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:All>\n                                    <L7p:TrueAssertion/>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"// Search policy XML for each possibility matching our reference, never fail\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:OneOrMore>\n                                    </L7p:ForEachLoop>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Search for references in policy XML\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:All>\n                                    <L7p:TrueAssertion/>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Search for references in policy XML, never fail\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:OneOrMore>\n                                    <wsp:OneOrMore wsp:Usage=\"Required\">\n                                    <wsp:All wsp:Usage=\"Required\">\n                                    <L7p:AuditDetailAssertion>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// FINE\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:Detail stringValue=\"==> Searching websocket connection definitions\"/>\n                                    <L7p:Level stringValue=\"FINE\"/>\n                                    </L7p:AuditDetailAssertion>\n                                    <L7p:Encapsulated>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// GET genericEntities\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n\n                                    <L7p:EncapsulatedAssertionConfigGuid stringValue=\"c8a5a0d5-1ae2-4144-b538-5c311efc1560\"/>\n\n                                    <L7p:EncapsulatedAssertionConfigName stringValue=\"Utility: Call Restman\"/>\n                                    <L7p:Parameters mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"element\"/>\n                                    <L7p:value stringValue=\"GenericEntity\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"message\"/>\n                                    <L7p:value stringValue=\"\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"method\"/>\n                                    <L7p:value stringValue=\"GET\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"resource\"/>\n                                    <L7p:value stringValue=\"genericEntities\"/>\n                                    </L7p:entry>\n                                    </L7p:Parameters>\n                                    </L7p:Encapsulated>\n                                    <L7p:Encapsulated>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Want a sorted list of generic entities for the display\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n\n                                    <L7p:EncapsulatedAssertionConfigGuid stringValue=\"6db56c26-58d7-4ffc-8fa5-01b525d5468b\"/>\n\n                                    <L7p:EncapsulatedAssertionConfigName stringValue=\"Utility: List Generic Entities\"/>\n                                    <L7p:Parameters mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"cacheAge\"/>\n                                    <L7p:value stringValue=\"${cacheAge}\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"refresh\"/>\n                                    <L7p:value stringValue=\"${request.http.parameter.refresh}\"/>\n                                    </L7p:entry>\n                                    </L7p:Parameters>\n                                    </L7p:Encapsulated>\n                                    <L7p:ResponseXpathAssertion>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Extract list of ids to search through\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:VariablePrefix stringValue=\"candidateIds\"/>\n                                    <L7p:XmlMsgSrc stringValue=\"genericEntities.sorted\"/>\n                                    <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                    <L7p:Expression stringValue=\"/GenericEntities/GenericEntity/@id\"/>\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                                    </L7p:XpathExpression>\n                                    </L7p:ResponseXpathAssertion>\n                                    <L7p:ForEachLoop\n                                    L7p:Usage=\"Required\"\n                                    loopVariable=\"candidateIds.results\" variablePrefix=\"candidateId\">\n                                    <wsp:OneOrMore wsp:Usage=\"Required\">\n                                    <wsp:All wsp:Usage=\"Required\">\n                                    <L7p:ResponseXpathAssertion>\n\n                                    <L7p:AssertionComment assertionComment=\"included\">\n\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"// Get the XML definition\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n\n                                    <L7p:VariablePrefix stringValue=\"genericEntity.xml\"/>\n\n                                    <L7p:XpathExpression xpathExpressionValue=\"included\">\n\n                                    <L7p:Expression stringValue=\"//l7:GenericEntity[@id=$candidateId.current]/l7:ValueXml\"/>\n\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"s\"/>\n\n                                    <L7p:value stringValue=\"http://schemas.xmlsoap.org/soap/envelope/\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"l7\"/>\n\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_2_0\"/>\n                                    </L7p:XpathExpression>\n                                    </L7p:ResponseXpathAssertion>\n                                    <L7p:SetVariable>\n\n                                    <L7p:Base64Expression stringValue=\"JHtnZW5lcmljRW50aXR5LnhtbC5yZXN1bHR9\"/>\n\n                                    <L7p:ContentType stringValue=\"text/xml; charset=utf-8\"/>\n\n                                    <L7p:DataType variableDataType=\"message\"/>\n\n                                    <L7p:VariableToSet stringValue=\"genericEntity.xml\"/>\n                                    </L7p:SetVariable>\n                                    <wsp:OneOrMore wsp:Usage=\"Required\">\n                                    <L7p:ResponseXpathAssertion>\n\n                                    <L7p:VariablePrefix stringValue=\"\"/>\n\n                                    <L7p:XmlMsgSrc stringValue=\"genericEntity.xml\"/>\n\n                                    <L7p:XpathExpression xpathExpressionValue=\"included\">\n\n                                    <L7p:Expression stringValue=\"/java/object/void[@property='inboundPrivateKeyAlias' and string=$alias.result]/../void[@property='inboundPrivateKeyId']/object[@class='com.l7tech.objectmodel.Goid' and string=$keystore.result]\"/>\n\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"s\"/>\n\n                                    <L7p:value stringValue=\"http://schemas.xmlsoap.org/soap/envelope/\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"l7\"/>\n\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_2_0\"/>\n                                    </L7p:XpathExpression>\n                                    </L7p:ResponseXpathAssertion>\n                                    <L7p:ResponseXpathAssertion>\n\n                                    <L7p:VariablePrefix stringValue=\"\"/>\n\n                                    <L7p:XmlMsgSrc stringValue=\"genericEntity.xml\"/>\n\n                                    <L7p:XpathExpression xpathExpressionValue=\"included\">\n\n                                    <L7p:Expression stringValue=\"/java/object/void[@property='outboundPrivateKeyAlias' and string=$alias.result]/../void[@property='outboundPrivateKeyId']/object[@class='com.l7tech.objectmodel.Goid' and string=$keystore.result]\"/>\n\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"s\"/>\n\n                                    <L7p:value stringValue=\"http://schemas.xmlsoap.org/soap/envelope/\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"l7\"/>\n\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_2_0\"/>\n                                    </L7p:XpathExpression>\n                                    </L7p:ResponseXpathAssertion>\n                                    <L7p:assertionComment>\n\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"// Check for inbound or outbound use of private key\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:OneOrMore>\n                                    <L7p:ResponseXpathAssertion>\n\n                                    <L7p:AssertionComment assertionComment=\"included\">\n\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"// Get name of this websocket connection definition\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n\n                                    <L7p:VariablePrefix stringValue=\"name\"/>\n\n                                    <L7p:XmlMsgSrc stringValue=\"genericEntities.sorted\"/>\n\n                                    <L7p:XpathExpression xpathExpressionValue=\"included\">\n\n                                    <L7p:Expression stringValue=\"/GenericEntities/GenericEntity[@id=$candidateId.current]/Name\"/>\n\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"l7\"/>\n\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                                    </L7p:XpathExpression>\n                                    </L7p:ResponseXpathAssertion>\n                                    <L7p:SetVariable>\n\n                                    <L7p:Base64Expression stringValue=\"V0VCU09DS0VUIENPTk5FQ1RJT046ICR7bmFtZS5yZXN1bHR9\"/>\n\n                                    <L7p:VariableToSet stringValue=\"depender\"/>\n                                    </L7p:SetVariable>\n                                    <L7p:ManipulateMultiValuedVariable>\n\n                                    <L7p:SourceVariableName stringValue=\"depender\"/>\n\n                                    <L7p:TargetVariableName stringValue=\"dependers.list\"/>\n                                    </L7p:ManipulateMultiValuedVariable>\n                                    <L7p:assertionComment>\n\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"// Check the candidate object is a depender\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:All>\n                                    <L7p:TrueAssertion/>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"// Check the candidate object is a depender, never fail\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:OneOrMore>\n                                    </L7p:ForEachLoop>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Search for references in websocket connection definitions\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:All>\n                                    <L7p:TrueAssertion/>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Search for references in websocket connection definitions, never fail\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:OneOrMore>\n                                    <wsp:OneOrMore wsp:Usage=\"Required\">\n                                    <wsp:All wsp:Usage=\"Required\">\n                                    <L7p:AuditDetailAssertion>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// FINE\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:Detail stringValue=\"==> Searching active connector definitions\"/>\n                                    <L7p:Level stringValue=\"FINE\"/>\n                                    </L7p:AuditDetailAssertion>\n                                    <L7p:Encapsulated>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// GET activeConnectors\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n\n                                    <L7p:EncapsulatedAssertionConfigGuid stringValue=\"c8a5a0d5-1ae2-4144-b538-5c311efc1560\"/>\n\n                                    <L7p:EncapsulatedAssertionConfigName stringValue=\"Utility: Call Restman\"/>\n                                    <L7p:Parameters mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"element\"/>\n                                    <L7p:value stringValue=\"\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"message\"/>\n                                    <L7p:value stringValue=\"\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"method\"/>\n                                    <L7p:value stringValue=\"GET\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"resource\"/>\n                                    <L7p:value stringValue=\"activeConnectors\"/>\n                                    </L7p:entry>\n                                    </L7p:Parameters>\n                                    </L7p:Encapsulated>\n                                    <L7p:ResponseXpathAssertion>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Obtain list of depender ids\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:VariablePrefix stringValue=\"dependerIds\"/>\n                                    <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                    <L7p:Expression stringValue=\"//l7:ActiveConnector/l7:Properties/l7:Property[@key='MqNativeIsSslKeystoreUsed' and l7:StringValue='true']/../l7:Property[@key='MqNativeSslKeystoreAlias' and l7:StringValue=$alias.result]/../l7:Property[@key='MqNativeSslKeystoreId' and l7:StringValue=$keystore.result]/../../@id\"/>\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"s\"/>\n                                    <L7p:value stringValue=\"http://schemas.xmlsoap.org/soap/envelope/\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_2_0\"/>\n                                    </L7p:XpathExpression>\n                                    </L7p:ResponseXpathAssertion>\n                                    <L7p:Encapsulated>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Want a sorted list of active connectors for the display\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n\n                                    <L7p:EncapsulatedAssertionConfigGuid stringValue=\"48b49f89-16fe-4b7a-bb66-02d86ad236d8\"/>\n\n                                    <L7p:EncapsulatedAssertionConfigName stringValue=\"Utility: List Active Connectors\"/>\n                                    <L7p:Parameters mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"cacheAge\"/>\n                                    <L7p:value stringValue=\"${cacheAge}\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"refresh\"/>\n                                    <L7p:value stringValue=\"${request.http.parameter.refresh}\"/>\n                                    </L7p:entry>\n                                    </L7p:Parameters>\n                                    </L7p:Encapsulated>\n                                    <L7p:ResponseXpathAssertion>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Extract list of ids to search through\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:VariablePrefix stringValue=\"candidateIds\"/>\n                                    <L7p:XmlMsgSrc stringValue=\"activeConnectors.sorted\"/>\n                                    <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                    <L7p:Expression stringValue=\"/ActiveConnectors/ActiveConnector/@id\"/>\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                                    </L7p:XpathExpression>\n                                    </L7p:ResponseXpathAssertion>\n                                    <L7p:ForEachLoop\n                                    L7p:Usage=\"Required\"\n                                    loopVariable=\"candidateIds.results\" variablePrefix=\"candidateId\">\n                                    <wsp:OneOrMore wsp:Usage=\"Required\">\n                                    <wsp:All wsp:Usage=\"Required\">\n                                    <L7p:ComparisonAssertion>\n\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n\n                                    <L7p:Expression1 stringValue=\"${dependerIds.results}\"/>\n\n                                    <L7p:Expression2 stringValue=\"${candidateId.current}\"/>\n\n                                    <L7p:MultivaluedComparison multivaluedComparison=\"ANY\"/>\n\n                                    <L7p:Predicates predicates=\"included\">\n\n                                    <L7p:item binary=\"included\">\n\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n\n                                    <L7p:RightValue stringValue=\"${candidateId.current}\"/>\n                                    </L7p:item>\n                                    </L7p:Predicates>\n                                    </L7p:ComparisonAssertion>\n                                    <L7p:ResponseXpathAssertion>\n\n                                    <L7p:AssertionComment assertionComment=\"included\">\n\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"// Get the name\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n\n                                    <L7p:VariablePrefix stringValue=\"name\"/>\n\n                                    <L7p:XmlMsgSrc stringValue=\"activeConnectors.sorted\"/>\n\n                                    <L7p:XpathExpression xpathExpressionValue=\"included\">\n\n                                    <L7p:Expression stringValue=\"/ActiveConnectors/ActiveConnector[@id=$candidateId.current]/Name\"/>\n\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"s\"/>\n\n                                    <L7p:value stringValue=\"http://schemas.xmlsoap.org/soap/envelope/\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"l7\"/>\n\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_2_0\"/>\n                                    </L7p:XpathExpression>\n                                    </L7p:ResponseXpathAssertion>\n                                    <L7p:ResponseXpathAssertion>\n\n                                    <L7p:AssertionComment assertionComment=\"included\">\n\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"// Get the type\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n\n                                    <L7p:VariablePrefix stringValue=\"type\"/>\n\n                                    <L7p:XmlMsgSrc stringValue=\"activeConnectors.sorted\"/>\n\n                                    <L7p:XpathExpression xpathExpressionValue=\"included\">\n\n                                    <L7p:Expression stringValue=\"/ActiveConnectors/ActiveConnector[@id=$candidateId.current]/Type\"/>\n\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"s\"/>\n\n                                    <L7p:value stringValue=\"http://schemas.xmlsoap.org/soap/envelope/\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"l7\"/>\n\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_2_0\"/>\n                                    </L7p:XpathExpression>\n                                    </L7p:ResponseXpathAssertion>\n                                    <L7p:SetVariable>\n\n                                    <L7p:Base64Expression stringValue=\"QUNUSVZFIENPTk5FQ1RPUjogJHtuYW1lLnJlc3VsdH0gKCR7dHlwZS5yZXN1bHR9KQ==\"/>\n\n                                    <L7p:VariableToSet stringValue=\"depender\"/>\n                                    </L7p:SetVariable>\n                                    <L7p:ManipulateMultiValuedVariable>\n\n                                    <L7p:SourceVariableName stringValue=\"depender\"/>\n\n                                    <L7p:TargetVariableName stringValue=\"dependers.list\"/>\n                                    </L7p:ManipulateMultiValuedVariable>\n                                    <L7p:assertionComment>\n\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"// Check the candidate object is a depender\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:All>\n                                    <L7p:TrueAssertion/>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"// Check the candidate object is a depender, never fail\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:OneOrMore>\n                                    </L7p:ForEachLoop>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Search for references in active connector definitions\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:All>\n                                    <L7p:TrueAssertion/>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Search for references in active connector definitions, never fail\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:OneOrMore>\n                                    <wsp:OneOrMore wsp:Usage=\"Required\">\n                                    <wsp:All wsp:Usage=\"Required\">\n                                    <L7p:ComparisonAssertion>\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:Expression1 stringValue=\"${dependers.list.length}\"/>\n                                    <L7p:Expression2 stringValue=\"1\"/>\n                                    <L7p:Operator operator=\"GE\"/>\n                                    <L7p:Predicates predicates=\"included\">\n                                    <L7p:item binary=\"included\">\n\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:Operator operator=\"GE\"/>\n                                    <L7p:RightValue stringValue=\"1\"/>\n                                    </L7p:item>\n                                    </L7p:Predicates>\n                                    </L7p:ComparisonAssertion>\n                                    <L7p:ForEachLoop\n                                    L7p:Usage=\"Required\"\n                                    loopVariable=\"dependers.list\" variablePrefix=\"depender\">\n                                    <L7p:SetVariable>\n\n                                    <L7p:Base64Expression stringValue=\"JHtkZXBlbmRlcnMuaHRtbH0NCiAgPGxpPiR7ZGVwZW5kZXIuY3VycmVudH08L2xpPg==\"/>\n                                    <L7p:VariableToSet stringValue=\"dependers.html\"/>\n                                    </L7p:SetVariable>\n                                    </L7p:ForEachLoop>\n                                    <L7p:SetVariable>\n                                    <L7p:Base64Expression stringValue=\"JHtodG1sQ29udGVudH0NCg0KPHA+VGhlIGZvbGxvd2luZyBvYmplY3RzIHJlZmVyZW5jZSB0aGlzIHByaXZhdGUga2V5OjwvcD4NCjx1bD4ke2RlcGVuZGVycy5odG1sfTwvdWw+\"/>\n                                    <L7p:VariableToSet stringValue=\"htmlContent\"/>\n                                    </L7p:SetVariable>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// ${dependers.list} has content\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:All>\n                                    <L7p:SetVariable>\n                                    <L7p:Base64Expression stringValue=\"JHtodG1sQ29udGVudH0NCjxwPk5vdGhpbmcgd2FzIGZvdW5kIHRoYXQgcmVmZXJlbmNlcyB0aGlzIHByaXZhdGUga2V5PC9wPg==\"/>\n                                    <L7p:VariableToSet stringValue=\"htmlContent\"/>\n                                    </L7p:SetVariable>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Append ${dependers.html} to ${htmlContent} if ${dependers.list} has any entries\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:OneOrMore>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// ${id} matches so retrieve dependers\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                </wsp:All>\n                                <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Do reverse dependency search if id matches\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:assertionComment>\n                            </wsp:OneOrMore>\n                            <L7p:assertionComment>\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Cycle through each object to add to display and check if search must be run\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:assertionComment>\n                        </L7p:ForEachLoop>\n                        <L7p:assertionComment>\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// ${objectType} == &quot;Private Key&quot;\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:assertionComment>\n                    </wsp:All>\n                    <wsp:All wsp:Usage=\"Required\">\n                        <L7p:ComparisonAssertion>\n                            <L7p:CaseSensitive booleanValue=\"false\"/>\n                            <L7p:Expression1 stringValue=\"${objectType}\"/>\n                            <L7p:Expression2 stringValue=\"Secure Password\"/>\n                            <L7p:Predicates predicates=\"included\">\n                                <L7p:item binary=\"included\">\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:RightValue stringValue=\"Secure Password\"/>\n                                </L7p:item>\n                            </L7p:Predicates>\n                        </L7p:ComparisonAssertion>\n                        <L7p:AuditDetailAssertion>\n                            <L7p:AssertionComment assertionComment=\"included\">\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// FINE\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:AssertionComment>\n                            <L7p:Detail stringValue=\"======> Listing ${objectType} objects\"/>\n                            <L7p:Level stringValue=\"FINE\"/>\n                        </L7p:AuditDetailAssertion>\n                        <L7p:Encapsulated>\n                            <L7p:AssertionComment assertionComment=\"included\">\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Get list of objectTypes to display and search for references\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:AssertionComment>\n                            <L7p:EncapsulatedAssertionConfigGuid stringValue=\"eeb96501-f75c-4078-bcf7-98bc2c52bfe8\"/>\n                            <L7p:EncapsulatedAssertionConfigName stringValue=\"Utility: List Secure Passwords\"/>\n                            <L7p:Parameters mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"cacheAge\"/>\n                                    <L7p:value stringValue=\"${cacheAge}\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"refresh\"/>\n                                    <L7p:value stringValue=\"${request.http.parameter.refresh}\"/>\n                                </L7p:entry>\n                            </L7p:Parameters>\n                        </L7p:Encapsulated>\n                        <L7p:ResponseXpathAssertion>\n                            <L7p:AssertionComment assertionComment=\"included\">\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Get list of ids\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:AssertionComment>\n                            <L7p:VariablePrefix stringValue=\"ids\"/>\n                            <L7p:XmlMsgSrc stringValue=\"securePasswords.sorted\"/>\n                            <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                <L7p:Expression stringValue=\"/SecurePasswords/SecurePassword/@id\"/>\n                                <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"s\"/>\n                                    <L7p:value stringValue=\"http://schemas.xmlsoap.org/soap/envelope/\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                    </L7p:entry>\n                                </L7p:Namespaces>\n                                <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                            </L7p:XpathExpression>\n                        </L7p:ResponseXpathAssertion>\n                        <L7p:ForEachLoop L7p:Usage=\"Required\"\n                            loopVariable=\"ids.results\" variablePrefix=\"id\">\n                            <L7p:ResponseXpathAssertion>\n                                <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Get name of the object for display\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:AssertionComment>\n                                <L7p:VariablePrefix stringValue=\"name\"/>\n                                <L7p:XmlMsgSrc stringValue=\"securePasswords.sorted\"/>\n                                <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                    <L7p:Expression stringValue=\"/SecurePasswords/SecurePassword[@id=$id.current]/Name\"/>\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"s\"/>\n                                    <L7p:value stringValue=\"http://schemas.xmlsoap.org/soap/envelope/\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                                </L7p:XpathExpression>\n                            </L7p:ResponseXpathAssertion>\n                            <L7p:AuditDetailAssertion>\n                                <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// FINE\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:AssertionComment>\n                                <L7p:Detail stringValue=\"=====> Processing ${objectType}: ${name.result} (${id.current})\"/>\n                                <L7p:Level stringValue=\"FINE\"/>\n                            </L7p:AuditDetailAssertion>\n                            <L7p:Encapsulated>\n                                <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// name.result\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:AssertionComment>\n                                <L7p:EncapsulatedAssertionConfigGuid stringValue=\"f6b19229-a705-4c48-bc78-3975564a1a9a\"/>\n                                <L7p:EncapsulatedAssertionConfigName stringValue=\"Utility: Escape HTML String\"/>\n                                <L7p:Parameters mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"escapedString\"/>\n                                    <L7p:value stringValue=\"${name.result}\"/>\n                                    </L7p:entry>\n                                </L7p:Parameters>\n                            </L7p:Encapsulated>\n                            <L7p:SetVariable>\n                                <L7p:Base64Expression stringValue=\"JHtodG1sQ29udGVudH0NCjxhIGlkPSIke2lkLmN1cnJlbnR9Ii8+PGEgaHJlZj0iJHtyZXF1ZXN0LnVybC5wYXRofT9vYmplY3RUeXBlPSR7b2JqZWN0VHlwZX0maWQ9JHtpZC5jdXJyZW50fSMke2lkLmN1cnJlbnR9IiBvbkNsaWNrPSJzZXRSZWZyZXNoKHRoaXMpIj4ke2VzY2FwZWRTdHJpbmd9PC9hPjxici8+\"/>\n                                <L7p:VariableToSet stringValue=\"htmlContent\"/>\n                            </L7p:SetVariable>\n                            <wsp:OneOrMore wsp:Usage=\"Required\">\n                                <L7p:ComparisonAssertion>\n                                    <L7p:Expression1 stringValue=\"${id}\"/>\n                                    <L7p:Expression2 stringValue=\"${id.current}\"/>\n                                    <L7p:Negate booleanValue=\"true\"/>\n                                    <L7p:Predicates predicates=\"included\">\n                                    <L7p:item binary=\"included\">\n                                    <L7p:Negated booleanValue=\"true\"/>\n                                    <L7p:RightValue stringValue=\"${id.current}\"/>\n                                    </L7p:item>\n                                    </L7p:Predicates>\n                                </L7p:ComparisonAssertion>\n                                <wsp:All wsp:Usage=\"Required\">\n                                    <L7p:AuditDetailAssertion>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// FINE\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:Detail stringValue=\"====> ID matched, processing for dependencies\"/>\n                                    <L7p:Level stringValue=\"FINE\"/>\n                                    </L7p:AuditDetailAssertion>\n                                    <L7p:SetVariable>\n                                    <L7p:Base64Expression stringValue=\"e3NlY3Bhc3MuJHtuYW1lLnJlc3VsdH0ucGxhaW50ZXh0fQ==\"/>\n                                    <L7p:VariableToSet stringValue=\"referenceString\"/>\n                                    </L7p:SetVariable>\n                                    <L7p:SetVariable>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Prepend $ to the string we will search for\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:Base64Expression stringValue=\"JCR7cmVmZXJlbmNlU3RyaW5nfQ==\"/>\n                                    <L7p:VariableToSet stringValue=\"referenceString\"/>\n                                    </L7p:SetVariable>\n                                    <L7p:AuditDetailAssertion>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// FINE\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:Detail stringValue=\"===> Searching objects for references (${referenceString})\"/>\n                                    <L7p:Level stringValue=\"FINE\"/>\n                                    </L7p:AuditDetailAssertion>\n                                    <wsp:OneOrMore wsp:Usage=\"Required\">\n                                    <wsp:All wsp:Usage=\"Required\">\n                                    <L7p:AuditDetailAssertion>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// FINE\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:Detail stringValue=\"==> Searching policy XML for non-encoded references\"/>\n                                    <L7p:Level stringValue=\"FINE\"/>\n                                    </L7p:AuditDetailAssertion>\n                                    <L7p:ResponseXpathAssertion>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Check if this policy has a direct reference to the secure password\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:VariablePrefix stringValue=\"policies\"/>\n                                    <L7p:XmlMsgSrc stringValue=\"allPolicyXML\"/>\n                                    <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                    <L7p:Expression stringValue=\"//AllPolicyXML/PolicyXML[contains(.,$referenceString)]\"/>\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                                    </L7p:XpathExpression>\n                                    </L7p:ResponseXpathAssertion>\n                                    <L7p:ForEachLoop\n                                    L7p:Usage=\"Required\"\n                                    loopVariable=\"policies.elements\" variablePrefix=\"policy\">\n                                    <L7p:SetVariable>\n\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"// Cast to message type for XPath\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n\n                                    <L7p:Base64Expression stringValue=\"JHtwb2xpY3kuY3VycmVudH0=\"/>\n                                    <L7p:ContentType stringValue=\"text/xml; charset=utf-8\"/>\n                                    <L7p:DataType variableDataType=\"message\"/>\n                                    <L7p:VariableToSet stringValue=\"policyObject.xml\"/>\n                                    </L7p:SetVariable>\n                                    <L7p:Include>\n                                    <L7p:PolicyGuid stringValue=\"8f33b165-bc16-4959-a524-aba67aff3cdf\"/>\n                                    </L7p:Include>\n                                    <L7p:SetVariable>\n\n                                    <L7p:Base64Expression stringValue=\"JHtzb3VyY2VUeXBlLnJlc3VsdH06ICR7Zm9sZGVyUGF0aC5yZXN1bHR9JHtuYW1lLnJlc3VsdH0gKGluIGRpcmVjdCByZWZlcmVuY2Up\"/>\n                                    <L7p:VariableToSet stringValue=\"depender\"/>\n                                    </L7p:SetVariable>\n                                    <L7p:ManipulateMultiValuedVariable>\n\n                                    <L7p:SourceVariableName stringValue=\"depender\"/>\n\n                                    <L7p:TargetVariableName stringValue=\"dependers.list\"/>\n                                    </L7p:ManipulateMultiValuedVariable>\n                                    </L7p:ForEachLoop>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Search for non-encoded references in policy XML\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:All>\n                                    <L7p:TrueAssertion/>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Search for non-encoded references in policy XML, never fail\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:OneOrMore>\n                                    <wsp:OneOrMore wsp:Usage=\"Required\">\n                                    <wsp:All wsp:Usage=\"Required\">\n                                    <L7p:AuditDetailAssertion>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// FINE\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:Detail stringValue=\"==> Searching policy XML for encoded references\"/>\n                                    <L7p:Level stringValue=\"FINE\"/>\n                                    </L7p:AuditDetailAssertion>\n                                    <L7p:ResponseXpathAssertion>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Extract all policy objects that contain Base64Expression or Base64ResponseBody elements\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:VariablePrefix stringValue=\"policies\"/>\n                                    <L7p:XmlMsgSrc stringValue=\"allPolicyXML\"/>\n                                    <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                    <L7p:Expression stringValue=\"//AllPolicyXML/PolicyXML[(contains(.,'&lt;L7p:Base64Expression ') or contains(.,'&lt;L7p:Base64ResponseBody '))]\"/>\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                                    </L7p:XpathExpression>\n                                    </L7p:ResponseXpathAssertion>\n                                    <L7p:ForEachLoop\n                                    L7p:Usage=\"Required\"\n                                    loopVariable=\"policies.elements\" variablePrefix=\"policy\">\n                                    <L7p:SetVariable>\n\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"// Cast to message type for XPath\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n\n                                    <L7p:Base64Expression stringValue=\"JHtwb2xpY3kuY3VycmVudH0=\"/>\n                                    <L7p:ContentType stringValue=\"text/xml; charset=utf-8\"/>\n                                    <L7p:DataType variableDataType=\"message\"/>\n                                    <L7p:VariableToSet stringValue=\"policyObject.xml\"/>\n                                    </L7p:SetVariable>\n                                    <L7p:ResponseXpathAssertion>\n\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"// Extract the policy XML from the policy object\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:VariablePrefix stringValue=\"policy.xml\"/>\n                                    <L7p:XmlMsgSrc stringValue=\"policyObject.xml\"/>\n                                    <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                    <L7p:Expression stringValue=\"/PolicyXML/text()\"/>\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"s\"/>\n\n                                    <L7p:value stringValue=\"http://schemas.xmlsoap.org/soap/envelope/\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                                    </L7p:XpathExpression>\n                                    </L7p:ResponseXpathAssertion>\n                                    <L7p:SetVariable>\n\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"// Cast to message type for XPath\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n\n                                    <L7p:Base64Expression stringValue=\"JHtwb2xpY3kueG1sLnJlc3VsdH0=\"/>\n                                    <L7p:ContentType stringValue=\"text/xml; charset=utf-8\"/>\n                                    <L7p:DataType variableDataType=\"message\"/>\n                                    <L7p:VariableToSet stringValue=\"policy.xml\"/>\n                                    </L7p:SetVariable>\n                                    <wsp:OneOrMore wsp:Usage=\"Required\">\n                                    <wsp:All wsp:Usage=\"Required\">\n                                    <L7p:ResponseXpathAssertion>\n\n                                    <L7p:AssertionComment assertionComment=\"included\">\n\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"// Extract all of the (Base64Expression | Base64ResponseBody)/@stringValue instances for analysis\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n\n                                    <L7p:VariablePrefix stringValue=\"stringValue\"/>\n\n                                    <L7p:XmlMsgSrc stringValue=\"policy.xml\"/>\n\n                                    <L7p:XpathExpression xpathExpressionValue=\"included\">\n\n                                    <L7p:Expression stringValue=\"(//L7p:Base64Expression | //L7p:Base64ResponseBody)/@stringValue\"/>\n\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"s\"/>\n\n                                    <L7p:value stringValue=\"http://schemas.xmlsoap.org/soap/envelope/\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"L7p\"/>\n\n                                    <L7p:value stringValue=\"http://www.layer7tech.com/ws/policy\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"wsp\"/>\n\n                                    <L7p:value stringValue=\"http://schemas.xmlsoap.org/ws/2002/12/policy\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                                    </L7p:XpathExpression>\n                                    </L7p:ResponseXpathAssertion>\n                                    <L7p:SetVariable>\n\n                                    <L7p:AssertionComment assertionComment=\"included\">\n\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"// Reset in case we broke out of something earlier\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n\n                                    <L7p:Base64Expression stringValue=\"ZmFsc2U=\"/>\n\n                                    <L7p:VariableToSet stringValue=\"stringValue.break\"/>\n                                    </L7p:SetVariable>\n                                    <L7p:ForEachLoop\n                                    L7p:Usage=\"Required\"\n                                    loopVariable=\"stringValue.results\" variablePrefix=\"stringValue\">\n                                    <L7p:EncodeDecode>\n\n                                    <L7p:SourceVariableName stringValue=\"stringValue.current\"/>\n\n                                    <L7p:TargetDataType variableDataType=\"string\"/>\n\n                                    <L7p:TargetVariableName stringValue=\"stringValue.current\"/>\n\n                                    <L7p:TransformType transformType=\"BASE64_DECODE\"/>\n                                    </L7p:EncodeDecode>\n\n                                    <wsp:OneOrMore wsp:Usage=\"Required\">\n                                    <L7p:ComparisonAssertion>\n\n                                    <L7p:Expression1 stringValue=\"${stringValue.current}\"/>\n\n                                    <L7p:Expression2 stringValue=\"${referenceString}\"/>\n\n                                    <L7p:Negate booleanValue=\"true\"/>\n\n                                    <L7p:Operator operator=\"CONTAINS\"/>\n\n                                    <L7p:Predicates predicates=\"included\">\n\n                                    <L7p:item binary=\"included\">\n\n                                    <L7p:Negated booleanValue=\"true\"/>\n\n                                    <L7p:Operator operator=\"CONTAINS\"/>\n\n                                    <L7p:RightValue stringValue=\"${referenceString}\"/>\n                                    </L7p:item>\n                                    </L7p:Predicates>\n                                    </L7p:ComparisonAssertion>\n                                    <wsp:All wsp:Usage=\"Required\">\n                                    <L7p:Include>\n\n                                    <L7p:PolicyGuid stringValue=\"8f33b165-bc16-4959-a524-aba67aff3cdf\"/>\n                                    </L7p:Include>\n                                    <L7p:SetVariable>\n\n                                    <L7p:Base64Expression stringValue=\"JHtzb3VyY2VUeXBlLnJlc3VsdH06ICR7Zm9sZGVyUGF0aC5yZXN1bHR9JHtuYW1lLnJlc3VsdH0gKGluIEJhc2U2NCBlbmNvZGVkIGF0dHJpYnV0ZSk=\"/>\n\n                                    <L7p:VariableToSet stringValue=\"depender\"/>\n                                    </L7p:SetVariable>\n                                    <L7p:ManipulateMultiValuedVariable>\n\n                                    <L7p:SourceVariableName stringValue=\"depender\"/>\n\n                                    <L7p:TargetVariableName stringValue=\"dependers.list\"/>\n                                    </L7p:ManipulateMultiValuedVariable>\n                                    <L7p:SetVariable>\n\n                                    <L7p:AssertionComment assertionComment=\"included\">\n\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"// Don't need any more\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n\n                                    <L7p:Base64Expression stringValue=\"dHJ1ZQ==\"/>\n\n                                    <L7p:VariableToSet stringValue=\"stringValue.break\"/>\n                                    </L7p:SetVariable>\n                                    <L7p:assertionComment>\n\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"// Extract id and append to ${dependers.list}\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:All>\n                                    <L7p:assertionComment>\n\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"// Check if ${stringValue.current} contains ${referenceString}\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:OneOrMore>\n                                    </L7p:ForEachLoop>\n                                    <L7p:assertionComment>\n\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"// Extract Base64Expressions from policy and check for matches\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:All>\n                                    <L7p:TrueAssertion/>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"// Extract Base64Expressions from policy and check for matches, never fail\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:OneOrMore>\n                                    </L7p:ForEachLoop>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Search for encoded references policy XML\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:All>\n                                    <L7p:TrueAssertion/>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Search for encoded references in policy XML, never fail\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:OneOrMore>\n                                    <wsp:OneOrMore wsp:Usage=\"Required\">\n                                    <wsp:All wsp:Usage=\"Required\">\n                                    <L7p:AuditDetailAssertion>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// FINE\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:Detail stringValue=\"==> Searching identity provider definitions\"/>\n                                    <L7p:Level stringValue=\"FINE\"/>\n                                    </L7p:AuditDetailAssertion>\n                                    <L7p:Encapsulated>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Retrieve list of identity providers\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n\n                                    <L7p:EncapsulatedAssertionConfigGuid stringValue=\"1ab6158d-33ce-4fa6-a7d8-2b8dc8e31faf\"/>\n\n                                    <L7p:EncapsulatedAssertionConfigName stringValue=\"Utility: List Identity Providers\"/>\n                                    <L7p:Parameters mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"cacheAge\"/>\n                                    <L7p:value stringValue=\"${cacheAge}\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"refresh\"/>\n                                    <L7p:value stringValue=\"${request.http.parameter.refresh}\"/>\n                                    </L7p:entry>\n                                    </L7p:Parameters>\n                                    </L7p:Encapsulated>\n                                    <L7p:ResponseXpathAssertion>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Extract list of ids to search through via bundles\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:VariablePrefix stringValue=\"candidateIds\"/>\n                                    <L7p:XmlMsgSrc stringValue=\"identityProviders.sorted\"/>\n                                    <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                    <L7p:Expression stringValue=\"/IdentityProviders/IdentityProvider[Type='LDAP']/@id\"/>\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                                    </L7p:XpathExpression>\n                                    </L7p:ResponseXpathAssertion>\n                                    <L7p:ForEachLoop\n                                    L7p:Usage=\"Required\"\n                                    loopVariable=\"candidateIds.results\" variablePrefix=\"candidateId\">\n                                    <L7p:Encapsulated>\n\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"// GET bundle?identityProvider=${candidateId.current}&amp;encryptSecrets=true\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n\n                                    <L7p:EncapsulatedAssertionConfigGuid stringValue=\"c8a5a0d5-1ae2-4144-b538-5c311efc1560\"/>\n\n                                    <L7p:EncapsulatedAssertionConfigName stringValue=\"Utility: Call Restman\"/>\n                                    <L7p:Parameters mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"element\"/>\n                                    <L7p:value stringValue=\"\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"message\"/>\n                                    <L7p:value stringValue=\"\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"method\"/>\n                                    <L7p:value stringValue=\"GET\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"resource\"/>\n                                    <L7p:value stringValue=\"bundle?identityProvider=${candidateId.current}&amp;encryptSecrets=true\"/>\n                                    </L7p:entry>\n                                    </L7p:Parameters>\n                                    </L7p:Encapsulated>\n                                    <wsp:OneOrMore wsp:Usage=\"Required\">\n                                    <wsp:All wsp:Usage=\"Required\">\n                                    <L7p:ResponseXpathAssertion>\n\n                                    <L7p:VariablePrefix stringValue=\"name\"/>\n\n                                    <L7p:XpathExpression xpathExpressionValue=\"included\">\n\n                                    <L7p:Expression stringValue=\"//l7:IdentityProvider/l7:Extension/l7:LdapIdentityProviderDetail[l7:BindPassword=$referenceString]/../../l7:Name\"/>\n\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"s\"/>\n\n                                    <L7p:value stringValue=\"http://schemas.xmlsoap.org/soap/envelope/\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"l7\"/>\n\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                                    </L7p:XpathExpression>\n                                    </L7p:ResponseXpathAssertion>\n                                    <L7p:ResponseXpathAssertion>\n\n                                    <L7p:VariablePrefix stringValue=\"type\"/>\n\n                                    <L7p:XpathExpression xpathExpressionValue=\"included\">\n\n                                    <L7p:Expression stringValue=\"//l7:IdentityProvider/l7:Extension/l7:LdapIdentityProviderDetail[l7:BindPassword=$referenceString]/../../l7:IdentityProviderType\"/>\n\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"s\"/>\n\n                                    <L7p:value stringValue=\"http://schemas.xmlsoap.org/soap/envelope/\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"l7\"/>\n\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                                    </L7p:XpathExpression>\n                                    </L7p:ResponseXpathAssertion>\n                                    <L7p:SetVariable>\n\n                                    <L7p:Base64Expression stringValue=\"SURFTlRJVFkgUFJPVklERVI6ICR7bmFtZS5yZXN1bHR9ICgke3R5cGUucmVzdWx0fSk=\"/>\n\n                                    <L7p:VariableToSet stringValue=\"depender\"/>\n                                    </L7p:SetVariable>\n                                    <L7p:ManipulateMultiValuedVariable>\n\n                                    <L7p:SourceVariableName stringValue=\"depender\"/>\n\n                                    <L7p:TargetVariableName stringValue=\"dependers.list\"/>\n                                    </L7p:ManipulateMultiValuedVariable>\n                                    <L7p:assertionComment>\n\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"// Check the candidate object for the reference\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:All>\n                                    <L7p:TrueAssertion/>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"// Check the candidate object for the reference, never fail\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:OneOrMore>\n                                    </L7p:ForEachLoop>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Search for references in identity provider definitions\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:All>\n                                    <L7p:TrueAssertion/>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Search for references in identity provider defintions, never fail\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:OneOrMore>\n                                    <wsp:OneOrMore wsp:Usage=\"Required\">\n                                    <wsp:All wsp:Usage=\"Required\">\n                                    <L7p:AuditDetailAssertion>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// FINE\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:Detail stringValue=\"==> Searching JMS destination definitions\"/>\n                                    <L7p:Level stringValue=\"FINE\"/>\n                                    </L7p:AuditDetailAssertion>\n                                    <L7p:Encapsulated>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Retrieve list of JMS destinations\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n\n                                    <L7p:EncapsulatedAssertionConfigGuid stringValue=\"53bc61d8-f0d0-4024-b09c-61fd5c9ef33e\"/>\n\n                                    <L7p:EncapsulatedAssertionConfigName stringValue=\"Utility: List JMS Destinations\"/>\n                                    <L7p:Parameters mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"cacheAge\"/>\n                                    <L7p:value stringValue=\"${cacheAge}\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"refresh\"/>\n                                    <L7p:value stringValue=\"${request.http.parameter.refresh}\"/>\n                                    </L7p:entry>\n                                    </L7p:Parameters>\n                                    </L7p:Encapsulated>\n                                    <L7p:ResponseXpathAssertion>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Extract list of ids to search through via bundles\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:VariablePrefix stringValue=\"candidateIds\"/>\n                                    <L7p:XmlMsgSrc stringValue=\"jmsDestinations.sorted\"/>\n                                    <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                    <L7p:Expression stringValue=\"/JMSDestinations/JMSDestination/@id\"/>\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                                    </L7p:XpathExpression>\n                                    </L7p:ResponseXpathAssertion>\n                                    <L7p:SetVariable>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Reset in case we broke out of something earlier\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:Base64Expression stringValue=\"ZmFsc2U=\"/>\n                                    <L7p:VariableToSet stringValue=\"candidateId.break\"/>\n                                    </L7p:SetVariable>\n                                    <L7p:ForEachLoop\n                                    L7p:Usage=\"Required\"\n                                    loopVariable=\"candidateIds.results\" variablePrefix=\"candidateId\">\n                                    <L7p:Encapsulated>\n\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"// GET bundle?jmsDestination=${candidateId.current}&amp;encryptSecrets=true\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n\n                                    <L7p:EncapsulatedAssertionConfigGuid stringValue=\"c8a5a0d5-1ae2-4144-b538-5c311efc1560\"/>\n\n                                    <L7p:EncapsulatedAssertionConfigName stringValue=\"Utility: Call Restman\"/>\n                                    <L7p:Parameters mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"element\"/>\n                                    <L7p:value stringValue=\"\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"message\"/>\n                                    <L7p:value stringValue=\"\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"method\"/>\n                                    <L7p:value stringValue=\"GET\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"resource\"/>\n                                    <L7p:value stringValue=\"bundle?jmsDestination=${candidateId.current}&amp;encryptSecrets=true\"/>\n                                    </L7p:entry>\n                                    </L7p:Parameters>\n                                    </L7p:Encapsulated>\n                                    <wsp:OneOrMore wsp:Usage=\"Required\">\n                                    <wsp:All wsp:Usage=\"Required\">\n                                    <L7p:ResponseXpathAssertion>\n\n                                    <L7p:AssertionComment assertionComment=\"included\">\n\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"// Might show up in several places, so get id in second XPath\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n\n                                    <L7p:VariablePrefix stringValue=\"\"/>\n\n                                    <L7p:XpathExpression xpathExpressionValue=\"included\">\n\n                                    <L7p:Expression stringValue=\"//l7:JMSDestinationDetail//l7:Property[l7:StringValue=$referenceString]\"/>\n\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"s\"/>\n\n                                    <L7p:value stringValue=\"http://schemas.xmlsoap.org/soap/envelope/\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"l7\"/>\n\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_2_0\"/>\n                                    </L7p:XpathExpression>\n                                    </L7p:ResponseXpathAssertion>\n                                    <L7p:ResponseXpathAssertion>\n\n                                    <L7p:VariablePrefix stringValue=\"dependerId\"/>\n\n                                    <L7p:XpathExpression xpathExpressionValue=\"included\">\n\n                                    <L7p:Expression stringValue=\"//l7:JMSDestination/@id\"/>\n\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"s\"/>\n\n                                    <L7p:value stringValue=\"http://schemas.xmlsoap.org/soap/envelope/\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"l7\"/>\n\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                                    </L7p:XpathExpression>\n                                    </L7p:ResponseXpathAssertion>\n                                    <L7p:ResponseXpathAssertion>\n\n                                    <L7p:AssertionComment assertionComment=\"included\">\n\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"// Get the name\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n\n                                    <L7p:VariablePrefix stringValue=\"name\"/>\n\n                                    <L7p:XmlMsgSrc stringValue=\"jmsDestinations.sorted\"/>\n\n                                    <L7p:XpathExpression xpathExpressionValue=\"included\">\n\n                                    <L7p:Expression stringValue=\"/JMSDestinations/JMSDestination[@id=$dependerId.result]/Name\"/>\n\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"s\"/>\n\n                                    <L7p:value stringValue=\"http://schemas.xmlsoap.org/soap/envelope/\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"l7\"/>\n\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_2_0\"/>\n                                    </L7p:XpathExpression>\n                                    </L7p:ResponseXpathAssertion>\n                                    <L7p:ResponseXpathAssertion>\n\n                                    <L7p:AssertionComment assertionComment=\"included\">\n\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"// Get the direction\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n\n                                    <L7p:VariablePrefix stringValue=\"direction\"/>\n\n                                    <L7p:XmlMsgSrc stringValue=\"jmsDestinations.sorted\"/>\n\n                                    <L7p:XpathExpression xpathExpressionValue=\"included\">\n\n                                    <L7p:Expression stringValue=\"/JMSDestinations/JMSDestination[@id=$dependerId.result]/Direction\"/>\n\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"s\"/>\n\n                                    <L7p:value stringValue=\"http://schemas.xmlsoap.org/soap/envelope/\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"l7\"/>\n\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_2_0\"/>\n                                    </L7p:XpathExpression>\n                                    </L7p:ResponseXpathAssertion>\n                                    <L7p:SetVariable>\n\n                                    <L7p:Base64Expression stringValue=\"Sk1TIERFU1RJTkFUSU9OOiAke25hbWUucmVzdWx0fSAoJHtkaXJlY3Rpb24ucmVzdWx0fSk=\"/>\n\n                                    <L7p:VariableToSet stringValue=\"depender\"/>\n                                    </L7p:SetVariable>\n                                    <L7p:ManipulateMultiValuedVariable>\n\n                                    <L7p:SourceVariableName stringValue=\"depender\"/>\n\n                                    <L7p:TargetVariableName stringValue=\"dependers.list\"/>\n                                    </L7p:ManipulateMultiValuedVariable>\n                                    <L7p:SetVariable>\n\n                                    <L7p:AssertionComment assertionComment=\"included\">\n\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"// Don't need any more\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n\n                                    <L7p:Base64Expression stringValue=\"dHJ1ZQ==\"/>\n\n                                    <L7p:VariableToSet stringValue=\"candidateId.break\"/>\n                                    </L7p:SetVariable>\n                                    <L7p:assertionComment>\n\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"// Check the candidate object for the reference\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:All>\n                                    <L7p:TrueAssertion/>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"// Check the candidate object for the reference, never fail\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:OneOrMore>\n                                    </L7p:ForEachLoop>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Search for references in JMS destination definitions\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:All>\n                                    <L7p:TrueAssertion/>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Search for references in JMS destination definitions, never fail\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:OneOrMore>\n                                    <wsp:OneOrMore wsp:Usage=\"Required\">\n                                    <wsp:All wsp:Usage=\"Required\">\n                                    <L7p:AuditDetailAssertion>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// FINE\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:Detail stringValue=\"==> Searching email listener definitions\"/>\n                                    <L7p:Level stringValue=\"FINE\"/>\n                                    </L7p:AuditDetailAssertion>\n                                    <L7p:Encapsulated>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// GET emailListeners\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n\n                                    <L7p:EncapsulatedAssertionConfigGuid stringValue=\"c8a5a0d5-1ae2-4144-b538-5c311efc1560\"/>\n\n                                    <L7p:EncapsulatedAssertionConfigName stringValue=\"Utility: Call Restman\"/>\n                                    <L7p:Parameters mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"element\"/>\n                                    <L7p:value stringValue=\"\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"message\"/>\n                                    <L7p:value stringValue=\"\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"method\"/>\n                                    <L7p:value stringValue=\"GET\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"resource\"/>\n                                    <L7p:value stringValue=\"emailListeners\"/>\n                                    </L7p:entry>\n                                    </L7p:Parameters>\n                                    </L7p:Encapsulated>\n                                    <L7p:ResponseXpathAssertion>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Obtain list of depender ids\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:VariablePrefix stringValue=\"dependerIds\"/>\n                                    <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                    <L7p:Expression stringValue=\"//l7:EmailListener[l7:Password=$referenceString]/@id\"/>\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"s\"/>\n                                    <L7p:value stringValue=\"http://schemas.xmlsoap.org/soap/envelope/\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_2_0\"/>\n                                    </L7p:XpathExpression>\n                                    </L7p:ResponseXpathAssertion>\n                                    <L7p:Encapsulated>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Want a sorted list of email listeners for the display\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n\n                                    <L7p:EncapsulatedAssertionConfigGuid stringValue=\"33877201-e5e7-4d81-a8d2-34c1250204ec\"/>\n\n                                    <L7p:EncapsulatedAssertionConfigName stringValue=\"Utility: List Email Listeners\"/>\n                                    <L7p:Parameters mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"cacheAge\"/>\n                                    <L7p:value stringValue=\"${cacheAge}\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"refresh\"/>\n                                    <L7p:value stringValue=\"${request.http.parameter.refresh}\"/>\n                                    </L7p:entry>\n                                    </L7p:Parameters>\n                                    </L7p:Encapsulated>\n                                    <L7p:ResponseXpathAssertion>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Extract list of ids to search through\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:VariablePrefix stringValue=\"candidateIds\"/>\n                                    <L7p:XmlMsgSrc stringValue=\"emailListeners.sorted\"/>\n                                    <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                    <L7p:Expression stringValue=\"/EmailListeners/EmailListener/@id\"/>\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                                    </L7p:XpathExpression>\n                                    </L7p:ResponseXpathAssertion>\n                                    <L7p:ForEachLoop\n                                    L7p:Usage=\"Required\"\n                                    loopVariable=\"candidateIds.results\" variablePrefix=\"candidateId\">\n                                    <wsp:OneOrMore wsp:Usage=\"Required\">\n                                    <wsp:All wsp:Usage=\"Required\">\n                                    <L7p:ComparisonAssertion>\n\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n\n                                    <L7p:Expression1 stringValue=\"${dependerIds.results}\"/>\n\n                                    <L7p:Expression2 stringValue=\"${candidateId.current}\"/>\n\n                                    <L7p:MultivaluedComparison multivaluedComparison=\"ANY\"/>\n\n                                    <L7p:Predicates predicates=\"included\">\n\n                                    <L7p:item binary=\"included\">\n\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n\n                                    <L7p:RightValue stringValue=\"${candidateId.current}\"/>\n                                    </L7p:item>\n                                    </L7p:Predicates>\n                                    </L7p:ComparisonAssertion>\n                                    <L7p:ResponseXpathAssertion>\n\n                                    <L7p:AssertionComment assertionComment=\"included\">\n\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"// Get the name\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n\n                                    <L7p:VariablePrefix stringValue=\"name\"/>\n\n                                    <L7p:XmlMsgSrc stringValue=\"emailListeners.sorted\"/>\n\n                                    <L7p:XpathExpression xpathExpressionValue=\"included\">\n\n                                    <L7p:Expression stringValue=\"/EmailListeners/EmailListener[@id=$candidateId.current]/Name\"/>\n\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"s\"/>\n\n                                    <L7p:value stringValue=\"http://schemas.xmlsoap.org/soap/envelope/\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"l7\"/>\n\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_2_0\"/>\n                                    </L7p:XpathExpression>\n                                    </L7p:ResponseXpathAssertion>\n                                    <L7p:ResponseXpathAssertion>\n\n                                    <L7p:AssertionComment assertionComment=\"included\">\n\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"// Get the type\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n\n                                    <L7p:VariablePrefix stringValue=\"type\"/>\n\n                                    <L7p:XmlMsgSrc stringValue=\"emailListeners.sorted\"/>\n\n                                    <L7p:XpathExpression xpathExpressionValue=\"included\">\n\n                                    <L7p:Expression stringValue=\"/EmailListeners/EmailListener[@id=$candidateId.current]/Type\"/>\n\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"s\"/>\n\n                                    <L7p:value stringValue=\"http://schemas.xmlsoap.org/soap/envelope/\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"l7\"/>\n\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_2_0\"/>\n                                    </L7p:XpathExpression>\n                                    </L7p:ResponseXpathAssertion>\n                                    <L7p:SetVariable>\n\n                                    <L7p:Base64Expression stringValue=\"RU1BSUwgTElTVEVORVI6ICR7bmFtZS5yZXN1bHR9ICgke3R5cGUucmVzdWx0fSk=\"/>\n\n                                    <L7p:VariableToSet stringValue=\"depender\"/>\n                                    </L7p:SetVariable>\n                                    <L7p:ManipulateMultiValuedVariable>\n\n                                    <L7p:SourceVariableName stringValue=\"depender\"/>\n\n                                    <L7p:TargetVariableName stringValue=\"dependers.list\"/>\n                                    </L7p:ManipulateMultiValuedVariable>\n                                    <L7p:assertionComment>\n\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"// Check the candidate object is a depender\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:All>\n                                    <L7p:TrueAssertion/>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"// Check the candidate object is a depender, never fail\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:OneOrMore>\n                                    </L7p:ForEachLoop>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Search for references in email listener definitions\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:All>\n                                    <L7p:TrueAssertion/>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Search for references in email listener definitions, never fail\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:OneOrMore>\n                                    <wsp:OneOrMore wsp:Usage=\"Required\">\n                                    <wsp:All wsp:Usage=\"Required\">\n                                    <L7p:AuditDetailAssertion>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// FINE\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:Detail stringValue=\"==> Searching HTTP configuration definitions\"/>\n                                    <L7p:Level stringValue=\"FINE\"/>\n                                    </L7p:AuditDetailAssertion>\n                                    <L7p:Encapsulated>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// GET httpConfigurations\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n\n                                    <L7p:EncapsulatedAssertionConfigGuid stringValue=\"c8a5a0d5-1ae2-4144-b538-5c311efc1560\"/>\n\n                                    <L7p:EncapsulatedAssertionConfigName stringValue=\"Utility: Call Restman\"/>\n                                    <L7p:Parameters mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"element\"/>\n                                    <L7p:value stringValue=\"\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"message\"/>\n                                    <L7p:value stringValue=\"\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"method\"/>\n                                    <L7p:value stringValue=\"GET\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"resource\"/>\n                                    <L7p:value stringValue=\"httpConfigurations\"/>\n                                    </L7p:entry>\n                                    </L7p:Parameters>\n                                    </L7p:Encapsulated>\n                                    <wsp:OneOrMore wsp:Usage=\"Required\">\n                                    <wsp:All wsp:Usage=\"Required\">\n                                    <L7p:ResponseXpathAssertion>\n\n                                    <L7p:AssertionComment assertionComment=\"included\">\n\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"// Obtain list of depender ids\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n\n                                    <L7p:VariablePrefix stringValue=\"dependerIds\"/>\n\n                                    <L7p:XpathExpression xpathExpressionValue=\"included\">\n\n                                    <L7p:Expression stringValue=\"//l7:HttpConfiguration[l7:PasswordId=$id.current]/@id\"/>\n\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"s\"/>\n\n                                    <L7p:value stringValue=\"http://schemas.xmlsoap.org/soap/envelope/\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"l7\"/>\n\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_2_0\"/>\n                                    </L7p:XpathExpression>\n                                    </L7p:ResponseXpathAssertion>\n                                    <L7p:ManipulateMultiValuedVariable>\n\n                                    <L7p:SourceVariableName stringValue=\"dependerIds.results\"/>\n\n                                    <L7p:TargetVariableName stringValue=\"dependerIds\"/>\n                                    </L7p:ManipulateMultiValuedVariable>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"// Obtain list of depender ids where credential password matches\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:All>\n                                    <L7p:TrueAssertion/>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Obtain list of depender ids where credential password matches, never fail\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:OneOrMore>\n                                    <wsp:OneOrMore wsp:Usage=\"Required\">\n                                    <wsp:All wsp:Usage=\"Required\">\n                                    <L7p:ResponseXpathAssertion>\n\n                                    <L7p:AssertionComment assertionComment=\"included\">\n\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"// Obtain list of depender ids\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n\n                                    <L7p:VariablePrefix stringValue=\"dependerIds\"/>\n\n                                    <L7p:XpathExpression xpathExpressionValue=\"included\">\n\n                                    <L7p:Expression stringValue=\"//l7:HttpConfiguration/l7:ProxyConfiguration[l7:PasswordId=$id.current]/../@id\"/>\n\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"s\"/>\n\n                                    <L7p:value stringValue=\"http://schemas.xmlsoap.org/soap/envelope/\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"l7\"/>\n\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_2_0\"/>\n                                    </L7p:XpathExpression>\n                                    </L7p:ResponseXpathAssertion>\n                                    <L7p:ManipulateMultiValuedVariable>\n\n                                    <L7p:SourceVariableName stringValue=\"dependerIds.results\"/>\n\n                                    <L7p:TargetVariableName stringValue=\"dependerIds\"/>\n                                    </L7p:ManipulateMultiValuedVariable>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"// Obtain list of depender ids where proxy password matches\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:All>\n                                    <L7p:TrueAssertion/>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Obtain list of depender ids where proxy password matches, never fail\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:OneOrMore>\n                                    <L7p:ComparisonAssertion>\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:Expression1 stringValue=\"${dependerIds.length}\"/>\n                                    <L7p:Expression2 stringValue=\"0\"/>\n                                    <L7p:Negate booleanValue=\"true\"/>\n                                    <L7p:Predicates predicates=\"included\">\n                                    <L7p:item binary=\"included\">\n\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:Negated booleanValue=\"true\"/>\n                                    <L7p:RightValue stringValue=\"0\"/>\n                                    </L7p:item>\n                                    </L7p:Predicates>\n                                    </L7p:ComparisonAssertion>\n                                    <L7p:Encapsulated>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Want a sorted list of HTTP configurations for the display\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n\n                                    <L7p:EncapsulatedAssertionConfigGuid stringValue=\"8ad8d013-cb3d-4ab1-b92d-8ad943148b5f\"/>\n\n                                    <L7p:EncapsulatedAssertionConfigName stringValue=\"Utility: List HTTP Configurations\"/>\n                                    <L7p:Parameters mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"cacheAge\"/>\n                                    <L7p:value stringValue=\"${cacheAge}\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"refresh\"/>\n                                    <L7p:value stringValue=\"${request.http.parameter.refresh}\"/>\n                                    </L7p:entry>\n                                    </L7p:Parameters>\n                                    </L7p:Encapsulated>\n                                    <L7p:ResponseXpathAssertion>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Extract list of ids to search through\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:VariablePrefix stringValue=\"candidateIds\"/>\n                                    <L7p:XmlMsgSrc stringValue=\"httpConfigurations.sorted\"/>\n                                    <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                    <L7p:Expression stringValue=\"/HTTPConfigurations/HTTPConfiguration/@id\"/>\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                                    </L7p:XpathExpression>\n                                    </L7p:ResponseXpathAssertion>\n                                    <L7p:ForEachLoop\n                                    L7p:Usage=\"Required\"\n                                    loopVariable=\"candidateIds.results\" variablePrefix=\"candidateId\">\n                                    <wsp:OneOrMore wsp:Usage=\"Required\">\n                                    <wsp:All wsp:Usage=\"Required\">\n                                    <L7p:ComparisonAssertion>\n\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n\n                                    <L7p:Expression1 stringValue=\"${dependerIds}\"/>\n\n                                    <L7p:Expression2 stringValue=\"${candidateId.current}\"/>\n\n                                    <L7p:MultivaluedComparison multivaluedComparison=\"ANY\"/>\n\n                                    <L7p:Predicates predicates=\"included\">\n\n                                    <L7p:item binary=\"included\">\n\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n\n                                    <L7p:RightValue stringValue=\"${candidateId.current}\"/>\n                                    </L7p:item>\n                                    </L7p:Predicates>\n                                    </L7p:ComparisonAssertion>\n                                    <L7p:ResponseXpathAssertion>\n\n                                    <L7p:AssertionComment assertionComment=\"included\">\n\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"// Get the name\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n\n                                    <L7p:VariablePrefix stringValue=\"host\"/>\n\n                                    <L7p:XmlMsgSrc stringValue=\"httpConfigurations.sorted\"/>\n\n                                    <L7p:XpathExpression xpathExpressionValue=\"included\">\n\n                                    <L7p:Expression stringValue=\"/HTTPConfigurations/HTTPConfiguration[@id=$candidateId.current]/Host\"/>\n\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"s\"/>\n\n                                    <L7p:value stringValue=\"http://schemas.xmlsoap.org/soap/envelope/\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"l7\"/>\n\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_2_0\"/>\n                                    </L7p:XpathExpression>\n                                    </L7p:ResponseXpathAssertion>\n                                    <L7p:SetVariable>\n\n                                    <L7p:Base64Expression stringValue=\"SFRUUCBDT05GSUdVUkFUSU9OOiAke2hvc3QucmVzdWx0fQ==\"/>\n\n                                    <L7p:VariableToSet stringValue=\"depender\"/>\n                                    </L7p:SetVariable>\n                                    <L7p:ManipulateMultiValuedVariable>\n\n                                    <L7p:SourceVariableName stringValue=\"depender\"/>\n\n                                    <L7p:TargetVariableName stringValue=\"dependers.list\"/>\n                                    </L7p:ManipulateMultiValuedVariable>\n                                    <L7p:assertionComment>\n\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"// Check the candidate object is a depender\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:All>\n                                    <L7p:TrueAssertion/>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"// Check the candidate object is a depender, never fail\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:OneOrMore>\n                                    </L7p:ForEachLoop>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Search for references in HTTP configuration definitions\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:All>\n                                    <L7p:TrueAssertion/>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Search for references in HTTP configuration definitions, never fail\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:OneOrMore>\n                                    <wsp:OneOrMore wsp:Usage=\"Required\">\n                                    <wsp:All wsp:Usage=\"Required\">\n                                    <L7p:AuditDetailAssertion>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// FINE\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:Detail stringValue=\"==> Searching active connector definitions\"/>\n                                    <L7p:Level stringValue=\"FINE\"/>\n                                    </L7p:AuditDetailAssertion>\n                                    <L7p:Encapsulated>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// GET activeConnectors\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n\n                                    <L7p:EncapsulatedAssertionConfigGuid stringValue=\"c8a5a0d5-1ae2-4144-b538-5c311efc1560\"/>\n\n                                    <L7p:EncapsulatedAssertionConfigName stringValue=\"Utility: Call Restman\"/>\n                                    <L7p:Parameters mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"element\"/>\n                                    <L7p:value stringValue=\"\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"message\"/>\n                                    <L7p:value stringValue=\"\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"method\"/>\n                                    <L7p:value stringValue=\"GET\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"resource\"/>\n                                    <L7p:value stringValue=\"activeConnectors\"/>\n                                    </L7p:entry>\n                                    </L7p:Parameters>\n                                    </L7p:Encapsulated>\n                                    <L7p:ResponseXpathAssertion>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Obtain list of depender ids\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:VariablePrefix stringValue=\"dependerIds\"/>\n                                    <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                    <L7p:Expression stringValue=\"//l7:ActiveConnector/l7:Properties/l7:Property[(@key='MqNativeSecurePasswordOid' or @key='SftpSecurePasswordOid' or @key='SftpSecurePasswordKeyOid') and l7:StringValue=$id.current]/../../@id\"/>\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"s\"/>\n                                    <L7p:value stringValue=\"http://schemas.xmlsoap.org/soap/envelope/\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_2_0\"/>\n                                    </L7p:XpathExpression>\n                                    </L7p:ResponseXpathAssertion>\n                                    <L7p:Encapsulated>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Want a sorted list of active connectors for the display\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n\n                                    <L7p:EncapsulatedAssertionConfigGuid stringValue=\"48b49f89-16fe-4b7a-bb66-02d86ad236d8\"/>\n\n                                    <L7p:EncapsulatedAssertionConfigName stringValue=\"Utility: List Active Connectors\"/>\n                                    <L7p:Parameters mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"cacheAge\"/>\n                                    <L7p:value stringValue=\"${cacheAge}\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"refresh\"/>\n                                    <L7p:value stringValue=\"${request.http.parameter.refresh}\"/>\n                                    </L7p:entry>\n                                    </L7p:Parameters>\n                                    </L7p:Encapsulated>\n                                    <L7p:ResponseXpathAssertion>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Extract list of ids to search through\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:VariablePrefix stringValue=\"candidateIds\"/>\n                                    <L7p:XmlMsgSrc stringValue=\"activeConnectors.sorted\"/>\n                                    <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                    <L7p:Expression stringValue=\"/ActiveConnectors/ActiveConnector/@id\"/>\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                                    </L7p:XpathExpression>\n                                    </L7p:ResponseXpathAssertion>\n                                    <L7p:ForEachLoop\n                                    L7p:Usage=\"Required\"\n                                    loopVariable=\"candidateIds.results\" variablePrefix=\"candidateId\">\n                                    <wsp:OneOrMore wsp:Usage=\"Required\">\n                                    <wsp:All wsp:Usage=\"Required\">\n                                    <L7p:ComparisonAssertion>\n\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n\n                                    <L7p:Expression1 stringValue=\"${dependerIds.results}\"/>\n\n                                    <L7p:Expression2 stringValue=\"${candidateId.current}\"/>\n\n                                    <L7p:MultivaluedComparison multivaluedComparison=\"ANY\"/>\n\n                                    <L7p:Predicates predicates=\"included\">\n\n                                    <L7p:item binary=\"included\">\n\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n\n                                    <L7p:RightValue stringValue=\"${candidateId.current}\"/>\n                                    </L7p:item>\n                                    </L7p:Predicates>\n                                    </L7p:ComparisonAssertion>\n                                    <L7p:ResponseXpathAssertion>\n\n                                    <L7p:AssertionComment assertionComment=\"included\">\n\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"// Get the name\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n\n                                    <L7p:VariablePrefix stringValue=\"name\"/>\n\n                                    <L7p:XmlMsgSrc stringValue=\"activeConnectors.sorted\"/>\n\n                                    <L7p:XpathExpression xpathExpressionValue=\"included\">\n\n                                    <L7p:Expression stringValue=\"/ActiveConnectors/ActiveConnector[@id=$candidateId.current]/Name\"/>\n\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"s\"/>\n\n                                    <L7p:value stringValue=\"http://schemas.xmlsoap.org/soap/envelope/\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"l7\"/>\n\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_2_0\"/>\n                                    </L7p:XpathExpression>\n                                    </L7p:ResponseXpathAssertion>\n                                    <L7p:ResponseXpathAssertion>\n\n                                    <L7p:AssertionComment assertionComment=\"included\">\n\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"// Get the type\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n\n                                    <L7p:VariablePrefix stringValue=\"type\"/>\n\n                                    <L7p:XmlMsgSrc stringValue=\"activeConnectors.sorted\"/>\n\n                                    <L7p:XpathExpression xpathExpressionValue=\"included\">\n\n                                    <L7p:Expression stringValue=\"/ActiveConnectors/ActiveConnector[@id=$candidateId.current]/Type\"/>\n\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"s\"/>\n\n                                    <L7p:value stringValue=\"http://schemas.xmlsoap.org/soap/envelope/\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"l7\"/>\n\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_2_0\"/>\n                                    </L7p:XpathExpression>\n                                    </L7p:ResponseXpathAssertion>\n                                    <L7p:SetVariable>\n\n                                    <L7p:Base64Expression stringValue=\"QUNUSVZFIENPTk5FQ1RPUjogJHtuYW1lLnJlc3VsdH0gKCR7dHlwZS5yZXN1bHR9KQ==\"/>\n\n                                    <L7p:VariableToSet stringValue=\"depender\"/>\n                                    </L7p:SetVariable>\n                                    <L7p:ManipulateMultiValuedVariable>\n\n                                    <L7p:SourceVariableName stringValue=\"depender\"/>\n\n                                    <L7p:TargetVariableName stringValue=\"dependers.list\"/>\n                                    </L7p:ManipulateMultiValuedVariable>\n                                    <L7p:assertionComment>\n\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"// Check the candidate object is a depender\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:All>\n                                    <L7p:TrueAssertion/>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"// Check the candidate object is a depender, never fail\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:OneOrMore>\n                                    </L7p:ForEachLoop>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Search for references in active connector definitions\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:All>\n                                    <L7p:TrueAssertion/>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Search for references in active connector definitions, never fail\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:OneOrMore>\n                                    <wsp:OneOrMore wsp:Usage=\"Required\">\n                                    <wsp:All wsp:Usage=\"Required\">\n                                    <L7p:AuditDetailAssertion>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// FINE\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:Detail stringValue=\"==> Searching JDBC Connections definitions\"/>\n                                    <L7p:Level stringValue=\"FINE\"/>\n                                    </L7p:AuditDetailAssertion>\n                                    <L7p:Encapsulated>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// GET jdbcConnections\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n\n                                    <L7p:EncapsulatedAssertionConfigGuid stringValue=\"c8a5a0d5-1ae2-4144-b538-5c311efc1560\"/>\n\n                                    <L7p:EncapsulatedAssertionConfigName stringValue=\"Utility: Call Restman\"/>\n                                    <L7p:Parameters mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"element\"/>\n                                    <L7p:value stringValue=\"\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"message\"/>\n                                    <L7p:value stringValue=\"\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"method\"/>\n                                    <L7p:value stringValue=\"GET\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"resource\"/>\n                                    <L7p:value stringValue=\"jdbcConnections\"/>\n                                    </L7p:entry>\n                                    </L7p:Parameters>\n                                    </L7p:Encapsulated>\n                                    <L7p:ResponseXpathAssertion>\n                                    <L7p:VariablePrefix stringValue=\"dependerIds\"/>\n                                    <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                    <L7p:Expression stringValue=\"//l7:JDBCConnection/l7:Extension/l7:ConnectionProperties//l7:Property[@key='password' and l7:StringValue=$referenceString]/../../../@id\"/>\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"s\"/>\n                                    <L7p:value stringValue=\"http://schemas.xmlsoap.org/soap/envelope/\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_2_0\"/>\n                                    </L7p:XpathExpression>\n                                    </L7p:ResponseXpathAssertion>\n                                    <L7p:Encapsulated>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Want a sorted list of JDBC connections for the display\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n\n                                    <L7p:EncapsulatedAssertionConfigGuid stringValue=\"f8abecfe-11d6-44e4-be07-16e6080a7e5e\"/>\n\n                                    <L7p:EncapsulatedAssertionConfigName stringValue=\"Utility: List JDBC Connections\"/>\n                                    <L7p:Parameters mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"cacheAge\"/>\n                                    <L7p:value stringValue=\"${cacheAge}\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"refresh\"/>\n                                    <L7p:value stringValue=\"${request.http.parameter.refresh}\"/>\n                                    </L7p:entry>\n                                    </L7p:Parameters>\n                                    </L7p:Encapsulated>\n                                    <L7p:ResponseXpathAssertion>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Extract list of ids to search through\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:VariablePrefix stringValue=\"candidateIds\"/>\n                                    <L7p:XmlMsgSrc stringValue=\"jdbcConnections.sorted\"/>\n                                    <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                    <L7p:Expression stringValue=\"/JDBCConnections/JDBCConnection/@id\"/>\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                                    </L7p:XpathExpression>\n                                    </L7p:ResponseXpathAssertion>\n                                    <L7p:ForEachLoop\n                                    L7p:Usage=\"Required\"\n                                    loopVariable=\"candidateIds.results\" variablePrefix=\"candidateId\">\n                                    <wsp:OneOrMore wsp:Usage=\"Required\">\n                                    <wsp:All wsp:Usage=\"Required\">\n                                    <L7p:ComparisonAssertion>\n\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n\n                                    <L7p:Expression1 stringValue=\"${dependerIds.results}\"/>\n\n                                    <L7p:Expression2 stringValue=\"${candidateId.current}\"/>\n\n                                    <L7p:MultivaluedComparison multivaluedComparison=\"ANY\"/>\n\n                                    <L7p:Predicates predicates=\"included\">\n\n                                    <L7p:item binary=\"included\">\n\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n\n                                    <L7p:RightValue stringValue=\"${candidateId.current}\"/>\n                                    </L7p:item>\n                                    </L7p:Predicates>\n                                    </L7p:ComparisonAssertion>\n                                    <L7p:ResponseXpathAssertion>\n\n                                    <L7p:AssertionComment assertionComment=\"included\">\n\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"// Get the name\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n\n                                    <L7p:VariablePrefix stringValue=\"name\"/>\n\n                                    <L7p:XmlMsgSrc stringValue=\"jdbcConnections.sorted\"/>\n\n                                    <L7p:XpathExpression xpathExpressionValue=\"included\">\n\n                                    <L7p:Expression stringValue=\"/JDBCConnections/JDBCConnection[@id=$candidateId.current]/Name\"/>\n\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"s\"/>\n\n                                    <L7p:value stringValue=\"http://schemas.xmlsoap.org/soap/envelope/\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"l7\"/>\n\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_2_0\"/>\n                                    </L7p:XpathExpression>\n                                    </L7p:ResponseXpathAssertion>\n                                    <L7p:SetVariable>\n\n                                    <L7p:Base64Expression stringValue=\"SkRCQyBDb25uZWN0aW9uOiAke25hbWUucmVzdWx0fQ==\"/>\n\n                                    <L7p:VariableToSet stringValue=\"depender\"/>\n                                    </L7p:SetVariable>\n                                    <L7p:ManipulateMultiValuedVariable>\n\n                                    <L7p:SourceVariableName stringValue=\"depender\"/>\n\n                                    <L7p:TargetVariableName stringValue=\"dependers.list\"/>\n                                    </L7p:ManipulateMultiValuedVariable>\n                                    <L7p:assertionComment>\n\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"// Check the candidate object for the reference\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:All>\n                                    <L7p:TrueAssertion/>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"// Check the candidate object for the reference, never fail\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:OneOrMore>\n                                    </L7p:ForEachLoop>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Search for references in JDBC connection definitions\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:All>\n                                    <L7p:TrueAssertion/>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Search for references in JDBC connection definitions, never fail\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:OneOrMore>\n                                    <wsp:OneOrMore wsp:Usage=\"Required\">\n                                    <wsp:All wsp:Usage=\"Required\">\n                                    <L7p:AuditDetailAssertion>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// FINE\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:Detail stringValue=\"==> Searching cassandra connection definitions\"/>\n                                    <L7p:Level stringValue=\"FINE\"/>\n                                    </L7p:AuditDetailAssertion>\n                                    <L7p:Encapsulated>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// GET cassandraConnections\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n\n                                    <L7p:EncapsulatedAssertionConfigGuid stringValue=\"c8a5a0d5-1ae2-4144-b538-5c311efc1560\"/>\n\n                                    <L7p:EncapsulatedAssertionConfigName stringValue=\"Utility: Call Restman\"/>\n                                    <L7p:Parameters mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"element\"/>\n                                    <L7p:value stringValue=\"\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"message\"/>\n                                    <L7p:value stringValue=\"\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"method\"/>\n                                    <L7p:value stringValue=\"GET\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"resource\"/>\n                                    <L7p:value stringValue=\"cassandraConnections\"/>\n                                    </L7p:entry>\n                                    </L7p:Parameters>\n                                    </L7p:Encapsulated>\n                                    <L7p:ResponseXpathAssertion>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Obtain list of depender ids\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:VariablePrefix stringValue=\"dependerIds\"/>\n                                    <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                    <L7p:Expression stringValue=\"//l7:CassandraConnection[l7:PasswordId=$id.current]/@id\"/>\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"s\"/>\n                                    <L7p:value stringValue=\"http://schemas.xmlsoap.org/soap/envelope/\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_2_0\"/>\n                                    </L7p:XpathExpression>\n                                    </L7p:ResponseXpathAssertion>\n                                    <L7p:Encapsulated>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Want a sorted list of cassandra connections for the display\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n\n                                    <L7p:EncapsulatedAssertionConfigGuid stringValue=\"b55454b6-3095-4e4d-92dc-3f10a6594fba\"/>\n\n                                    <L7p:EncapsulatedAssertionConfigName stringValue=\"Utility: List Cassandra Connections\"/>\n                                    <L7p:Parameters mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"cacheAge\"/>\n                                    <L7p:value stringValue=\"${cacheAge}\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"refresh\"/>\n                                    <L7p:value stringValue=\"${request.http.parameter.refresh}\"/>\n                                    </L7p:entry>\n                                    </L7p:Parameters>\n                                    </L7p:Encapsulated>\n                                    <L7p:ResponseXpathAssertion>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Extract list of ids to search through\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:VariablePrefix stringValue=\"candidateIds\"/>\n                                    <L7p:XmlMsgSrc stringValue=\"cassandraConnections.sorted\"/>\n                                    <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                    <L7p:Expression stringValue=\"/CassandraConnections/CassandraConnection/@id\"/>\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                                    </L7p:XpathExpression>\n                                    </L7p:ResponseXpathAssertion>\n                                    <L7p:ForEachLoop\n                                    L7p:Usage=\"Required\"\n                                    loopVariable=\"candidateIds.results\" variablePrefix=\"candidateId\">\n                                    <wsp:OneOrMore wsp:Usage=\"Required\">\n                                    <wsp:All wsp:Usage=\"Required\">\n                                    <L7p:ComparisonAssertion>\n\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n\n                                    <L7p:Expression1 stringValue=\"${dependerIds.results}\"/>\n\n                                    <L7p:Expression2 stringValue=\"${candidateId.current}\"/>\n\n                                    <L7p:MultivaluedComparison multivaluedComparison=\"ANY\"/>\n\n                                    <L7p:Predicates predicates=\"included\">\n\n                                    <L7p:item binary=\"included\">\n\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n\n                                    <L7p:RightValue stringValue=\"${candidateId.current}\"/>\n                                    </L7p:item>\n                                    </L7p:Predicates>\n                                    </L7p:ComparisonAssertion>\n                                    <L7p:ResponseXpathAssertion>\n\n                                    <L7p:AssertionComment assertionComment=\"included\">\n\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"// Get the name\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n\n                                    <L7p:VariablePrefix stringValue=\"name\"/>\n\n                                    <L7p:XmlMsgSrc stringValue=\"cassandraConnections.sorted\"/>\n\n                                    <L7p:XpathExpression xpathExpressionValue=\"included\">\n\n                                    <L7p:Expression stringValue=\"/CassandraConnections/CassandraConnection[@id=$candidateId.current]/Name\"/>\n\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"s\"/>\n\n                                    <L7p:value stringValue=\"http://schemas.xmlsoap.org/soap/envelope/\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"l7\"/>\n\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_2_0\"/>\n                                    </L7p:XpathExpression>\n                                    </L7p:ResponseXpathAssertion>\n                                    <L7p:SetVariable>\n\n                                    <L7p:Base64Expression stringValue=\"Q0FTU0FORFJBIENPTk5FQ1RJT046ICR7bmFtZS5yZXN1bHR9\"/>\n\n                                    <L7p:VariableToSet stringValue=\"depender\"/>\n                                    </L7p:SetVariable>\n                                    <L7p:ManipulateMultiValuedVariable>\n\n                                    <L7p:SourceVariableName stringValue=\"depender\"/>\n\n                                    <L7p:TargetVariableName stringValue=\"dependers.list\"/>\n                                    </L7p:ManipulateMultiValuedVariable>\n                                    <L7p:assertionComment>\n\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"// Check the candidate object is a depender\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:All>\n                                    <L7p:TrueAssertion/>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"// Check the candidate object is a depender, never fail\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:OneOrMore>\n                                    </L7p:ForEachLoop>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Search for references in cassandra connection definitions\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:All>\n                                    <L7p:TrueAssertion/>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Search for references in cassandra connection definitions, never fail\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:OneOrMore>\n                                    <wsp:OneOrMore wsp:Usage=\"Required\">\n                                    <wsp:All wsp:Usage=\"Required\">\n                                    <L7p:ComparisonAssertion>\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:Expression1 stringValue=\"${dependers.list.length}\"/>\n                                    <L7p:Expression2 stringValue=\"1\"/>\n                                    <L7p:Operator operator=\"GE\"/>\n                                    <L7p:Predicates predicates=\"included\">\n                                    <L7p:item binary=\"included\">\n\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:Operator operator=\"GE\"/>\n                                    <L7p:RightValue stringValue=\"1\"/>\n                                    </L7p:item>\n                                    </L7p:Predicates>\n                                    </L7p:ComparisonAssertion>\n                                    <L7p:ForEachLoop\n                                    L7p:Usage=\"Required\"\n                                    loopVariable=\"dependers.list\" variablePrefix=\"depender\">\n                                    <L7p:SetVariable>\n\n                                    <L7p:Base64Expression stringValue=\"JHtkZXBlbmRlcnMuaHRtbH0NCiAgPGxpPiR7ZGVwZW5kZXIuY3VycmVudH08L2xpPg==\"/>\n                                    <L7p:VariableToSet stringValue=\"dependers.html\"/>\n                                    </L7p:SetVariable>\n                                    </L7p:ForEachLoop>\n                                    <L7p:SetVariable>\n                                    <L7p:Base64Expression stringValue=\"JHtodG1sQ29udGVudH0NCg0KPHA+VGhlIGZvbGxvd2luZyBvYmplY3RzIHJlZmVyZW5jZSB0aGlzIHNlY3VyZSBwYXNzd29yZDo8L3A+DQo8dWw+JHtkZXBlbmRlcnMuaHRtbH08L3VsPg==\"/>\n                                    <L7p:VariableToSet stringValue=\"htmlContent\"/>\n                                    </L7p:SetVariable>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// ${dependers.list} has content\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:All>\n                                    <L7p:SetVariable>\n                                    <L7p:Base64Expression stringValue=\"JHtodG1sQ29udGVudH0NCjxwPk5vdGhpbmcgd2FzIGZvdW5kIHRoYXQgcmVmZXJlbmNlcyB0aGlzIHNlY3VyZSBwYXNzd29yZDwvcD4=\"/>\n                                    <L7p:VariableToSet stringValue=\"htmlContent\"/>\n                                    </L7p:SetVariable>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Append ${dependers.html} to ${htmlContent} if ${dependers.list} has any entries\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:OneOrMore>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// ${id} matches so retrieve dependers\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                </wsp:All>\n                                <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Do reverse dependency search if id matches\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:assertionComment>\n                            </wsp:OneOrMore>\n                            <L7p:assertionComment>\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Cycle through each object to add to display and check if search must be run\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:assertionComment>\n                        </L7p:ForEachLoop>\n                        <L7p:assertionComment>\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// ${objectType} == &quot;Secure Password&quot;\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:assertionComment>\n                    </wsp:All>\n                    <wsp:All wsp:Usage=\"Required\">\n                        <L7p:ComparisonAssertion>\n                            <L7p:CaseSensitive booleanValue=\"false\"/>\n                            <L7p:Expression1 stringValue=\"${objectType}\"/>\n                            <L7p:Expression2 stringValue=\"Service\"/>\n                            <L7p:Predicates predicates=\"included\">\n                                <L7p:item binary=\"included\">\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:RightValue stringValue=\"Service\"/>\n                                </L7p:item>\n                            </L7p:Predicates>\n                        </L7p:ComparisonAssertion>\n                        <L7p:AuditDetailAssertion>\n                            <L7p:AssertionComment assertionComment=\"included\">\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// FINE\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:AssertionComment>\n                            <L7p:Detail stringValue=\"======> Listing ${objectType} objects\"/>\n                            <L7p:Level stringValue=\"FINE\"/>\n                        </L7p:AuditDetailAssertion>\n                        <L7p:CommentAssertion>\n                            <L7p:Comment stringValue=\"* Note: ${services.sorted} was set earlier, so don't call Utility: List Services here\"/>\n                        </L7p:CommentAssertion>\n                        <L7p:ResponseXpathAssertion>\n                            <L7p:AssertionComment assertionComment=\"included\">\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Get list of ids\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:AssertionComment>\n                            <L7p:VariablePrefix stringValue=\"ids\"/>\n                            <L7p:XmlMsgSrc stringValue=\"services.sorted\"/>\n                            <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                <L7p:Expression stringValue=\"/Services/Service/@id\"/>\n                                <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"s\"/>\n                                    <L7p:value stringValue=\"http://schemas.xmlsoap.org/soap/envelope/\"/>\n                                    </L7p:entry>\n                                </L7p:Namespaces>\n                                <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                            </L7p:XpathExpression>\n                        </L7p:ResponseXpathAssertion>\n                        <L7p:ForEachLoop L7p:Usage=\"Required\"\n                            loopVariable=\"ids.results\" variablePrefix=\"id\">\n                            <L7p:ResponseXpathAssertion>\n                                <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Get name of the object for display\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:AssertionComment>\n                                <L7p:VariablePrefix stringValue=\"name\"/>\n                                <L7p:XmlMsgSrc stringValue=\"services.sorted\"/>\n                                <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                    <L7p:Expression stringValue=\"/Services/Service[@id=$id.current]/Name\"/>\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"s\"/>\n                                    <L7p:value stringValue=\"http://schemas.xmlsoap.org/soap/envelope/\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                                </L7p:XpathExpression>\n                            </L7p:ResponseXpathAssertion>\n                            <L7p:ResponseXpathAssertion>\n                                <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Get folderPath of the object to display\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:AssertionComment>\n                                <L7p:VariablePrefix stringValue=\"folderPath\"/>\n                                <L7p:XmlMsgSrc stringValue=\"services.sorted\"/>\n                                <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                    <L7p:Expression stringValue=\"/Services/Service[@id=$id.current]/FolderPath\"/>\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"s\"/>\n                                    <L7p:value stringValue=\"http://schemas.xmlsoap.org/soap/envelope/\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                                </L7p:XpathExpression>\n                            </L7p:ResponseXpathAssertion>\n                            <L7p:AuditDetailAssertion>\n                                <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// FINE\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:AssertionComment>\n                                <L7p:Detail stringValue=\"=====> Processing ${objectType}: ${name.result} (${id.current})\"/>\n                                <L7p:Level stringValue=\"FINE\"/>\n                            </L7p:AuditDetailAssertion>\n                            <L7p:Encapsulated>\n                                <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// name.result\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:AssertionComment>\n                                <L7p:EncapsulatedAssertionConfigGuid stringValue=\"f6b19229-a705-4c48-bc78-3975564a1a9a\"/>\n                                <L7p:EncapsulatedAssertionConfigName stringValue=\"Utility: Escape HTML String\"/>\n                                <L7p:Parameters mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"escapedString\"/>\n                                    <L7p:value stringValue=\"${name.result}\"/>\n                                    </L7p:entry>\n                                </L7p:Parameters>\n                            </L7p:Encapsulated>\n                            <L7p:SetVariable>\n                                <L7p:Base64Expression stringValue=\"JHtlc2NhcGVkU3RyaW5nfQ==\"/>\n                                <L7p:VariableToSet stringValue=\"name\"/>\n                            </L7p:SetVariable>\n                            <L7p:Encapsulated>\n                                <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// folderPath.result\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:AssertionComment>\n                                <L7p:EncapsulatedAssertionConfigGuid stringValue=\"f6b19229-a705-4c48-bc78-3975564a1a9a\"/>\n                                <L7p:EncapsulatedAssertionConfigName stringValue=\"Utility: Escape HTML String\"/>\n                                <L7p:Parameters mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"escapedString\"/>\n                                    <L7p:value stringValue=\"${folderPath.result}\"/>\n                                    </L7p:entry>\n                                </L7p:Parameters>\n                            </L7p:Encapsulated>\n                            <L7p:SetVariable>\n                                <L7p:Base64Expression stringValue=\"JHtodG1sQ29udGVudH0NCjxhIGlkPSIke2lkLmN1cnJlbnR9Ii8+PGEgaHJlZj0iJHtyZXF1ZXN0LnVybC5wYXRofT9vYmplY3RUeXBlPSR7b2JqZWN0VHlwZX0maWQ9JHtpZC5jdXJyZW50fSMke2lkLmN1cnJlbnR9IiBvbkNsaWNrPSJzZXRSZWZyZXNoKHRoaXMpIj4ke2VzY2FwZWRTdHJpbmd9JHtuYW1lfTwvYT48YnIvPg==\"/>\n                                <L7p:VariableToSet stringValue=\"htmlContent\"/>\n                            </L7p:SetVariable>\n                            <wsp:OneOrMore wsp:Usage=\"Required\">\n                                <L7p:ComparisonAssertion>\n                                    <L7p:Expression1 stringValue=\"${id}\"/>\n                                    <L7p:Expression2 stringValue=\"${id.current}\"/>\n                                    <L7p:Negate booleanValue=\"true\"/>\n                                    <L7p:Predicates predicates=\"included\">\n                                    <L7p:item binary=\"included\">\n                                    <L7p:Negated booleanValue=\"true\"/>\n                                    <L7p:RightValue stringValue=\"${id.current}\"/>\n                                    </L7p:item>\n                                    </L7p:Predicates>\n                                </L7p:ComparisonAssertion>\n                                <wsp:All wsp:Usage=\"Required\">\n                                    <L7p:AuditDetailAssertion>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// FINE\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:Detail stringValue=\"====> ID matched, processing for dependencies\"/>\n                                    <L7p:Level stringValue=\"FINE\"/>\n                                    </L7p:AuditDetailAssertion>\n                                    <L7p:SetVariable>\n                                    <L7p:Base64Expression stringValue=\"JHtpZC5jdXJyZW50fQ==\"/>\n                                    <L7p:VariableToSet stringValue=\"referenceString\"/>\n                                    </L7p:SetVariable>\n                                    <L7p:AuditDetailAssertion>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// FINE\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:Detail stringValue=\"===> Searching objects for references to ${referenceString}\"/>\n                                    <L7p:Level stringValue=\"FINE\"/>\n                                    </L7p:AuditDetailAssertion>\n                                    <wsp:OneOrMore wsp:Usage=\"Required\">\n                                    <wsp:All wsp:Usage=\"Required\">\n                                    <L7p:AuditDetailAssertion>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// FINE\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:Detail stringValue=\"==> Searching listen port definitions\"/>\n                                    <L7p:Level stringValue=\"FINE\"/>\n                                    </L7p:AuditDetailAssertion>\n                                    <L7p:Encapsulated>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// GET listenPorts\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n\n                                    <L7p:EncapsulatedAssertionConfigGuid stringValue=\"c8a5a0d5-1ae2-4144-b538-5c311efc1560\"/>\n\n                                    <L7p:EncapsulatedAssertionConfigName stringValue=\"Utility: Call Restman\"/>\n                                    <L7p:Parameters mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"element\"/>\n                                    <L7p:value stringValue=\"\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"message\"/>\n                                    <L7p:value stringValue=\"\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"method\"/>\n                                    <L7p:value stringValue=\"GET\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"resource\"/>\n                                    <L7p:value stringValue=\"listenPorts\"/>\n                                    </L7p:entry>\n                                    </L7p:Parameters>\n                                    </L7p:Encapsulated>\n                                    <L7p:ResponseXpathAssertion>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Get list of listen ports that link to this service\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:VariablePrefix stringValue=\"dependers\"/>\n                                    <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                    <L7p:Expression stringValue=\"/l7:List/l7:Item/l7:Resource/l7:ListenPort/l7:TargetServiceReference[@id=$referenceString]/../@id\"/>\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                                    </L7p:XpathExpression>\n                                    </L7p:ResponseXpathAssertion>\n                                    <L7p:Encapsulated>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Get sorted list of listen ports\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n\n                                    <L7p:EncapsulatedAssertionConfigGuid stringValue=\"9bee9837-82a1-4aab-99f4-08b664773ad7\"/>\n\n                                    <L7p:EncapsulatedAssertionConfigName stringValue=\"Utility: List Listen Ports\"/>\n                                    <L7p:Parameters mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"cacheAge\"/>\n                                    <L7p:value stringValue=\"${cacheAge}\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"refresh\"/>\n                                    <L7p:value stringValue=\"${request.http.parameter.refresh}\"/>\n                                    </L7p:entry>\n                                    </L7p:Parameters>\n                                    </L7p:Encapsulated>\n                                    <L7p:ForEachLoop\n                                    L7p:Usage=\"Required\"\n                                    loopVariable=\"dependers.results\" variablePrefix=\"depender\">\n                                    <L7p:ResponseXpathAssertion>\n\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"// Get listen port name\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:VariablePrefix stringValue=\"name\"/>\n                                    <L7p:XmlMsgSrc stringValue=\"listenPorts.sorted\"/>\n                                    <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                    <L7p:Expression stringValue=\"/ListenPorts/ListenPort[@id=$depender.current]/Name\"/>\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                                    </L7p:XpathExpression>\n                                    </L7p:ResponseXpathAssertion>\n                                    <L7p:ResponseXpathAssertion>\n\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"// Get listen port protocol\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:VariablePrefix stringValue=\"protocol\"/>\n                                    <L7p:XmlMsgSrc stringValue=\"listenPorts.sorted\"/>\n                                    <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                    <L7p:Expression stringValue=\"/ListenPorts/ListenPort[@id=$depender.current]/Protocol\"/>\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                                    </L7p:XpathExpression>\n                                    </L7p:ResponseXpathAssertion>\n                                    <L7p:ResponseXpathAssertion>\n\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"// Get listen port port\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:VariablePrefix stringValue=\"port\"/>\n                                    <L7p:XmlMsgSrc stringValue=\"listenPorts.sorted\"/>\n                                    <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                    <L7p:Expression stringValue=\"/ListenPorts/ListenPort[@id=$depender.current]/Port\"/>\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                                    </L7p:XpathExpression>\n                                    </L7p:ResponseXpathAssertion>\n                                    <L7p:SetVariable>\n\n                                    <L7p:Base64Expression stringValue=\"TElTVEVOIFBPUlQ6ICR7bmFtZS5yZXN1bHR9ICgke3Byb3RvY29sLnJlc3VsdH0gb24gcG9ydCAke3BvcnQucmVzdWx0fSk=\"/>\n                                    <L7p:VariableToSet stringValue=\"depender\"/>\n                                    </L7p:SetVariable>\n                                    <L7p:ManipulateMultiValuedVariable>\n\n                                    <L7p:SourceVariableName stringValue=\"depender\"/>\n\n                                    <L7p:TargetVariableName stringValue=\"dependers.list\"/>\n                                    </L7p:ManipulateMultiValuedVariable>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Add each one to ${dependers.list}\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </L7p:ForEachLoop>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Search for references in listen port definitions\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:All>\n                                    <L7p:TrueAssertion/>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Search for references in listen port definitions, never fail\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:OneOrMore>\n                                    <wsp:OneOrMore wsp:Usage=\"Required\">\n                                    <wsp:All wsp:Usage=\"Required\">\n                                    <L7p:AuditDetailAssertion>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// FINE\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:Detail stringValue=\"==> Searching JMS destination definitions\"/>\n                                    <L7p:Level stringValue=\"FINE\"/>\n                                    </L7p:AuditDetailAssertion>\n                                    <L7p:Encapsulated>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// GET jmsDestinations\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n\n                                    <L7p:EncapsulatedAssertionConfigGuid stringValue=\"c8a5a0d5-1ae2-4144-b538-5c311efc1560\"/>\n\n                                    <L7p:EncapsulatedAssertionConfigName stringValue=\"Utility: Call Restman\"/>\n                                    <L7p:Parameters mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"element\"/>\n                                    <L7p:value stringValue=\"\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"message\"/>\n                                    <L7p:value stringValue=\"\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"method\"/>\n                                    <L7p:value stringValue=\"GET\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"resource\"/>\n                                    <L7p:value stringValue=\"jmsDestinations\"/>\n                                    </L7p:entry>\n                                    </L7p:Parameters>\n                                    </L7p:Encapsulated>\n                                    <L7p:ResponseXpathAssertion>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Get list of JMS destinations that link to this service\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:VariablePrefix stringValue=\"dependers\"/>\n                                    <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                    <L7p:Expression stringValue=\"/l7:List/l7:Item/l7:Resource/l7:JMSDestination/l7:JMSConnection/l7:ContextPropertiesTemplate/l7:Property[@key='com.l7tech.server.jms.prop.hardwired.service.id' and l7:StringValue=$referenceString]/../../../@id\"/>\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                                    </L7p:XpathExpression>\n                                    </L7p:ResponseXpathAssertion>\n                                    <L7p:Encapsulated>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Get sorted list of JMS destinations\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n\n                                    <L7p:EncapsulatedAssertionConfigGuid stringValue=\"53bc61d8-f0d0-4024-b09c-61fd5c9ef33e\"/>\n\n                                    <L7p:EncapsulatedAssertionConfigName stringValue=\"Utility: List JMS Destinations\"/>\n                                    <L7p:Parameters mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"cacheAge\"/>\n                                    <L7p:value stringValue=\"${cacheAge}\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"refresh\"/>\n                                    <L7p:value stringValue=\"${request.http.parameter.refresh}\"/>\n                                    </L7p:entry>\n                                    </L7p:Parameters>\n                                    </L7p:Encapsulated>\n                                    <L7p:ForEachLoop\n                                    L7p:Usage=\"Required\"\n                                    loopVariable=\"dependers.results\" variablePrefix=\"depender\">\n                                    <L7p:ResponseXpathAssertion>\n\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"// Get JMS destination name\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:VariablePrefix stringValue=\"name\"/>\n                                    <L7p:XmlMsgSrc stringValue=\"jmsDestinations.sorted\"/>\n                                    <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                    <L7p:Expression stringValue=\"/JMSDestinations/JMSDestination[@id=$depender.current]/Name\"/>\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                                    </L7p:XpathExpression>\n                                    </L7p:ResponseXpathAssertion>\n                                    <L7p:ResponseXpathAssertion>\n\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"// Get JMS destination type\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:VariablePrefix stringValue=\"type\"/>\n                                    <L7p:XmlMsgSrc stringValue=\"jmsDestinations.sorted\"/>\n                                    <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                    <L7p:Expression stringValue=\"/JMSDestinations/JMSDestination[@id=$depender.current]/Type\"/>\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                                    </L7p:XpathExpression>\n                                    </L7p:ResponseXpathAssertion>\n                                    <L7p:ResponseXpathAssertion>\n\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"// Get JMS destination direction\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:VariablePrefix stringValue=\"direction\"/>\n                                    <L7p:XmlMsgSrc stringValue=\"jmsDestinations.sorted\"/>\n                                    <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                    <L7p:Expression stringValue=\"/JMSDestinations/JMSDestination[@id=$depender.current]/Direction\"/>\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                                    </L7p:XpathExpression>\n                                    </L7p:ResponseXpathAssertion>\n                                    <L7p:SetVariable>\n\n                                    <L7p:Base64Expression stringValue=\"Sk1TIERFU1RJTkFUSU9OOiAke25hbWUucmVzdWx0fSAoJHtkaXJlY3Rpb24ucmVzdWx0fSAke3R5cGUucmVzdWx0fSk=\"/>\n                                    <L7p:VariableToSet stringValue=\"depender\"/>\n                                    </L7p:SetVariable>\n                                    <L7p:ManipulateMultiValuedVariable>\n\n                                    <L7p:SourceVariableName stringValue=\"depender\"/>\n\n                                    <L7p:TargetVariableName stringValue=\"dependers.list\"/>\n                                    </L7p:ManipulateMultiValuedVariable>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Add each one to ${dependers.list}\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </L7p:ForEachLoop>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Search for references in JMS destination definitions\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:All>\n                                    <L7p:TrueAssertion/>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Search for references in JMS destination definitions, never fail\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:OneOrMore>\n                                    <wsp:OneOrMore wsp:Usage=\"Required\">\n                                    <wsp:All wsp:Usage=\"Required\">\n                                    <L7p:AuditDetailAssertion>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// FINE\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:Detail stringValue=\"==> Searching email listener definitions\"/>\n                                    <L7p:Level stringValue=\"FINE\"/>\n                                    </L7p:AuditDetailAssertion>\n                                    <L7p:Encapsulated>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// GET emailListeners\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n\n                                    <L7p:EncapsulatedAssertionConfigGuid stringValue=\"c8a5a0d5-1ae2-4144-b538-5c311efc1560\"/>\n\n                                    <L7p:EncapsulatedAssertionConfigName stringValue=\"Utility: Call Restman\"/>\n                                    <L7p:Parameters mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"element\"/>\n                                    <L7p:value stringValue=\"\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"message\"/>\n                                    <L7p:value stringValue=\"\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"method\"/>\n                                    <L7p:value stringValue=\"GET\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"resource\"/>\n                                    <L7p:value stringValue=\"emailListeners\"/>\n                                    </L7p:entry>\n                                    </L7p:Parameters>\n                                    </L7p:Encapsulated>\n                                    <L7p:ResponseXpathAssertion>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Get list of JMS destinations that link to this service\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:VariablePrefix stringValue=\"dependers\"/>\n                                    <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                    <L7p:Expression stringValue=\"/l7:List/l7:Item/l7:Resource/l7:EmailListener/l7:Properties/l7:Property[@key='com.l7tech.server.jms.prop.hardwired.service.id' and l7:StringValue=$referenceString]/../../@id\"/>\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                                    </L7p:XpathExpression>\n                                    </L7p:ResponseXpathAssertion>\n                                    <L7p:Encapsulated>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Get sorted list of email listeners\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n\n                                    <L7p:EncapsulatedAssertionConfigGuid stringValue=\"33877201-e5e7-4d81-a8d2-34c1250204ec\"/>\n\n                                    <L7p:EncapsulatedAssertionConfigName stringValue=\"Utility: List Email Listeners\"/>\n                                    <L7p:Parameters mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"cacheAge\"/>\n                                    <L7p:value stringValue=\"${cacheAge}\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"refresh\"/>\n                                    <L7p:value stringValue=\"${request.http.parameter.refresh}\"/>\n                                    </L7p:entry>\n                                    </L7p:Parameters>\n                                    </L7p:Encapsulated>\n                                    <L7p:ForEachLoop\n                                    L7p:Usage=\"Required\"\n                                    loopVariable=\"dependers.results\" variablePrefix=\"depender\">\n                                    <L7p:ResponseXpathAssertion>\n\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"// Get email listener name\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:VariablePrefix stringValue=\"name\"/>\n                                    <L7p:XmlMsgSrc stringValue=\"emailListeners.sorted\"/>\n                                    <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                    <L7p:Expression stringValue=\"/EmailListeners/EmailListener[@id=$depender.current]/Name\"/>\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                                    </L7p:XpathExpression>\n                                    </L7p:ResponseXpathAssertion>\n                                    <L7p:ResponseXpathAssertion>\n\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"// Get email listener type\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:VariablePrefix stringValue=\"type\"/>\n                                    <L7p:XmlMsgSrc stringValue=\"emailListeners.sorted\"/>\n                                    <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                    <L7p:Expression stringValue=\"/EmailListeners/EmailListener[@id=$depender.current]/Type\"/>\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                                    </L7p:XpathExpression>\n                                    </L7p:ResponseXpathAssertion>\n                                    <L7p:ResponseXpathAssertion>\n\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"// Get email listener hostname\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:VariablePrefix stringValue=\"hostname\"/>\n                                    <L7p:XmlMsgSrc stringValue=\"emailListeners.sorted\"/>\n                                    <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                    <L7p:Expression stringValue=\"/EmailListeners/EmailListener[@id=$depender.current]/Hostname\"/>\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                                    </L7p:XpathExpression>\n                                    </L7p:ResponseXpathAssertion>\n                                    <L7p:SetVariable>\n\n                                    <L7p:Base64Expression stringValue=\"RU1BSUwgTElTVEVORVI6ICR7bmFtZS5yZXN1bHR9ICgke3R5cGUucmVzdWx0fSB0byAke2hvc3RuYW1lLnJlc3VsdH0p\"/>\n                                    <L7p:VariableToSet stringValue=\"depender\"/>\n                                    </L7p:SetVariable>\n                                    <L7p:ManipulateMultiValuedVariable>\n\n                                    <L7p:SourceVariableName stringValue=\"depender\"/>\n\n                                    <L7p:TargetVariableName stringValue=\"dependers.list\"/>\n                                    </L7p:ManipulateMultiValuedVariable>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Add each one to ${dependers.list}\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </L7p:ForEachLoop>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Search for references in email listener definitions\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:All>\n                                    <L7p:TrueAssertion/>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Search for references in email listener definitions, never fail\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:OneOrMore>\n                                    <wsp:OneOrMore wsp:Usage=\"Required\">\n                                    <wsp:All wsp:Usage=\"Required\">\n                                    <L7p:AuditDetailAssertion>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// FINE\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:Detail stringValue=\"==> Searching active connectore definitions\"/>\n                                    <L7p:Level stringValue=\"FINE\"/>\n                                    </L7p:AuditDetailAssertion>\n                                    <L7p:Encapsulated>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// GET activeConnectors\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n\n                                    <L7p:EncapsulatedAssertionConfigGuid stringValue=\"c8a5a0d5-1ae2-4144-b538-5c311efc1560\"/>\n\n                                    <L7p:EncapsulatedAssertionConfigName stringValue=\"Utility: Call Restman\"/>\n                                    <L7p:Parameters mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"element\"/>\n                                    <L7p:value stringValue=\"\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"message\"/>\n                                    <L7p:value stringValue=\"\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"method\"/>\n                                    <L7p:value stringValue=\"GET\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"resource\"/>\n                                    <L7p:value stringValue=\"activeConnectors\"/>\n                                    </L7p:entry>\n                                    </L7p:Parameters>\n                                    </L7p:Encapsulated>\n                                    <L7p:ResponseXpathAssertion>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Get list of active connectors that link to this service\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:VariablePrefix stringValue=\"dependers\"/>\n                                    <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                    <L7p:Expression stringValue=\"/l7:List/l7:Item/l7:Resource/l7:ActiveConnector[l7:HardwiredId=$referenceString]/@id\"/>\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                                    </L7p:XpathExpression>\n                                    </L7p:ResponseXpathAssertion>\n                                    <L7p:Encapsulated>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Get sorted list of active connectors\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n\n                                    <L7p:EncapsulatedAssertionConfigGuid stringValue=\"48b49f89-16fe-4b7a-bb66-02d86ad236d8\"/>\n\n                                    <L7p:EncapsulatedAssertionConfigName stringValue=\"Utility: List Active Connectors\"/>\n                                    <L7p:Parameters mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"cacheAge\"/>\n                                    <L7p:value stringValue=\"${cacheAge}\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"refresh\"/>\n                                    <L7p:value stringValue=\"${request.http.parameter.refresh}\"/>\n                                    </L7p:entry>\n                                    </L7p:Parameters>\n                                    </L7p:Encapsulated>\n                                    <L7p:ForEachLoop\n                                    L7p:Usage=\"Required\"\n                                    loopVariable=\"dependers.results\" variablePrefix=\"depender\">\n                                    <L7p:ResponseXpathAssertion>\n\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"// Get active connector name\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:VariablePrefix stringValue=\"name\"/>\n                                    <L7p:XmlMsgSrc stringValue=\"activeConnectors.sorted\"/>\n                                    <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                    <L7p:Expression stringValue=\"/ActiveConnectors/ActiveConnector[@id=$depender.current]/Name\"/>\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                                    </L7p:XpathExpression>\n                                    </L7p:ResponseXpathAssertion>\n                                    <L7p:ResponseXpathAssertion>\n\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"// Get active connector type\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:VariablePrefix stringValue=\"type\"/>\n                                    <L7p:XmlMsgSrc stringValue=\"activeConnectors.sorted\"/>\n                                    <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                    <L7p:Expression stringValue=\"/ActiveConnectors/ActiveConnector[@id=$depender.current]/Type\"/>\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                                    </L7p:XpathExpression>\n                                    </L7p:ResponseXpathAssertion>\n                                    <L7p:SetVariable>\n\n                                    <L7p:Base64Expression stringValue=\"QUNUSVZFIENPTk5FQ1RPUjogJHtuYW1lLnJlc3VsdH0gKCR7dHlwZS5yZXN1bHR9KQ==\"/>\n                                    <L7p:VariableToSet stringValue=\"depender\"/>\n                                    </L7p:SetVariable>\n                                    <L7p:ManipulateMultiValuedVariable>\n\n                                    <L7p:SourceVariableName stringValue=\"depender\"/>\n\n                                    <L7p:TargetVariableName stringValue=\"dependers.list\"/>\n                                    </L7p:ManipulateMultiValuedVariable>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Add each one to ${dependers.list}\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </L7p:ForEachLoop>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Search for references in active connector definitions\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:All>\n                                    <L7p:TrueAssertion/>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Search for references in active connector definitions, never fail\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:OneOrMore>\n                                    <wsp:OneOrMore wsp:Usage=\"Required\">\n                                    <wsp:All wsp:Usage=\"Required\">\n                                    <L7p:AuditDetailAssertion>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// FINE\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:Detail stringValue=\"==> Searching websocket connection definitions\"/>\n                                    <L7p:Level stringValue=\"FINE\"/>\n                                    </L7p:AuditDetailAssertion>\n                                    <L7p:Encapsulated>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// GET genericEntities\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n\n                                    <L7p:EncapsulatedAssertionConfigGuid stringValue=\"c8a5a0d5-1ae2-4144-b538-5c311efc1560\"/>\n\n                                    <L7p:EncapsulatedAssertionConfigName stringValue=\"Utility: Call Restman\"/>\n                                    <L7p:Parameters mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"element\"/>\n                                    <L7p:value stringValue=\"GenericEntity\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"message\"/>\n                                    <L7p:value stringValue=\"\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"method\"/>\n                                    <L7p:value stringValue=\"GET\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"resource\"/>\n                                    <L7p:value stringValue=\"genericEntities\"/>\n                                    </L7p:entry>\n                                    </L7p:Parameters>\n                                    </L7p:Encapsulated>\n                                    <L7p:Encapsulated>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Want a sorted list of generic entities for the display\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n\n                                    <L7p:EncapsulatedAssertionConfigGuid stringValue=\"6db56c26-58d7-4ffc-8fa5-01b525d5468b\"/>\n\n                                    <L7p:EncapsulatedAssertionConfigName stringValue=\"Utility: List Generic Entities\"/>\n                                    <L7p:Parameters mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"cacheAge\"/>\n                                    <L7p:value stringValue=\"${cacheAge}\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"refresh\"/>\n                                    <L7p:value stringValue=\"${request.http.parameter.refresh}\"/>\n                                    </L7p:entry>\n                                    </L7p:Parameters>\n                                    </L7p:Encapsulated>\n                                    <L7p:ResponseXpathAssertion>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Extract list of ids to search through\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:VariablePrefix stringValue=\"candidateIds\"/>\n                                    <L7p:XmlMsgSrc stringValue=\"genericEntities.sorted\"/>\n                                    <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                    <L7p:Expression stringValue=\"/GenericEntities/GenericEntity/@id\"/>\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                                    </L7p:XpathExpression>\n                                    </L7p:ResponseXpathAssertion>\n                                    <L7p:ForEachLoop\n                                    L7p:Usage=\"Required\"\n                                    loopVariable=\"candidateIds.results\" variablePrefix=\"candidateId\">\n                                    <wsp:OneOrMore wsp:Usage=\"Required\">\n                                    <wsp:All wsp:Usage=\"Required\">\n                                    <L7p:ResponseXpathAssertion>\n\n                                    <L7p:AssertionComment assertionComment=\"included\">\n\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"// Get the XML definition\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n\n                                    <L7p:VariablePrefix stringValue=\"genericEntity.xml\"/>\n\n                                    <L7p:XpathExpression xpathExpressionValue=\"included\">\n\n                                    <L7p:Expression stringValue=\"//l7:GenericEntity[@id=$candidateId.current]/l7:ValueXml\"/>\n\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"s\"/>\n\n                                    <L7p:value stringValue=\"http://schemas.xmlsoap.org/soap/envelope/\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"l7\"/>\n\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_2_0\"/>\n                                    </L7p:XpathExpression>\n                                    </L7p:ResponseXpathAssertion>\n                                    <L7p:SetVariable>\n\n                                    <L7p:Base64Expression stringValue=\"JHtnZW5lcmljRW50aXR5LnhtbC5yZXN1bHR9\"/>\n\n                                    <L7p:ContentType stringValue=\"text/xml; charset=utf-8\"/>\n\n                                    <L7p:DataType variableDataType=\"message\"/>\n\n                                    <L7p:VariableToSet stringValue=\"genericEntity.xml\"/>\n                                    </L7p:SetVariable>\n                                    <wsp:OneOrMore wsp:Usage=\"Required\">\n                                    <L7p:ResponseXpathAssertion>\n\n                                    <L7p:VariablePrefix stringValue=\"\"/>\n\n                                    <L7p:XmlMsgSrc stringValue=\"genericEntity.xml\"/>\n\n                                    <L7p:XpathExpression xpathExpressionValue=\"included\">\n\n                                    <L7p:Expression stringValue=\"/java/object/void[@property='connectionPolicyGOID']/object[@class='com.l7tech.objectmodel.Goid' and string=$id.current]\"/>\n\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"s\"/>\n\n                                    <L7p:value stringValue=\"http://schemas.xmlsoap.org/soap/envelope/\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"l7\"/>\n\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_2_0\"/>\n                                    </L7p:XpathExpression>\n                                    </L7p:ResponseXpathAssertion>\n                                    <L7p:ResponseXpathAssertion>\n\n                                    <L7p:VariablePrefix stringValue=\"\"/>\n\n                                    <L7p:XmlMsgSrc stringValue=\"genericEntity.xml\"/>\n\n                                    <L7p:XpathExpression xpathExpressionValue=\"included\">\n\n                                    <L7p:Expression stringValue=\"/java/object/void[@property='inboundPolicyOID']/object[@class='com.l7tech.objectmodel.Goid' and string=$id.current]\"/>\n\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"s\"/>\n\n                                    <L7p:value stringValue=\"http://schemas.xmlsoap.org/soap/envelope/\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"l7\"/>\n\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_2_0\"/>\n                                    </L7p:XpathExpression>\n                                    </L7p:ResponseXpathAssertion>\n                                    <L7p:ResponseXpathAssertion>\n\n                                    <L7p:VariablePrefix stringValue=\"\"/>\n\n                                    <L7p:XmlMsgSrc stringValue=\"genericEntity.xml\"/>\n\n                                    <L7p:XpathExpression xpathExpressionValue=\"included\">\n\n                                    <L7p:Expression stringValue=\"/java/object/void[@property='outboundConnectionPolicyId']/object[@class='com.l7tech.objectmodel.Goid' and string=$id.current]\"/>\n\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"s\"/>\n\n                                    <L7p:value stringValue=\"http://schemas.xmlsoap.org/soap/envelope/\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"l7\"/>\n\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_2_0\"/>\n                                    </L7p:XpathExpression>\n                                    </L7p:ResponseXpathAssertion>\n                                    <L7p:ResponseXpathAssertion>\n\n                                    <L7p:VariablePrefix stringValue=\"\"/>\n\n                                    <L7p:XmlMsgSrc stringValue=\"genericEntity.xml\"/>\n\n                                    <L7p:XpathExpression xpathExpressionValue=\"included\">\n\n                                    <L7p:Expression stringValue=\"/java/object/void[@property='outboundPolicyOID']/object[@class='com.l7tech.objectmodel.Goid' and string=$id.current]\"/>\n\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"s\"/>\n\n                                    <L7p:value stringValue=\"http://schemas.xmlsoap.org/soap/envelope/\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"l7\"/>\n\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_2_0\"/>\n                                    </L7p:XpathExpression>\n                                    </L7p:ResponseXpathAssertion>\n                                    <L7p:assertionComment>\n\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"// Check for our service id in websocket connection definition XML\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:OneOrMore>\n                                    <L7p:ResponseXpathAssertion>\n\n                                    <L7p:AssertionComment assertionComment=\"included\">\n\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"// Get name of this websocket connection definition\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n\n                                    <L7p:VariablePrefix stringValue=\"name\"/>\n\n                                    <L7p:XmlMsgSrc stringValue=\"genericEntities.sorted\"/>\n\n                                    <L7p:XpathExpression xpathExpressionValue=\"included\">\n\n                                    <L7p:Expression stringValue=\"/GenericEntities/GenericEntity[@id=$candidateId.current]/Name\"/>\n\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"l7\"/>\n\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                                    </L7p:XpathExpression>\n                                    </L7p:ResponseXpathAssertion>\n                                    <L7p:SetVariable>\n\n                                    <L7p:Base64Expression stringValue=\"V0VCU09DS0VUIENPTk5FQ1RJT046ICR7bmFtZS5yZXN1bHR9\"/>\n\n                                    <L7p:VariableToSet stringValue=\"depender\"/>\n                                    </L7p:SetVariable>\n                                    <L7p:ManipulateMultiValuedVariable>\n\n                                    <L7p:SourceVariableName stringValue=\"depender\"/>\n\n                                    <L7p:TargetVariableName stringValue=\"dependers.list\"/>\n                                    </L7p:ManipulateMultiValuedVariable>\n                                    <L7p:assertionComment>\n\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"// Check the candidate object is a depender\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:All>\n                                    <L7p:TrueAssertion/>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"// Check the candidate object is a depender, never fail\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:OneOrMore>\n                                    </L7p:ForEachLoop>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Search for references in websocket connection definitions\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:All>\n                                    <L7p:TrueAssertion/>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Search for references in websocket connection definitions, never fail\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:OneOrMore>\n                                    <wsp:OneOrMore wsp:Usage=\"Required\">\n                                    <wsp:All wsp:Usage=\"Required\">\n                                    <L7p:AuditDetailAssertion>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// FINE\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:Detail stringValue=\"==> Searching XMPP connection definitions\"/>\n                                    <L7p:Level stringValue=\"FINE\"/>\n                                    </L7p:AuditDetailAssertion>\n                                    <L7p:Encapsulated>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// GET genericEntities\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n\n                                    <L7p:EncapsulatedAssertionConfigGuid stringValue=\"c8a5a0d5-1ae2-4144-b538-5c311efc1560\"/>\n\n                                    <L7p:EncapsulatedAssertionConfigName stringValue=\"Utility: Call Restman\"/>\n                                    <L7p:Parameters mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"element\"/>\n                                    <L7p:value stringValue=\"GenericEntity\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"message\"/>\n                                    <L7p:value stringValue=\"\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"method\"/>\n                                    <L7p:value stringValue=\"GET\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"resource\"/>\n                                    <L7p:value stringValue=\"genericEntities\"/>\n                                    </L7p:entry>\n                                    </L7p:Parameters>\n                                    </L7p:Encapsulated>\n                                    <L7p:Encapsulated>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Want a sorted list of generic entities for the display\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n\n                                    <L7p:EncapsulatedAssertionConfigGuid stringValue=\"6db56c26-58d7-4ffc-8fa5-01b525d5468b\"/>\n\n                                    <L7p:EncapsulatedAssertionConfigName stringValue=\"Utility: List Generic Entities\"/>\n                                    <L7p:Parameters mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"cacheAge\"/>\n                                    <L7p:value stringValue=\"${cacheAge}\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"refresh\"/>\n                                    <L7p:value stringValue=\"${request.http.parameter.refresh}\"/>\n                                    </L7p:entry>\n                                    </L7p:Parameters>\n                                    </L7p:Encapsulated>\n                                    <L7p:ResponseXpathAssertion>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Extract list of ids to search through\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:VariablePrefix stringValue=\"candidateIds\"/>\n                                    <L7p:XmlMsgSrc stringValue=\"genericEntities.sorted\"/>\n                                    <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                    <L7p:Expression stringValue=\"/GenericEntities/GenericEntity/@id\"/>\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                                    </L7p:XpathExpression>\n                                    </L7p:ResponseXpathAssertion>\n                                    <L7p:ForEachLoop\n                                    L7p:Usage=\"Required\"\n                                    loopVariable=\"candidateIds.results\" variablePrefix=\"candidateId\">\n                                    <wsp:OneOrMore wsp:Usage=\"Required\">\n                                    <wsp:All wsp:Usage=\"Required\">\n                                    <L7p:ResponseXpathAssertion>\n\n                                    <L7p:AssertionComment assertionComment=\"included\">\n\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"// Get the XML definition\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n\n                                    <L7p:VariablePrefix stringValue=\"genericEntity.xml\"/>\n\n                                    <L7p:XpathExpression xpathExpressionValue=\"included\">\n\n                                    <L7p:Expression stringValue=\"//l7:GenericEntity[@id=$candidateId.current]/l7:ValueXml\"/>\n\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"s\"/>\n\n                                    <L7p:value stringValue=\"http://schemas.xmlsoap.org/soap/envelope/\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"l7\"/>\n\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_2_0\"/>\n                                    </L7p:XpathExpression>\n                                    </L7p:ResponseXpathAssertion>\n                                    <L7p:SetVariable>\n\n                                    <L7p:Base64Expression stringValue=\"JHtnZW5lcmljRW50aXR5LnhtbC5yZXN1bHR9\"/>\n\n                                    <L7p:ContentType stringValue=\"text/xml; charset=utf-8\"/>\n\n                                    <L7p:DataType variableDataType=\"message\"/>\n\n                                    <L7p:VariableToSet stringValue=\"genericEntity.xml\"/>\n                                    </L7p:SetVariable>\n                                    <wsp:OneOrMore wsp:Usage=\"Required\">\n                                    <L7p:ResponseXpathAssertion>\n\n                                    <L7p:VariablePrefix stringValue=\"\"/>\n\n                                    <L7p:XmlMsgSrc stringValue=\"genericEntity.xml\"/>\n\n                                    <L7p:XpathExpression xpathExpressionValue=\"included\">\n\n                                    <L7p:Expression stringValue=\"/java/object/void[@property='messageReceivedServiceOid']/object[@class='com.l7tech.objectmodel.Goid' and string=$id.current]\"/>\n\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"s\"/>\n\n                                    <L7p:value stringValue=\"http://schemas.xmlsoap.org/soap/envelope/\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"l7\"/>\n\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_2_0\"/>\n                                    </L7p:XpathExpression>\n                                    </L7p:ResponseXpathAssertion>\n                                    <L7p:ResponseXpathAssertion>\n\n                                    <L7p:VariablePrefix stringValue=\"\"/>\n\n                                    <L7p:XmlMsgSrc stringValue=\"genericEntity.xml\"/>\n\n                                    <L7p:XpathExpression xpathExpressionValue=\"included\">\n\n                                    <L7p:Expression stringValue=\"/java/object/void[@property='sessionTerminatedServiceOid']/object[@class='com.l7tech.objectmodel.Goid' and string=$id.current]\"/>\n\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"s\"/>\n\n                                    <L7p:value stringValue=\"http://schemas.xmlsoap.org/soap/envelope/\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"l7\"/>\n\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_2_0\"/>\n                                    </L7p:XpathExpression>\n                                    </L7p:ResponseXpathAssertion>\n                                    <L7p:assertionComment>\n\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"// Check for our service id in XMPP connection definition XML\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:OneOrMore>\n                                    <L7p:ResponseXpathAssertion>\n\n                                    <L7p:AssertionComment assertionComment=\"included\">\n\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"// Get name of this XMPP connection definition\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n\n                                    <L7p:VariablePrefix stringValue=\"name\"/>\n\n                                    <L7p:XmlMsgSrc stringValue=\"genericEntities.sorted\"/>\n\n                                    <L7p:XpathExpression xpathExpressionValue=\"included\">\n\n                                    <L7p:Expression stringValue=\"/GenericEntities/GenericEntity[@id=$candidateId.current]/Name\"/>\n\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"l7\"/>\n\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                                    </L7p:XpathExpression>\n                                    </L7p:ResponseXpathAssertion>\n                                    <L7p:SetVariable>\n\n                                    <L7p:Base64Expression stringValue=\"WE1QUCBDT05ORUNUSU9OOiAke25hbWUucmVzdWx0fQ==\"/>\n\n                                    <L7p:VariableToSet stringValue=\"depender\"/>\n                                    </L7p:SetVariable>\n                                    <L7p:ManipulateMultiValuedVariable>\n\n                                    <L7p:SourceVariableName stringValue=\"depender\"/>\n\n                                    <L7p:TargetVariableName stringValue=\"dependers.list\"/>\n                                    </L7p:ManipulateMultiValuedVariable>\n                                    <L7p:assertionComment>\n\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"// Check the candidate object is a depender\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:All>\n                                    <L7p:TrueAssertion/>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"// Check the candidate object is a depender, never fail\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:OneOrMore>\n                                    </L7p:ForEachLoop>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Search for references in XMPP connection definitions\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:All>\n                                    <L7p:TrueAssertion/>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Search for references in XMPP connection definitions, never fail\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:OneOrMore>\n                                    <wsp:OneOrMore wsp:Usage=\"Required\">\n                                    <wsp:All wsp:Usage=\"Required\">\n                                    <L7p:ComparisonAssertion>\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:Expression1 stringValue=\"${dependers.list.length}\"/>\n                                    <L7p:Expression2 stringValue=\"1\"/>\n                                    <L7p:Operator operator=\"GE\"/>\n                                    <L7p:Predicates predicates=\"included\">\n                                    <L7p:item binary=\"included\">\n\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:Operator operator=\"GE\"/>\n                                    <L7p:RightValue stringValue=\"1\"/>\n                                    </L7p:item>\n                                    </L7p:Predicates>\n                                    </L7p:ComparisonAssertion>\n                                    <L7p:ForEachLoop\n                                    L7p:Usage=\"Required\"\n                                    loopVariable=\"dependers.list\" variablePrefix=\"depender\">\n                                    <L7p:SetVariable>\n\n                                    <L7p:Base64Expression stringValue=\"JHtkZXBlbmRlcnMuaHRtbH0NCiAgPGxpPiR7ZGVwZW5kZXIuY3VycmVudH08L2xpPg==\"/>\n                                    <L7p:VariableToSet stringValue=\"dependers.html\"/>\n                                    </L7p:SetVariable>\n                                    </L7p:ForEachLoop>\n                                    <L7p:SetVariable>\n                                    <L7p:Base64Expression stringValue=\"JHtodG1sQ29udGVudH0NCg0KPHA+VGhlIGZvbGxvd2luZyBvYmplY3RzIGRlcGVuZCBvbiB0aGlzIHNlcnZpY2U6PC9wPg0KPHVsPiR7ZGVwZW5kZXJzLmh0bWx9PC91bD4=\"/>\n                                    <L7p:VariableToSet stringValue=\"htmlContent\"/>\n                                    </L7p:SetVariable>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// ${dependers.list} has content\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:All>\n                                    <L7p:SetVariable>\n                                    <L7p:Base64Expression stringValue=\"JHtodG1sQ29udGVudH0NCjxwPk5vdGhpbmcgd2FzIGZvdW5kIHRoYXQgZGVwZW5kcyBvbiB0aGlzIHNlcnZpY2U8L3A+\"/>\n                                    <L7p:VariableToSet stringValue=\"htmlContent\"/>\n                                    </L7p:SetVariable>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Append ${dependers.html} to ${htmlContent} if ${dependers.list} has any entries\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:OneOrMore>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// ${id} matches so retrieve dependers\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                </wsp:All>\n                                <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Do reverse dependency search if id matches\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:assertionComment>\n                            </wsp:OneOrMore>\n                            <L7p:assertionComment>\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Cycle through each object to add to display and check if search must be run\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:assertionComment>\n                        </L7p:ForEachLoop>\n                        <L7p:assertionComment>\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// ${objectType} == &quot;Service&quot;\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:assertionComment>\n                    </wsp:All>\n                    <wsp:All wsp:Usage=\"Required\">\n                        <L7p:ComparisonAssertion>\n                            <L7p:CaseSensitive booleanValue=\"false\"/>\n                            <L7p:Expression1 stringValue=\"${objectType}\"/>\n                            <L7p:Expression2 stringValue=\"SiteMinder Configuration\"/>\n                            <L7p:Predicates predicates=\"included\">\n                                <L7p:item binary=\"included\">\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:RightValue stringValue=\"SiteMinder Configuration\"/>\n                                </L7p:item>\n                            </L7p:Predicates>\n                        </L7p:ComparisonAssertion>\n                        <L7p:AuditDetailAssertion>\n                            <L7p:AssertionComment assertionComment=\"included\">\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// FINE\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:AssertionComment>\n                            <L7p:Detail stringValue=\"======> Listing ${objectType} objects\"/>\n                            <L7p:Level stringValue=\"FINE\"/>\n                        </L7p:AuditDetailAssertion>\n                        <L7p:Encapsulated>\n                            <L7p:AssertionComment assertionComment=\"included\">\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Get list of objectTypes to display and search for references\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:AssertionComment>\n                            <L7p:EncapsulatedAssertionConfigGuid stringValue=\"779a8f46-fcef-4739-b6c7-95eea2a160ff\"/>\n                            <L7p:EncapsulatedAssertionConfigName stringValue=\"Utility: List SiteMinder Configurations\"/>\n                            <L7p:Parameters mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"cacheAge\"/>\n                                    <L7p:value stringValue=\"${cacheAge}\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"refresh\"/>\n                                    <L7p:value stringValue=\"${request.http.parameter.refresh}\"/>\n                                </L7p:entry>\n                            </L7p:Parameters>\n                        </L7p:Encapsulated>\n                        <L7p:ResponseXpathAssertion>\n                            <L7p:AssertionComment assertionComment=\"included\">\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Get list of ids\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:AssertionComment>\n                            <L7p:VariablePrefix stringValue=\"ids\"/>\n                            <L7p:XmlMsgSrc stringValue=\"siteminderConfigurations.sorted\"/>\n                            <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                <L7p:Expression stringValue=\"/SiteMinderConfigurations/SiteMinderConfiguration/@id\"/>\n                                <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"s\"/>\n                                    <L7p:value stringValue=\"http://schemas.xmlsoap.org/soap/envelope/\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                    </L7p:entry>\n                                </L7p:Namespaces>\n                                <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                            </L7p:XpathExpression>\n                        </L7p:ResponseXpathAssertion>\n                        <L7p:ForEachLoop L7p:Usage=\"Required\"\n                            loopVariable=\"ids.results\" variablePrefix=\"id\">\n                            <L7p:ResponseXpathAssertion>\n                                <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Get name of the object for display\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:AssertionComment>\n                                <L7p:VariablePrefix stringValue=\"name\"/>\n                                <L7p:XmlMsgSrc stringValue=\"siteminderConfigurations.sorted\"/>\n                                <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                    <L7p:Expression stringValue=\"/SiteMinderConfigurations/SiteMinderConfiguration[@id=$id.current]/Name\"/>\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"s\"/>\n                                    <L7p:value stringValue=\"http://schemas.xmlsoap.org/soap/envelope/\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                                </L7p:XpathExpression>\n                            </L7p:ResponseXpathAssertion>\n                            <L7p:AuditDetailAssertion>\n                                <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// FINE\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:AssertionComment>\n                                <L7p:Detail stringValue=\"=====> Processing ${objectType}: ${name.result} (${id.current})\"/>\n                                <L7p:Level stringValue=\"FINE\"/>\n                            </L7p:AuditDetailAssertion>\n                            <L7p:Encapsulated>\n                                <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// name.result\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:AssertionComment>\n                                <L7p:EncapsulatedAssertionConfigGuid stringValue=\"f6b19229-a705-4c48-bc78-3975564a1a9a\"/>\n                                <L7p:EncapsulatedAssertionConfigName stringValue=\"Utility: Escape HTML String\"/>\n                                <L7p:Parameters mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"escapedString\"/>\n                                    <L7p:value stringValue=\"${name.result}\"/>\n                                    </L7p:entry>\n                                </L7p:Parameters>\n                            </L7p:Encapsulated>\n                            <L7p:SetVariable>\n                                <L7p:Base64Expression stringValue=\"JHtodG1sQ29udGVudH0NCjxhIGlkPSIke2lkLmN1cnJlbnR9Ii8+PGEgaHJlZj0iJHtyZXF1ZXN0LnVybC5wYXRofT9vYmplY3RUeXBlPSR7b2JqZWN0VHlwZX0maWQ9JHtpZC5jdXJyZW50fSMke2lkLmN1cnJlbnR9IiBvbkNsaWNrPSJzZXRSZWZyZXNoKHRoaXMpIj4ke2VzY2FwZWRTdHJpbmd9PC9hPjxici8+\"/>\n                                <L7p:VariableToSet stringValue=\"htmlContent\"/>\n                            </L7p:SetVariable>\n                            <wsp:OneOrMore wsp:Usage=\"Required\">\n                                <L7p:ComparisonAssertion>\n                                    <L7p:Expression1 stringValue=\"${id}\"/>\n                                    <L7p:Expression2 stringValue=\"${id.current}\"/>\n                                    <L7p:Negate booleanValue=\"true\"/>\n                                    <L7p:Predicates predicates=\"included\">\n                                    <L7p:item binary=\"included\">\n                                    <L7p:Negated booleanValue=\"true\"/>\n                                    <L7p:RightValue stringValue=\"${id.current}\"/>\n                                    </L7p:item>\n                                    </L7p:Predicates>\n                                </L7p:ComparisonAssertion>\n                                <wsp:All wsp:Usage=\"Required\">\n                                    <L7p:AuditDetailAssertion>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// FINE\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:Detail stringValue=\"====> ID matched, processing for dependencies\"/>\n                                    <L7p:Level stringValue=\"FINE\"/>\n                                    </L7p:AuditDetailAssertion>\n                                    <L7p:SetVariable>\n                                    <L7p:Base64Expression stringValue=\"JHtpZC5jdXJyZW50fQ==\"/>\n                                    <L7p:VariableToSet stringValue=\"referenceString\"/>\n                                    </L7p:SetVariable>\n                                    <L7p:AuditDetailAssertion>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// FINE\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:Detail stringValue=\"===> Searching objects for references to ${referenceString}\"/>\n                                    <L7p:Level stringValue=\"FINE\"/>\n                                    </L7p:AuditDetailAssertion>\n                                    <wsp:OneOrMore wsp:Usage=\"Required\">\n                                    <wsp:All wsp:Usage=\"Required\">\n                                    <L7p:AuditDetailAssertion>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// FINE\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:Detail stringValue=\"==> Searching policy XML\"/>\n                                    <L7p:Level stringValue=\"FINE\"/>\n                                    </L7p:AuditDetailAssertion>\n                                    <L7p:ResponseXpathAssertion>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Find policies that reference a SiteMinder configuration\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:VariablePrefix stringValue=\"policies\"/>\n                                    <L7p:XmlMsgSrc stringValue=\"allPolicyXML\"/>\n                                    <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                    <L7p:Expression stringValue=\"//AllPolicyXML/PolicyXML[contains(.,'L7p:SiteMinderCheckProtected')]\"/>\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                                    </L7p:XpathExpression>\n                                    </L7p:ResponseXpathAssertion>\n                                    <L7p:ForEachLoop\n                                    L7p:Usage=\"Required\"\n                                    loopVariable=\"policies.elements\" variablePrefix=\"policy\">\n                                    <L7p:SetVariable>\n\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"// Cast to message type for XPath\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n\n                                    <L7p:Base64Expression stringValue=\"JHtwb2xpY3kuY3VycmVudH0=\"/>\n                                    <L7p:ContentType stringValue=\"text/xml; charset=utf-8\"/>\n                                    <L7p:DataType variableDataType=\"message\"/>\n                                    <L7p:VariableToSet stringValue=\"policyObject.xml\"/>\n                                    </L7p:SetVariable>\n                                    <L7p:ResponseXpathAssertion>\n\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"// Extract the policy XML from the policy object\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:VariablePrefix stringValue=\"policy.xml\"/>\n                                    <L7p:XmlMsgSrc stringValue=\"policyObject.xml\"/>\n                                    <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                    <L7p:Expression stringValue=\"/PolicyXML/text()\"/>\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"s\"/>\n\n                                    <L7p:value stringValue=\"http://schemas.xmlsoap.org/soap/envelope/\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                                    </L7p:XpathExpression>\n                                    </L7p:ResponseXpathAssertion>\n                                    <L7p:SetVariable>\n\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"// Cast to message type for XPath\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n\n                                    <L7p:Base64Expression stringValue=\"JHtwb2xpY3kueG1sLnJlc3VsdH0=\"/>\n                                    <L7p:ContentType stringValue=\"text/xml; charset=utf-8\"/>\n                                    <L7p:DataType variableDataType=\"message\"/>\n                                    <L7p:VariableToSet stringValue=\"policy.xml\"/>\n                                    </L7p:SetVariable>\n                                    <wsp:OneOrMore wsp:Usage=\"Required\">\n                                    <wsp:All wsp:Usage=\"Required\">\n                                    <L7p:ResponseXpathAssertion>\n\n                                    <L7p:AssertionComment assertionComment=\"included\">\n\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"// Check if the policy XML has a reference to this SiteMinder configuration\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n\n                                    <L7p:VariablePrefix stringValue=\"\"/>\n\n                                    <L7p:XmlMsgSrc stringValue=\"policy.xml\"/>\n\n                                    <L7p:XpathExpression xpathExpressionValue=\"included\">\n\n                                    <L7p:Expression stringValue=\"//L7p:SiteMinderCheckProtected/L7p:AgentGoid[@goidValue=$referenceString]\"/>\n\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"L7p\"/>\n\n                                    <L7p:value stringValue=\"http://www.layer7tech.com/ws/policy\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"wsp\"/>\n\n                                    <L7p:value stringValue=\"http://schemas.xmlsoap.org/ws/2002/12/policy\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                                    </L7p:XpathExpression>\n                                    </L7p:ResponseXpathAssertion>\n                                    <L7p:Include>\n\n                                    <L7p:PolicyGuid stringValue=\"8f33b165-bc16-4959-a524-aba67aff3cdf\"/>\n                                    </L7p:Include>\n                                    <L7p:SetVariable>\n\n                                    <L7p:Base64Expression stringValue=\"JHtzb3VyY2VUeXBlLnJlc3VsdH06ICR7Zm9sZGVyUGF0aC5yZXN1bHR9JHtuYW1lLnJlc3VsdH0=\"/>\n\n                                    <L7p:VariableToSet stringValue=\"depender\"/>\n                                    </L7p:SetVariable>\n                                    <L7p:ManipulateMultiValuedVariable>\n\n                                    <L7p:SourceVariableName stringValue=\"depender\"/>\n\n                                    <L7p:TargetVariableName stringValue=\"dependers.list\"/>\n                                    </L7p:ManipulateMultiValuedVariable>\n                                    <L7p:assertionComment>\n\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"// Search policy XML for SiteMinderCheckProtected element matching our reference\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:All>\n                                    <L7p:TrueAssertion/>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"// Search policy XML for SiteMinderCheckProtected element matching our reference, never fail\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:OneOrMore>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Cycle through each policy to see if the SiteMinder configuration is the one we want and append to ${dependers.list}\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </L7p:ForEachLoop>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Search for references in policy XML\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:All>\n                                    <L7p:TrueAssertion/>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Search for references in policy XML, never fail\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:OneOrMore>\n                                    <wsp:OneOrMore wsp:Usage=\"Required\">\n                                    <wsp:All wsp:Usage=\"Required\">\n                                    <L7p:ComparisonAssertion>\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:Expression1 stringValue=\"${dependers.list.length}\"/>\n                                    <L7p:Expression2 stringValue=\"1\"/>\n                                    <L7p:Operator operator=\"GE\"/>\n                                    <L7p:Predicates predicates=\"included\">\n                                    <L7p:item binary=\"included\">\n\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:Operator operator=\"GE\"/>\n                                    <L7p:RightValue stringValue=\"1\"/>\n                                    </L7p:item>\n                                    </L7p:Predicates>\n                                    </L7p:ComparisonAssertion>\n                                    <L7p:ForEachLoop\n                                    L7p:Usage=\"Required\"\n                                    loopVariable=\"dependers.list\" variablePrefix=\"depender\">\n                                    <L7p:SetVariable>\n\n                                    <L7p:Base64Expression stringValue=\"JHtkZXBlbmRlcnMuaHRtbH0NCiAgPGxpPiR7ZGVwZW5kZXIuY3VycmVudH08L2xpPg==\"/>\n                                    <L7p:VariableToSet stringValue=\"dependers.html\"/>\n                                    </L7p:SetVariable>\n                                    </L7p:ForEachLoop>\n                                    <L7p:SetVariable>\n                                    <L7p:Base64Expression stringValue=\"JHtodG1sQ29udGVudH0NCg0KPHA+VGhlIGZvbGxvd2luZyBvYmplY3RzIHVzZSB0aGlzIFNpdGVNaW5kZXIgY29uZmlndXJhdGlvbjo8L3A+DQo8dWw+JHtkZXBlbmRlcnMuaHRtbH08L3VsPg==\"/>\n                                    <L7p:VariableToSet stringValue=\"htmlContent\"/>\n                                    </L7p:SetVariable>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// ${dependers.list} has content\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:All>\n                                    <L7p:SetVariable>\n                                    <L7p:Base64Expression stringValue=\"JHtodG1sQ29udGVudH0NCjxwPk5vdGhpbmcgd2FzIGZvdW5kIHRoYXQgdXNlcyB0aGlzIFNpdGVNaW5kZXIgY29uZmlndXJhdGlvbjwvcD4=\"/>\n                                    <L7p:VariableToSet stringValue=\"htmlContent\"/>\n                                    </L7p:SetVariable>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Append ${dependers.html} to ${htmlContent} if ${dependers.list} has any entries\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:OneOrMore>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// ${id} matches so retrieve dependers\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                </wsp:All>\n                                <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Do reverse dependency search if id matches\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:assertionComment>\n                            </wsp:OneOrMore>\n                            <L7p:assertionComment>\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Cycle through each object to add to display and check if search must be run\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:assertionComment>\n                        </L7p:ForEachLoop>\n                        <L7p:assertionComment>\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// ${objectType} == &quot;SiteMinder Configuration&quot;\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:assertionComment>\n                    </wsp:All>\n                    <wsp:All wsp:Usage=\"Required\">\n                        <L7p:ComparisonAssertion>\n                            <L7p:CaseSensitive booleanValue=\"false\"/>\n                            <L7p:Expression1 stringValue=\"${objectType}\"/>\n                            <L7p:Expression2 stringValue=\"Trusted Certificate\"/>\n                            <L7p:Predicates predicates=\"included\">\n                                <L7p:item binary=\"included\">\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:RightValue stringValue=\"Trusted Certificate\"/>\n                                </L7p:item>\n                            </L7p:Predicates>\n                        </L7p:ComparisonAssertion>\n                        <L7p:AuditDetailAssertion>\n                            <L7p:AssertionComment assertionComment=\"included\">\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// FINE\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:AssertionComment>\n                            <L7p:Detail stringValue=\"======> Listing ${objectType} objects\"/>\n                            <L7p:Level stringValue=\"FINE\"/>\n                        </L7p:AuditDetailAssertion>\n                        <L7p:Encapsulated>\n                            <L7p:AssertionComment assertionComment=\"included\">\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Get list of objectTypes to display and search for references\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:AssertionComment>\n                            <L7p:EncapsulatedAssertionConfigGuid stringValue=\"1feebe6b-c754-4bdc-834b-c6f3065d0216\"/>\n                            <L7p:EncapsulatedAssertionConfigName stringValue=\"Utility: List Trusted Certificates\"/>\n                            <L7p:Parameters mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"cacheAge\"/>\n                                    <L7p:value stringValue=\"${cacheAge}\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"refresh\"/>\n                                    <L7p:value stringValue=\"${request.http.parameter.refresh}\"/>\n                                </L7p:entry>\n                            </L7p:Parameters>\n                        </L7p:Encapsulated>\n                        <L7p:ResponseXpathAssertion>\n                            <L7p:AssertionComment assertionComment=\"included\">\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Get list of ids\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:AssertionComment>\n                            <L7p:VariablePrefix stringValue=\"ids\"/>\n                            <L7p:XmlMsgSrc stringValue=\"trustedCertificates.sorted\"/>\n                            <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                <L7p:Expression stringValue=\"/TrustedCertificates/TrustedCertificate/@id\"/>\n                                <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"s\"/>\n                                    <L7p:value stringValue=\"http://schemas.xmlsoap.org/soap/envelope/\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                    </L7p:entry>\n                                </L7p:Namespaces>\n                                <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                            </L7p:XpathExpression>\n                        </L7p:ResponseXpathAssertion>\n                        <L7p:ForEachLoop L7p:Usage=\"Required\"\n                            loopVariable=\"ids.results\" variablePrefix=\"id\">\n                            <L7p:ResponseXpathAssertion>\n                                <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Get name of the object for display\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:AssertionComment>\n                                <L7p:VariablePrefix stringValue=\"name\"/>\n                                <L7p:XmlMsgSrc stringValue=\"trustedCertificates.sorted\"/>\n                                <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                    <L7p:Expression stringValue=\"/TrustedCertificates/TrustedCertificate[@id=$id.current]/Name\"/>\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"s\"/>\n                                    <L7p:value stringValue=\"http://schemas.xmlsoap.org/soap/envelope/\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                                </L7p:XpathExpression>\n                            </L7p:ResponseXpathAssertion>\n                            <L7p:AuditDetailAssertion>\n                                <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// FINE\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:AssertionComment>\n                                <L7p:Detail stringValue=\"=====> Processing ${objectType}: ${name.result} (${id.current})\"/>\n                                <L7p:Level stringValue=\"FINE\"/>\n                            </L7p:AuditDetailAssertion>\n                            <L7p:Encapsulated>\n                                <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// name.result\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:AssertionComment>\n                                <L7p:EncapsulatedAssertionConfigGuid stringValue=\"f6b19229-a705-4c48-bc78-3975564a1a9a\"/>\n                                <L7p:EncapsulatedAssertionConfigName stringValue=\"Utility: Escape HTML String\"/>\n                                <L7p:Parameters mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"escapedString\"/>\n                                    <L7p:value stringValue=\"${name.result}\"/>\n                                    </L7p:entry>\n                                </L7p:Parameters>\n                            </L7p:Encapsulated>\n                            <L7p:SetVariable>\n                                <L7p:Base64Expression stringValue=\"JHtodG1sQ29udGVudH0NCjxhIGlkPSIke2lkLmN1cnJlbnR9Ii8+PGEgaHJlZj0iJHtyZXF1ZXN0LnVybC5wYXRofT9vYmplY3RUeXBlPSR7b2JqZWN0VHlwZX0maWQ9JHtpZC5jdXJyZW50fSMke2lkLmN1cnJlbnR9IiBvbkNsaWNrPSJzZXRSZWZyZXNoKHRoaXMpIj4ke2VzY2FwZWRTdHJpbmd9PC9hPjxici8+\"/>\n                                <L7p:VariableToSet stringValue=\"htmlContent\"/>\n                            </L7p:SetVariable>\n                            <wsp:OneOrMore wsp:Usage=\"Required\">\n                                <L7p:ComparisonAssertion>\n                                    <L7p:Expression1 stringValue=\"${id}\"/>\n                                    <L7p:Expression2 stringValue=\"${id.current}\"/>\n                                    <L7p:Negate booleanValue=\"true\"/>\n                                    <L7p:Predicates predicates=\"included\">\n                                    <L7p:item binary=\"included\">\n                                    <L7p:Negated booleanValue=\"true\"/>\n                                    <L7p:RightValue stringValue=\"${id.current}\"/>\n                                    </L7p:item>\n                                    </L7p:Predicates>\n                                </L7p:ComparisonAssertion>\n                                <wsp:All wsp:Usage=\"Required\">\n                                    <L7p:AuditDetailAssertion>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// FINE\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:Detail stringValue=\"====> ID matched, processing for dependencies\"/>\n                                    <L7p:Level stringValue=\"FINE\"/>\n                                    </L7p:AuditDetailAssertion>\n                                    <L7p:ResponseXpathAssertion>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Get certificate\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:VariablePrefix stringValue=\"certificate\"/>\n                                    <L7p:XmlMsgSrc stringValue=\"trustedCertificates.sorted\"/>\n                                    <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                    <L7p:Expression stringValue=\"/TrustedCertificates/TrustedCertificate[@id=$id.current]/Certificate\"/>\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"s\"/>\n                                    <L7p:value stringValue=\"http://schemas.xmlsoap.org/soap/envelope/\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                                    </L7p:XpathExpression>\n                                    </L7p:ResponseXpathAssertion>\n                                    <L7p:EncodeDecode>\n                                    <L7p:CharacterEncoding stringValueNull=\"null\"/>\n                                    <L7p:SourceVariableName stringValue=\"certificate.result\"/>\n                                    <L7p:TargetDataType variableDataType=\"cert\"/>\n                                    <L7p:TargetVariableName stringValue=\"trustedCertificate\"/>\n                                    <L7p:TransformType transformType=\"BASE64_DECODE\"/>\n                                    </L7p:EncodeDecode>\n                                    <L7p:SetVariable>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Cast to regular variables for predicate use in XPaths\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:Base64Expression stringValue=\"JHtuYW1lLnJlc3VsdH0=\"/>\n                                    <L7p:VariableToSet stringValue=\"trustedCertificate.name\"/>\n                                    </L7p:SetVariable>\n                                    <L7p:AuditDetailAssertion>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// FINE\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:Detail stringValue=\"===> Searching objects for references\"/>\n                                    <L7p:Level stringValue=\"FINE\"/>\n                                    </L7p:AuditDetailAssertion>\n                                    <wsp:OneOrMore wsp:Usage=\"Required\">\n                                    <wsp:All wsp:Usage=\"Required\">\n                                    <L7p:AuditDetailAssertion>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// FINE\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:Detail stringValue=\"==> Searching policy XML\"/>\n                                    <L7p:Level stringValue=\"FINE\"/>\n                                    </L7p:AuditDetailAssertion>\n                                    <wsp:OneOrMore wsp:Usage=\"Required\">\n                                    <L7p:ResponseXpathAssertion>\n\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"// Extract all policy objects that contain the LookupTrustedCertificate element\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:VariablePrefix stringValue=\"policies\"/>\n                                    <L7p:XmlMsgSrc stringValue=\"allPolicyXML\"/>\n                                    <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                    <L7p:Expression stringValue=\"/AllPolicyXML/PolicyXML[contains(.,'&lt;L7p:LookupTrustedCertificate>')]\"/>\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                                    </L7p:XpathExpression>\n                                    </L7p:ResponseXpathAssertion>\n                                    <L7p:ResponseXpathAssertion>\n\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"// Extract all policy objects that contain the NonSoapVerifyElement element\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:VariablePrefix stringValue=\"policies\"/>\n                                    <L7p:XmlMsgSrc stringValue=\"allPolicyXML\"/>\n                                    <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                    <L7p:Expression stringValue=\"/AllPolicyXML/PolicyXML[contains(.,'&lt;L7p:NonSoapVerifyElement>')]\"/>\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                                    </L7p:XpathExpression>\n                                    </L7p:ResponseXpathAssertion>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Find policy objects that contain &lt;L7p:LookupTrustedCertificate> or &lt;L7p:NonSoapVerifyElement>\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:OneOrMore>\n                                    <L7p:ForEachLoop\n                                    L7p:Usage=\"Required\"\n                                    loopVariable=\"policies.elements\" variablePrefix=\"policy\">\n                                    <L7p:SetVariable>\n\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"// Cast to message type for XPath\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n\n                                    <L7p:Base64Expression stringValue=\"JHtwb2xpY3kuY3VycmVudH0=\"/>\n                                    <L7p:ContentType stringValue=\"text/xml; charset=utf-8\"/>\n                                    <L7p:DataType variableDataType=\"message\"/>\n                                    <L7p:VariableToSet stringValue=\"policyObject.xml\"/>\n                                    </L7p:SetVariable>\n                                    <L7p:ResponseXpathAssertion>\n\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"// Extract the policy XML from the policy object\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:VariablePrefix stringValue=\"policy.xml\"/>\n                                    <L7p:XmlMsgSrc stringValue=\"policyObject.xml\"/>\n                                    <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                    <L7p:Expression stringValue=\"/PolicyXML/text()\"/>\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"s\"/>\n\n                                    <L7p:value stringValue=\"http://schemas.xmlsoap.org/soap/envelope/\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                                    </L7p:XpathExpression>\n                                    </L7p:ResponseXpathAssertion>\n                                    <L7p:SetVariable>\n\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"// Cast to message type for XPath\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n\n                                    <L7p:Base64Expression stringValue=\"JHtwb2xpY3kueG1sLnJlc3VsdH0=\"/>\n                                    <L7p:ContentType stringValue=\"text/xml; charset=utf-8\"/>\n                                    <L7p:DataType variableDataType=\"message\"/>\n                                    <L7p:VariableToSet stringValue=\"policy.xml\"/>\n                                    </L7p:SetVariable>\n                                    <wsp:OneOrMore wsp:Usage=\"Required\">\n                                    <wsp:All wsp:Usage=\"Required\">\n                                    <wsp:OneOrMore wsp:Usage=\"Required\">\n                                    <wsp:All wsp:Usage=\"Required\">\n                                    <L7p:ResponseXpathAssertion>\n\n                                    <L7p:AssertionComment assertionComment=\"included\">\n\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"// Check if the policy XML has a reference to this trusted certificate by name\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n\n                                    <L7p:VariablePrefix stringValue=\"\"/>\n\n                                    <L7p:XmlMsgSrc stringValue=\"policy.xml\"/>\n\n                                    <L7p:XpathExpression xpathExpressionValue=\"included\">\n\n                                    <L7p:Expression stringValue=\"//L7p:NonSoapVerifyElement/L7p:VerifyCertificateName[@stringValue=$trustedCertificate.name]\"/>\n\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"L7p\"/>\n\n                                    <L7p:value stringValue=\"http://www.layer7tech.com/ws/policy\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                                    </L7p:XpathExpression>\n                                    </L7p:ResponseXpathAssertion>\n                                    <L7p:AuditDetailAssertion>\n\n                                    <L7p:AssertionComment assertionComment=\"included\">\n\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"// FINE\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n\n                                    <L7p:Detail stringValue=\"==> Matched NonSoapVerifyElement for certificate name\"/>\n\n                                    <L7p:Level stringValue=\"FINE\"/>\n                                    </L7p:AuditDetailAssertion>\n                                    <L7p:assertionComment>\n\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"// Check VerifyCertificateName for match in name\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:All>\n                                    <wsp:All wsp:Usage=\"Required\">\n                                    <L7p:ResponseXpathAssertion>\n\n                                    <L7p:AssertionComment assertionComment=\"included\">\n\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"// Check if the policy XML has a reference to this trusted certificate by name\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n\n                                    <L7p:VariablePrefix stringValue=\"\"/>\n\n                                    <L7p:XmlMsgSrc stringValue=\"policy.xml\"/>\n\n                                    <L7p:XpathExpression xpathExpressionValue=\"included\">\n\n                                    <L7p:Expression stringValue=\"//L7p:NonSoapVerifyElement/L7p:VerifyCertificateGoid[@goidValue=$id.current]\"/>\n\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"L7p\"/>\n\n                                    <L7p:value stringValue=\"http://www.layer7tech.com/ws/policy\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                                    </L7p:XpathExpression>\n                                    </L7p:ResponseXpathAssertion>\n                                    <L7p:AuditDetailAssertion>\n\n                                    <L7p:AssertionComment assertionComment=\"included\">\n\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"// FINE\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n\n                                    <L7p:Detail stringValue=\"==> Matched NonSoapVerifyElement for ID\"/>\n\n                                    <L7p:Level stringValue=\"FINE\"/>\n                                    </L7p:AuditDetailAssertion>\n                                    <L7p:assertionComment>\n\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"// Check VerifyCertificateName for match in id\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:All>\n                                    <wsp:All wsp:Usage=\"Required\">\n                                    <L7p:ResponseXpathAssertion>\n\n                                    <L7p:AssertionComment assertionComment=\"included\">\n\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"// Check if the policy XML has a reference to this trusted certificate by name\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n\n                                    <L7p:VariablePrefix stringValue=\"\"/>\n\n                                    <L7p:XmlMsgSrc stringValue=\"policy.xml\"/>\n\n                                    <L7p:XpathExpression xpathExpressionValue=\"included\">\n\n                                    <L7p:Expression stringValue=\"//L7p:LookupTrustedCertificate/L7p:TrustedCertificateName[@stringValue=$trustedCertificate.name]\"/>\n\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"L7p\"/>\n\n                                    <L7p:value stringValue=\"http://www.layer7tech.com/ws/policy\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                                    </L7p:XpathExpression>\n                                    </L7p:ResponseXpathAssertion>\n                                    <L7p:AuditDetailAssertion>\n\n                                    <L7p:AssertionComment assertionComment=\"included\">\n\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"// FINE\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n\n                                    <L7p:Detail stringValue=\"==> Matched LookupTrustedCertificate for certificate name\"/>\n\n                                    <L7p:Level stringValue=\"FINE\"/>\n                                    </L7p:AuditDetailAssertion>\n                                    <L7p:assertionComment>\n\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"// Check LookupTrustedCertificate for match in name\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:All>\n                                    <wsp:All wsp:Usage=\"Required\">\n                                    <L7p:SetVariable>\n\n                                    <L7p:Base64Expression stringValue=\"JHt0cnVzdGVkQ2VydGlmaWNhdGUuc3ViamVjdEtleUlkZW50aWZpZXJ9\"/>\n\n                                    <L7p:VariableToSet stringValue=\"ski\"/>\n                                    </L7p:SetVariable>\n                                    <L7p:ResponseXpathAssertion>\n\n                                    <L7p:AssertionComment assertionComment=\"included\">\n\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"// Check if the policy XML has a reference to this trusted certificate by name\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n\n                                    <L7p:VariablePrefix stringValue=\"\"/>\n\n                                    <L7p:XmlMsgSrc stringValue=\"policy.xml\"/>\n\n                                    <L7p:XpathExpression xpathExpressionValue=\"included\">\n\n                                    <L7p:Expression stringValue=\"//L7p:LookupTrustedCertificate/L7p:CertSubjectKeyIdentifier[@stringValue=$ski]\"/>\n\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"L7p\"/>\n\n                                    <L7p:value stringValue=\"http://www.layer7tech.com/ws/policy\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                                    </L7p:XpathExpression>\n                                    </L7p:ResponseXpathAssertion>\n                                    <L7p:AuditDetailAssertion>\n\n                                    <L7p:AssertionComment assertionComment=\"included\">\n\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"// FINE\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n\n                                    <L7p:Detail stringValue=\"==> Matched LookupTrustedCertificate for SKI\"/>\n\n                                    <L7p:Level stringValue=\"FINE\"/>\n                                    </L7p:AuditDetailAssertion>\n                                    <L7p:assertionComment>\n\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"// Check LookupTrustedCertificate for match in SKI\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:All>\n                                    <wsp:All wsp:Usage=\"Required\">\n                                    <L7p:SetVariable>\n\n                                    <L7p:Base64Expression stringValue=\"JHt0cnVzdGVkQ2VydGlmaWNhdGUudGh1bWJwcmludFNIQTF9\"/>\n\n                                    <L7p:VariableToSet stringValue=\"thumbprintSHA1\"/>\n                                    </L7p:SetVariable>\n                                    <L7p:ResponseXpathAssertion>\n\n                                    <L7p:AssertionComment assertionComment=\"included\">\n\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"// Check if the policy XML has a reference to this trusted certificate by name\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n\n                                    <L7p:VariablePrefix stringValue=\"\"/>\n\n                                    <L7p:XmlMsgSrc stringValue=\"policy.xml\"/>\n\n                                    <L7p:XpathExpression xpathExpressionValue=\"included\">\n\n                                    <L7p:Expression stringValue=\"//L7p:LookupTrustedCertificate/L7p:CertThumbprintSha1[@stringValue=$thumbprintSHA1]\"/>\n\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"L7p\"/>\n\n                                    <L7p:value stringValue=\"http://www.layer7tech.com/ws/policy\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                                    </L7p:XpathExpression>\n                                    </L7p:ResponseXpathAssertion>\n                                    <L7p:AuditDetailAssertion>\n\n                                    <L7p:AssertionComment assertionComment=\"included\">\n\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"// FINE\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n\n                                    <L7p:Detail stringValue=\"==> Matched LookupTrustedCertificate for ThumbprintSHA1\"/>\n\n                                    <L7p:Level stringValue=\"FINE\"/>\n                                    </L7p:AuditDetailAssertion>\n                                    <L7p:assertionComment>\n\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"// Check LookupTrustedCertificate for match in ThumbprintSHA1\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:All>\n                                    <wsp:All wsp:Usage=\"Required\">\n                                    <L7p:ResponseXpathAssertion>\n\n                                    <L7p:AssertionComment assertionComment=\"included\">\n\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"// Attempt to extract the certSubjectDn element from the policy XML\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n\n                                    <L7p:VariablePrefix stringValue=\"certSubjectDn\"/>\n\n                                    <L7p:XmlMsgSrc stringValue=\"policy.xml\"/>\n\n                                    <L7p:XpathExpression xpathExpressionValue=\"included\">\n\n                                    <L7p:Expression stringValue=\"//L7p:LookupTrustedCertificate/L7p:CertSubjectDn/@stringValue\"/>\n\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"L7p\"/>\n\n                                    <L7p:value stringValue=\"http://www.layer7tech.com/ws/policy\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                                    </L7p:XpathExpression>\n                                    </L7p:ResponseXpathAssertion>\n                                    <L7p:Regex>\n\n                                    <L7p:AssertionComment assertionComment=\"included\">\n\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"// Normalise spaces between levels\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n\n                                    <L7p:AutoTarget booleanValue=\"false\"/>\n\n                                    <L7p:OtherTargetMessageVariable stringValue=\"certSubjectDn.result\"/>\n\n                                    <L7p:Regex stringValue=\", *\"/>\n\n                                    <L7p:Replace booleanValue=\"true\"/>\n\n                                    <L7p:Replacement stringValue=\",\"/>\n\n                                    <L7p:Target target=\"OTHER\"/>\n                                    </L7p:Regex>\n                                    <L7p:ComparisonAssertion>\n\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n\n                                    <L7p:Expression1 stringValue=\"${certSubjectDn.result}\"/>\n\n                                    <L7p:Expression2 stringValue=\"${trustedCertificate.subject.canonical}\"/>\n\n                                    <L7p:Predicates predicates=\"included\">\n\n                                    <L7p:item binary=\"included\">\n\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n\n                                    <L7p:RightValue stringValue=\"${trustedCertificate.subject.canonical}\"/>\n                                    </L7p:item>\n                                    </L7p:Predicates>\n                                    </L7p:ComparisonAssertion>\n                                    <L7p:AuditDetailAssertion>\n\n                                    <L7p:AssertionComment assertionComment=\"included\">\n\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"// FINE\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n\n                                    <L7p:Detail stringValue=\"==> Matched LookupTrustedCertificate for subject DN\"/>\n\n                                    <L7p:Level stringValue=\"FINE\"/>\n                                    </L7p:AuditDetailAssertion>\n                                    <L7p:assertionComment>\n\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"// Check LookupTrustedCertificate for match in subject DN\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:All>\n                                    <wsp:All wsp:Usage=\"Required\">\n                                    <L7p:SetVariable>\n\n                                    <L7p:AssertionComment assertionComment=\"included\">\n\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"// Cast to normal variable for XPath\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n\n                                    <L7p:Base64Expression stringValue=\"JHt0cnVzdGVkQ2VydGlmaWNhdGUuc2VyaWFsfQ==\"/>\n\n                                    <L7p:VariableToSet stringValue=\"serialNumber\"/>\n                                    </L7p:SetVariable>\n                                    <L7p:ResponseXpathAssertion>\n\n                                    <L7p:AssertionComment assertionComment=\"included\">\n\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"// Check if the policy XML has a reference to this trusted certificate by serial number\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n\n                                    <L7p:VariablePrefix stringValue=\"\"/>\n\n                                    <L7p:XmlMsgSrc stringValue=\"policy.xml\"/>\n\n                                    <L7p:XpathExpression xpathExpressionValue=\"included\">\n\n                                    <L7p:Expression stringValue=\"//L7p:LookupTrustedCertificate/L7p:CertSerialNumber[@stringValue=$serialNumber]\"/>\n\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"L7p\"/>\n\n                                    <L7p:value stringValue=\"http://www.layer7tech.com/ws/policy\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"wsp\"/>\n\n                                    <L7p:value stringValue=\"http://schemas.xmlsoap.org/ws/2002/12/policy\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                                    </L7p:XpathExpression>\n                                    </L7p:ResponseXpathAssertion>\n                                    <L7p:ResponseXpathAssertion>\n\n                                    <L7p:AssertionComment assertionComment=\"included\">\n\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"// Attempt to extract the certIssuerDn element from the policy XML\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n\n                                    <L7p:VariablePrefix stringValue=\"certIssuerDn\"/>\n\n                                    <L7p:XmlMsgSrc stringValue=\"policy.xml\"/>\n\n                                    <L7p:XpathExpression xpathExpressionValue=\"included\">\n\n                                    <L7p:Expression stringValue=\"//L7p:LookupTrustedCertificate/L7p:CertIssuerDn/@stringValue\"/>\n\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"L7p\"/>\n\n                                    <L7p:value stringValue=\"http://www.layer7tech.com/ws/policy\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                                    </L7p:XpathExpression>\n                                    </L7p:ResponseXpathAssertion>\n                                    <L7p:Regex>\n\n                                    <L7p:AssertionComment assertionComment=\"included\">\n\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"// Normalise spaces between levels\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n\n                                    <L7p:AutoTarget booleanValue=\"false\"/>\n\n                                    <L7p:OtherTargetMessageVariable stringValue=\"certIssuerDn.result\"/>\n\n                                    <L7p:Regex stringValue=\", *\"/>\n\n                                    <L7p:Replace booleanValue=\"true\"/>\n\n                                    <L7p:Replacement stringValue=\",\"/>\n\n                                    <L7p:Target target=\"OTHER\"/>\n                                    </L7p:Regex>\n                                    <L7p:ComparisonAssertion>\n\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n\n                                    <L7p:Expression1 stringValue=\"${certIssuerDn.result}\"/>\n\n                                    <L7p:Expression2 stringValue=\"${trustedCertificate.issuer.canonical}\"/>\n\n                                    <L7p:Predicates predicates=\"included\">\n\n                                    <L7p:item binary=\"included\">\n\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n\n                                    <L7p:RightValue stringValue=\"${trustedCertificate.issuer.canonical}\"/>\n                                    </L7p:item>\n                                    </L7p:Predicates>\n                                    </L7p:ComparisonAssertion>\n                                    <L7p:AuditDetailAssertion>\n\n                                    <L7p:AssertionComment assertionComment=\"included\">\n\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"// FINE\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n\n                                    <L7p:Detail stringValue=\"==> Matched LookupTrustedCertificate for issuer DN and serial number\"/>\n\n                                    <L7p:Level stringValue=\"FINE\"/>\n                                    </L7p:AuditDetailAssertion>\n                                    <L7p:assertionComment>\n\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"// Check LookupTrustedCertificate for match in issuer DN and serial number\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:All>\n                                    <L7p:assertionComment>\n\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"// Match the possible scenarios for LookupTrustedCertificate\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:OneOrMore>\n                                    <L7p:Include>\n\n                                    <L7p:PolicyGuid stringValue=\"8f33b165-bc16-4959-a524-aba67aff3cdf\"/>\n                                    </L7p:Include>\n                                    <L7p:SetVariable>\n\n                                    <L7p:Base64Expression stringValue=\"JHtzb3VyY2VUeXBlLnJlc3VsdH06ICR7Zm9sZGVyUGF0aC5yZXN1bHR9JHtuYW1lLnJlc3VsdH0=\"/>\n\n                                    <L7p:VariableToSet stringValue=\"depender\"/>\n                                    </L7p:SetVariable>\n                                    <L7p:ManipulateMultiValuedVariable>\n\n                                    <L7p:SourceVariableName stringValue=\"depender\"/>\n\n                                    <L7p:TargetVariableName stringValue=\"dependers.list\"/>\n                                    </L7p:ManipulateMultiValuedVariable>\n                                    <L7p:assertionComment>\n\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"// Search policy XML for TrustedCertificateName element matching ${name.result}\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:All>\n                                    <L7p:TrueAssertion/>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"// Search policy XML for each possibility matching our reference, never fail\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:OneOrMore>\n                                    </L7p:ForEachLoop>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Search for references in policy XML\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:All>\n                                    <L7p:TrueAssertion/>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Search for references in policy XML, never fail\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:OneOrMore>\n                                    <wsp:OneOrMore wsp:Usage=\"Required\">\n                                    <wsp:All wsp:Usage=\"Required\">\n                                    <L7p:AuditDetailAssertion>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// FINE\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:Detail stringValue=\"==> Searching identity provider definitions\"/>\n                                    <L7p:Level stringValue=\"FINE\"/>\n                                    </L7p:AuditDetailAssertion>\n                                    <L7p:Encapsulated>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// GET identityProviders\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n\n                                    <L7p:EncapsulatedAssertionConfigGuid stringValue=\"c8a5a0d5-1ae2-4144-b538-5c311efc1560\"/>\n\n                                    <L7p:EncapsulatedAssertionConfigName stringValue=\"Utility: Call Restman\"/>\n                                    <L7p:Parameters mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"element\"/>\n                                    <L7p:value stringValue=\"\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"message\"/>\n                                    <L7p:value stringValue=\"\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"method\"/>\n                                    <L7p:value stringValue=\"GET\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"resource\"/>\n                                    <L7p:value stringValue=\"identityProviders\"/>\n                                    </L7p:entry>\n                                    </L7p:Parameters>\n                                    </L7p:Encapsulated>\n                                    <L7p:ResponseXpathAssertion>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Extract list of IDPs that reference this trusted certificate\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:VariablePrefix stringValue=\"dependers\"/>\n                                    <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                    <L7p:Expression stringValue=\"/l7:List/l7:Item/l7:Resource/l7:IdentityProvider/l7:Extension/l7:FederatedIdentityProviderDetail/l7:CertificateReferences/l7:Reference[@id=$id.current]/../../../../@id\"/>\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                                    </L7p:XpathExpression>\n                                    </L7p:ResponseXpathAssertion>\n                                    <L7p:ForEachLoop\n                                    L7p:Usage=\"Required\"\n                                    loopVariable=\"dependers.results\" variablePrefix=\"depender\">\n                                    <L7p:ResponseXpathAssertion>\n\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"// Get name of Identity Provider that references this trusted certificate\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:VariablePrefix stringValue=\"name\"/>\n                                    <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                    <L7p:Expression stringValue=\"/l7:List/l7:Item/l7:Resource/l7:IdentityProvider[@id=$depender.current]/l7:Name\"/>\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                                    </L7p:XpathExpression>\n                                    </L7p:ResponseXpathAssertion>\n                                    <L7p:SetVariable>\n\n                                    <L7p:Base64Expression stringValue=\"SURFTlRJVFkgUFJPVklERVI6ICR7bmFtZS5yZXN1bHR9\"/>\n                                    <L7p:VariableToSet stringValue=\"depender\"/>\n                                    </L7p:SetVariable>\n                                    <L7p:ManipulateMultiValuedVariable>\n\n                                    <L7p:SourceVariableName stringValue=\"depender\"/>\n\n                                    <L7p:TargetVariableName stringValue=\"dependers.list\"/>\n                                    </L7p:ManipulateMultiValuedVariable>\n                                    </L7p:ForEachLoop>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Search for references in identity provider definitions\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:All>\n                                    <L7p:TrueAssertion/>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Search for references in identity provider definitions, never fail\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:OneOrMore>\n                                    <wsp:OneOrMore wsp:Usage=\"Required\">\n                                    <wsp:All wsp:Usage=\"Required\">\n                                    <L7p:ComparisonAssertion>\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:Expression1 stringValue=\"${dependers.list.length}\"/>\n                                    <L7p:Expression2 stringValue=\"1\"/>\n                                    <L7p:Operator operator=\"GE\"/>\n                                    <L7p:Predicates predicates=\"included\">\n                                    <L7p:item binary=\"included\">\n\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:Operator operator=\"GE\"/>\n                                    <L7p:RightValue stringValue=\"1\"/>\n                                    </L7p:item>\n                                    </L7p:Predicates>\n                                    </L7p:ComparisonAssertion>\n                                    <L7p:ForEachLoop\n                                    L7p:Usage=\"Required\"\n                                    loopVariable=\"dependers.list\" variablePrefix=\"depender\">\n                                    <L7p:SetVariable>\n\n                                    <L7p:Base64Expression stringValue=\"JHtkZXBlbmRlcnMuaHRtbH0NCiAgPGxpPiR7ZGVwZW5kZXIuY3VycmVudH08L2xpPg==\"/>\n                                    <L7p:VariableToSet stringValue=\"dependers.html\"/>\n                                    </L7p:SetVariable>\n                                    </L7p:ForEachLoop>\n                                    <L7p:SetVariable>\n                                    <L7p:Base64Expression stringValue=\"JHtodG1sQ29udGVudH0NCg0KPHA+VGhlIGZvbGxvd2luZyBvYmplY3RzIHJlZmVyZW5jZSB0aGlzIHRydXN0ZWQgY2VydGlmaWNhdGU6PC9wPg0KPHVsPiR7ZGVwZW5kZXJzLmh0bWx9PC91bD4NCjxwPkNhdmVhdCBlbXB0b3I6IFRoaXMgZG9lcyBub3QgbG9vayBmb3IgdHJ1c3RlZCBjZXJ0aWZpY2F0ZXMgcmVmZXJlbmNlZCBpbiBwb2xpY3kgYnkgY29udGV4dCB2YXJpYWJsZXMhPC9wPg==\"/>\n                                    <L7p:VariableToSet stringValue=\"htmlContent\"/>\n                                    </L7p:SetVariable>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// ${dependers.list} has content\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:All>\n                                    <L7p:SetVariable>\n                                    <L7p:Base64Expression stringValue=\"JHtodG1sQ29udGVudH0NCjxwPk5vdGhpbmcgd2FzIGZvdW5kIHRoYXQgcmVmZXJlbmNlcyB0aGlzIHRydXN0ZWQgY2VydGlmaWNhdGU8L3A+DQo8cD5DYXZlYXQgZW1wdG9yOiBUaGlzIGRvZXMgbm90IGxvb2sgZm9yIHRydXN0ZWQgY2VydGlmaWNhdGVzIHJlZmVyZW5jZWQgaW4gcG9saWN5IGJ5IGNvbnRleHQgdmFyaWFibGVzITwvcD4=\"/>\n                                    <L7p:VariableToSet stringValue=\"htmlContent\"/>\n                                    </L7p:SetVariable>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Append ${dependers.html} to ${htmlContent} if ${dependers.list} has any entries\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:OneOrMore>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// ${id} matches so retrieve dependers\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                </wsp:All>\n                                <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Do reverse dependency search if id matches\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:assertionComment>\n                            </wsp:OneOrMore>\n                            <L7p:assertionComment>\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Cycle through each object to add to display and check if search must be run\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:assertionComment>\n                        </L7p:ForEachLoop>\n                        <L7p:assertionComment>\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// ${objectType} == &quot;Trusted Certificate&quot;\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:assertionComment>\n                    </wsp:All>\n                    <wsp:All wsp:Usage=\"Required\">\n                        <L7p:ComparisonAssertion>\n                            <L7p:CaseSensitive booleanValue=\"false\"/>\n                            <L7p:Expression1 stringValue=\"${objectType}\"/>\n                            <L7p:Expression2 stringValue=\"User\"/>\n                            <L7p:Predicates predicates=\"included\">\n                                <L7p:item binary=\"included\">\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:RightValue stringValue=\"User\"/>\n                                </L7p:item>\n                            </L7p:Predicates>\n                        </L7p:ComparisonAssertion>\n                        <L7p:AuditDetailAssertion>\n                            <L7p:AssertionComment assertionComment=\"included\">\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// FINE\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:AssertionComment>\n                            <L7p:Detail stringValue=\"======> Listing ${objectType} objects\"/>\n                            <L7p:Level stringValue=\"FINE\"/>\n                        </L7p:AuditDetailAssertion>\n                        <L7p:Encapsulated>\n                            <L7p:AssertionComment assertionComment=\"included\">\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Get list of objectTypes to display and search for references\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:AssertionComment>\n                            <L7p:EncapsulatedAssertionConfigGuid stringValue=\"005d518f-604e-4c02-b889-85c2607e46cc\"/>\n                            <L7p:EncapsulatedAssertionConfigName stringValue=\"Utility: List Users\"/>\n                            <L7p:Parameters mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"cacheAge\"/>\n                                    <L7p:value stringValue=\"${cacheAge}\"/>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"refresh\"/>\n                                    <L7p:value stringValue=\"${request.http.parameter.refresh}\"/>\n                                </L7p:entry>\n                            </L7p:Parameters>\n                        </L7p:Encapsulated>\n                        <L7p:ResponseXpathAssertion>\n                            <L7p:AssertionComment assertionComment=\"included\">\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Get list of ids\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:AssertionComment>\n                            <L7p:VariablePrefix stringValue=\"ids\"/>\n                            <L7p:XmlMsgSrc stringValue=\"users.sorted\"/>\n                            <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                <L7p:Expression stringValue=\"/Users/User/@id\"/>\n                                <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"s\"/>\n                                    <L7p:value stringValue=\"http://schemas.xmlsoap.org/soap/envelope/\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                    </L7p:entry>\n                                </L7p:Namespaces>\n                                <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                            </L7p:XpathExpression>\n                        </L7p:ResponseXpathAssertion>\n                        <L7p:ForEachLoop L7p:Usage=\"Required\"\n                            loopVariable=\"ids.results\" variablePrefix=\"id\">\n                            <L7p:ResponseXpathAssertion>\n                                <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Get name of the object for display\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:AssertionComment>\n                                <L7p:VariablePrefix stringValue=\"name\"/>\n                                <L7p:XmlMsgSrc stringValue=\"users.sorted\"/>\n                                <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                    <L7p:Expression stringValue=\"/Users/User[@id=$id.current]/Name\"/>\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"s\"/>\n                                    <L7p:value stringValue=\"http://schemas.xmlsoap.org/soap/envelope/\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                                </L7p:XpathExpression>\n                            </L7p:ResponseXpathAssertion>\n                            <L7p:ResponseXpathAssertion>\n                                <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Get providerName of the object for display\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:AssertionComment>\n                                <L7p:VariablePrefix stringValue=\"providerName\"/>\n                                <L7p:XmlMsgSrc stringValue=\"users.sorted\"/>\n                                <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                    <L7p:Expression stringValue=\"/Users/User[@id=$id.current]/@providerName\"/>\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"s\"/>\n                                    <L7p:value stringValue=\"http://schemas.xmlsoap.org/soap/envelope/\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                                </L7p:XpathExpression>\n                            </L7p:ResponseXpathAssertion>\n                            <L7p:AuditDetailAssertion>\n                                <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// FINE\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:AssertionComment>\n                                <L7p:Detail stringValue=\"=====> Processing ${objectType}: ${login.result} (${id.current})\"/>\n                                <L7p:Level stringValue=\"FINE\"/>\n                            </L7p:AuditDetailAssertion>\n                            <L7p:Encapsulated>\n                                <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// ${providerName.result}: ${name.result}\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:AssertionComment>\n                                <L7p:EncapsulatedAssertionConfigGuid stringValue=\"f6b19229-a705-4c48-bc78-3975564a1a9a\"/>\n                                <L7p:EncapsulatedAssertionConfigName stringValue=\"Utility: Escape HTML String\"/>\n                                <L7p:Parameters mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"escapedString\"/>\n                                    <L7p:value stringValue=\"${providerName.result} : ${name.result}\"/>\n                                    </L7p:entry>\n                                </L7p:Parameters>\n                            </L7p:Encapsulated>\n                            <L7p:SetVariable>\n                                <L7p:Base64Expression stringValue=\"JHtodG1sQ29udGVudH0NCjxhIGlkPSIke2lkLmN1cnJlbnR9Ii8+PGEgaHJlZj0iJHtyZXF1ZXN0LnVybC5wYXRofT9vYmplY3RUeXBlPSR7b2JqZWN0VHlwZX0maWQ9JHtpZC5jdXJyZW50fSMke2lkLmN1cnJlbnR9IiBvbkNsaWNrPSJzZXRSZWZyZXNoKHRoaXMpIj4ke2VzY2FwZWRTdHJpbmd9PC9hPjxici8+\"/>\n                                <L7p:VariableToSet stringValue=\"htmlContent\"/>\n                            </L7p:SetVariable>\n                            <wsp:OneOrMore wsp:Usage=\"Required\">\n                                <L7p:ComparisonAssertion>\n                                    <L7p:Expression1 stringValue=\"${id}\"/>\n                                    <L7p:Expression2 stringValue=\"${id.current}\"/>\n                                    <L7p:Negate booleanValue=\"true\"/>\n                                    <L7p:Predicates predicates=\"included\">\n                                    <L7p:item binary=\"included\">\n                                    <L7p:Negated booleanValue=\"true\"/>\n                                    <L7p:RightValue stringValue=\"${id.current}\"/>\n                                    </L7p:item>\n                                    </L7p:Predicates>\n                                </L7p:ComparisonAssertion>\n                                <wsp:All wsp:Usage=\"Required\">\n                                    <L7p:AuditDetailAssertion>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// FINE\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:Detail stringValue=\"====> ID matched, processing for dependencies\"/>\n                                    <L7p:Level stringValue=\"FINE\"/>\n                                    </L7p:AuditDetailAssertion>\n                                    <L7p:ResponseXpathAssertion>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Get providerId of the object for confirmation\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:VariablePrefix stringValue=\"providerId\"/>\n                                    <L7p:XmlMsgSrc stringValue=\"users.sorted\"/>\n                                    <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                    <L7p:Expression stringValue=\"/Users/User[@id=$id.current]/@providerId\"/>\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"s\"/>\n                                    <L7p:value stringValue=\"http://schemas.xmlsoap.org/soap/envelope/\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                                    </L7p:XpathExpression>\n                                    </L7p:ResponseXpathAssertion>\n                                    <L7p:SetVariable>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// The final identifier string we'll use\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:Base64Expression stringValue=\"PEw3cDpVc2VyVWlkIHN0cmluZ1ZhbHVlPSIke2lkLmN1cnJlbnR9Ii8+\"/>\n                                    <L7p:VariableToSet stringValue=\"referenceString\"/>\n                                    </L7p:SetVariable>\n                                    <L7p:AuditDetailAssertion>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// FINE\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:Detail stringValue=\"===> Searching objects for references to ${referenceString}\"/>\n                                    <L7p:Level stringValue=\"FINE\"/>\n                                    </L7p:AuditDetailAssertion>\n                                    <wsp:OneOrMore wsp:Usage=\"Required\">\n                                    <wsp:All wsp:Usage=\"Required\">\n                                    <L7p:AuditDetailAssertion>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// FINE\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:Detail stringValue=\"==> Searching policy XML\"/>\n                                    <L7p:Level stringValue=\"FINE\"/>\n                                    </L7p:AuditDetailAssertion>\n                                    <L7p:ResponseXpathAssertion>\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Extract all policy objects that contain the reference string\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:VariablePrefix stringValue=\"policies\"/>\n                                    <L7p:XmlMsgSrc stringValue=\"allPolicyXML\"/>\n                                    <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                    <L7p:Expression stringValue=\"/AllPolicyXML/PolicyXML[contains(.,$referenceString)]\"/>\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                                    </L7p:XpathExpression>\n                                    </L7p:ResponseXpathAssertion>\n                                    <L7p:ForEachLoop\n                                    L7p:Usage=\"Required\"\n                                    loopVariable=\"policies.elements\" variablePrefix=\"policy\">\n                                    <L7p:SetVariable>\n\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"// Cast to message type for XPath\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n\n                                    <L7p:Base64Expression stringValue=\"JHtwb2xpY3kuY3VycmVudH0=\"/>\n                                    <L7p:ContentType stringValue=\"text/xml; charset=utf-8\"/>\n                                    <L7p:DataType variableDataType=\"message\"/>\n                                    <L7p:VariableToSet stringValue=\"policyObject.xml\"/>\n                                    </L7p:SetVariable>\n                                    <L7p:ResponseXpathAssertion>\n\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"// Extract the policy XML from the policy object\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n                                    <L7p:VariablePrefix stringValue=\"policy.xml\"/>\n                                    <L7p:XmlMsgSrc stringValue=\"policyObject.xml\"/>\n                                    <L7p:XpathExpression xpathExpressionValue=\"included\">\n                                    <L7p:Expression stringValue=\"/PolicyXML/text()\"/>\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"s\"/>\n\n                                    <L7p:value stringValue=\"http://schemas.xmlsoap.org/soap/envelope/\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"l7\"/>\n\n                                    <L7p:value stringValue=\"http://ns.l7tech.com/2010/04/gateway-management\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                                    </L7p:XpathExpression>\n                                    </L7p:ResponseXpathAssertion>\n                                    <L7p:SetVariable>\n\n                                    <L7p:AssertionComment assertionComment=\"included\">\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"// Cast to message type for XPath\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n\n                                    <L7p:Base64Expression stringValue=\"JHtwb2xpY3kueG1sLnJlc3VsdH0=\"/>\n                                    <L7p:ContentType stringValue=\"text/xml; charset=utf-8\"/>\n                                    <L7p:DataType variableDataType=\"message\"/>\n                                    <L7p:VariableToSet stringValue=\"policy.xml\"/>\n                                    </L7p:SetVariable>\n                                    <wsp:OneOrMore wsp:Usage=\"Required\">\n                                    <wsp:All wsp:Usage=\"Required\">\n                                    <L7p:ResponseXpathAssertion>\n\n                                    <L7p:AssertionComment assertionComment=\"included\">\n\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"// Check if the policy XML has a reference to this user id\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:AssertionComment>\n\n                                    <L7p:VariablePrefix stringValue=\"\"/>\n\n                                    <L7p:XmlMsgSrc stringValue=\"policy.xml\"/>\n\n                                    <L7p:XpathExpression xpathExpressionValue=\"included\">\n\n                                    <L7p:Expression stringValue=\"//L7p:SpecificUser/L7p:IdentityProviderOid[@goidValue=$providerId.result]\"/>\n\n                                    <L7p:Namespaces mapValue=\"included\">\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"L7p\"/>\n\n                                    <L7p:value stringValue=\"http://www.layer7tech.com/ws/policy\"/>\n                                    </L7p:entry>\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"wsp\"/>\n\n                                    <L7p:value stringValue=\"http://schemas.xmlsoap.org/ws/2002/12/policy\"/>\n                                    </L7p:entry>\n                                    </L7p:Namespaces>\n\n                                    <L7p:XpathVersion xpathVersion=\"XPATH_1_0\"/>\n                                    </L7p:XpathExpression>\n                                    </L7p:ResponseXpathAssertion>\n                                    <L7p:Include>\n\n                                    <L7p:PolicyGuid stringValue=\"8f33b165-bc16-4959-a524-aba67aff3cdf\"/>\n                                    </L7p:Include>\n                                    <L7p:SetVariable>\n\n                                    <L7p:Base64Expression stringValue=\"JHtzb3VyY2VUeXBlLnJlc3VsdH06ICR7Zm9sZGVyUGF0aC5yZXN1bHR9JHtuYW1lLnJlc3VsdH0=\"/>\n\n                                    <L7p:VariableToSet stringValue=\"depender\"/>\n                                    </L7p:SetVariable>\n                                    <L7p:ManipulateMultiValuedVariable>\n\n                                    <L7p:SourceVariableName stringValue=\"depender\"/>\n\n                                    <L7p:TargetVariableName stringValue=\"dependers.list\"/>\n                                    </L7p:ManipulateMultiValuedVariable>\n                                    <L7p:assertionComment>\n\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"// Search policy XML for IdentityProviderOid element matching our reference\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:All>\n                                    <L7p:TrueAssertion/>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n\n                                    <L7p:value stringValue=\"// Search policy XML for IdentityProviderOid element matching our reference, never fail\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:OneOrMore>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Cycle through each policy that has our reference string and confirm the provider\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </L7p:ForEachLoop>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Search for references in policy XML\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:All>\n                                    <L7p:TrueAssertion/>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Search for references in policy XML, never fail\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:OneOrMore>\n                                    <wsp:OneOrMore wsp:Usage=\"Required\">\n                                    <wsp:All wsp:Usage=\"Required\">\n                                    <L7p:ComparisonAssertion>\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:Expression1 stringValue=\"${dependers.list.length}\"/>\n                                    <L7p:Expression2 stringValue=\"1\"/>\n                                    <L7p:Operator operator=\"GE\"/>\n                                    <L7p:Predicates predicates=\"included\">\n                                    <L7p:item binary=\"included\">\n\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:Operator operator=\"GE\"/>\n                                    <L7p:RightValue stringValue=\"1\"/>\n                                    </L7p:item>\n                                    </L7p:Predicates>\n                                    </L7p:ComparisonAssertion>\n                                    <L7p:ForEachLoop\n                                    L7p:Usage=\"Required\"\n                                    loopVariable=\"dependers.list\" variablePrefix=\"depender\">\n                                    <L7p:SetVariable>\n\n                                    <L7p:Base64Expression stringValue=\"JHtkZXBlbmRlcnMuaHRtbH0NCiAgPGxpPiR7ZGVwZW5kZXIuY3VycmVudH08L2xpPg==\"/>\n                                    <L7p:VariableToSet stringValue=\"dependers.html\"/>\n                                    </L7p:SetVariable>\n                                    </L7p:ForEachLoop>\n                                    <L7p:SetVariable>\n                                    <L7p:Base64Expression stringValue=\"JHtodG1sQ29udGVudH0NCg0KPHA+VGhlIGZvbGxvd2luZyBvYmplY3RzIHJlZmVyZW5jZSB0aGlzIHVzZXI6PC9wPg0KPHVsPiR7ZGVwZW5kZXJzLmh0bWx9PC91bD4=\"/>\n                                    <L7p:VariableToSet stringValue=\"htmlContent\"/>\n                                    </L7p:SetVariable>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// ${dependers.list} has content\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:All>\n                                    <L7p:SetVariable>\n                                    <L7p:Base64Expression stringValue=\"JHtodG1sQ29udGVudH0NCjxwPk5vdGhpbmcgd2FzIGZvdW5kIHRoYXQgcmVmZXJlbmNlcyB0aGlzIHVzZXI8L3A+\"/>\n                                    <L7p:VariableToSet stringValue=\"htmlContent\"/>\n                                    </L7p:SetVariable>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Append ${dependers.html} to ${htmlContent} if ${dependers.list} has any entries\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                    </wsp:OneOrMore>\n                                    <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// ${id} matches so retrieve dependers\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                    </L7p:assertionComment>\n                                </wsp:All>\n                                <L7p:assertionComment>\n                                    <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Do reverse dependency search if id matches\"/>\n                                    </L7p:entry>\n                                    </L7p:Properties>\n                                </L7p:assertionComment>\n                            </wsp:OneOrMore>\n                            <L7p:assertionComment>\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Cycle through each object to add to display and check if search must be run\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:assertionComment>\n                        </L7p:ForEachLoop>\n                        <L7p:assertionComment>\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// ${objectType} == &quot;User&quot;\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:assertionComment>\n                    </wsp:All>\n                    <wsp:All wsp:Usage=\"Required\">\n                        <L7p:ComparisonAssertion>\n                            <L7p:CaseSensitive booleanValue=\"false\"/>\n                            <L7p:Expression1 stringValue=\"${ids.found}\"/>\n                            <L7p:Operator operatorNull=\"null\"/>\n                            <L7p:Predicates predicates=\"included\">\n                                <L7p:item dataType=\"included\">\n                                    <L7p:Type variableDataType=\"boolean\"/>\n                                </L7p:item>\n                                <L7p:item binary=\"included\">\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:RightValue stringValue=\"false\"/>\n                                </L7p:item>\n                            </L7p:Predicates>\n                        </L7p:ComparisonAssertion>\n                        <L7p:AuditDetailAssertion>\n                            <L7p:AssertionComment assertionComment=\"included\">\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// FINE\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:AssertionComment>\n                            <L7p:Detail stringValue=\"==> No objects of ${objectType} found\"/>\n                            <L7p:Level stringValue=\"FINE\"/>\n                        </L7p:AuditDetailAssertion>\n                        <L7p:SetVariable>\n                            <L7p:Base64Expression stringValue=\"PHA+Tm8gJHtvYmplY3RUeXBlfSBvYmplY3RzIHdlcmUgZm91bmQuPC9wPg==\"/>\n                            <L7p:VariableToSet stringValue=\"htmlContent\"/>\n                        </L7p:SetVariable>\n                        <L7p:assertionComment>\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// if ${ids.found} == false then set message to &quot;No objects found&quot;\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:assertionComment>\n                    </wsp:All>\n                    <wsp:All wsp:Usage=\"Required\">\n                        <L7p:AuditDetailAssertion>\n                            <L7p:AssertionComment assertionComment=\"included\">\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// FINE\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:AssertionComment>\n                            <L7p:Detail stringValue=\"==> Failed to process object type: ${objectType}\"/>\n                            <L7p:Level stringValue=\"FINE\"/>\n                        </L7p:AuditDetailAssertion>\n                        <L7p:SetVariable>\n                            <L7p:Base64Expression stringValue=\"RmFpbGVkIHRvIHByb2Nlc3Mgb2JqZWN0IHR5cGU6ICR7b2JqZWN0VHlwZX0gaWRzLmZvdW5kPSR7aWRzLmZvdW5kfQ==\"/>\n                            <L7p:VariableToSet stringValue=\"error.message\"/>\n                        </L7p:SetVariable>\n                        <L7p:SetVariable>\n                            <L7p:Base64Expression stringValue=\"NTAw\"/>\n                            <L7p:VariableToSet stringValue=\"error.status\"/>\n                        </L7p:SetVariable>\n                        <L7p:FalseAssertion/>\n                        <L7p:assertionComment>\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Failure processing request\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:assertionComment>\n                    </wsp:All>\n                    <L7p:assertionComment>\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// Handle different objectTypes\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:assertionComment>\n                </wsp:OneOrMore>\n                <L7p:HardcodedResponse>\n                    <L7p:Base64ResponseBody stringValue=\"PGh0bWw+CiAgPGhlYWQ+CiAgICA8dGl0bGU+QVBJIEdhdGV3YXkgRGVwZW5kZW5jeSBBbmFseXplcjwvdGl0bGU+CgogICAgPHNjcmlwdD4KICAgICAgZnVuY3Rpb24gc2V0UmVmcmVzaCAob2JqZWN0KSB7CiAgICAgICAgdXJsPW5ldyBVUkwob2JqZWN0LmhyZWYpOwogICAgICAgIHVybC5zZWFyY2hQYXJhbXMuc2V0KCdyZWZyZXNoJywgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoInJlZnJlc2giKS5jaGVja2VkKTsKICAgICAgICBvYmplY3QuaHJlZj11cmw7CiAgICAgIH0KICAgIDwvc2NyaXB0PgogIDwvaGVhZD4KCiAgPGJvZHk+CiAgICA8aDE+QVBJIEdhdGV3YXkgRGVwZW5kZW5jeSBBbmFseXplcjwvaDE+CgogICAgPHA+U2VsZWN0IG9iamVjdCB0eXBlIHRvIGdlbmVyYXRlIGxpc3Qgb2Ygb2JqZWN0cywgdGhlbiBzZWxlY3QgYSBzcGVjaWZpYyBvYmplY3QgdG8gZmluZAogICAgICAgd2hhdCBkZXBlbmRzIG9uIGl0LjwvcD4KCiAgICA8cD5Ob3RlOiBUaGlzIHV0aWxpdHkgaXMgcHJvdmlkZWQgYXMtaXMgYW5kIGlzIG5vdCBuZWNlc3NhcmlseSBjb21wcmVoZW5zaXZlLiBDYXZlYXQgRW1wdG9yLjwvcD4KCiAgICA8Zm9ybSBtZXRob2Q9IkdFVCI+CiAgICA8cD5PYmplY3QgVHlwZTogJHtvYmplY3RUeXBlLnNlbGVjdH08L3A+CiAgICA8L2Zvcm0+CgogICAgPHA+UmVmcmVzaCBjYWNoZT8gPGlucHV0IHR5cGU9ImNoZWNrYm94IiBpZD0icmVmcmVzaCI+PC9wPgoKJHtodG1sQ29udGVudH0KCiAgICA8aHIvPgogICAgPHA+PGEgaHJlZj0iJHtyZXF1ZXN0LnVybC5wYXRofT9hY3Rpb249bG9nb3V0Ij5Mb2dvdXQ8L2E+IHwgPGEgaHJlZj0iL2FwaWd3L3V0aWxpdHlUZXN0ZXIiPlV0aWxpdHkgQXNzZXJ0aW9ucyBUZXN0ZXI8L2E+PC9wPgogIDwvYm9keT4KPC9odG1sPg==\"/>\n                    <L7p:ResponseContentType stringValue=\"text/html; charset=UTF-8\"/>\n                </L7p:HardcodedResponse>\n                <L7p:assertionComment>\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// ${loggedIn} == true\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:assertionComment>\n            </wsp:All>\n            <wsp:All wsp:Usage=\"Required\">\n                <L7p:ComparisonAssertion>\n                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                    <L7p:Expression1 stringValue=\"${loggedIn}\"/>\n                    <L7p:Operator operatorNull=\"null\"/>\n                    <L7p:Predicates predicates=\"included\">\n                        <L7p:item dataType=\"included\">\n                            <L7p:Type variableDataType=\"boolean\"/>\n                        </L7p:item>\n                        <L7p:item binary=\"included\">\n                            <L7p:CaseSensitive booleanValue=\"false\"/>\n                            <L7p:RightValue stringValue=\"false\"/>\n                        </L7p:item>\n                    </L7p:Predicates>\n                </L7p:ComparisonAssertion>\n                <wsp:OneOrMore wsp:Usage=\"Required\">\n                    <wsp:All wsp:Usage=\"Required\">\n                        <L7p:ComparisonAssertion>\n                            <L7p:CaseSensitive booleanValue=\"false\"/>\n                            <L7p:Expression1 stringValue=\"${logout}\"/>\n                            <L7p:Operator operatorNull=\"null\"/>\n                            <L7p:Predicates predicates=\"included\">\n                                <L7p:item dataType=\"included\">\n                                    <L7p:Type variableDataType=\"boolean\"/>\n                                </L7p:item>\n                                <L7p:item binary=\"included\">\n                                    <L7p:CaseSensitive booleanValue=\"false\"/>\n                                    <L7p:RightValue stringValue=\"true\"/>\n                                </L7p:item>\n                            </L7p:Predicates>\n                        </L7p:ComparisonAssertion>\n                        <L7p:SetVariable>\n                            <L7p:Base64Expression stringValue=\"\"/>\n                            <L7p:DataType variableDataType=\"dateTime\"/>\n                            <L7p:DateOffsetExpression stringValue=\"-1\"/>\n                            <L7p:DateOffsetField intValue=\"5\"/>\n                            <L7p:VariableToSet stringValue=\"yesterday\"/>\n                        </L7p:SetVariable>\n                        <L7p:ManageCookie>\n                            <L7p:CookieAttributes mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"name\"/>\n                                    <L7p:value nameValuePair=\"included\">\n                                    <L7p:Key stringValue=\"name\"/>\n                                    <L7p:Value stringValue=\"sessionKey\"/>\n                                    </L7p:value>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"max-age\"/>\n                                    <L7p:value nameValuePair=\"included\">\n                                    <L7p:Key stringValue=\"max-age\"/>\n                                    <L7p:Value stringValue=\"0\"/>\n                                    </L7p:value>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"httpOnly\"/>\n                                    <L7p:value nameValuePair=\"included\">\n                                    <L7p:Key stringValue=\"httpOnly\"/>\n                                    <L7p:Value stringValue=\"true\"/>\n                                    </L7p:value>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"secure\"/>\n                                    <L7p:value nameValuePair=\"included\">\n                                    <L7p:Key stringValue=\"secure\"/>\n                                    <L7p:Value stringValue=\"true\"/>\n                                    </L7p:value>\n                                </L7p:entry>\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"value\"/>\n                                    <L7p:value nameValuePair=\"included\">\n                                    <L7p:Key stringValue=\"value\"/>\n                                    <L7p:Value stringValue=\"NULL\"/>\n                                    </L7p:value>\n                                </L7p:entry>\n                            </L7p:CookieAttributes>\n                            <L7p:Operation operation=\"ADD_OR_REPLACE\"/>\n                            <L7p:Target target=\"RESPONSE\"/>\n                        </L7p:ManageCookie>\n                        <L7p:CacheStorage>\n                            <L7p:AssertionComment assertionComment=\"included\">\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Remove from cache by setting TTL to 0\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:AssertionComment>\n                            <L7p:CacheEntryKey stringValue=\"${cookie.sessionKey}\"/>\n                            <L7p:CacheId stringValue=\"loginCache\"/>\n                            <L7p:MaxEntries stringValue=\"25\"/>\n                            <L7p:MaxEntryAgeSeconds stringValue=\"0\"/>\n                            <L7p:MaxEntrySizeBytes stringValue=\"1000\"/>\n                            <L7p:OtherTargetMessageVariable stringValue=\"sessionDetail\"/>\n                            <L7p:Target target=\"OTHER\"/>\n                        </L7p:CacheStorage>\n                        <L7p:AddHeader>\n                            <L7p:HeaderName stringValue=\"Location\"/>\n                            <L7p:HeaderValue stringValue=\"${request.url.path}\"/>\n                            <L7p:Target target=\"RESPONSE\"/>\n                        </L7p:AddHeader>\n                        <L7p:HardcodedResponse>\n                            <L7p:Base64ResponseBody stringValue=\"PGh0bWw+CjxoZWFkPgo8dGl0bGU+JHtmb3JtLm1lc3NhZ2V9PC90aXRsZT4KPC9oZWFkPgoKPGJvZHk+CjxoMT4ke2Zvcm0ubWVzc2FnZX08L2gxPgoKPHA+PGEgaHJlZj0iJHtyZXF1ZXN0LnVybC5wYXRofSI+Q29udGludWU8L3A+CjxociAvPgo8L2JvZHk+CjwvaHRtbD4=\"/>\n                            <L7p:ResponseContentType stringValue=\"text/html; charset=UTF-8\"/>\n                            <L7p:ResponseStatus stringValue=\"302\"/>\n                        </L7p:HardcodedResponse>\n                        <L7p:assertionComment>\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Logout\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:assertionComment>\n                    </wsp:All>\n                    <wsp:All wsp:Usage=\"Required\">\n                        <L7p:AuditDetailAssertion>\n                            <L7p:AssertionComment assertionComment=\"included\">\n                                <L7p:Properties mapValue=\"included\">\n                                    <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// FINE\"/>\n                                    </L7p:entry>\n                                </L7p:Properties>\n                            </L7p:AssertionComment>\n                            <L7p:Detail stringValue=\"==> Not authenticated, returning login form\"/>\n                            <L7p:Level stringValue=\"FINE\"/>\n                        </L7p:AuditDetailAssertion>\n                        <L7p:HardcodedResponse>\n                            <L7p:Base64ResponseBody stringValue=\"PGh0bWw+CiAgPGhlYWQ+CiAgICA8dGl0bGU+QVBJIEdhdGV3YXkgRGVwZW5kZW5jaWVzIEFuYWx5emVyPC90aXRsZT4KICA8L2hlYWQ+CgogIDxib2R5PgogICAgPGgxPkFQSSBHYXRld2F5IERlcGVuZGVuY2llcyBBbmFseXplcjwvaDE+CgogICAgPHA+JHtmb3JtLm1lc3NhZ2V9PC9wPgoKICAgIDxwPlBsZWFzZSBwcm92aWRlIFBvbGljeSBNYW5hZ2VyIGFkbWluaXN0cmF0b3IgY3JlZGVudGlhbHM6PC9wPgogICAgPGZvcm0gbWV0aG9kPSJQT1NUIj4KICAgIDxwPlVzZXJuYW1lOiA8aW5wdXQgbmFtZT0idXNlcm5hbWUiIHR5cGU9InRleHQiLz48YnIvPgogICAgUGFzc3dvcmQ6IDxpbnB1dCBuYW1lPSJwYXNzd29yZCIgdHlwZT0icGFzc3dvcmQiLz48YnIvPgogICAgPGlucHV0IHR5cGU9InN1Ym1pdCIgdmFsdWU9IkNvbnRpbnVlIi8+PC9wPgogICAgPGlucHV0IHR5cGU9ImhpZGRlbiIgbmFtZT0iYWN0aW9uIiB2YWx1ZT0ibG9naW4iLz4KICAgIDwvZm9ybT4KCiAgICA8aHIvPgogIDwvYm9keT4KPC9odG1sPg==\"/>\n                            <L7p:ResponseContentType stringValue=\"text/html; charset=UTF-8\"/>\n                        </L7p:HardcodedResponse>\n                        <L7p:assertionComment>\n                            <L7p:Properties mapValue=\"included\">\n                                <L7p:entry>\n                                    <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                    <L7p:value stringValue=\"// Failed or new\"/>\n                                </L7p:entry>\n                            </L7p:Properties>\n                        </L7p:assertionComment>\n                    </wsp:All>\n                    <L7p:assertionComment>\n                        <L7p:Properties mapValue=\"included\">\n                            <L7p:entry>\n                                <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                                <L7p:value stringValue=\"// Handle logout vs failed or new login\"/>\n                            </L7p:entry>\n                        </L7p:Properties>\n                    </L7p:assertionComment>\n                </wsp:OneOrMore>\n                <L7p:assertionComment>\n                    <L7p:Properties mapValue=\"included\">\n                        <L7p:entry>\n                            <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                            <L7p:value stringValue=\"// ${loggedIn} == false\"/>\n                        </L7p:entry>\n                    </L7p:Properties>\n                </L7p:assertionComment>\n            </wsp:All>\n            <L7p:assertionComment>\n                <L7p:Properties mapValue=\"included\">\n                    <L7p:entry>\n                        <L7p:key stringValue=\"RIGHT.COMMENT\"/>\n                        <L7p:value stringValue=\"// Do processing if ${loggedIn} == true else return login form\"/>\n                    </L7p:entry>\n                </L7p:Properties>\n            </L7p:assertionComment>\n        </wsp:OneOrMore>\n    </wsp:All>\n</wsp:Policy>\n"
      }
    }
  ],
  "properties": {
    "meta": {
      "id": "81277fdb-27f1-4e2b-8d1a-a93bd7e67a90",
      "name": "Gateway Graphman Bundle - 2025-02-05T14:21:31.436Z",
      "author": "admin",
      "hostname": "localhost",
      "timestamp": "2025-02-05T14:21:31.436Z"
    },
    "defaultAction": "NEW_OR_UPDATE"
  }
}